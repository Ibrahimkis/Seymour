(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();function Tm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _h={exports:{}},xs={};var Ob;function TM(){if(Ob)return xs;Ob=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,o,s){var a=null;if(s!==void 0&&(a=""+s),o.key!==void 0&&(a=""+o.key),"key"in o){s={};for(var u in o)u!=="key"&&(s[u]=o[u])}else s=o;return o=s.ref,{$$typeof:t,type:i,key:a,ref:o!==void 0?o:null,props:s}}return xs.Fragment=e,xs.jsx=n,xs.jsxs=n,xs}var Rb;function MM(){return Rb||(Rb=1,_h.exports=TM()),_h.exports}var b=MM(),Hh={exports:{}},Ce={};var Db;function AM(){if(Db)return Ce;Db=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),x=Symbol.iterator;function v(O){return O===null||typeof O!="object"?null:(O=x&&O[x]||O["@@iterator"],typeof O=="function"?O:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,w={};function E(O,U,K){this.props=O,this.context=U,this.refs=w,this.updater=K||S}E.prototype.isReactComponent={},E.prototype.setState=function(O,U){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,U,"setState")},E.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function A(){}A.prototype=E.prototype;function D(O,U,K){this.props=O,this.context=U,this.refs=w,this.updater=K||S}var L=D.prototype=new A;L.constructor=D,k(L,E.prototype),L.isPureReactComponent=!0;var T=Array.isArray;function z(){}var N={H:null,A:null,T:null,S:null},B=Object.prototype.hasOwnProperty;function _(O,U,K){var ie=K.ref;return{$$typeof:t,type:O,key:U,ref:ie!==void 0?ie:null,props:K}}function W(O,U){return _(O.type,U,O.props)}function oe(O){return typeof O=="object"&&O!==null&&O.$$typeof===t}function re(O){var U={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(K){return U[K]})}var fe=/\/+/g;function he(O,U){return typeof O=="object"&&O!==null&&O.key!=null?re(""+O.key):U.toString(36)}function we(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(z,z):(O.status="pending",O.then(function(U){O.status==="pending"&&(O.status="fulfilled",O.value=U)},function(U){O.status==="pending"&&(O.status="rejected",O.reason=U)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function q(O,U,K,ie,le){var Y=typeof O;(Y==="undefined"||Y==="boolean")&&(O=null);var Z=!1;if(O===null)Z=!0;else switch(Y){case"bigint":case"string":case"number":Z=!0;break;case"object":switch(O.$$typeof){case t:case e:Z=!0;break;case p:return Z=O._init,q(Z(O._payload),U,K,ie,le)}}if(Z)return le=le(O),Z=ie===""?"."+he(O,0):ie,T(le)?(K="",Z!=null&&(K=Z.replace(fe,"$&/")+"/"),q(le,U,K,"",function(Mt){return Mt})):le!=null&&(oe(le)&&(le=W(le,K+(le.key==null||O&&O.key===le.key?"":(""+le.key).replace(fe,"$&/")+"/")+Z)),U.push(le)),1;Z=0;var ae=ie===""?".":ie+":";if(T(O))for(var me=0;me<O.length;me++)ie=O[me],Y=ae+he(ie,me),Z+=q(ie,U,K,Y,le);else if(me=v(O),typeof me=="function")for(O=me.call(O),me=0;!(ie=O.next()).done;)ie=ie.value,Y=ae+he(ie,me++),Z+=q(ie,U,K,Y,le);else if(Y==="object"){if(typeof O.then=="function")return q(we(O),U,K,ie,le);throw U=String(O),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return Z}function ee(O,U,K){if(O==null)return O;var ie=[],le=0;return q(O,ie,"","",function(Y){return U.call(K,Y,le++)}),ie}function ce(O){if(O._status===-1){var U=O._result;U=U(),U.then(function(K){(O._status===0||O._status===-1)&&(O._status=1,O._result=K)},function(K){(O._status===0||O._status===-1)&&(O._status=2,O._result=K)}),O._status===-1&&(O._status=0,O._result=U)}if(O._status===1)return O._result.default;throw O._result}var te=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(U))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},pe={map:ee,forEach:function(O,U,K){ee(O,function(){U.apply(this,arguments)},K)},count:function(O){var U=0;return ee(O,function(){U++}),U},toArray:function(O){return ee(O,function(U){return U})||[]},only:function(O){if(!oe(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return Ce.Activity=g,Ce.Children=pe,Ce.Component=E,Ce.Fragment=n,Ce.Profiler=o,Ce.PureComponent=D,Ce.StrictMode=i,Ce.Suspense=d,Ce.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,Ce.__COMPILER_RUNTIME={__proto__:null,c:function(O){return N.H.useMemoCache(O)}},Ce.cache=function(O){return function(){return O.apply(null,arguments)}},Ce.cacheSignal=function(){return null},Ce.cloneElement=function(O,U,K){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var ie=k({},O.props),le=O.key;if(U!=null)for(Y in U.key!==void 0&&(le=""+U.key),U)!B.call(U,Y)||Y==="key"||Y==="__self"||Y==="__source"||Y==="ref"&&U.ref===void 0||(ie[Y]=U[Y]);var Y=arguments.length-2;if(Y===1)ie.children=K;else if(1<Y){for(var Z=Array(Y),ae=0;ae<Y;ae++)Z[ae]=arguments[ae+2];ie.children=Z}return _(O.type,le,ie)},Ce.createContext=function(O){return O={$$typeof:a,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:s,_context:O},O},Ce.createElement=function(O,U,K){var ie,le={},Y=null;if(U!=null)for(ie in U.key!==void 0&&(Y=""+U.key),U)B.call(U,ie)&&ie!=="key"&&ie!=="__self"&&ie!=="__source"&&(le[ie]=U[ie]);var Z=arguments.length-2;if(Z===1)le.children=K;else if(1<Z){for(var ae=Array(Z),me=0;me<Z;me++)ae[me]=arguments[me+2];le.children=ae}if(O&&O.defaultProps)for(ie in Z=O.defaultProps,Z)le[ie]===void 0&&(le[ie]=Z[ie]);return _(O,Y,le)},Ce.createRef=function(){return{current:null}},Ce.forwardRef=function(O){return{$$typeof:u,render:O}},Ce.isValidElement=oe,Ce.lazy=function(O){return{$$typeof:p,_payload:{_status:-1,_result:O},_init:ce}},Ce.memo=function(O,U){return{$$typeof:h,type:O,compare:U===void 0?null:U}},Ce.startTransition=function(O){var U=N.T,K={};N.T=K;try{var ie=O(),le=N.S;le!==null&&le(K,ie),typeof ie=="object"&&ie!==null&&typeof ie.then=="function"&&ie.then(z,te)}catch(Y){te(Y)}finally{U!==null&&K.types!==null&&(U.types=K.types),N.T=U}},Ce.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},Ce.use=function(O){return N.H.use(O)},Ce.useActionState=function(O,U,K){return N.H.useActionState(O,U,K)},Ce.useCallback=function(O,U){return N.H.useCallback(O,U)},Ce.useContext=function(O){return N.H.useContext(O)},Ce.useDebugValue=function(){},Ce.useDeferredValue=function(O,U){return N.H.useDeferredValue(O,U)},Ce.useEffect=function(O,U){return N.H.useEffect(O,U)},Ce.useEffectEvent=function(O){return N.H.useEffectEvent(O)},Ce.useId=function(){return N.H.useId()},Ce.useImperativeHandle=function(O,U,K){return N.H.useImperativeHandle(O,U,K)},Ce.useInsertionEffect=function(O,U){return N.H.useInsertionEffect(O,U)},Ce.useLayoutEffect=function(O,U){return N.H.useLayoutEffect(O,U)},Ce.useMemo=function(O,U){return N.H.useMemo(O,U)},Ce.useOptimistic=function(O,U){return N.H.useOptimistic(O,U)},Ce.useReducer=function(O,U,K){return N.H.useReducer(O,U,K)},Ce.useRef=function(O){return N.H.useRef(O)},Ce.useState=function(O){return N.H.useState(O)},Ce.useSyncExternalStore=function(O,U,K){return N.H.useSyncExternalStore(O,U,K)},Ce.useTransition=function(){return N.H.useTransition()},Ce.version="19.2.3",Ce}var Nb;function ta(){return Nb||(Nb=1,Hh.exports=AM()),Hh.exports}var R=ta();const Ri=Tm(R);var Uh={exports:{}},bs={},$h={exports:{}},Ph={};var jb;function OM(){return jb||(jb=1,(function(t){function e(q,ee){var ce=q.length;q.push(ee);e:for(;0<ce;){var te=ce-1>>>1,pe=q[te];if(0<o(pe,ee))q[te]=ee,q[ce]=pe,ce=te;else break e}}function n(q){return q.length===0?null:q[0]}function i(q){if(q.length===0)return null;var ee=q[0],ce=q.pop();if(ce!==ee){q[0]=ce;e:for(var te=0,pe=q.length,O=pe>>>1;te<O;){var U=2*(te+1)-1,K=q[U],ie=U+1,le=q[ie];if(0>o(K,ce))ie<pe&&0>o(le,K)?(q[te]=le,q[ie]=ce,te=ie):(q[te]=K,q[U]=ce,te=U);else if(ie<pe&&0>o(le,ce))q[te]=le,q[ie]=ce,te=ie;else break e}}return ee}function o(q,ee){var ce=q.sortIndex-ee.sortIndex;return ce!==0?ce:q.id-ee.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,u=a.now();t.unstable_now=function(){return a.now()-u}}var d=[],h=[],p=1,g=null,x=3,v=!1,S=!1,k=!1,w=!1,E=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function L(q){for(var ee=n(h);ee!==null;){if(ee.callback===null)i(h);else if(ee.startTime<=q)i(h),ee.sortIndex=ee.expirationTime,e(d,ee);else break;ee=n(h)}}function T(q){if(k=!1,L(q),!S)if(n(d)!==null)S=!0,z||(z=!0,re());else{var ee=n(h);ee!==null&&we(T,ee.startTime-q)}}var z=!1,N=-1,B=5,_=-1;function W(){return w?!0:!(t.unstable_now()-_<B)}function oe(){if(w=!1,z){var q=t.unstable_now();_=q;var ee=!0;try{e:{S=!1,k&&(k=!1,A(N),N=-1),v=!0;var ce=x;try{t:{for(L(q),g=n(d);g!==null&&!(g.expirationTime>q&&W());){var te=g.callback;if(typeof te=="function"){g.callback=null,x=g.priorityLevel;var pe=te(g.expirationTime<=q);if(q=t.unstable_now(),typeof pe=="function"){g.callback=pe,L(q),ee=!0;break t}g===n(d)&&i(d),L(q)}else i(d);g=n(d)}if(g!==null)ee=!0;else{var O=n(h);O!==null&&we(T,O.startTime-q),ee=!1}}break e}finally{g=null,x=ce,v=!1}ee=void 0}}finally{ee?re():z=!1}}}var re;if(typeof D=="function")re=function(){D(oe)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,he=fe.port2;fe.port1.onmessage=oe,re=function(){he.postMessage(null)}}else re=function(){E(oe,0)};function we(q,ee){N=E(function(){q(t.unstable_now())},ee)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(q){switch(x){case 1:case 2:case 3:var ee=3;break;default:ee=x}var ce=x;x=ee;try{return q()}finally{x=ce}},t.unstable_requestPaint=function(){w=!0},t.unstable_runWithPriority=function(q,ee){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ce=x;x=q;try{return ee()}finally{x=ce}},t.unstable_scheduleCallback=function(q,ee,ce){var te=t.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?te+ce:te):ce=te,q){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=ce+pe,q={id:p++,callback:ee,priorityLevel:q,startTime:ce,expirationTime:pe,sortIndex:-1},ce>te?(q.sortIndex=ce,e(h,q),n(d)===null&&q===n(h)&&(k?(A(N),N=-1):k=!0,we(T,ce-te))):(q.sortIndex=pe,e(d,q),S||v||(S=!0,z||(z=!0,re()))),q},t.unstable_shouldYield=W,t.unstable_wrapCallback=function(q){var ee=x;return function(){var ce=x;x=ee;try{return q.apply(this,arguments)}finally{x=ce}}}})(Ph)),Ph}var zb;function RM(){return zb||(zb=1,$h.exports=OM()),$h.exports}var Vh={exports:{}},At={};var Lb;function DM(){if(Lb)return At;Lb=1;var t=ta();function e(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)h+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},o=Symbol.for("react.portal");function s(d,h,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:g==null?null:""+g,children:d,containerInfo:h,implementation:p}}var a=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return At.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,At.createPortal=function(d,h){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return s(d,h,null,p)},At.flushSync=function(d){var h=a.T,p=i.p;try{if(a.T=null,i.p=2,d)return d()}finally{a.T=h,i.p=p,i.d.f()}},At.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,i.d.C(d,h))},At.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},At.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var p=h.as,g=u(p,h.crossOrigin),x=typeof h.integrity=="string"?h.integrity:void 0,v=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;p==="style"?i.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:g,integrity:x,fetchPriority:v}):p==="script"&&i.d.X(d,{crossOrigin:g,integrity:x,fetchPriority:v,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},At.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var p=u(h.as,h.crossOrigin);i.d.M(d,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&i.d.M(d)},At.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var p=h.as,g=u(p,h.crossOrigin);i.d.L(d,p,{crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},At.preloadModule=function(d,h){if(typeof d=="string")if(h){var p=u(h.as,h.crossOrigin);i.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else i.d.m(d)},At.requestFormReset=function(d){i.d.r(d)},At.unstable_batchedUpdates=function(d,h){return d(h)},At.useFormState=function(d,h,p){return a.H.useFormState(d,h,p)},At.useFormStatus=function(){return a.H.useHostTransitionStatus()},At.version="19.2.3",At}var Bb;function mS(){if(Bb)return Vh.exports;Bb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Vh.exports=DM(),Vh.exports}var Ib;function NM(){if(Ib)return bs;Ib=1;var t=RM(),e=ta(),n=mS();function i(r){var l="https://react.dev/errors/"+r;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)l+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+r+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function s(r){var l=r,c=r;if(r.alternate)for(;l.return;)l=l.return;else{r=l;do l=r,(l.flags&4098)!==0&&(c=l.return),r=l.return;while(r)}return l.tag===3?c:null}function a(r){if(r.tag===13){var l=r.memoizedState;if(l===null&&(r=r.alternate,r!==null&&(l=r.memoizedState)),l!==null)return l.dehydrated}return null}function u(r){if(r.tag===31){var l=r.memoizedState;if(l===null&&(r=r.alternate,r!==null&&(l=r.memoizedState)),l!==null)return l.dehydrated}return null}function d(r){if(s(r)!==r)throw Error(i(188))}function h(r){var l=r.alternate;if(!l){if(l=s(r),l===null)throw Error(i(188));return l!==r?null:r}for(var c=r,f=l;;){var m=c.return;if(m===null)break;var y=m.alternate;if(y===null){if(f=m.return,f!==null){c=f;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===c)return d(m),r;if(y===f)return d(m),l;y=y.sibling}throw Error(i(188))}if(c.return!==f.return)c=m,f=y;else{for(var C=!1,M=m.child;M;){if(M===c){C=!0,c=m,f=y;break}if(M===f){C=!0,f=m,c=y;break}M=M.sibling}if(!C){for(M=y.child;M;){if(M===c){C=!0,c=y,f=m;break}if(M===f){C=!0,f=y,c=m;break}M=M.sibling}if(!C)throw Error(i(189))}}if(c.alternate!==f)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?r:l}function p(r){var l=r.tag;if(l===5||l===26||l===27||l===6)return r;for(r=r.child;r!==null;){if(l=p(r),l!==null)return l;r=r.sibling}return null}var g=Object.assign,x=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),A=Symbol.for("react.consumer"),D=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),W=Symbol.for("react.memo_cache_sentinel"),oe=Symbol.iterator;function re(r){return r===null||typeof r!="object"?null:(r=oe&&r[oe]||r["@@iterator"],typeof r=="function"?r:null)}var fe=Symbol.for("react.client.reference");function he(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===fe?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case k:return"Fragment";case E:return"Profiler";case w:return"StrictMode";case T:return"Suspense";case z:return"SuspenseList";case _:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case S:return"Portal";case D:return r.displayName||"Context";case A:return(r._context.displayName||"Context")+".Consumer";case L:var l=r.render;return r=r.displayName,r||(r=l.displayName||l.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case N:return l=r.displayName||null,l!==null?l:he(r.type)||"Memo";case B:l=r._payload,r=r._init;try{return he(r(l))}catch{}}return null}var we=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},te=[],pe=-1;function O(r){return{current:r}}function U(r){0>pe||(r.current=te[pe],te[pe]=null,pe--)}function K(r,l){pe++,te[pe]=r.current,r.current=l}var ie=O(null),le=O(null),Y=O(null),Z=O(null);function ae(r,l){switch(K(Y,l),K(le,r),K(ie,null),l.nodeType){case 9:case 11:r=(r=l.documentElement)&&(r=r.namespaceURI)?Qx(r):0;break;default:if(r=l.tagName,l=l.namespaceURI)l=Qx(l),r=Zx(l,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}U(ie),K(ie,r)}function me(){U(ie),U(le),U(Y)}function Mt(r){r.memoizedState!==null&&K(Z,r);var l=ie.current,c=Zx(l,r.type);l!==c&&(K(le,r),K(ie,c))}function Ln(r){le.current===r&&(U(ie),U(le)),Z.current===r&&(U(Z),ps._currentValue=ce)}var kl,Ag;function Rr(r){if(kl===void 0)try{throw Error()}catch(c){var l=c.stack.trim().match(/\n( *(at )?)/);kl=l&&l[1]||"",Ag=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+kl+r+Ag}var vd=!1;function Sd(r,l){if(!r||vd)return"";vd=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(l){var J=function(){throw Error()};if(Object.defineProperty(J.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(J,[])}catch(F){var V=F}Reflect.construct(r,[],J)}else{try{J.call()}catch(F){V=F}r.call(J.prototype)}}else{try{throw Error()}catch(F){V=F}(J=r())&&typeof J.catch=="function"&&J.catch(function(){})}}catch(F){if(F&&V&&typeof F.stack=="string")return[F.stack,V.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=f.DetermineComponentFrameRoot(),C=y[0],M=y[1];if(C&&M){var j=C.split(`
`),P=M.split(`
`);for(m=f=0;f<j.length&&!j[f].includes("DetermineComponentFrameRoot");)f++;for(;m<P.length&&!P[m].includes("DetermineComponentFrameRoot");)m++;if(f===j.length||m===P.length)for(f=j.length-1,m=P.length-1;1<=f&&0<=m&&j[f]!==P[m];)m--;for(;1<=f&&0<=m;f--,m--)if(j[f]!==P[m]){if(f!==1||m!==1)do if(f--,m--,0>m||j[f]!==P[m]){var G=`
`+j[f].replace(" at new "," at ");return r.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",r.displayName)),G}while(1<=f&&0<=m);break}}}finally{vd=!1,Error.prepareStackTrace=c}return(c=r?r.displayName||r.name:"")?Rr(c):""}function iE(r,l){switch(r.tag){case 26:case 27:case 5:return Rr(r.type);case 16:return Rr("Lazy");case 13:return r.child!==l&&l!==null?Rr("Suspense Fallback"):Rr("Suspense");case 19:return Rr("SuspenseList");case 0:case 15:return Sd(r.type,!1);case 11:return Sd(r.type.render,!1);case 1:return Sd(r.type,!0);case 31:return Rr("Activity");default:return""}}function Og(r){try{var l="",c=null;do l+=iE(r,c),c=r,r=r.return;while(r);return l}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var wd=Object.prototype.hasOwnProperty,Cd=t.unstable_scheduleCallback,kd=t.unstable_cancelCallback,rE=t.unstable_shouldYield,oE=t.unstable_requestPaint,Gt=t.unstable_now,lE=t.unstable_getCurrentPriorityLevel,Rg=t.unstable_ImmediatePriority,Dg=t.unstable_UserBlockingPriority,ua=t.unstable_NormalPriority,sE=t.unstable_LowPriority,Ng=t.unstable_IdlePriority,aE=t.log,cE=t.unstable_setDisableYieldValue,El=null,Kt=null;function Bi(r){if(typeof aE=="function"&&cE(r),Kt&&typeof Kt.setStrictMode=="function")try{Kt.setStrictMode(El,r)}catch{}}var Xt=Math.clz32?Math.clz32:fE,uE=Math.log,dE=Math.LN2;function fE(r){return r>>>=0,r===0?32:31-(uE(r)/dE|0)|0}var da=256,fa=262144,ha=4194304;function Dr(r){var l=r&42;if(l!==0)return l;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function pa(r,l,c){var f=r.pendingLanes;if(f===0)return 0;var m=0,y=r.suspendedLanes,C=r.pingedLanes;r=r.warmLanes;var M=f&134217727;return M!==0?(f=M&~y,f!==0?m=Dr(f):(C&=M,C!==0?m=Dr(C):c||(c=M&~r,c!==0&&(m=Dr(c))))):(M=f&~y,M!==0?m=Dr(M):C!==0?m=Dr(C):c||(c=f&~r,c!==0&&(m=Dr(c)))),m===0?0:l!==0&&l!==m&&(l&y)===0&&(y=m&-m,c=l&-l,y>=c||y===32&&(c&4194048)!==0)?l:m}function Tl(r,l){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&l)===0}function hE(r,l){switch(r){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jg(){var r=ha;return ha<<=1,(ha&62914560)===0&&(ha=4194304),r}function Ed(r){for(var l=[],c=0;31>c;c++)l.push(r);return l}function Ml(r,l){r.pendingLanes|=l,l!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function pE(r,l,c,f,m,y){var C=r.pendingLanes;r.pendingLanes=c,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=c,r.entangledLanes&=c,r.errorRecoveryDisabledLanes&=c,r.shellSuspendCounter=0;var M=r.entanglements,j=r.expirationTimes,P=r.hiddenUpdates;for(c=C&~c;0<c;){var G=31-Xt(c),J=1<<G;M[G]=0,j[G]=-1;var V=P[G];if(V!==null)for(P[G]=null,G=0;G<V.length;G++){var F=V[G];F!==null&&(F.lane&=-536870913)}c&=~J}f!==0&&zg(r,f,0),y!==0&&m===0&&r.tag!==0&&(r.suspendedLanes|=y&~(C&~l))}function zg(r,l,c){r.pendingLanes|=l,r.suspendedLanes&=~l;var f=31-Xt(l);r.entangledLanes|=l,r.entanglements[f]=r.entanglements[f]|1073741824|c&261930}function Lg(r,l){var c=r.entangledLanes|=l;for(r=r.entanglements;c;){var f=31-Xt(c),m=1<<f;m&l|r[f]&l&&(r[f]|=l),c&=~m}}function Bg(r,l){var c=l&-l;return c=(c&42)!==0?1:Td(c),(c&(r.suspendedLanes|l))!==0?0:c}function Td(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Md(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Ig(){var r=ee.p;return r!==0?r:(r=window.event,r===void 0?32:wb(r.type))}function _g(r,l){var c=ee.p;try{return ee.p=r,l()}finally{ee.p=c}}var Ii=Math.random().toString(36).slice(2),xt="__reactFiber$"+Ii,It="__reactProps$"+Ii,go="__reactContainer$"+Ii,Ad="__reactEvents$"+Ii,mE="__reactListeners$"+Ii,gE="__reactHandles$"+Ii,Hg="__reactResources$"+Ii,Al="__reactMarker$"+Ii;function Od(r){delete r[xt],delete r[It],delete r[Ad],delete r[mE],delete r[gE]}function yo(r){var l=r[xt];if(l)return l;for(var c=r.parentNode;c;){if(l=c[go]||c[xt]){if(c=l.alternate,l.child!==null||c!==null&&c.child!==null)for(r=lb(r);r!==null;){if(c=r[xt])return c;r=lb(r)}return l}r=c,c=r.parentNode}return null}function xo(r){if(r=r[xt]||r[go]){var l=r.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return r}return null}function Ol(r){var l=r.tag;if(l===5||l===26||l===27||l===6)return r.stateNode;throw Error(i(33))}function bo(r){var l=r[Hg];return l||(l=r[Hg]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function ft(r){r[Al]=!0}var Ug=new Set,$g={};function Nr(r,l){vo(r,l),vo(r+"Capture",l)}function vo(r,l){for($g[r]=l,r=0;r<l.length;r++)Ug.add(l[r])}var yE=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Pg={},Vg={};function xE(r){return wd.call(Vg,r)?!0:wd.call(Pg,r)?!1:yE.test(r)?Vg[r]=!0:(Pg[r]=!0,!1)}function ma(r,l,c){if(xE(l))if(c===null)r.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":r.removeAttribute(l);return;case"boolean":var f=l.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){r.removeAttribute(l);return}}r.setAttribute(l,""+c)}}function ga(r,l,c){if(c===null)r.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttribute(l,""+c)}}function Jn(r,l,c,f){if(f===null)r.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(c);return}r.setAttributeNS(l,c,""+f)}}function cn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function qg(r){var l=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function bE(r,l,c){var f=Object.getOwnPropertyDescriptor(r.constructor.prototype,l);if(!r.hasOwnProperty(l)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var m=f.get,y=f.set;return Object.defineProperty(r,l,{configurable:!0,get:function(){return m.call(this)},set:function(C){c=""+C,y.call(this,C)}}),Object.defineProperty(r,l,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(C){c=""+C},stopTracking:function(){r._valueTracker=null,delete r[l]}}}}function Rd(r){if(!r._valueTracker){var l=qg(r)?"checked":"value";r._valueTracker=bE(r,l,""+r[l])}}function Fg(r){if(!r)return!1;var l=r._valueTracker;if(!l)return!0;var c=l.getValue(),f="";return r&&(f=qg(r)?r.checked?"true":"false":r.value),r=f,r!==c?(l.setValue(r),!0):!1}function ya(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var vE=/[\n"\\]/g;function un(r){return r.replace(vE,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Dd(r,l,c,f,m,y,C,M){r.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?r.type=C:r.removeAttribute("type"),l!=null?C==="number"?(l===0&&r.value===""||r.value!=l)&&(r.value=""+cn(l)):r.value!==""+cn(l)&&(r.value=""+cn(l)):C!=="submit"&&C!=="reset"||r.removeAttribute("value"),l!=null?Nd(r,C,cn(l)):c!=null?Nd(r,C,cn(c)):f!=null&&r.removeAttribute("value"),m==null&&y!=null&&(r.defaultChecked=!!y),m!=null&&(r.checked=m&&typeof m!="function"&&typeof m!="symbol"),M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?r.name=""+cn(M):r.removeAttribute("name")}function Wg(r,l,c,f,m,y,C,M){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),l!=null||c!=null){if(!(y!=="submit"&&y!=="reset"||l!=null)){Rd(r);return}c=c!=null?""+cn(c):"",l=l!=null?""+cn(l):c,M||l===r.value||(r.value=l),r.defaultValue=l}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,r.checked=M?r.checked:!!f,r.defaultChecked=!!f,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(r.name=C),Rd(r)}function Nd(r,l,c){l==="number"&&ya(r.ownerDocument)===r||r.defaultValue===""+c||(r.defaultValue=""+c)}function So(r,l,c,f){if(r=r.options,l){l={};for(var m=0;m<c.length;m++)l["$"+c[m]]=!0;for(c=0;c<r.length;c++)m=l.hasOwnProperty("$"+r[c].value),r[c].selected!==m&&(r[c].selected=m),m&&f&&(r[c].defaultSelected=!0)}else{for(c=""+cn(c),l=null,m=0;m<r.length;m++){if(r[m].value===c){r[m].selected=!0,f&&(r[m].defaultSelected=!0);return}l!==null||r[m].disabled||(l=r[m])}l!==null&&(l.selected=!0)}}function Yg(r,l,c){if(l!=null&&(l=""+cn(l),l!==r.value&&(r.value=l),c==null)){r.defaultValue!==l&&(r.defaultValue=l);return}r.defaultValue=c!=null?""+cn(c):""}function Gg(r,l,c,f){if(l==null){if(f!=null){if(c!=null)throw Error(i(92));if(we(f)){if(1<f.length)throw Error(i(93));f=f[0]}c=f}c==null&&(c=""),l=c}c=cn(l),r.defaultValue=c,f=r.textContent,f===c&&f!==""&&f!==null&&(r.value=f),Rd(r)}function wo(r,l){if(l){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=l;return}}r.textContent=l}var SE=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Kg(r,l,c){var f=l.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?r.setProperty(l,""):l==="float"?r.cssFloat="":r[l]="":f?r.setProperty(l,c):typeof c!="number"||c===0||SE.has(l)?l==="float"?r.cssFloat=c:r[l]=(""+c).trim():r[l]=c+"px"}function Xg(r,l,c){if(l!=null&&typeof l!="object")throw Error(i(62));if(r=r.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||l!=null&&l.hasOwnProperty(f)||(f.indexOf("--")===0?r.setProperty(f,""):f==="float"?r.cssFloat="":r[f]="");for(var m in l)f=l[m],l.hasOwnProperty(m)&&c[m]!==f&&Kg(r,m,f)}else for(var y in l)l.hasOwnProperty(y)&&Kg(r,y,l[y])}function jd(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wE=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),CE=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function xa(r){return CE.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Qn(){}var zd=null;function Ld(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Co=null,ko=null;function Jg(r){var l=xo(r);if(l&&(r=l.stateNode)){var c=r[It]||null;e:switch(r=l.stateNode,l.type){case"input":if(Dd(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),l=c.name,c.type==="radio"&&l!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+un(""+l)+'"][type="radio"]'),l=0;l<c.length;l++){var f=c[l];if(f!==r&&f.form===r.form){var m=f[It]||null;if(!m)throw Error(i(90));Dd(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(l=0;l<c.length;l++)f=c[l],f.form===r.form&&Fg(f)}break e;case"textarea":Yg(r,c.value,c.defaultValue);break e;case"select":l=c.value,l!=null&&So(r,!!c.multiple,l,!1)}}}var Bd=!1;function Qg(r,l,c){if(Bd)return r(l,c);Bd=!0;try{var f=r(l);return f}finally{if(Bd=!1,(Co!==null||ko!==null)&&(oc(),Co&&(l=Co,r=ko,ko=Co=null,Jg(l),r)))for(l=0;l<r.length;l++)Jg(r[l])}}function Rl(r,l){var c=r.stateNode;if(c===null)return null;var f=c[It]||null;if(f===null)return null;c=f[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(r=r.type,f=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!f;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(i(231,l,typeof c));return c}var Zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Id=!1;if(Zn)try{var Dl={};Object.defineProperty(Dl,"passive",{get:function(){Id=!0}}),window.addEventListener("test",Dl,Dl),window.removeEventListener("test",Dl,Dl)}catch{Id=!1}var _i=null,_d=null,ba=null;function Zg(){if(ba)return ba;var r,l=_d,c=l.length,f,m="value"in _i?_i.value:_i.textContent,y=m.length;for(r=0;r<c&&l[r]===m[r];r++);var C=c-r;for(f=1;f<=C&&l[c-f]===m[y-f];f++);return ba=m.slice(r,1<f?1-f:void 0)}function va(r){var l=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&l===13&&(r=13)):r=l,r===10&&(r=13),32<=r||r===13?r:0}function Sa(){return!0}function ey(){return!1}function _t(r){function l(c,f,m,y,C){this._reactName=c,this._targetInst=m,this.type=f,this.nativeEvent=y,this.target=C,this.currentTarget=null;for(var M in r)r.hasOwnProperty(M)&&(c=r[M],this[M]=c?c(y):y[M]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Sa:ey,this.isPropagationStopped=ey,this}return g(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Sa)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Sa)},persist:function(){},isPersistent:Sa}),l}var jr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wa=_t(jr),Nl=g({},jr,{view:0,detail:0}),kE=_t(Nl),Hd,Ud,jl,Ca=g({},Nl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pd,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==jl&&(jl&&r.type==="mousemove"?(Hd=r.screenX-jl.screenX,Ud=r.screenY-jl.screenY):Ud=Hd=0,jl=r),Hd)},movementY:function(r){return"movementY"in r?r.movementY:Ud}}),ty=_t(Ca),EE=g({},Ca,{dataTransfer:0}),TE=_t(EE),ME=g({},Nl,{relatedTarget:0}),$d=_t(ME),AE=g({},jr,{animationName:0,elapsedTime:0,pseudoElement:0}),OE=_t(AE),RE=g({},jr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),DE=_t(RE),NE=g({},jr,{data:0}),ny=_t(NE),jE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},LE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function BE(r){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(r):(r=LE[r])?!!l[r]:!1}function Pd(){return BE}var IE=g({},Nl,{key:function(r){if(r.key){var l=jE[r.key]||r.key;if(l!=="Unidentified")return l}return r.type==="keypress"?(r=va(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?zE[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pd,charCode:function(r){return r.type==="keypress"?va(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?va(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),_E=_t(IE),HE=g({},Ca,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),iy=_t(HE),UE=g({},Nl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pd}),$E=_t(UE),PE=g({},jr,{propertyName:0,elapsedTime:0,pseudoElement:0}),VE=_t(PE),qE=g({},Ca,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),FE=_t(qE),WE=g({},jr,{newState:0,oldState:0}),YE=_t(WE),GE=[9,13,27,32],Vd=Zn&&"CompositionEvent"in window,zl=null;Zn&&"documentMode"in document&&(zl=document.documentMode);var KE=Zn&&"TextEvent"in window&&!zl,ry=Zn&&(!Vd||zl&&8<zl&&11>=zl),oy=" ",ly=!1;function sy(r,l){switch(r){case"keyup":return GE.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ay(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Eo=!1;function XE(r,l){switch(r){case"compositionend":return ay(l);case"keypress":return l.which!==32?null:(ly=!0,oy);case"textInput":return r=l.data,r===oy&&ly?null:r;default:return null}}function JE(r,l){if(Eo)return r==="compositionend"||!Vd&&sy(r,l)?(r=Zg(),ba=_d=_i=null,Eo=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return ry&&l.locale!=="ko"?null:l.data;default:return null}}var QE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cy(r){var l=r&&r.nodeName&&r.nodeName.toLowerCase();return l==="input"?!!QE[r.type]:l==="textarea"}function uy(r,l,c,f){Co?ko?ko.push(f):ko=[f]:Co=f,l=fc(l,"onChange"),0<l.length&&(c=new wa("onChange","change",null,c,f),r.push({event:c,listeners:l}))}var Ll=null,Bl=null;function ZE(r){Wx(r,0)}function ka(r){var l=Ol(r);if(Fg(l))return r}function dy(r,l){if(r==="change")return l}var fy=!1;if(Zn){var qd;if(Zn){var Fd="oninput"in document;if(!Fd){var hy=document.createElement("div");hy.setAttribute("oninput","return;"),Fd=typeof hy.oninput=="function"}qd=Fd}else qd=!1;fy=qd&&(!document.documentMode||9<document.documentMode)}function py(){Ll&&(Ll.detachEvent("onpropertychange",my),Bl=Ll=null)}function my(r){if(r.propertyName==="value"&&ka(Bl)){var l=[];uy(l,Bl,r,Ld(r)),Qg(ZE,l)}}function eT(r,l,c){r==="focusin"?(py(),Ll=l,Bl=c,Ll.attachEvent("onpropertychange",my)):r==="focusout"&&py()}function tT(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return ka(Bl)}function nT(r,l){if(r==="click")return ka(l)}function iT(r,l){if(r==="input"||r==="change")return ka(l)}function rT(r,l){return r===l&&(r!==0||1/r===1/l)||r!==r&&l!==l}var Jt=typeof Object.is=="function"?Object.is:rT;function Il(r,l){if(Jt(r,l))return!0;if(typeof r!="object"||r===null||typeof l!="object"||l===null)return!1;var c=Object.keys(r),f=Object.keys(l);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var m=c[f];if(!wd.call(l,m)||!Jt(r[m],l[m]))return!1}return!0}function gy(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function yy(r,l){var c=gy(r);r=0;for(var f;c;){if(c.nodeType===3){if(f=r+c.textContent.length,r<=l&&f>=l)return{node:c,offset:l-r};r=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=gy(c)}}function xy(r,l){return r&&l?r===l?!0:r&&r.nodeType===3?!1:l&&l.nodeType===3?xy(r,l.parentNode):"contains"in r?r.contains(l):r.compareDocumentPosition?!!(r.compareDocumentPosition(l)&16):!1:!1}function by(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var l=ya(r.document);l instanceof r.HTMLIFrameElement;){try{var c=typeof l.contentWindow.location.href=="string"}catch{c=!1}if(c)r=l.contentWindow;else break;l=ya(r.document)}return l}function Wd(r){var l=r&&r.nodeName&&r.nodeName.toLowerCase();return l&&(l==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||l==="textarea"||r.contentEditable==="true")}var oT=Zn&&"documentMode"in document&&11>=document.documentMode,To=null,Yd=null,_l=null,Gd=!1;function vy(r,l,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Gd||To==null||To!==ya(f)||(f=To,"selectionStart"in f&&Wd(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),_l&&Il(_l,f)||(_l=f,f=fc(Yd,"onSelect"),0<f.length&&(l=new wa("onSelect","select",null,l,c),r.push({event:l,listeners:f}),l.target=To)))}function zr(r,l){var c={};return c[r.toLowerCase()]=l.toLowerCase(),c["Webkit"+r]="webkit"+l,c["Moz"+r]="moz"+l,c}var Mo={animationend:zr("Animation","AnimationEnd"),animationiteration:zr("Animation","AnimationIteration"),animationstart:zr("Animation","AnimationStart"),transitionrun:zr("Transition","TransitionRun"),transitionstart:zr("Transition","TransitionStart"),transitioncancel:zr("Transition","TransitionCancel"),transitionend:zr("Transition","TransitionEnd")},Kd={},Sy={};Zn&&(Sy=document.createElement("div").style,"AnimationEvent"in window||(delete Mo.animationend.animation,delete Mo.animationiteration.animation,delete Mo.animationstart.animation),"TransitionEvent"in window||delete Mo.transitionend.transition);function Lr(r){if(Kd[r])return Kd[r];if(!Mo[r])return r;var l=Mo[r],c;for(c in l)if(l.hasOwnProperty(c)&&c in Sy)return Kd[r]=l[c];return r}var wy=Lr("animationend"),Cy=Lr("animationiteration"),ky=Lr("animationstart"),lT=Lr("transitionrun"),sT=Lr("transitionstart"),aT=Lr("transitioncancel"),Ey=Lr("transitionend"),Ty=new Map,Xd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Xd.push("scrollEnd");function Mn(r,l){Ty.set(r,l),Nr(l,[r])}var Ea=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},dn=[],Ao=0,Jd=0;function Ta(){for(var r=Ao,l=Jd=Ao=0;l<r;){var c=dn[l];dn[l++]=null;var f=dn[l];dn[l++]=null;var m=dn[l];dn[l++]=null;var y=dn[l];if(dn[l++]=null,f!==null&&m!==null){var C=f.pending;C===null?m.next=m:(m.next=C.next,C.next=m),f.pending=m}y!==0&&My(c,m,y)}}function Ma(r,l,c,f){dn[Ao++]=r,dn[Ao++]=l,dn[Ao++]=c,dn[Ao++]=f,Jd|=f,r.lanes|=f,r=r.alternate,r!==null&&(r.lanes|=f)}function Qd(r,l,c,f){return Ma(r,l,c,f),Aa(r)}function Br(r,l){return Ma(r,null,null,l),Aa(r)}function My(r,l,c){r.lanes|=c;var f=r.alternate;f!==null&&(f.lanes|=c);for(var m=!1,y=r.return;y!==null;)y.childLanes|=c,f=y.alternate,f!==null&&(f.childLanes|=c),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(m=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,m&&l!==null&&(m=31-Xt(c),r=y.hiddenUpdates,f=r[m],f===null?r[m]=[l]:f.push(l),l.lane=c|536870912),y):null}function Aa(r){if(50<ss)throw ss=0,ah=null,Error(i(185));for(var l=r.return;l!==null;)r=l,l=r.return;return r.tag===3?r.stateNode:null}var Oo={};function cT(r,l,c,f){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qt(r,l,c,f){return new cT(r,l,c,f)}function Zd(r){return r=r.prototype,!(!r||!r.isReactComponent)}function ei(r,l){var c=r.alternate;return c===null?(c=Qt(r.tag,l,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=l,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&65011712,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,l=r.dependencies,c.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c.refCleanup=r.refCleanup,c}function Ay(r,l){r.flags&=65011714;var c=r.alternate;return c===null?(r.childLanes=0,r.lanes=l,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=c.childLanes,r.lanes=c.lanes,r.child=c.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=c.memoizedProps,r.memoizedState=c.memoizedState,r.updateQueue=c.updateQueue,r.type=c.type,l=c.dependencies,r.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),r}function Oa(r,l,c,f,m,y){var C=0;if(f=r,typeof r=="function")Zd(r)&&(C=1);else if(typeof r=="string")C=pM(r,c,ie.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case _:return r=Qt(31,c,l,m),r.elementType=_,r.lanes=y,r;case k:return Ir(c.children,m,y,l);case w:C=8,m|=24;break;case E:return r=Qt(12,c,l,m|2),r.elementType=E,r.lanes=y,r;case T:return r=Qt(13,c,l,m),r.elementType=T,r.lanes=y,r;case z:return r=Qt(19,c,l,m),r.elementType=z,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case D:C=10;break e;case A:C=9;break e;case L:C=11;break e;case N:C=14;break e;case B:C=16,f=null;break e}C=29,c=Error(i(130,r===null?"null":typeof r,"")),f=null}return l=Qt(C,c,l,m),l.elementType=r,l.type=f,l.lanes=y,l}function Ir(r,l,c,f){return r=Qt(7,r,f,l),r.lanes=c,r}function ef(r,l,c){return r=Qt(6,r,null,l),r.lanes=c,r}function Oy(r){var l=Qt(18,null,null,0);return l.stateNode=r,l}function tf(r,l,c){return l=Qt(4,r.children!==null?r.children:[],r.key,l),l.lanes=c,l.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},l}var Ry=new WeakMap;function fn(r,l){if(typeof r=="object"&&r!==null){var c=Ry.get(r);return c!==void 0?c:(l={value:r,source:l,stack:Og(l)},Ry.set(r,l),l)}return{value:r,source:l,stack:Og(l)}}var Ro=[],Do=0,Ra=null,Hl=0,hn=[],pn=0,Hi=null,Bn=1,In="";function ti(r,l){Ro[Do++]=Hl,Ro[Do++]=Ra,Ra=r,Hl=l}function Dy(r,l,c){hn[pn++]=Bn,hn[pn++]=In,hn[pn++]=Hi,Hi=r;var f=Bn;r=In;var m=32-Xt(f)-1;f&=~(1<<m),c+=1;var y=32-Xt(l)+m;if(30<y){var C=m-m%5;y=(f&(1<<C)-1).toString(32),f>>=C,m-=C,Bn=1<<32-Xt(l)+m|c<<m|f,In=y+r}else Bn=1<<y|c<<m|f,In=r}function nf(r){r.return!==null&&(ti(r,1),Dy(r,1,0))}function rf(r){for(;r===Ra;)Ra=Ro[--Do],Ro[Do]=null,Hl=Ro[--Do],Ro[Do]=null;for(;r===Hi;)Hi=hn[--pn],hn[pn]=null,In=hn[--pn],hn[pn]=null,Bn=hn[--pn],hn[pn]=null}function Ny(r,l){hn[pn++]=Bn,hn[pn++]=In,hn[pn++]=Hi,Bn=l.id,In=l.overflow,Hi=r}var bt=null,Ve=null,De=!1,Ui=null,mn=!1,of=Error(i(519));function $i(r){var l=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ul(fn(l,r)),of}function jy(r){var l=r.stateNode,c=r.type,f=r.memoizedProps;switch(l[xt]=r,l[It]=f,c){case"dialog":Ae("cancel",l),Ae("close",l);break;case"iframe":case"object":case"embed":Ae("load",l);break;case"video":case"audio":for(c=0;c<cs.length;c++)Ae(cs[c],l);break;case"source":Ae("error",l);break;case"img":case"image":case"link":Ae("error",l),Ae("load",l);break;case"details":Ae("toggle",l);break;case"input":Ae("invalid",l),Wg(l,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Ae("invalid",l);break;case"textarea":Ae("invalid",l),Gg(l,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||l.textContent===""+c||f.suppressHydrationWarning===!0||Xx(l.textContent,c)?(f.popover!=null&&(Ae("beforetoggle",l),Ae("toggle",l)),f.onScroll!=null&&Ae("scroll",l),f.onScrollEnd!=null&&Ae("scrollend",l),f.onClick!=null&&(l.onclick=Qn),l=!0):l=!1,l||$i(r,!0)}function zy(r){for(bt=r.return;bt;)switch(bt.tag){case 5:case 31:case 13:mn=!1;return;case 27:case 3:mn=!0;return;default:bt=bt.return}}function No(r){if(r!==bt)return!1;if(!De)return zy(r),De=!0,!1;var l=r.tag,c;if((c=l!==3&&l!==27)&&((c=l===5)&&(c=r.type,c=!(c!=="form"&&c!=="button")||Ch(r.type,r.memoizedProps)),c=!c),c&&Ve&&$i(r),zy(r),l===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));Ve=ob(r)}else if(l===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));Ve=ob(r)}else l===27?(l=Ve,tr(r.type)?(r=Ah,Ah=null,Ve=r):Ve=l):Ve=bt?yn(r.stateNode.nextSibling):null;return!0}function _r(){Ve=bt=null,De=!1}function lf(){var r=Ui;return r!==null&&(Pt===null?Pt=r:Pt.push.apply(Pt,r),Ui=null),r}function Ul(r){Ui===null?Ui=[r]:Ui.push(r)}var sf=O(null),Hr=null,ni=null;function Pi(r,l,c){K(sf,l._currentValue),l._currentValue=c}function ii(r){r._currentValue=sf.current,U(sf)}function af(r,l,c){for(;r!==null;){var f=r.alternate;if((r.childLanes&l)!==l?(r.childLanes|=l,f!==null&&(f.childLanes|=l)):f!==null&&(f.childLanes&l)!==l&&(f.childLanes|=l),r===c)break;r=r.return}}function cf(r,l,c,f){var m=r.child;for(m!==null&&(m.return=r);m!==null;){var y=m.dependencies;if(y!==null){var C=m.child;y=y.firstContext;e:for(;y!==null;){var M=y;y=m;for(var j=0;j<l.length;j++)if(M.context===l[j]){y.lanes|=c,M=y.alternate,M!==null&&(M.lanes|=c),af(y.return,c,r),f||(C=null);break e}y=M.next}}else if(m.tag===18){if(C=m.return,C===null)throw Error(i(341));C.lanes|=c,y=C.alternate,y!==null&&(y.lanes|=c),af(C,c,r),C=null}else C=m.child;if(C!==null)C.return=m;else for(C=m;C!==null;){if(C===r){C=null;break}if(m=C.sibling,m!==null){m.return=C.return,C=m;break}C=C.return}m=C}}function jo(r,l,c,f){r=null;for(var m=l,y=!1;m!==null;){if(!y){if((m.flags&524288)!==0)y=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var C=m.alternate;if(C===null)throw Error(i(387));if(C=C.memoizedProps,C!==null){var M=m.type;Jt(m.pendingProps.value,C.value)||(r!==null?r.push(M):r=[M])}}else if(m===Z.current){if(C=m.alternate,C===null)throw Error(i(387));C.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(r!==null?r.push(ps):r=[ps])}m=m.return}r!==null&&cf(l,r,c,f),l.flags|=262144}function Da(r){for(r=r.firstContext;r!==null;){if(!Jt(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Ur(r){Hr=r,ni=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function vt(r){return Ly(Hr,r)}function Na(r,l){return Hr===null&&Ur(r),Ly(r,l)}function Ly(r,l){var c=l._currentValue;if(l={context:l,memoizedValue:c,next:null},ni===null){if(r===null)throw Error(i(308));ni=l,r.dependencies={lanes:0,firstContext:l},r.flags|=524288}else ni=ni.next=l;return c}var uT=typeof AbortController<"u"?AbortController:function(){var r=[],l=this.signal={aborted:!1,addEventListener:function(c,f){r.push(f)}};this.abort=function(){l.aborted=!0,r.forEach(function(c){return c()})}},dT=t.unstable_scheduleCallback,fT=t.unstable_NormalPriority,ot={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function uf(){return{controller:new uT,data:new Map,refCount:0}}function $l(r){r.refCount--,r.refCount===0&&dT(fT,function(){r.controller.abort()})}var Pl=null,df=0,zo=0,Lo=null;function hT(r,l){if(Pl===null){var c=Pl=[];df=0,zo=ph(),Lo={status:"pending",value:void 0,then:function(f){c.push(f)}}}return df++,l.then(By,By),l}function By(){if(--df===0&&Pl!==null){Lo!==null&&(Lo.status="fulfilled");var r=Pl;Pl=null,zo=0,Lo=null;for(var l=0;l<r.length;l++)(0,r[l])()}}function pT(r,l){var c=[],f={status:"pending",value:null,reason:null,then:function(m){c.push(m)}};return r.then(function(){f.status="fulfilled",f.value=l;for(var m=0;m<c.length;m++)(0,c[m])(l)},function(m){for(f.status="rejected",f.reason=m,m=0;m<c.length;m++)(0,c[m])(void 0)}),f}var Iy=q.S;q.S=function(r,l){vx=Gt(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&hT(r,l),Iy!==null&&Iy(r,l)};var $r=O(null);function ff(){var r=$r.current;return r!==null?r:$e.pooledCache}function ja(r,l){l===null?K($r,$r.current):K($r,l.pool)}function _y(){var r=ff();return r===null?null:{parent:ot._currentValue,pool:r}}var Bo=Error(i(460)),hf=Error(i(474)),za=Error(i(542)),La={then:function(){}};function Hy(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Uy(r,l,c){switch(c=r[c],c===void 0?r.push(l):c!==l&&(l.then(Qn,Qn),l=c),l.status){case"fulfilled":return l.value;case"rejected":throw r=l.reason,Py(r),r;default:if(typeof l.status=="string")l.then(Qn,Qn);else{if(r=$e,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=l,r.status="pending",r.then(function(f){if(l.status==="pending"){var m=l;m.status="fulfilled",m.value=f}},function(f){if(l.status==="pending"){var m=l;m.status="rejected",m.reason=f}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw r=l.reason,Py(r),r}throw Vr=l,Bo}}function Pr(r){try{var l=r._init;return l(r._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Vr=c,Bo):c}}var Vr=null;function $y(){if(Vr===null)throw Error(i(459));var r=Vr;return Vr=null,r}function Py(r){if(r===Bo||r===za)throw Error(i(483))}var Io=null,Vl=0;function Ba(r){var l=Vl;return Vl+=1,Io===null&&(Io=[]),Uy(Io,r,l)}function ql(r,l){l=l.props.ref,r.ref=l!==void 0?l:null}function Ia(r,l){throw l.$$typeof===x?Error(i(525)):(r=Object.prototype.toString.call(l),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":r)))}function Vy(r){function l(H,I){if(r){var $=H.deletions;$===null?(H.deletions=[I],H.flags|=16):$.push(I)}}function c(H,I){if(!r)return null;for(;I!==null;)l(H,I),I=I.sibling;return null}function f(H){for(var I=new Map;H!==null;)H.key!==null?I.set(H.key,H):I.set(H.index,H),H=H.sibling;return I}function m(H,I){return H=ei(H,I),H.index=0,H.sibling=null,H}function y(H,I,$){return H.index=$,r?($=H.alternate,$!==null?($=$.index,$<I?(H.flags|=67108866,I):$):(H.flags|=67108866,I)):(H.flags|=1048576,I)}function C(H){return r&&H.alternate===null&&(H.flags|=67108866),H}function M(H,I,$,X){return I===null||I.tag!==6?(I=ef($,H.mode,X),I.return=H,I):(I=m(I,$),I.return=H,I)}function j(H,I,$,X){var ge=$.type;return ge===k?G(H,I,$.props.children,X,$.key):I!==null&&(I.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===B&&Pr(ge)===I.type)?(I=m(I,$.props),ql(I,$),I.return=H,I):(I=Oa($.type,$.key,$.props,null,H.mode,X),ql(I,$),I.return=H,I)}function P(H,I,$,X){return I===null||I.tag!==4||I.stateNode.containerInfo!==$.containerInfo||I.stateNode.implementation!==$.implementation?(I=tf($,H.mode,X),I.return=H,I):(I=m(I,$.children||[]),I.return=H,I)}function G(H,I,$,X,ge){return I===null||I.tag!==7?(I=Ir($,H.mode,X,ge),I.return=H,I):(I=m(I,$),I.return=H,I)}function J(H,I,$){if(typeof I=="string"&&I!==""||typeof I=="number"||typeof I=="bigint")return I=ef(""+I,H.mode,$),I.return=H,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case v:return $=Oa(I.type,I.key,I.props,null,H.mode,$),ql($,I),$.return=H,$;case S:return I=tf(I,H.mode,$),I.return=H,I;case B:return I=Pr(I),J(H,I,$)}if(we(I)||re(I))return I=Ir(I,H.mode,$,null),I.return=H,I;if(typeof I.then=="function")return J(H,Ba(I),$);if(I.$$typeof===D)return J(H,Na(H,I),$);Ia(H,I)}return null}function V(H,I,$,X){var ge=I!==null?I.key:null;if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return ge!==null?null:M(H,I,""+$,X);if(typeof $=="object"&&$!==null){switch($.$$typeof){case v:return $.key===ge?j(H,I,$,X):null;case S:return $.key===ge?P(H,I,$,X):null;case B:return $=Pr($),V(H,I,$,X)}if(we($)||re($))return ge!==null?null:G(H,I,$,X,null);if(typeof $.then=="function")return V(H,I,Ba($),X);if($.$$typeof===D)return V(H,I,Na(H,$),X);Ia(H,$)}return null}function F(H,I,$,X,ge){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return H=H.get($)||null,M(I,H,""+X,ge);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case v:return H=H.get(X.key===null?$:X.key)||null,j(I,H,X,ge);case S:return H=H.get(X.key===null?$:X.key)||null,P(I,H,X,ge);case B:return X=Pr(X),F(H,I,$,X,ge)}if(we(X)||re(X))return H=H.get($)||null,G(I,H,X,ge,null);if(typeof X.then=="function")return F(H,I,$,Ba(X),ge);if(X.$$typeof===D)return F(H,I,$,Na(I,X),ge);Ia(I,X)}return null}function ue(H,I,$,X){for(var ge=null,Ne=null,de=I,Ee=I=0,Re=null;de!==null&&Ee<$.length;Ee++){de.index>Ee?(Re=de,de=null):Re=de.sibling;var je=V(H,de,$[Ee],X);if(je===null){de===null&&(de=Re);break}r&&de&&je.alternate===null&&l(H,de),I=y(je,I,Ee),Ne===null?ge=je:Ne.sibling=je,Ne=je,de=Re}if(Ee===$.length)return c(H,de),De&&ti(H,Ee),ge;if(de===null){for(;Ee<$.length;Ee++)de=J(H,$[Ee],X),de!==null&&(I=y(de,I,Ee),Ne===null?ge=de:Ne.sibling=de,Ne=de);return De&&ti(H,Ee),ge}for(de=f(de);Ee<$.length;Ee++)Re=F(de,H,Ee,$[Ee],X),Re!==null&&(r&&Re.alternate!==null&&de.delete(Re.key===null?Ee:Re.key),I=y(Re,I,Ee),Ne===null?ge=Re:Ne.sibling=Re,Ne=Re);return r&&de.forEach(function(lr){return l(H,lr)}),De&&ti(H,Ee),ge}function be(H,I,$,X){if($==null)throw Error(i(151));for(var ge=null,Ne=null,de=I,Ee=I=0,Re=null,je=$.next();de!==null&&!je.done;Ee++,je=$.next()){de.index>Ee?(Re=de,de=null):Re=de.sibling;var lr=V(H,de,je.value,X);if(lr===null){de===null&&(de=Re);break}r&&de&&lr.alternate===null&&l(H,de),I=y(lr,I,Ee),Ne===null?ge=lr:Ne.sibling=lr,Ne=lr,de=Re}if(je.done)return c(H,de),De&&ti(H,Ee),ge;if(de===null){for(;!je.done;Ee++,je=$.next())je=J(H,je.value,X),je!==null&&(I=y(je,I,Ee),Ne===null?ge=je:Ne.sibling=je,Ne=je);return De&&ti(H,Ee),ge}for(de=f(de);!je.done;Ee++,je=$.next())je=F(de,H,Ee,je.value,X),je!==null&&(r&&je.alternate!==null&&de.delete(je.key===null?Ee:je.key),I=y(je,I,Ee),Ne===null?ge=je:Ne.sibling=je,Ne=je);return r&&de.forEach(function(EM){return l(H,EM)}),De&&ti(H,Ee),ge}function Ue(H,I,$,X){if(typeof $=="object"&&$!==null&&$.type===k&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case v:e:{for(var ge=$.key;I!==null;){if(I.key===ge){if(ge=$.type,ge===k){if(I.tag===7){c(H,I.sibling),X=m(I,$.props.children),X.return=H,H=X;break e}}else if(I.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===B&&Pr(ge)===I.type){c(H,I.sibling),X=m(I,$.props),ql(X,$),X.return=H,H=X;break e}c(H,I);break}else l(H,I);I=I.sibling}$.type===k?(X=Ir($.props.children,H.mode,X,$.key),X.return=H,H=X):(X=Oa($.type,$.key,$.props,null,H.mode,X),ql(X,$),X.return=H,H=X)}return C(H);case S:e:{for(ge=$.key;I!==null;){if(I.key===ge)if(I.tag===4&&I.stateNode.containerInfo===$.containerInfo&&I.stateNode.implementation===$.implementation){c(H,I.sibling),X=m(I,$.children||[]),X.return=H,H=X;break e}else{c(H,I);break}else l(H,I);I=I.sibling}X=tf($,H.mode,X),X.return=H,H=X}return C(H);case B:return $=Pr($),Ue(H,I,$,X)}if(we($))return ue(H,I,$,X);if(re($)){if(ge=re($),typeof ge!="function")throw Error(i(150));return $=ge.call($),be(H,I,$,X)}if(typeof $.then=="function")return Ue(H,I,Ba($),X);if($.$$typeof===D)return Ue(H,I,Na(H,$),X);Ia(H,$)}return typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint"?($=""+$,I!==null&&I.tag===6?(c(H,I.sibling),X=m(I,$),X.return=H,H=X):(c(H,I),X=ef($,H.mode,X),X.return=H,H=X),C(H)):c(H,I)}return function(H,I,$,X){try{Vl=0;var ge=Ue(H,I,$,X);return Io=null,ge}catch(de){if(de===Bo||de===za)throw de;var Ne=Qt(29,de,null,H.mode);return Ne.lanes=X,Ne.return=H,Ne}}}var qr=Vy(!0),qy=Vy(!1),Vi=!1;function pf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function mf(r,l){r=r.updateQueue,l.updateQueue===r&&(l.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function qi(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Fi(r,l,c){var f=r.updateQueue;if(f===null)return null;if(f=f.shared,(ze&2)!==0){var m=f.pending;return m===null?l.next=l:(l.next=m.next,m.next=l),f.pending=l,l=Aa(r),My(r,null,c),l}return Ma(r,f,l,c),Aa(r)}function Fl(r,l,c){if(l=l.updateQueue,l!==null&&(l=l.shared,(c&4194048)!==0)){var f=l.lanes;f&=r.pendingLanes,c|=f,l.lanes=c,Lg(r,c)}}function gf(r,l){var c=r.updateQueue,f=r.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var m=null,y=null;if(c=c.firstBaseUpdate,c!==null){do{var C={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};y===null?m=y=C:y=y.next=C,c=c.next}while(c!==null);y===null?m=y=l:y=y.next=l}else m=y=l;c={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:f.shared,callbacks:f.callbacks},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=l:r.next=l,c.lastBaseUpdate=l}var yf=!1;function Wl(){if(yf){var r=Lo;if(r!==null)throw r}}function Yl(r,l,c,f){yf=!1;var m=r.updateQueue;Vi=!1;var y=m.firstBaseUpdate,C=m.lastBaseUpdate,M=m.shared.pending;if(M!==null){m.shared.pending=null;var j=M,P=j.next;j.next=null,C===null?y=P:C.next=P,C=j;var G=r.alternate;G!==null&&(G=G.updateQueue,M=G.lastBaseUpdate,M!==C&&(M===null?G.firstBaseUpdate=P:M.next=P,G.lastBaseUpdate=j))}if(y!==null){var J=m.baseState;C=0,G=P=j=null,M=y;do{var V=M.lane&-536870913,F=V!==M.lane;if(F?(Oe&V)===V:(f&V)===V){V!==0&&V===zo&&(yf=!0),G!==null&&(G=G.next={lane:0,tag:M.tag,payload:M.payload,callback:null,next:null});e:{var ue=r,be=M;V=l;var Ue=c;switch(be.tag){case 1:if(ue=be.payload,typeof ue=="function"){J=ue.call(Ue,J,V);break e}J=ue;break e;case 3:ue.flags=ue.flags&-65537|128;case 0:if(ue=be.payload,V=typeof ue=="function"?ue.call(Ue,J,V):ue,V==null)break e;J=g({},J,V);break e;case 2:Vi=!0}}V=M.callback,V!==null&&(r.flags|=64,F&&(r.flags|=8192),F=m.callbacks,F===null?m.callbacks=[V]:F.push(V))}else F={lane:V,tag:M.tag,payload:M.payload,callback:M.callback,next:null},G===null?(P=G=F,j=J):G=G.next=F,C|=V;if(M=M.next,M===null){if(M=m.shared.pending,M===null)break;F=M,M=F.next,F.next=null,m.lastBaseUpdate=F,m.shared.pending=null}}while(!0);G===null&&(j=J),m.baseState=j,m.firstBaseUpdate=P,m.lastBaseUpdate=G,y===null&&(m.shared.lanes=0),Xi|=C,r.lanes=C,r.memoizedState=J}}function Fy(r,l){if(typeof r!="function")throw Error(i(191,r));r.call(l)}function Wy(r,l){var c=r.callbacks;if(c!==null)for(r.callbacks=null,r=0;r<c.length;r++)Fy(c[r],l)}var _o=O(null),_a=O(0);function Yy(r,l){r=fi,K(_a,r),K(_o,l),fi=r|l.baseLanes}function xf(){K(_a,fi),K(_o,_o.current)}function bf(){fi=_a.current,U(_o),U(_a)}var Zt=O(null),gn=null;function Wi(r){var l=r.alternate;K(it,it.current&1),K(Zt,r),gn===null&&(l===null||_o.current!==null||l.memoizedState!==null)&&(gn=r)}function vf(r){K(it,it.current),K(Zt,r),gn===null&&(gn=r)}function Gy(r){r.tag===22?(K(it,it.current),K(Zt,r),gn===null&&(gn=r)):Yi()}function Yi(){K(it,it.current),K(Zt,Zt.current)}function en(r){U(Zt),gn===r&&(gn=null),U(it)}var it=O(0);function Ha(r){for(var l=r;l!==null;){if(l.tag===13){var c=l.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Th(c)||Mh(c)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var ri=0,ke=null,_e=null,lt=null,Ua=!1,Ho=!1,Fr=!1,$a=0,Gl=0,Uo=null,mT=0;function Qe(){throw Error(i(321))}function Sf(r,l){if(l===null)return!1;for(var c=0;c<l.length&&c<r.length;c++)if(!Jt(r[c],l[c]))return!1;return!0}function wf(r,l,c,f,m,y){return ri=y,ke=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,q.H=r===null||r.memoizedState===null?D0:If,Fr=!1,y=c(f,m),Fr=!1,Ho&&(y=Xy(l,c,f,m)),Ky(r),y}function Ky(r){q.H=Jl;var l=_e!==null&&_e.next!==null;if(ri=0,lt=_e=ke=null,Ua=!1,Gl=0,Uo=null,l)throw Error(i(300));r===null||st||(r=r.dependencies,r!==null&&Da(r)&&(st=!0))}function Xy(r,l,c,f){ke=r;var m=0;do{if(Ho&&(Uo=null),Gl=0,Ho=!1,25<=m)throw Error(i(301));if(m+=1,lt=_e=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}q.H=N0,y=l(c,f)}while(Ho);return y}function gT(){var r=q.H,l=r.useState()[0];return l=typeof l.then=="function"?Kl(l):l,r=r.useState()[0],(_e!==null?_e.memoizedState:null)!==r&&(ke.flags|=1024),l}function Cf(){var r=$a!==0;return $a=0,r}function kf(r,l,c){l.updateQueue=r.updateQueue,l.flags&=-2053,r.lanes&=~c}function Ef(r){if(Ua){for(r=r.memoizedState;r!==null;){var l=r.queue;l!==null&&(l.pending=null),r=r.next}Ua=!1}ri=0,lt=_e=ke=null,Ho=!1,Gl=$a=0,Uo=null}function Nt(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lt===null?ke.memoizedState=lt=r:lt=lt.next=r,lt}function rt(){if(_e===null){var r=ke.alternate;r=r!==null?r.memoizedState:null}else r=_e.next;var l=lt===null?ke.memoizedState:lt.next;if(l!==null)lt=l,_e=r;else{if(r===null)throw ke.alternate===null?Error(i(467)):Error(i(310));_e=r,r={memoizedState:_e.memoizedState,baseState:_e.baseState,baseQueue:_e.baseQueue,queue:_e.queue,next:null},lt===null?ke.memoizedState=lt=r:lt=lt.next=r}return lt}function Pa(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Kl(r){var l=Gl;return Gl+=1,Uo===null&&(Uo=[]),r=Uy(Uo,r,l),l=ke,(lt===null?l.memoizedState:lt.next)===null&&(l=l.alternate,q.H=l===null||l.memoizedState===null?D0:If),r}function Va(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Kl(r);if(r.$$typeof===D)return vt(r)}throw Error(i(438,String(r)))}function Tf(r){var l=null,c=ke.updateQueue;if(c!==null&&(l=c.memoCache),l==null){var f=ke.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(l={data:f.data.map(function(m){return m.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),c===null&&(c=Pa(),ke.updateQueue=c),c.memoCache=l,c=l.data[l.index],c===void 0)for(c=l.data[l.index]=Array(r),f=0;f<r;f++)c[f]=W;return l.index++,c}function oi(r,l){return typeof l=="function"?l(r):l}function qa(r){var l=rt();return Mf(l,_e,r)}function Mf(r,l,c){var f=r.queue;if(f===null)throw Error(i(311));f.lastRenderedReducer=c;var m=r.baseQueue,y=f.pending;if(y!==null){if(m!==null){var C=m.next;m.next=y.next,y.next=C}l.baseQueue=m=y,f.pending=null}if(y=r.baseState,m===null)r.memoizedState=y;else{l=m.next;var M=C=null,j=null,P=l,G=!1;do{var J=P.lane&-536870913;if(J!==P.lane?(Oe&J)===J:(ri&J)===J){var V=P.revertLane;if(V===0)j!==null&&(j=j.next={lane:0,revertLane:0,gesture:null,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null}),J===zo&&(G=!0);else if((ri&V)===V){P=P.next,V===zo&&(G=!0);continue}else J={lane:0,revertLane:P.revertLane,gesture:null,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null},j===null?(M=j=J,C=y):j=j.next=J,ke.lanes|=V,Xi|=V;J=P.action,Fr&&c(y,J),y=P.hasEagerState?P.eagerState:c(y,J)}else V={lane:J,revertLane:P.revertLane,gesture:P.gesture,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null},j===null?(M=j=V,C=y):j=j.next=V,ke.lanes|=J,Xi|=J;P=P.next}while(P!==null&&P!==l);if(j===null?C=y:j.next=M,!Jt(y,r.memoizedState)&&(st=!0,G&&(c=Lo,c!==null)))throw c;r.memoizedState=y,r.baseState=C,r.baseQueue=j,f.lastRenderedState=y}return m===null&&(f.lanes=0),[r.memoizedState,f.dispatch]}function Af(r){var l=rt(),c=l.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=r;var f=c.dispatch,m=c.pending,y=l.memoizedState;if(m!==null){c.pending=null;var C=m=m.next;do y=r(y,C.action),C=C.next;while(C!==m);Jt(y,l.memoizedState)||(st=!0),l.memoizedState=y,l.baseQueue===null&&(l.baseState=y),c.lastRenderedState=y}return[y,f]}function Jy(r,l,c){var f=ke,m=rt(),y=De;if(y){if(c===void 0)throw Error(i(407));c=c()}else c=l();var C=!Jt((_e||m).memoizedState,c);if(C&&(m.memoizedState=c,st=!0),m=m.queue,Df(e0.bind(null,f,m,r),[r]),m.getSnapshot!==l||C||lt!==null&&lt.memoizedState.tag&1){if(f.flags|=2048,$o(9,{destroy:void 0},Zy.bind(null,f,m,c,l),null),$e===null)throw Error(i(349));y||(ri&127)!==0||Qy(f,l,c)}return c}function Qy(r,l,c){r.flags|=16384,r={getSnapshot:l,value:c},l=ke.updateQueue,l===null?(l=Pa(),ke.updateQueue=l,l.stores=[r]):(c=l.stores,c===null?l.stores=[r]:c.push(r))}function Zy(r,l,c,f){l.value=c,l.getSnapshot=f,t0(l)&&n0(r)}function e0(r,l,c){return c(function(){t0(l)&&n0(r)})}function t0(r){var l=r.getSnapshot;r=r.value;try{var c=l();return!Jt(r,c)}catch{return!0}}function n0(r){var l=Br(r,2);l!==null&&Vt(l,r,2)}function Of(r){var l=Nt();if(typeof r=="function"){var c=r;if(r=c(),Fr){Bi(!0);try{c()}finally{Bi(!1)}}}return l.memoizedState=l.baseState=r,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:r},l}function i0(r,l,c,f){return r.baseState=c,Mf(r,_e,typeof f=="function"?f:oi)}function yT(r,l,c,f,m){if(Ya(r))throw Error(i(485));if(r=l.action,r!==null){var y={payload:m,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){y.listeners.push(C)}};q.T!==null?c(!0):y.isTransition=!1,f(y),c=l.pending,c===null?(y.next=l.pending=y,r0(l,y)):(y.next=c.next,l.pending=c.next=y)}}function r0(r,l){var c=l.action,f=l.payload,m=r.state;if(l.isTransition){var y=q.T,C={};q.T=C;try{var M=c(m,f),j=q.S;j!==null&&j(C,M),o0(r,l,M)}catch(P){Rf(r,l,P)}finally{y!==null&&C.types!==null&&(y.types=C.types),q.T=y}}else try{y=c(m,f),o0(r,l,y)}catch(P){Rf(r,l,P)}}function o0(r,l,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){l0(r,l,f)},function(f){return Rf(r,l,f)}):l0(r,l,c)}function l0(r,l,c){l.status="fulfilled",l.value=c,s0(l),r.state=c,l=r.pending,l!==null&&(c=l.next,c===l?r.pending=null:(c=c.next,l.next=c,r0(r,c)))}function Rf(r,l,c){var f=r.pending;if(r.pending=null,f!==null){f=f.next;do l.status="rejected",l.reason=c,s0(l),l=l.next;while(l!==f)}r.action=null}function s0(r){r=r.listeners;for(var l=0;l<r.length;l++)(0,r[l])()}function a0(r,l){return l}function c0(r,l){if(De){var c=$e.formState;if(c!==null){e:{var f=ke;if(De){if(Ve){t:{for(var m=Ve,y=mn;m.nodeType!==8;){if(!y){m=null;break t}if(m=yn(m.nextSibling),m===null){m=null;break t}}y=m.data,m=y==="F!"||y==="F"?m:null}if(m){Ve=yn(m.nextSibling),f=m.data==="F!";break e}}$i(f)}f=!1}f&&(l=c[0])}}return c=Nt(),c.memoizedState=c.baseState=l,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a0,lastRenderedState:l},c.queue=f,c=A0.bind(null,ke,f),f.dispatch=c,f=Of(!1),y=Bf.bind(null,ke,!1,f.queue),f=Nt(),m={state:l,dispatch:null,action:r,pending:null},f.queue=m,c=yT.bind(null,ke,m,y,c),m.dispatch=c,f.memoizedState=r,[l,c,!1]}function u0(r){var l=rt();return d0(l,_e,r)}function d0(r,l,c){if(l=Mf(r,l,a0)[0],r=qa(oi)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var f=Kl(l)}catch(C){throw C===Bo?za:C}else f=l;l=rt();var m=l.queue,y=m.dispatch;return c!==l.memoizedState&&(ke.flags|=2048,$o(9,{destroy:void 0},xT.bind(null,m,c),null)),[f,y,r]}function xT(r,l){r.action=l}function f0(r){var l=rt(),c=_e;if(c!==null)return d0(l,c,r);rt(),l=l.memoizedState,c=rt();var f=c.queue.dispatch;return c.memoizedState=r,[l,f,!1]}function $o(r,l,c,f){return r={tag:r,create:c,deps:f,inst:l,next:null},l=ke.updateQueue,l===null&&(l=Pa(),ke.updateQueue=l),c=l.lastEffect,c===null?l.lastEffect=r.next=r:(f=c.next,c.next=r,r.next=f,l.lastEffect=r),r}function h0(){return rt().memoizedState}function Fa(r,l,c,f){var m=Nt();ke.flags|=r,m.memoizedState=$o(1|l,{destroy:void 0},c,f===void 0?null:f)}function Wa(r,l,c,f){var m=rt();f=f===void 0?null:f;var y=m.memoizedState.inst;_e!==null&&f!==null&&Sf(f,_e.memoizedState.deps)?m.memoizedState=$o(l,y,c,f):(ke.flags|=r,m.memoizedState=$o(1|l,y,c,f))}function p0(r,l){Fa(8390656,8,r,l)}function Df(r,l){Wa(2048,8,r,l)}function bT(r){ke.flags|=4;var l=ke.updateQueue;if(l===null)l=Pa(),ke.updateQueue=l,l.events=[r];else{var c=l.events;c===null?l.events=[r]:c.push(r)}}function m0(r){var l=rt().memoizedState;return bT({ref:l,nextImpl:r}),function(){if((ze&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}function g0(r,l){return Wa(4,2,r,l)}function y0(r,l){return Wa(4,4,r,l)}function x0(r,l){if(typeof l=="function"){r=r();var c=l(r);return function(){typeof c=="function"?c():l(null)}}if(l!=null)return r=r(),l.current=r,function(){l.current=null}}function b0(r,l,c){c=c!=null?c.concat([r]):null,Wa(4,4,x0.bind(null,l,r),c)}function Nf(){}function v0(r,l){var c=rt();l=l===void 0?null:l;var f=c.memoizedState;return l!==null&&Sf(l,f[1])?f[0]:(c.memoizedState=[r,l],r)}function S0(r,l){var c=rt();l=l===void 0?null:l;var f=c.memoizedState;if(l!==null&&Sf(l,f[1]))return f[0];if(f=r(),Fr){Bi(!0);try{r()}finally{Bi(!1)}}return c.memoizedState=[f,l],f}function jf(r,l,c){return c===void 0||(ri&1073741824)!==0&&(Oe&261930)===0?r.memoizedState=l:(r.memoizedState=c,r=wx(),ke.lanes|=r,Xi|=r,c)}function w0(r,l,c,f){return Jt(c,l)?c:_o.current!==null?(r=jf(r,c,f),Jt(r,l)||(st=!0),r):(ri&42)===0||(ri&1073741824)!==0&&(Oe&261930)===0?(st=!0,r.memoizedState=c):(r=wx(),ke.lanes|=r,Xi|=r,l)}function C0(r,l,c,f,m){var y=ee.p;ee.p=y!==0&&8>y?y:8;var C=q.T,M={};q.T=M,Bf(r,!1,l,c);try{var j=m(),P=q.S;if(P!==null&&P(M,j),j!==null&&typeof j=="object"&&typeof j.then=="function"){var G=pT(j,f);Xl(r,l,G,rn(r))}else Xl(r,l,f,rn(r))}catch(J){Xl(r,l,{then:function(){},status:"rejected",reason:J},rn())}finally{ee.p=y,C!==null&&M.types!==null&&(C.types=M.types),q.T=C}}function vT(){}function zf(r,l,c,f){if(r.tag!==5)throw Error(i(476));var m=k0(r).queue;C0(r,m,l,ce,c===null?vT:function(){return E0(r),c(f)})}function k0(r){var l=r.memoizedState;if(l!==null)return l;l={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:ce},next:null};var c={};return l.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:c},next:null},r.memoizedState=l,r=r.alternate,r!==null&&(r.memoizedState=l),l}function E0(r){var l=k0(r);l.next===null&&(l=r.alternate.memoizedState),Xl(r,l.next.queue,{},rn())}function Lf(){return vt(ps)}function T0(){return rt().memoizedState}function M0(){return rt().memoizedState}function ST(r){for(var l=r.return;l!==null;){switch(l.tag){case 24:case 3:var c=rn();r=qi(c);var f=Fi(l,r,c);f!==null&&(Vt(f,l,c),Fl(f,l,c)),l={cache:uf()},r.payload=l;return}l=l.return}}function wT(r,l,c){var f=rn();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Ya(r)?O0(l,c):(c=Qd(r,l,c,f),c!==null&&(Vt(c,r,f),R0(c,l,f)))}function A0(r,l,c){var f=rn();Xl(r,l,c,f)}function Xl(r,l,c,f){var m={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Ya(r))O0(l,m);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=l.lastRenderedReducer,y!==null))try{var C=l.lastRenderedState,M=y(C,c);if(m.hasEagerState=!0,m.eagerState=M,Jt(M,C))return Ma(r,l,m,0),$e===null&&Ta(),!1}catch{}if(c=Qd(r,l,m,f),c!==null)return Vt(c,r,f),R0(c,l,f),!0}return!1}function Bf(r,l,c,f){if(f={lane:2,revertLane:ph(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Ya(r)){if(l)throw Error(i(479))}else l=Qd(r,c,f,2),l!==null&&Vt(l,r,2)}function Ya(r){var l=r.alternate;return r===ke||l!==null&&l===ke}function O0(r,l){Ho=Ua=!0;var c=r.pending;c===null?l.next=l:(l.next=c.next,c.next=l),r.pending=l}function R0(r,l,c){if((c&4194048)!==0){var f=l.lanes;f&=r.pendingLanes,c|=f,l.lanes=c,Lg(r,c)}}var Jl={readContext:vt,use:Va,useCallback:Qe,useContext:Qe,useEffect:Qe,useImperativeHandle:Qe,useLayoutEffect:Qe,useInsertionEffect:Qe,useMemo:Qe,useReducer:Qe,useRef:Qe,useState:Qe,useDebugValue:Qe,useDeferredValue:Qe,useTransition:Qe,useSyncExternalStore:Qe,useId:Qe,useHostTransitionStatus:Qe,useFormState:Qe,useActionState:Qe,useOptimistic:Qe,useMemoCache:Qe,useCacheRefresh:Qe};Jl.useEffectEvent=Qe;var D0={readContext:vt,use:Va,useCallback:function(r,l){return Nt().memoizedState=[r,l===void 0?null:l],r},useContext:vt,useEffect:p0,useImperativeHandle:function(r,l,c){c=c!=null?c.concat([r]):null,Fa(4194308,4,x0.bind(null,l,r),c)},useLayoutEffect:function(r,l){return Fa(4194308,4,r,l)},useInsertionEffect:function(r,l){Fa(4,2,r,l)},useMemo:function(r,l){var c=Nt();l=l===void 0?null:l;var f=r();if(Fr){Bi(!0);try{r()}finally{Bi(!1)}}return c.memoizedState=[f,l],f},useReducer:function(r,l,c){var f=Nt();if(c!==void 0){var m=c(l);if(Fr){Bi(!0);try{c(l)}finally{Bi(!1)}}}else m=l;return f.memoizedState=f.baseState=m,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:m},f.queue=r,r=r.dispatch=wT.bind(null,ke,r),[f.memoizedState,r]},useRef:function(r){var l=Nt();return r={current:r},l.memoizedState=r},useState:function(r){r=Of(r);var l=r.queue,c=A0.bind(null,ke,l);return l.dispatch=c,[r.memoizedState,c]},useDebugValue:Nf,useDeferredValue:function(r,l){var c=Nt();return jf(c,r,l)},useTransition:function(){var r=Of(!1);return r=C0.bind(null,ke,r.queue,!0,!1),Nt().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,l,c){var f=ke,m=Nt();if(De){if(c===void 0)throw Error(i(407));c=c()}else{if(c=l(),$e===null)throw Error(i(349));(Oe&127)!==0||Qy(f,l,c)}m.memoizedState=c;var y={value:c,getSnapshot:l};return m.queue=y,p0(e0.bind(null,f,y,r),[r]),f.flags|=2048,$o(9,{destroy:void 0},Zy.bind(null,f,y,c,l),null),c},useId:function(){var r=Nt(),l=$e.identifierPrefix;if(De){var c=In,f=Bn;c=(f&~(1<<32-Xt(f)-1)).toString(32)+c,l="_"+l+"R_"+c,c=$a++,0<c&&(l+="H"+c.toString(32)),l+="_"}else c=mT++,l="_"+l+"r_"+c.toString(32)+"_";return r.memoizedState=l},useHostTransitionStatus:Lf,useFormState:c0,useActionState:c0,useOptimistic:function(r){var l=Nt();l.memoizedState=l.baseState=r;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=c,l=Bf.bind(null,ke,!0,c),c.dispatch=l,[r,l]},useMemoCache:Tf,useCacheRefresh:function(){return Nt().memoizedState=ST.bind(null,ke)},useEffectEvent:function(r){var l=Nt(),c={impl:r};return l.memoizedState=c,function(){if((ze&2)!==0)throw Error(i(440));return c.impl.apply(void 0,arguments)}}},If={readContext:vt,use:Va,useCallback:v0,useContext:vt,useEffect:Df,useImperativeHandle:b0,useInsertionEffect:g0,useLayoutEffect:y0,useMemo:S0,useReducer:qa,useRef:h0,useState:function(){return qa(oi)},useDebugValue:Nf,useDeferredValue:function(r,l){var c=rt();return w0(c,_e.memoizedState,r,l)},useTransition:function(){var r=qa(oi)[0],l=rt().memoizedState;return[typeof r=="boolean"?r:Kl(r),l]},useSyncExternalStore:Jy,useId:T0,useHostTransitionStatus:Lf,useFormState:u0,useActionState:u0,useOptimistic:function(r,l){var c=rt();return i0(c,_e,r,l)},useMemoCache:Tf,useCacheRefresh:M0};If.useEffectEvent=m0;var N0={readContext:vt,use:Va,useCallback:v0,useContext:vt,useEffect:Df,useImperativeHandle:b0,useInsertionEffect:g0,useLayoutEffect:y0,useMemo:S0,useReducer:Af,useRef:h0,useState:function(){return Af(oi)},useDebugValue:Nf,useDeferredValue:function(r,l){var c=rt();return _e===null?jf(c,r,l):w0(c,_e.memoizedState,r,l)},useTransition:function(){var r=Af(oi)[0],l=rt().memoizedState;return[typeof r=="boolean"?r:Kl(r),l]},useSyncExternalStore:Jy,useId:T0,useHostTransitionStatus:Lf,useFormState:f0,useActionState:f0,useOptimistic:function(r,l){var c=rt();return _e!==null?i0(c,_e,r,l):(c.baseState=r,[r,c.queue.dispatch])},useMemoCache:Tf,useCacheRefresh:M0};N0.useEffectEvent=m0;function _f(r,l,c,f){l=r.memoizedState,c=c(f,l),c=c==null?l:g({},l,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var Hf={enqueueSetState:function(r,l,c){r=r._reactInternals;var f=rn(),m=qi(f);m.payload=l,c!=null&&(m.callback=c),l=Fi(r,m,f),l!==null&&(Vt(l,r,f),Fl(l,r,f))},enqueueReplaceState:function(r,l,c){r=r._reactInternals;var f=rn(),m=qi(f);m.tag=1,m.payload=l,c!=null&&(m.callback=c),l=Fi(r,m,f),l!==null&&(Vt(l,r,f),Fl(l,r,f))},enqueueForceUpdate:function(r,l){r=r._reactInternals;var c=rn(),f=qi(c);f.tag=2,l!=null&&(f.callback=l),l=Fi(r,f,c),l!==null&&(Vt(l,r,c),Fl(l,r,c))}};function j0(r,l,c,f,m,y,C){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(f,y,C):l.prototype&&l.prototype.isPureReactComponent?!Il(c,f)||!Il(m,y):!0}function z0(r,l,c,f){r=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(c,f),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(c,f),l.state!==r&&Hf.enqueueReplaceState(l,l.state,null)}function Wr(r,l){var c=l;if("ref"in l){c={};for(var f in l)f!=="ref"&&(c[f]=l[f])}if(r=r.defaultProps){c===l&&(c=g({},c));for(var m in r)c[m]===void 0&&(c[m]=r[m])}return c}function L0(r){Ea(r)}function B0(r){console.error(r)}function I0(r){Ea(r)}function Ga(r,l){try{var c=r.onUncaughtError;c(l.value,{componentStack:l.stack})}catch(f){setTimeout(function(){throw f})}}function _0(r,l,c){try{var f=r.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Uf(r,l,c){return c=qi(c),c.tag=3,c.payload={element:null},c.callback=function(){Ga(r,l)},c}function H0(r){return r=qi(r),r.tag=3,r}function U0(r,l,c,f){var m=c.type.getDerivedStateFromError;if(typeof m=="function"){var y=f.value;r.payload=function(){return m(y)},r.callback=function(){_0(l,c,f)}}var C=c.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(r.callback=function(){_0(l,c,f),typeof m!="function"&&(Ji===null?Ji=new Set([this]):Ji.add(this));var M=f.stack;this.componentDidCatch(f.value,{componentStack:M!==null?M:""})})}function CT(r,l,c,f,m){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(l=c.alternate,l!==null&&jo(l,c,m,!0),c=Zt.current,c!==null){switch(c.tag){case 31:case 13:return gn===null?lc():c.alternate===null&&Ze===0&&(Ze=3),c.flags&=-257,c.flags|=65536,c.lanes=m,f===La?c.flags|=16384:(l=c.updateQueue,l===null?c.updateQueue=new Set([f]):l.add(f),dh(r,f,m)),!1;case 22:return c.flags|=65536,f===La?c.flags|=16384:(l=c.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=l):(c=l.retryQueue,c===null?l.retryQueue=new Set([f]):c.add(f)),dh(r,f,m)),!1}throw Error(i(435,c.tag))}return dh(r,f,m),lc(),!1}if(De)return l=Zt.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=m,f!==of&&(r=Error(i(422),{cause:f}),Ul(fn(r,c)))):(f!==of&&(l=Error(i(423),{cause:f}),Ul(fn(l,c))),r=r.current.alternate,r.flags|=65536,m&=-m,r.lanes|=m,f=fn(f,c),m=Uf(r.stateNode,f,m),gf(r,m),Ze!==4&&(Ze=2)),!1;var y=Error(i(520),{cause:f});if(y=fn(y,c),ls===null?ls=[y]:ls.push(y),Ze!==4&&(Ze=2),l===null)return!0;f=fn(f,c),c=l;do{switch(c.tag){case 3:return c.flags|=65536,r=m&-m,c.lanes|=r,r=Uf(c.stateNode,f,r),gf(c,r),!1;case 1:if(l=c.type,y=c.stateNode,(c.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ji===null||!Ji.has(y))))return c.flags|=65536,m&=-m,c.lanes|=m,m=H0(m),U0(m,r,c,f),gf(c,m),!1}c=c.return}while(c!==null);return!1}var $f=Error(i(461)),st=!1;function St(r,l,c,f){l.child=r===null?qy(l,null,c,f):qr(l,r.child,c,f)}function $0(r,l,c,f,m){c=c.render;var y=l.ref;if("ref"in f){var C={};for(var M in f)M!=="ref"&&(C[M]=f[M])}else C=f;return Ur(l),f=wf(r,l,c,C,y,m),M=Cf(),r!==null&&!st?(kf(r,l,m),li(r,l,m)):(De&&M&&nf(l),l.flags|=1,St(r,l,f,m),l.child)}function P0(r,l,c,f,m){if(r===null){var y=c.type;return typeof y=="function"&&!Zd(y)&&y.defaultProps===void 0&&c.compare===null?(l.tag=15,l.type=y,V0(r,l,y,f,m)):(r=Oa(c.type,null,f,l,l.mode,m),r.ref=l.ref,r.return=l,l.child=r)}if(y=r.child,!Kf(r,m)){var C=y.memoizedProps;if(c=c.compare,c=c!==null?c:Il,c(C,f)&&r.ref===l.ref)return li(r,l,m)}return l.flags|=1,r=ei(y,f),r.ref=l.ref,r.return=l,l.child=r}function V0(r,l,c,f,m){if(r!==null){var y=r.memoizedProps;if(Il(y,f)&&r.ref===l.ref)if(st=!1,l.pendingProps=f=y,Kf(r,m))(r.flags&131072)!==0&&(st=!0);else return l.lanes=r.lanes,li(r,l,m)}return Pf(r,l,c,f,m)}function q0(r,l,c,f){var m=f.children,y=r!==null?r.memoizedState:null;if(r===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((l.flags&128)!==0){if(y=y!==null?y.baseLanes|c:c,r!==null){for(f=l.child=r.child,m=0;f!==null;)m=m|f.lanes|f.childLanes,f=f.sibling;f=m&~y}else f=0,l.child=null;return F0(r,l,y,c,f)}if((c&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},r!==null&&ja(l,y!==null?y.cachePool:null),y!==null?Yy(l,y):xf(),Gy(l);else return f=l.lanes=536870912,F0(r,l,y!==null?y.baseLanes|c:c,c,f)}else y!==null?(ja(l,y.cachePool),Yy(l,y),Yi(),l.memoizedState=null):(r!==null&&ja(l,null),xf(),Yi());return St(r,l,m,c),l.child}function Ql(r,l){return r!==null&&r.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function F0(r,l,c,f,m){var y=ff();return y=y===null?null:{parent:ot._currentValue,pool:y},l.memoizedState={baseLanes:c,cachePool:y},r!==null&&ja(l,null),xf(),Gy(l),r!==null&&jo(r,l,f,!0),l.childLanes=m,null}function Ka(r,l){return l=Ja({mode:l.mode,children:l.children},r.mode),l.ref=r.ref,r.child=l,l.return=r,l}function W0(r,l,c){return qr(l,r.child,null,c),r=Ka(l,l.pendingProps),r.flags|=2,en(l),l.memoizedState=null,r}function kT(r,l,c){var f=l.pendingProps,m=(l.flags&128)!==0;if(l.flags&=-129,r===null){if(De){if(f.mode==="hidden")return r=Ka(l,f),l.lanes=536870912,Ql(null,r);if(vf(l),(r=Ve)?(r=rb(r,mn),r=r!==null&&r.data==="&"?r:null,r!==null&&(l.memoizedState={dehydrated:r,treeContext:Hi!==null?{id:Bn,overflow:In}:null,retryLane:536870912,hydrationErrors:null},c=Oy(r),c.return=l,l.child=c,bt=l,Ve=null)):r=null,r===null)throw $i(l);return l.lanes=536870912,null}return Ka(l,f)}var y=r.memoizedState;if(y!==null){var C=y.dehydrated;if(vf(l),m)if(l.flags&256)l.flags&=-257,l=W0(r,l,c);else if(l.memoizedState!==null)l.child=r.child,l.flags|=128,l=null;else throw Error(i(558));else if(st||jo(r,l,c,!1),m=(c&r.childLanes)!==0,st||m){if(f=$e,f!==null&&(C=Bg(f,c),C!==0&&C!==y.retryLane))throw y.retryLane=C,Br(r,C),Vt(f,r,C),$f;lc(),l=W0(r,l,c)}else r=y.treeContext,Ve=yn(C.nextSibling),bt=l,De=!0,Ui=null,mn=!1,r!==null&&Ny(l,r),l=Ka(l,f),l.flags|=4096;return l}return r=ei(r.child,{mode:f.mode,children:f.children}),r.ref=l.ref,l.child=r,r.return=l,r}function Xa(r,l){var c=l.ref;if(c===null)r!==null&&r.ref!==null&&(l.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(r===null||r.ref!==c)&&(l.flags|=4194816)}}function Pf(r,l,c,f,m){return Ur(l),c=wf(r,l,c,f,void 0,m),f=Cf(),r!==null&&!st?(kf(r,l,m),li(r,l,m)):(De&&f&&nf(l),l.flags|=1,St(r,l,c,m),l.child)}function Y0(r,l,c,f,m,y){return Ur(l),l.updateQueue=null,c=Xy(l,f,c,m),Ky(r),f=Cf(),r!==null&&!st?(kf(r,l,y),li(r,l,y)):(De&&f&&nf(l),l.flags|=1,St(r,l,c,y),l.child)}function G0(r,l,c,f,m){if(Ur(l),l.stateNode===null){var y=Oo,C=c.contextType;typeof C=="object"&&C!==null&&(y=vt(C)),y=new c(f,y),l.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Hf,l.stateNode=y,y._reactInternals=l,y=l.stateNode,y.props=f,y.state=l.memoizedState,y.refs={},pf(l),C=c.contextType,y.context=typeof C=="object"&&C!==null?vt(C):Oo,y.state=l.memoizedState,C=c.getDerivedStateFromProps,typeof C=="function"&&(_f(l,c,C,f),y.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(C=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),C!==y.state&&Hf.enqueueReplaceState(y,y.state,null),Yl(l,f,y,m),Wl(),y.state=l.memoizedState),typeof y.componentDidMount=="function"&&(l.flags|=4194308),f=!0}else if(r===null){y=l.stateNode;var M=l.memoizedProps,j=Wr(c,M);y.props=j;var P=y.context,G=c.contextType;C=Oo,typeof G=="object"&&G!==null&&(C=vt(G));var J=c.getDerivedStateFromProps;G=typeof J=="function"||typeof y.getSnapshotBeforeUpdate=="function",M=l.pendingProps!==M,G||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(M||P!==C)&&z0(l,y,f,C),Vi=!1;var V=l.memoizedState;y.state=V,Yl(l,f,y,m),Wl(),P=l.memoizedState,M||V!==P||Vi?(typeof J=="function"&&(_f(l,c,J,f),P=l.memoizedState),(j=Vi||j0(l,c,j,f,V,P,C))?(G||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(l.flags|=4194308)):(typeof y.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=f,l.memoizedState=P),y.props=f,y.state=P,y.context=C,f=j):(typeof y.componentDidMount=="function"&&(l.flags|=4194308),f=!1)}else{y=l.stateNode,mf(r,l),C=l.memoizedProps,G=Wr(c,C),y.props=G,J=l.pendingProps,V=y.context,P=c.contextType,j=Oo,typeof P=="object"&&P!==null&&(j=vt(P)),M=c.getDerivedStateFromProps,(P=typeof M=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(C!==J||V!==j)&&z0(l,y,f,j),Vi=!1,V=l.memoizedState,y.state=V,Yl(l,f,y,m),Wl();var F=l.memoizedState;C!==J||V!==F||Vi||r!==null&&r.dependencies!==null&&Da(r.dependencies)?(typeof M=="function"&&(_f(l,c,M,f),F=l.memoizedState),(G=Vi||j0(l,c,G,f,V,F,j)||r!==null&&r.dependencies!==null&&Da(r.dependencies))?(P||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(f,F,j),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(f,F,j)),typeof y.componentDidUpdate=="function"&&(l.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof y.componentDidUpdate!="function"||C===r.memoizedProps&&V===r.memoizedState||(l.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||C===r.memoizedProps&&V===r.memoizedState||(l.flags|=1024),l.memoizedProps=f,l.memoizedState=F),y.props=f,y.state=F,y.context=j,f=G):(typeof y.componentDidUpdate!="function"||C===r.memoizedProps&&V===r.memoizedState||(l.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||C===r.memoizedProps&&V===r.memoizedState||(l.flags|=1024),f=!1)}return y=f,Xa(r,l),f=(l.flags&128)!==0,y||f?(y=l.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:y.render(),l.flags|=1,r!==null&&f?(l.child=qr(l,r.child,null,m),l.child=qr(l,null,c,m)):St(r,l,c,m),l.memoizedState=y.state,r=l.child):r=li(r,l,m),r}function K0(r,l,c,f){return _r(),l.flags|=256,St(r,l,c,f),l.child}var Vf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function qf(r){return{baseLanes:r,cachePool:_y()}}function Ff(r,l,c){return r=r!==null?r.childLanes&~c:0,l&&(r|=nn),r}function X0(r,l,c){var f=l.pendingProps,m=!1,y=(l.flags&128)!==0,C;if((C=y)||(C=r!==null&&r.memoizedState===null?!1:(it.current&2)!==0),C&&(m=!0,l.flags&=-129),C=(l.flags&32)!==0,l.flags&=-33,r===null){if(De){if(m?Wi(l):Yi(),(r=Ve)?(r=rb(r,mn),r=r!==null&&r.data!=="&"?r:null,r!==null&&(l.memoizedState={dehydrated:r,treeContext:Hi!==null?{id:Bn,overflow:In}:null,retryLane:536870912,hydrationErrors:null},c=Oy(r),c.return=l,l.child=c,bt=l,Ve=null)):r=null,r===null)throw $i(l);return Mh(r)?l.lanes=32:l.lanes=536870912,null}var M=f.children;return f=f.fallback,m?(Yi(),m=l.mode,M=Ja({mode:"hidden",children:M},m),f=Ir(f,m,c,null),M.return=l,f.return=l,M.sibling=f,l.child=M,f=l.child,f.memoizedState=qf(c),f.childLanes=Ff(r,C,c),l.memoizedState=Vf,Ql(null,f)):(Wi(l),Wf(l,M))}var j=r.memoizedState;if(j!==null&&(M=j.dehydrated,M!==null)){if(y)l.flags&256?(Wi(l),l.flags&=-257,l=Yf(r,l,c)):l.memoizedState!==null?(Yi(),l.child=r.child,l.flags|=128,l=null):(Yi(),M=f.fallback,m=l.mode,f=Ja({mode:"visible",children:f.children},m),M=Ir(M,m,c,null),M.flags|=2,f.return=l,M.return=l,f.sibling=M,l.child=f,qr(l,r.child,null,c),f=l.child,f.memoizedState=qf(c),f.childLanes=Ff(r,C,c),l.memoizedState=Vf,l=Ql(null,f));else if(Wi(l),Mh(M)){if(C=M.nextSibling&&M.nextSibling.dataset,C)var P=C.dgst;C=P,f=Error(i(419)),f.stack="",f.digest=C,Ul({value:f,source:null,stack:null}),l=Yf(r,l,c)}else if(st||jo(r,l,c,!1),C=(c&r.childLanes)!==0,st||C){if(C=$e,C!==null&&(f=Bg(C,c),f!==0&&f!==j.retryLane))throw j.retryLane=f,Br(r,f),Vt(C,r,f),$f;Th(M)||lc(),l=Yf(r,l,c)}else Th(M)?(l.flags|=192,l.child=r.child,l=null):(r=j.treeContext,Ve=yn(M.nextSibling),bt=l,De=!0,Ui=null,mn=!1,r!==null&&Ny(l,r),l=Wf(l,f.children),l.flags|=4096);return l}return m?(Yi(),M=f.fallback,m=l.mode,j=r.child,P=j.sibling,f=ei(j,{mode:"hidden",children:f.children}),f.subtreeFlags=j.subtreeFlags&65011712,P!==null?M=ei(P,M):(M=Ir(M,m,c,null),M.flags|=2),M.return=l,f.return=l,f.sibling=M,l.child=f,Ql(null,f),f=l.child,M=r.child.memoizedState,M===null?M=qf(c):(m=M.cachePool,m!==null?(j=ot._currentValue,m=m.parent!==j?{parent:j,pool:j}:m):m=_y(),M={baseLanes:M.baseLanes|c,cachePool:m}),f.memoizedState=M,f.childLanes=Ff(r,C,c),l.memoizedState=Vf,Ql(r.child,f)):(Wi(l),c=r.child,r=c.sibling,c=ei(c,{mode:"visible",children:f.children}),c.return=l,c.sibling=null,r!==null&&(C=l.deletions,C===null?(l.deletions=[r],l.flags|=16):C.push(r)),l.child=c,l.memoizedState=null,c)}function Wf(r,l){return l=Ja({mode:"visible",children:l},r.mode),l.return=r,r.child=l}function Ja(r,l){return r=Qt(22,r,null,l),r.lanes=0,r}function Yf(r,l,c){return qr(l,r.child,null,c),r=Wf(l,l.pendingProps.children),r.flags|=2,l.memoizedState=null,r}function J0(r,l,c){r.lanes|=l;var f=r.alternate;f!==null&&(f.lanes|=l),af(r.return,l,c)}function Gf(r,l,c,f,m,y){var C=r.memoizedState;C===null?r.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:m,treeForkCount:y}:(C.isBackwards=l,C.rendering=null,C.renderingStartTime=0,C.last=f,C.tail=c,C.tailMode=m,C.treeForkCount=y)}function Q0(r,l,c){var f=l.pendingProps,m=f.revealOrder,y=f.tail;f=f.children;var C=it.current,M=(C&2)!==0;if(M?(C=C&1|2,l.flags|=128):C&=1,K(it,C),St(r,l,f,c),f=De?Hl:0,!M&&r!==null&&(r.flags&128)!==0)e:for(r=l.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&J0(r,c,l);else if(r.tag===19)J0(r,c,l);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===l)break e;for(;r.sibling===null;){if(r.return===null||r.return===l)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(m){case"forwards":for(c=l.child,m=null;c!==null;)r=c.alternate,r!==null&&Ha(r)===null&&(m=c),c=c.sibling;c=m,c===null?(m=l.child,l.child=null):(m=c.sibling,c.sibling=null),Gf(l,!1,m,c,y,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,m=l.child,l.child=null;m!==null;){if(r=m.alternate,r!==null&&Ha(r)===null){l.child=m;break}r=m.sibling,m.sibling=c,c=m,m=r}Gf(l,!0,c,null,y,f);break;case"together":Gf(l,!1,null,null,void 0,f);break;default:l.memoizedState=null}return l.child}function li(r,l,c){if(r!==null&&(l.dependencies=r.dependencies),Xi|=l.lanes,(c&l.childLanes)===0)if(r!==null){if(jo(r,l,c,!1),(c&l.childLanes)===0)return null}else return null;if(r!==null&&l.child!==r.child)throw Error(i(153));if(l.child!==null){for(r=l.child,c=ei(r,r.pendingProps),l.child=c,c.return=l;r.sibling!==null;)r=r.sibling,c=c.sibling=ei(r,r.pendingProps),c.return=l;c.sibling=null}return l.child}function Kf(r,l){return(r.lanes&l)!==0?!0:(r=r.dependencies,!!(r!==null&&Da(r)))}function ET(r,l,c){switch(l.tag){case 3:ae(l,l.stateNode.containerInfo),Pi(l,ot,r.memoizedState.cache),_r();break;case 27:case 5:Mt(l);break;case 4:ae(l,l.stateNode.containerInfo);break;case 10:Pi(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,vf(l),null;break;case 13:var f=l.memoizedState;if(f!==null)return f.dehydrated!==null?(Wi(l),l.flags|=128,null):(c&l.child.childLanes)!==0?X0(r,l,c):(Wi(l),r=li(r,l,c),r!==null?r.sibling:null);Wi(l);break;case 19:var m=(r.flags&128)!==0;if(f=(c&l.childLanes)!==0,f||(jo(r,l,c,!1),f=(c&l.childLanes)!==0),m){if(f)return Q0(r,l,c);l.flags|=128}if(m=l.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),K(it,it.current),f)break;return null;case 22:return l.lanes=0,q0(r,l,c,l.pendingProps);case 24:Pi(l,ot,r.memoizedState.cache)}return li(r,l,c)}function Z0(r,l,c){if(r!==null)if(r.memoizedProps!==l.pendingProps)st=!0;else{if(!Kf(r,c)&&(l.flags&128)===0)return st=!1,ET(r,l,c);st=(r.flags&131072)!==0}else st=!1,De&&(l.flags&1048576)!==0&&Dy(l,Hl,l.index);switch(l.lanes=0,l.tag){case 16:e:{var f=l.pendingProps;if(r=Pr(l.elementType),l.type=r,typeof r=="function")Zd(r)?(f=Wr(r,f),l.tag=1,l=G0(null,l,r,f,c)):(l.tag=0,l=Pf(null,l,r,f,c));else{if(r!=null){var m=r.$$typeof;if(m===L){l.tag=11,l=$0(null,l,r,f,c);break e}else if(m===N){l.tag=14,l=P0(null,l,r,f,c);break e}}throw l=he(r)||r,Error(i(306,l,""))}}return l;case 0:return Pf(r,l,l.type,l.pendingProps,c);case 1:return f=l.type,m=Wr(f,l.pendingProps),G0(r,l,f,m,c);case 3:e:{if(ae(l,l.stateNode.containerInfo),r===null)throw Error(i(387));f=l.pendingProps;var y=l.memoizedState;m=y.element,mf(r,l),Yl(l,f,null,c);var C=l.memoizedState;if(f=C.cache,Pi(l,ot,f),f!==y.cache&&cf(l,[ot],c,!0),Wl(),f=C.element,y.isDehydrated)if(y={element:f,isDehydrated:!1,cache:C.cache},l.updateQueue.baseState=y,l.memoizedState=y,l.flags&256){l=K0(r,l,f,c);break e}else if(f!==m){m=fn(Error(i(424)),l),Ul(m),l=K0(r,l,f,c);break e}else for(r=l.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,Ve=yn(r.firstChild),bt=l,De=!0,Ui=null,mn=!0,c=qy(l,null,f,c),l.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(_r(),f===m){l=li(r,l,c);break e}St(r,l,f,c)}l=l.child}return l;case 26:return Xa(r,l),r===null?(c=ub(l.type,null,l.pendingProps,null))?l.memoizedState=c:De||(c=l.type,r=l.pendingProps,f=hc(Y.current).createElement(c),f[xt]=l,f[It]=r,wt(f,c,r),ft(f),l.stateNode=f):l.memoizedState=ub(l.type,r.memoizedProps,l.pendingProps,r.memoizedState),null;case 27:return Mt(l),r===null&&De&&(f=l.stateNode=sb(l.type,l.pendingProps,Y.current),bt=l,mn=!0,m=Ve,tr(l.type)?(Ah=m,Ve=yn(f.firstChild)):Ve=m),St(r,l,l.pendingProps.children,c),Xa(r,l),r===null&&(l.flags|=4194304),l.child;case 5:return r===null&&De&&((m=f=Ve)&&(f=tM(f,l.type,l.pendingProps,mn),f!==null?(l.stateNode=f,bt=l,Ve=yn(f.firstChild),mn=!1,m=!0):m=!1),m||$i(l)),Mt(l),m=l.type,y=l.pendingProps,C=r!==null?r.memoizedProps:null,f=y.children,Ch(m,y)?f=null:C!==null&&Ch(m,C)&&(l.flags|=32),l.memoizedState!==null&&(m=wf(r,l,gT,null,null,c),ps._currentValue=m),Xa(r,l),St(r,l,f,c),l.child;case 6:return r===null&&De&&((r=c=Ve)&&(c=nM(c,l.pendingProps,mn),c!==null?(l.stateNode=c,bt=l,Ve=null,r=!0):r=!1),r||$i(l)),null;case 13:return X0(r,l,c);case 4:return ae(l,l.stateNode.containerInfo),f=l.pendingProps,r===null?l.child=qr(l,null,f,c):St(r,l,f,c),l.child;case 11:return $0(r,l,l.type,l.pendingProps,c);case 7:return St(r,l,l.pendingProps,c),l.child;case 8:return St(r,l,l.pendingProps.children,c),l.child;case 12:return St(r,l,l.pendingProps.children,c),l.child;case 10:return f=l.pendingProps,Pi(l,l.type,f.value),St(r,l,f.children,c),l.child;case 9:return m=l.type._context,f=l.pendingProps.children,Ur(l),m=vt(m),f=f(m),l.flags|=1,St(r,l,f,c),l.child;case 14:return P0(r,l,l.type,l.pendingProps,c);case 15:return V0(r,l,l.type,l.pendingProps,c);case 19:return Q0(r,l,c);case 31:return kT(r,l,c);case 22:return q0(r,l,c,l.pendingProps);case 24:return Ur(l),f=vt(ot),r===null?(m=ff(),m===null&&(m=$e,y=uf(),m.pooledCache=y,y.refCount++,y!==null&&(m.pooledCacheLanes|=c),m=y),l.memoizedState={parent:f,cache:m},pf(l),Pi(l,ot,m)):((r.lanes&c)!==0&&(mf(r,l),Yl(l,null,null,c),Wl()),m=r.memoizedState,y=l.memoizedState,m.parent!==f?(m={parent:f,cache:f},l.memoizedState=m,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=m),Pi(l,ot,f)):(f=y.cache,Pi(l,ot,f),f!==m.cache&&cf(l,[ot],c,!0))),St(r,l,l.pendingProps.children,c),l.child;case 29:throw l.pendingProps}throw Error(i(156,l.tag))}function si(r){r.flags|=4}function Xf(r,l,c,f,m){if((l=(r.mode&32)!==0)&&(l=!1),l){if(r.flags|=16777216,(m&335544128)===m)if(r.stateNode.complete)r.flags|=8192;else if(Tx())r.flags|=8192;else throw Vr=La,hf}else r.flags&=-16777217}function ex(r,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!mb(l))if(Tx())r.flags|=8192;else throw Vr=La,hf}function Qa(r,l){l!==null&&(r.flags|=4),r.flags&16384&&(l=r.tag!==22?jg():536870912,r.lanes|=l,Fo|=l)}function Zl(r,l){if(!De)switch(r.tailMode){case"hidden":l=r.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?l||r.tail===null?r.tail=null:r.tail.sibling=null:f.sibling=null}}function qe(r){var l=r.alternate!==null&&r.alternate.child===r.child,c=0,f=0;if(l)for(var m=r.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags&65011712,f|=m.flags&65011712,m.return=r,m=m.sibling;else for(m=r.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=r,m=m.sibling;return r.subtreeFlags|=f,r.childLanes=c,l}function TT(r,l,c){var f=l.pendingProps;switch(rf(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qe(l),null;case 1:return qe(l),null;case 3:return c=l.stateNode,f=null,r!==null&&(f=r.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),ii(ot),me(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(r===null||r.child===null)&&(No(l)?si(l):r===null||r.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,lf())),qe(l),null;case 26:var m=l.type,y=l.memoizedState;return r===null?(si(l),y!==null?(qe(l),ex(l,y)):(qe(l),Xf(l,m,null,f,c))):y?y!==r.memoizedState?(si(l),qe(l),ex(l,y)):(qe(l),l.flags&=-16777217):(r=r.memoizedProps,r!==f&&si(l),qe(l),Xf(l,m,r,f,c)),null;case 27:if(Ln(l),c=Y.current,m=l.type,r!==null&&l.stateNode!=null)r.memoizedProps!==f&&si(l);else{if(!f){if(l.stateNode===null)throw Error(i(166));return qe(l),null}r=ie.current,No(l)?jy(l):(r=sb(m,f,c),l.stateNode=r,si(l))}return qe(l),null;case 5:if(Ln(l),m=l.type,r!==null&&l.stateNode!=null)r.memoizedProps!==f&&si(l);else{if(!f){if(l.stateNode===null)throw Error(i(166));return qe(l),null}if(y=ie.current,No(l))jy(l);else{var C=hc(Y.current);switch(y){case 1:y=C.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:y=C.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":y=C.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":y=C.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":y=C.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof f.is=="string"?C.createElement("select",{is:f.is}):C.createElement("select"),f.multiple?y.multiple=!0:f.size&&(y.size=f.size);break;default:y=typeof f.is=="string"?C.createElement(m,{is:f.is}):C.createElement(m)}}y[xt]=l,y[It]=f;e:for(C=l.child;C!==null;){if(C.tag===5||C.tag===6)y.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===l)break e;for(;C.sibling===null;){if(C.return===null||C.return===l)break e;C=C.return}C.sibling.return=C.return,C=C.sibling}l.stateNode=y;e:switch(wt(y,m,f),m){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&si(l)}}return qe(l),Xf(l,l.type,r===null?null:r.memoizedProps,l.pendingProps,c),null;case 6:if(r&&l.stateNode!=null)r.memoizedProps!==f&&si(l);else{if(typeof f!="string"&&l.stateNode===null)throw Error(i(166));if(r=Y.current,No(l)){if(r=l.stateNode,c=l.memoizedProps,f=null,m=bt,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}r[xt]=l,r=!!(r.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||Xx(r.nodeValue,c)),r||$i(l,!0)}else r=hc(r).createTextNode(f),r[xt]=l,l.stateNode=r}return qe(l),null;case 31:if(c=l.memoizedState,r===null||r.memoizedState!==null){if(f=No(l),c!==null){if(r===null){if(!f)throw Error(i(318));if(r=l.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[xt]=l}else _r(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;qe(l),r=!1}else c=lf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=c),r=!0;if(!r)return l.flags&256?(en(l),l):(en(l),null);if((l.flags&128)!==0)throw Error(i(558))}return qe(l),null;case 13:if(f=l.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(m=No(l),f!==null&&f.dehydrated!==null){if(r===null){if(!m)throw Error(i(318));if(m=l.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[xt]=l}else _r(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;qe(l),m=!1}else m=lf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=m),m=!0;if(!m)return l.flags&256?(en(l),l):(en(l),null)}return en(l),(l.flags&128)!==0?(l.lanes=c,l):(c=f!==null,r=r!==null&&r.memoizedState!==null,c&&(f=l.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool),y=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(y=f.memoizedState.cachePool.pool),y!==m&&(f.flags|=2048)),c!==r&&c&&(l.child.flags|=8192),Qa(l,l.updateQueue),qe(l),null);case 4:return me(),r===null&&xh(l.stateNode.containerInfo),qe(l),null;case 10:return ii(l.type),qe(l),null;case 19:if(U(it),f=l.memoizedState,f===null)return qe(l),null;if(m=(l.flags&128)!==0,y=f.rendering,y===null)if(m)Zl(f,!1);else{if(Ze!==0||r!==null&&(r.flags&128)!==0)for(r=l.child;r!==null;){if(y=Ha(r),y!==null){for(l.flags|=128,Zl(f,!1),r=y.updateQueue,l.updateQueue=r,Qa(l,r),l.subtreeFlags=0,r=c,c=l.child;c!==null;)Ay(c,r),c=c.sibling;return K(it,it.current&1|2),De&&ti(l,f.treeForkCount),l.child}r=r.sibling}f.tail!==null&&Gt()>ic&&(l.flags|=128,m=!0,Zl(f,!1),l.lanes=4194304)}else{if(!m)if(r=Ha(y),r!==null){if(l.flags|=128,m=!0,r=r.updateQueue,l.updateQueue=r,Qa(l,r),Zl(f,!0),f.tail===null&&f.tailMode==="hidden"&&!y.alternate&&!De)return qe(l),null}else 2*Gt()-f.renderingStartTime>ic&&c!==536870912&&(l.flags|=128,m=!0,Zl(f,!1),l.lanes=4194304);f.isBackwards?(y.sibling=l.child,l.child=y):(r=f.last,r!==null?r.sibling=y:l.child=y,f.last=y)}return f.tail!==null?(r=f.tail,f.rendering=r,f.tail=r.sibling,f.renderingStartTime=Gt(),r.sibling=null,c=it.current,K(it,m?c&1|2:c&1),De&&ti(l,f.treeForkCount),r):(qe(l),null);case 22:case 23:return en(l),bf(),f=l.memoizedState!==null,r!==null?r.memoizedState!==null!==f&&(l.flags|=8192):f&&(l.flags|=8192),f?(c&536870912)!==0&&(l.flags&128)===0&&(qe(l),l.subtreeFlags&6&&(l.flags|=8192)):qe(l),c=l.updateQueue,c!==null&&Qa(l,c.retryQueue),c=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),f=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),f!==c&&(l.flags|=2048),r!==null&&U($r),null;case 24:return c=null,r!==null&&(c=r.memoizedState.cache),l.memoizedState.cache!==c&&(l.flags|=2048),ii(ot),qe(l),null;case 25:return null;case 30:return null}throw Error(i(156,l.tag))}function MT(r,l){switch(rf(l),l.tag){case 1:return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 3:return ii(ot),me(),r=l.flags,(r&65536)!==0&&(r&128)===0?(l.flags=r&-65537|128,l):null;case 26:case 27:case 5:return Ln(l),null;case 31:if(l.memoizedState!==null){if(en(l),l.alternate===null)throw Error(i(340));_r()}return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 13:if(en(l),r=l.memoizedState,r!==null&&r.dehydrated!==null){if(l.alternate===null)throw Error(i(340));_r()}return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 19:return U(it),null;case 4:return me(),null;case 10:return ii(l.type),null;case 22:case 23:return en(l),bf(),r!==null&&U($r),r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 24:return ii(ot),null;case 25:return null;default:return null}}function tx(r,l){switch(rf(l),l.tag){case 3:ii(ot),me();break;case 26:case 27:case 5:Ln(l);break;case 4:me();break;case 31:l.memoizedState!==null&&en(l);break;case 13:en(l);break;case 19:U(it);break;case 10:ii(l.type);break;case 22:case 23:en(l),bf(),r!==null&&U($r);break;case 24:ii(ot)}}function es(r,l){try{var c=l.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&r)===r){f=void 0;var y=c.create,C=c.inst;f=y(),C.destroy=f}c=c.next}while(c!==m)}}catch(M){Be(l,l.return,M)}}function Gi(r,l,c){try{var f=l.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var y=m.next;f=y;do{if((f.tag&r)===r){var C=f.inst,M=C.destroy;if(M!==void 0){C.destroy=void 0,m=l;var j=c,P=M;try{P()}catch(G){Be(m,j,G)}}}f=f.next}while(f!==y)}}catch(G){Be(l,l.return,G)}}function nx(r){var l=r.updateQueue;if(l!==null){var c=r.stateNode;try{Wy(l,c)}catch(f){Be(r,r.return,f)}}}function ix(r,l,c){c.props=Wr(r.type,r.memoizedProps),c.state=r.memoizedState;try{c.componentWillUnmount()}catch(f){Be(r,l,f)}}function ts(r,l){try{var c=r.ref;if(c!==null){switch(r.tag){case 26:case 27:case 5:var f=r.stateNode;break;case 30:f=r.stateNode;break;default:f=r.stateNode}typeof c=="function"?r.refCleanup=c(f):c.current=f}}catch(m){Be(r,l,m)}}function _n(r,l){var c=r.ref,f=r.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(m){Be(r,l,m)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(m){Be(r,l,m)}else c.current=null}function rx(r){var l=r.type,c=r.memoizedProps,f=r.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(m){Be(r,r.return,m)}}function Jf(r,l,c){try{var f=r.stateNode;KT(f,r.type,c,l),f[It]=l}catch(m){Be(r,r.return,m)}}function ox(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&tr(r.type)||r.tag===4}function Qf(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||ox(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&tr(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Zf(r,l,c){var f=r.tag;if(f===5||f===6)r=r.stateNode,l?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(r,l):(l=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,l.appendChild(r),c=c._reactRootContainer,c!=null||l.onclick!==null||(l.onclick=Qn));else if(f!==4&&(f===27&&tr(r.type)&&(c=r.stateNode,l=null),r=r.child,r!==null))for(Zf(r,l,c),r=r.sibling;r!==null;)Zf(r,l,c),r=r.sibling}function Za(r,l,c){var f=r.tag;if(f===5||f===6)r=r.stateNode,l?c.insertBefore(r,l):c.appendChild(r);else if(f!==4&&(f===27&&tr(r.type)&&(c=r.stateNode),r=r.child,r!==null))for(Za(r,l,c),r=r.sibling;r!==null;)Za(r,l,c),r=r.sibling}function lx(r){var l=r.stateNode,c=r.memoizedProps;try{for(var f=r.type,m=l.attributes;m.length;)l.removeAttributeNode(m[0]);wt(l,f,c),l[xt]=r,l[It]=c}catch(y){Be(r,r.return,y)}}var ai=!1,at=!1,eh=!1,sx=typeof WeakSet=="function"?WeakSet:Set,ht=null;function AT(r,l){if(r=r.containerInfo,Sh=vc,r=by(r),Wd(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var m=f.anchorOffset,y=f.focusNode;f=f.focusOffset;try{c.nodeType,y.nodeType}catch{c=null;break e}var C=0,M=-1,j=-1,P=0,G=0,J=r,V=null;t:for(;;){for(var F;J!==c||m!==0&&J.nodeType!==3||(M=C+m),J!==y||f!==0&&J.nodeType!==3||(j=C+f),J.nodeType===3&&(C+=J.nodeValue.length),(F=J.firstChild)!==null;)V=J,J=F;for(;;){if(J===r)break t;if(V===c&&++P===m&&(M=C),V===y&&++G===f&&(j=C),(F=J.nextSibling)!==null)break;J=V,V=J.parentNode}J=F}c=M===-1||j===-1?null:{start:M,end:j}}else c=null}c=c||{start:0,end:0}}else c=null;for(wh={focusedElem:r,selectionRange:c},vc=!1,ht=l;ht!==null;)if(l=ht,r=l.child,(l.subtreeFlags&1028)!==0&&r!==null)r.return=l,ht=r;else for(;ht!==null;){switch(l=ht,y=l.alternate,r=l.flags,l.tag){case 0:if((r&4)!==0&&(r=l.updateQueue,r=r!==null?r.events:null,r!==null))for(c=0;c<r.length;c++)m=r[c],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,c=l,m=y.memoizedProps,y=y.memoizedState,f=c.stateNode;try{var ue=Wr(c.type,m);r=f.getSnapshotBeforeUpdate(ue,y),f.__reactInternalSnapshotBeforeUpdate=r}catch(be){Be(c,c.return,be)}}break;case 3:if((r&1024)!==0){if(r=l.stateNode.containerInfo,c=r.nodeType,c===9)Eh(r);else if(c===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Eh(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=l.sibling,r!==null){r.return=l.return,ht=r;break}ht=l.return}}function ax(r,l,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:ui(r,c),f&4&&es(5,c);break;case 1:if(ui(r,c),f&4)if(r=c.stateNode,l===null)try{r.componentDidMount()}catch(C){Be(c,c.return,C)}else{var m=Wr(c.type,l.memoizedProps);l=l.memoizedState;try{r.componentDidUpdate(m,l,r.__reactInternalSnapshotBeforeUpdate)}catch(C){Be(c,c.return,C)}}f&64&&nx(c),f&512&&ts(c,c.return);break;case 3:if(ui(r,c),f&64&&(r=c.updateQueue,r!==null)){if(l=null,c.child!==null)switch(c.child.tag){case 27:case 5:l=c.child.stateNode;break;case 1:l=c.child.stateNode}try{Wy(r,l)}catch(C){Be(c,c.return,C)}}break;case 27:l===null&&f&4&&lx(c);case 26:case 5:ui(r,c),l===null&&f&4&&rx(c),f&512&&ts(c,c.return);break;case 12:ui(r,c);break;case 31:ui(r,c),f&4&&dx(r,c);break;case 13:ui(r,c),f&4&&fx(r,c),f&64&&(r=c.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(c=IT.bind(null,c),iM(r,c))));break;case 22:if(f=c.memoizedState!==null||ai,!f){l=l!==null&&l.memoizedState!==null||at,m=ai;var y=at;ai=f,(at=l)&&!y?di(r,c,(c.subtreeFlags&8772)!==0):ui(r,c),ai=m,at=y}break;case 30:break;default:ui(r,c)}}function cx(r){var l=r.alternate;l!==null&&(r.alternate=null,cx(l)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(l=r.stateNode,l!==null&&Od(l)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var We=null,Ht=!1;function ci(r,l,c){for(c=c.child;c!==null;)ux(r,l,c),c=c.sibling}function ux(r,l,c){if(Kt&&typeof Kt.onCommitFiberUnmount=="function")try{Kt.onCommitFiberUnmount(El,c)}catch{}switch(c.tag){case 26:at||_n(c,l),ci(r,l,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:at||_n(c,l);var f=We,m=Ht;tr(c.type)&&(We=c.stateNode,Ht=!1),ci(r,l,c),ds(c.stateNode),We=f,Ht=m;break;case 5:at||_n(c,l);case 6:if(f=We,m=Ht,We=null,ci(r,l,c),We=f,Ht=m,We!==null)if(Ht)try{(We.nodeType===9?We.body:We.nodeName==="HTML"?We.ownerDocument.body:We).removeChild(c.stateNode)}catch(y){Be(c,l,y)}else try{We.removeChild(c.stateNode)}catch(y){Be(c,l,y)}break;case 18:We!==null&&(Ht?(r=We,nb(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,c.stateNode),Zo(r)):nb(We,c.stateNode));break;case 4:f=We,m=Ht,We=c.stateNode.containerInfo,Ht=!0,ci(r,l,c),We=f,Ht=m;break;case 0:case 11:case 14:case 15:Gi(2,c,l),at||Gi(4,c,l),ci(r,l,c);break;case 1:at||(_n(c,l),f=c.stateNode,typeof f.componentWillUnmount=="function"&&ix(c,l,f)),ci(r,l,c);break;case 21:ci(r,l,c);break;case 22:at=(f=at)||c.memoizedState!==null,ci(r,l,c),at=f;break;default:ci(r,l,c)}}function dx(r,l){if(l.memoizedState===null&&(r=l.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Zo(r)}catch(c){Be(l,l.return,c)}}}function fx(r,l){if(l.memoizedState===null&&(r=l.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Zo(r)}catch(c){Be(l,l.return,c)}}function OT(r){switch(r.tag){case 31:case 13:case 19:var l=r.stateNode;return l===null&&(l=r.stateNode=new sx),l;case 22:return r=r.stateNode,l=r._retryCache,l===null&&(l=r._retryCache=new sx),l;default:throw Error(i(435,r.tag))}}function ec(r,l){var c=OT(r);l.forEach(function(f){if(!c.has(f)){c.add(f);var m=_T.bind(null,r,f);f.then(m,m)}})}function Ut(r,l){var c=l.deletions;if(c!==null)for(var f=0;f<c.length;f++){var m=c[f],y=r,C=l,M=C;e:for(;M!==null;){switch(M.tag){case 27:if(tr(M.type)){We=M.stateNode,Ht=!1;break e}break;case 5:We=M.stateNode,Ht=!1;break e;case 3:case 4:We=M.stateNode.containerInfo,Ht=!0;break e}M=M.return}if(We===null)throw Error(i(160));ux(y,C,m),We=null,Ht=!1,y=m.alternate,y!==null&&(y.return=null),m.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)hx(l,r),l=l.sibling}var An=null;function hx(r,l){var c=r.alternate,f=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Ut(l,r),$t(r),f&4&&(Gi(3,r,r.return),es(3,r),Gi(5,r,r.return));break;case 1:Ut(l,r),$t(r),f&512&&(at||c===null||_n(c,c.return)),f&64&&ai&&(r=r.updateQueue,r!==null&&(f=r.callbacks,f!==null&&(c=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var m=An;if(Ut(l,r),$t(r),f&512&&(at||c===null||_n(c,c.return)),f&4){var y=c!==null?c.memoizedState:null;if(f=r.memoizedState,c===null)if(f===null)if(r.stateNode===null){e:{f=r.type,c=r.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":y=m.getElementsByTagName("title")[0],(!y||y[Al]||y[xt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=m.createElement(f),m.head.insertBefore(y,m.querySelector("head > title"))),wt(y,f,c),y[xt]=r,ft(y),f=y;break e;case"link":var C=hb("link","href",m).get(f+(c.href||""));if(C){for(var M=0;M<C.length;M++)if(y=C[M],y.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&y.getAttribute("rel")===(c.rel==null?null:c.rel)&&y.getAttribute("title")===(c.title==null?null:c.title)&&y.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){C.splice(M,1);break t}}y=m.createElement(f),wt(y,f,c),m.head.appendChild(y);break;case"meta":if(C=hb("meta","content",m).get(f+(c.content||""))){for(M=0;M<C.length;M++)if(y=C[M],y.getAttribute("content")===(c.content==null?null:""+c.content)&&y.getAttribute("name")===(c.name==null?null:c.name)&&y.getAttribute("property")===(c.property==null?null:c.property)&&y.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&y.getAttribute("charset")===(c.charSet==null?null:c.charSet)){C.splice(M,1);break t}}y=m.createElement(f),wt(y,f,c),m.head.appendChild(y);break;default:throw Error(i(468,f))}y[xt]=r,ft(y),f=y}r.stateNode=f}else pb(m,r.type,r.stateNode);else r.stateNode=fb(m,f,r.memoizedProps);else y!==f?(y===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):y.count--,f===null?pb(m,r.type,r.stateNode):fb(m,f,r.memoizedProps)):f===null&&r.stateNode!==null&&Jf(r,r.memoizedProps,c.memoizedProps)}break;case 27:Ut(l,r),$t(r),f&512&&(at||c===null||_n(c,c.return)),c!==null&&f&4&&Jf(r,r.memoizedProps,c.memoizedProps);break;case 5:if(Ut(l,r),$t(r),f&512&&(at||c===null||_n(c,c.return)),r.flags&32){m=r.stateNode;try{wo(m,"")}catch(ue){Be(r,r.return,ue)}}f&4&&r.stateNode!=null&&(m=r.memoizedProps,Jf(r,m,c!==null?c.memoizedProps:m)),f&1024&&(eh=!0);break;case 6:if(Ut(l,r),$t(r),f&4){if(r.stateNode===null)throw Error(i(162));f=r.memoizedProps,c=r.stateNode;try{c.nodeValue=f}catch(ue){Be(r,r.return,ue)}}break;case 3:if(gc=null,m=An,An=pc(l.containerInfo),Ut(l,r),An=m,$t(r),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Zo(l.containerInfo)}catch(ue){Be(r,r.return,ue)}eh&&(eh=!1,px(r));break;case 4:f=An,An=pc(r.stateNode.containerInfo),Ut(l,r),$t(r),An=f;break;case 12:Ut(l,r),$t(r);break;case 31:Ut(l,r),$t(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,ec(r,f)));break;case 13:Ut(l,r),$t(r),r.child.flags&8192&&r.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(nc=Gt()),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,ec(r,f)));break;case 22:m=r.memoizedState!==null;var j=c!==null&&c.memoizedState!==null,P=ai,G=at;if(ai=P||m,at=G||j,Ut(l,r),at=G,ai=P,$t(r),f&8192)e:for(l=r.stateNode,l._visibility=m?l._visibility&-2:l._visibility|1,m&&(c===null||j||ai||at||Yr(r)),c=null,l=r;;){if(l.tag===5||l.tag===26){if(c===null){j=c=l;try{if(y=j.stateNode,m)C=y.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{M=j.stateNode;var J=j.memoizedProps.style,V=J!=null&&J.hasOwnProperty("display")?J.display:null;M.style.display=V==null||typeof V=="boolean"?"":(""+V).trim()}}catch(ue){Be(j,j.return,ue)}}}else if(l.tag===6){if(c===null){j=l;try{j.stateNode.nodeValue=m?"":j.memoizedProps}catch(ue){Be(j,j.return,ue)}}}else if(l.tag===18){if(c===null){j=l;try{var F=j.stateNode;m?ib(F,!0):ib(j.stateNode,!1)}catch(ue){Be(j,j.return,ue)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===r)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break e;for(;l.sibling===null;){if(l.return===null||l.return===r)break e;c===l&&(c=null),l=l.return}c===l&&(c=null),l.sibling.return=l.return,l=l.sibling}f&4&&(f=r.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,ec(r,c))));break;case 19:Ut(l,r),$t(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,ec(r,f)));break;case 30:break;case 21:break;default:Ut(l,r),$t(r)}}function $t(r){var l=r.flags;if(l&2){try{for(var c,f=r.return;f!==null;){if(ox(f)){c=f;break}f=f.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var m=c.stateNode,y=Qf(r);Za(r,y,m);break;case 5:var C=c.stateNode;c.flags&32&&(wo(C,""),c.flags&=-33);var M=Qf(r);Za(r,M,C);break;case 3:case 4:var j=c.stateNode.containerInfo,P=Qf(r);Zf(r,P,j);break;default:throw Error(i(161))}}catch(G){Be(r,r.return,G)}r.flags&=-3}l&4096&&(r.flags&=-4097)}function px(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var l=r;px(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),r=r.sibling}}function ui(r,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)ax(r,l.alternate,l),l=l.sibling}function Yr(r){for(r=r.child;r!==null;){var l=r;switch(l.tag){case 0:case 11:case 14:case 15:Gi(4,l,l.return),Yr(l);break;case 1:_n(l,l.return);var c=l.stateNode;typeof c.componentWillUnmount=="function"&&ix(l,l.return,c),Yr(l);break;case 27:ds(l.stateNode);case 26:case 5:_n(l,l.return),Yr(l);break;case 22:l.memoizedState===null&&Yr(l);break;case 30:Yr(l);break;default:Yr(l)}r=r.sibling}}function di(r,l,c){for(c=c&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var f=l.alternate,m=r,y=l,C=y.flags;switch(y.tag){case 0:case 11:case 15:di(m,y,c),es(4,y);break;case 1:if(di(m,y,c),f=y,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(P){Be(f,f.return,P)}if(f=y,m=f.updateQueue,m!==null){var M=f.stateNode;try{var j=m.shared.hiddenCallbacks;if(j!==null)for(m.shared.hiddenCallbacks=null,m=0;m<j.length;m++)Fy(j[m],M)}catch(P){Be(f,f.return,P)}}c&&C&64&&nx(y),ts(y,y.return);break;case 27:lx(y);case 26:case 5:di(m,y,c),c&&f===null&&C&4&&rx(y),ts(y,y.return);break;case 12:di(m,y,c);break;case 31:di(m,y,c),c&&C&4&&dx(m,y);break;case 13:di(m,y,c),c&&C&4&&fx(m,y);break;case 22:y.memoizedState===null&&di(m,y,c),ts(y,y.return);break;case 30:break;default:di(m,y,c)}l=l.sibling}}function th(r,l){var c=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),r=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(r=l.memoizedState.cachePool.pool),r!==c&&(r!=null&&r.refCount++,c!=null&&$l(c))}function nh(r,l){r=null,l.alternate!==null&&(r=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==r&&(l.refCount++,r!=null&&$l(r))}function On(r,l,c,f){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)mx(r,l,c,f),l=l.sibling}function mx(r,l,c,f){var m=l.flags;switch(l.tag){case 0:case 11:case 15:On(r,l,c,f),m&2048&&es(9,l);break;case 1:On(r,l,c,f);break;case 3:On(r,l,c,f),m&2048&&(r=null,l.alternate!==null&&(r=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==r&&(l.refCount++,r!=null&&$l(r)));break;case 12:if(m&2048){On(r,l,c,f),r=l.stateNode;try{var y=l.memoizedProps,C=y.id,M=y.onPostCommit;typeof M=="function"&&M(C,l.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(j){Be(l,l.return,j)}}else On(r,l,c,f);break;case 31:On(r,l,c,f);break;case 13:On(r,l,c,f);break;case 23:break;case 22:y=l.stateNode,C=l.alternate,l.memoizedState!==null?y._visibility&2?On(r,l,c,f):ns(r,l):y._visibility&2?On(r,l,c,f):(y._visibility|=2,Po(r,l,c,f,(l.subtreeFlags&10256)!==0||!1)),m&2048&&th(C,l);break;case 24:On(r,l,c,f),m&2048&&nh(l.alternate,l);break;default:On(r,l,c,f)}}function Po(r,l,c,f,m){for(m=m&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var y=r,C=l,M=c,j=f,P=C.flags;switch(C.tag){case 0:case 11:case 15:Po(y,C,M,j,m),es(8,C);break;case 23:break;case 22:var G=C.stateNode;C.memoizedState!==null?G._visibility&2?Po(y,C,M,j,m):ns(y,C):(G._visibility|=2,Po(y,C,M,j,m)),m&&P&2048&&th(C.alternate,C);break;case 24:Po(y,C,M,j,m),m&&P&2048&&nh(C.alternate,C);break;default:Po(y,C,M,j,m)}l=l.sibling}}function ns(r,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var c=r,f=l,m=f.flags;switch(f.tag){case 22:ns(c,f),m&2048&&th(f.alternate,f);break;case 24:ns(c,f),m&2048&&nh(f.alternate,f);break;default:ns(c,f)}l=l.sibling}}var is=8192;function Vo(r,l,c){if(r.subtreeFlags&is)for(r=r.child;r!==null;)gx(r,l,c),r=r.sibling}function gx(r,l,c){switch(r.tag){case 26:Vo(r,l,c),r.flags&is&&r.memoizedState!==null&&mM(c,An,r.memoizedState,r.memoizedProps);break;case 5:Vo(r,l,c);break;case 3:case 4:var f=An;An=pc(r.stateNode.containerInfo),Vo(r,l,c),An=f;break;case 22:r.memoizedState===null&&(f=r.alternate,f!==null&&f.memoizedState!==null?(f=is,is=16777216,Vo(r,l,c),is=f):Vo(r,l,c));break;default:Vo(r,l,c)}}function yx(r){var l=r.alternate;if(l!==null&&(r=l.child,r!==null)){l.child=null;do l=r.sibling,r.sibling=null,r=l;while(r!==null)}}function rs(r){var l=r.deletions;if((r.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var f=l[c];ht=f,bx(f,r)}yx(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)xx(r),r=r.sibling}function xx(r){switch(r.tag){case 0:case 11:case 15:rs(r),r.flags&2048&&Gi(9,r,r.return);break;case 3:rs(r);break;case 12:rs(r);break;case 22:var l=r.stateNode;r.memoizedState!==null&&l._visibility&2&&(r.return===null||r.return.tag!==13)?(l._visibility&=-3,tc(r)):rs(r);break;default:rs(r)}}function tc(r){var l=r.deletions;if((r.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var f=l[c];ht=f,bx(f,r)}yx(r)}for(r=r.child;r!==null;){switch(l=r,l.tag){case 0:case 11:case 15:Gi(8,l,l.return),tc(l);break;case 22:c=l.stateNode,c._visibility&2&&(c._visibility&=-3,tc(l));break;default:tc(l)}r=r.sibling}}function bx(r,l){for(;ht!==null;){var c=ht;switch(c.tag){case 0:case 11:case 15:Gi(8,c,l);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:$l(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,ht=f;else e:for(c=r;ht!==null;){f=ht;var m=f.sibling,y=f.return;if(cx(f),f===c){ht=null;break e}if(m!==null){m.return=y,ht=m;break e}ht=y}}}var RT={getCacheForType:function(r){var l=vt(ot),c=l.data.get(r);return c===void 0&&(c=r(),l.data.set(r,c)),c},cacheSignal:function(){return vt(ot).controller.signal}},DT=typeof WeakMap=="function"?WeakMap:Map,ze=0,$e=null,Me=null,Oe=0,Le=0,tn=null,Ki=!1,qo=!1,ih=!1,fi=0,Ze=0,Xi=0,Gr=0,rh=0,nn=0,Fo=0,ls=null,Pt=null,oh=!1,nc=0,vx=0,ic=1/0,rc=null,Ji=null,dt=0,Qi=null,Wo=null,hi=0,lh=0,sh=null,Sx=null,ss=0,ah=null;function rn(){return(ze&2)!==0&&Oe!==0?Oe&-Oe:q.T!==null?ph():Ig()}function wx(){if(nn===0)if((Oe&536870912)===0||De){var r=fa;fa<<=1,(fa&3932160)===0&&(fa=262144),nn=r}else nn=536870912;return r=Zt.current,r!==null&&(r.flags|=32),nn}function Vt(r,l,c){(r===$e&&(Le===2||Le===9)||r.cancelPendingCommit!==null)&&(Yo(r,0),Zi(r,Oe,nn,!1)),Ml(r,c),((ze&2)===0||r!==$e)&&(r===$e&&((ze&2)===0&&(Gr|=c),Ze===4&&Zi(r,Oe,nn,!1)),Hn(r))}function Cx(r,l,c){if((ze&6)!==0)throw Error(i(327));var f=!c&&(l&127)===0&&(l&r.expiredLanes)===0||Tl(r,l),m=f?zT(r,l):uh(r,l,!0),y=f;do{if(m===0){qo&&!f&&Zi(r,l,0,!1);break}else{if(c=r.current.alternate,y&&!NT(c)){m=uh(r,l,!1),y=!1;continue}if(m===2){if(y=l,r.errorRecoveryDisabledLanes&y)var C=0;else C=r.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){l=C;e:{var M=r;m=ls;var j=M.current.memoizedState.isDehydrated;if(j&&(Yo(M,C).flags|=256),C=uh(M,C,!1),C!==2){if(ih&&!j){M.errorRecoveryDisabledLanes|=y,Gr|=y,m=4;break e}y=Pt,Pt=m,y!==null&&(Pt===null?Pt=y:Pt.push.apply(Pt,y))}m=C}if(y=!1,m!==2)continue}}if(m===1){Yo(r,0),Zi(r,l,0,!0);break}e:{switch(f=r,y=m,y){case 0:case 1:throw Error(i(345));case 4:if((l&4194048)!==l)break;case 6:Zi(f,l,nn,!Ki);break e;case 2:Pt=null;break;case 3:case 5:break;default:throw Error(i(329))}if((l&62914560)===l&&(m=nc+300-Gt(),10<m)){if(Zi(f,l,nn,!Ki),pa(f,0,!0)!==0)break e;hi=l,f.timeoutHandle=eb(kx.bind(null,f,c,Pt,rc,oh,l,nn,Gr,Fo,Ki,y,"Throttled",-0,0),m);break e}kx(f,c,Pt,rc,oh,l,nn,Gr,Fo,Ki,y,null,-0,0)}}break}while(!0);Hn(r)}function kx(r,l,c,f,m,y,C,M,j,P,G,J,V,F){if(r.timeoutHandle=-1,J=l.subtreeFlags,J&8192||(J&16785408)===16785408){J={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Qn},gx(l,y,J);var ue=(y&62914560)===y?nc-Gt():(y&4194048)===y?vx-Gt():0;if(ue=gM(J,ue),ue!==null){hi=y,r.cancelPendingCommit=ue(Nx.bind(null,r,l,y,c,f,m,C,M,j,G,J,null,V,F)),Zi(r,y,C,!P);return}}Nx(r,l,y,c,f,m,C,M,j)}function NT(r){for(var l=r;;){var c=l.tag;if((c===0||c===11||c===15)&&l.flags&16384&&(c=l.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var m=c[f],y=m.getSnapshot;m=m.value;try{if(!Jt(y(),m))return!1}catch{return!1}}if(c=l.child,l.subtreeFlags&16384&&c!==null)c.return=l,l=c;else{if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Zi(r,l,c,f){l&=~rh,l&=~Gr,r.suspendedLanes|=l,r.pingedLanes&=~l,f&&(r.warmLanes|=l),f=r.expirationTimes;for(var m=l;0<m;){var y=31-Xt(m),C=1<<y;f[y]=-1,m&=~C}c!==0&&zg(r,c,l)}function oc(){return(ze&6)===0?(as(0),!1):!0}function ch(){if(Me!==null){if(Le===0)var r=Me.return;else r=Me,ni=Hr=null,Ef(r),Io=null,Vl=0,r=Me;for(;r!==null;)tx(r.alternate,r),r=r.return;Me=null}}function Yo(r,l){var c=r.timeoutHandle;c!==-1&&(r.timeoutHandle=-1,QT(c)),c=r.cancelPendingCommit,c!==null&&(r.cancelPendingCommit=null,c()),hi=0,ch(),$e=r,Me=c=ei(r.current,null),Oe=l,Le=0,tn=null,Ki=!1,qo=Tl(r,l),ih=!1,Fo=nn=rh=Gr=Xi=Ze=0,Pt=ls=null,oh=!1,(l&8)!==0&&(l|=l&32);var f=r.entangledLanes;if(f!==0)for(r=r.entanglements,f&=l;0<f;){var m=31-Xt(f),y=1<<m;l|=r[m],f&=~y}return fi=l,Ta(),c}function Ex(r,l){ke=null,q.H=Jl,l===Bo||l===za?(l=$y(),Le=3):l===hf?(l=$y(),Le=4):Le=l===$f?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,tn=l,Me===null&&(Ze=1,Ga(r,fn(l,r.current)))}function Tx(){var r=Zt.current;return r===null?!0:(Oe&4194048)===Oe?gn===null:(Oe&62914560)===Oe||(Oe&536870912)!==0?r===gn:!1}function Mx(){var r=q.H;return q.H=Jl,r===null?Jl:r}function Ax(){var r=q.A;return q.A=RT,r}function lc(){Ze=4,Ki||(Oe&4194048)!==Oe&&Zt.current!==null||(qo=!0),(Xi&134217727)===0&&(Gr&134217727)===0||$e===null||Zi($e,Oe,nn,!1)}function uh(r,l,c){var f=ze;ze|=2;var m=Mx(),y=Ax();($e!==r||Oe!==l)&&(rc=null,Yo(r,l)),l=!1;var C=Ze;e:do try{if(Le!==0&&Me!==null){var M=Me,j=tn;switch(Le){case 8:ch(),C=6;break e;case 3:case 2:case 9:case 6:Zt.current===null&&(l=!0);var P=Le;if(Le=0,tn=null,Go(r,M,j,P),c&&qo){C=0;break e}break;default:P=Le,Le=0,tn=null,Go(r,M,j,P)}}jT(),C=Ze;break}catch(G){Ex(r,G)}while(!0);return l&&r.shellSuspendCounter++,ni=Hr=null,ze=f,q.H=m,q.A=y,Me===null&&($e=null,Oe=0,Ta()),C}function jT(){for(;Me!==null;)Ox(Me)}function zT(r,l){var c=ze;ze|=2;var f=Mx(),m=Ax();$e!==r||Oe!==l?(rc=null,ic=Gt()+500,Yo(r,l)):qo=Tl(r,l);e:do try{if(Le!==0&&Me!==null){l=Me;var y=tn;t:switch(Le){case 1:Le=0,tn=null,Go(r,l,y,1);break;case 2:case 9:if(Hy(y)){Le=0,tn=null,Rx(l);break}l=function(){Le!==2&&Le!==9||$e!==r||(Le=7),Hn(r)},y.then(l,l);break e;case 3:Le=7;break e;case 4:Le=5;break e;case 7:Hy(y)?(Le=0,tn=null,Rx(l)):(Le=0,tn=null,Go(r,l,y,7));break;case 5:var C=null;switch(Me.tag){case 26:C=Me.memoizedState;case 5:case 27:var M=Me;if(C?mb(C):M.stateNode.complete){Le=0,tn=null;var j=M.sibling;if(j!==null)Me=j;else{var P=M.return;P!==null?(Me=P,sc(P)):Me=null}break t}}Le=0,tn=null,Go(r,l,y,5);break;case 6:Le=0,tn=null,Go(r,l,y,6);break;case 8:ch(),Ze=6;break e;default:throw Error(i(462))}}LT();break}catch(G){Ex(r,G)}while(!0);return ni=Hr=null,q.H=f,q.A=m,ze=c,Me!==null?0:($e=null,Oe=0,Ta(),Ze)}function LT(){for(;Me!==null&&!rE();)Ox(Me)}function Ox(r){var l=Z0(r.alternate,r,fi);r.memoizedProps=r.pendingProps,l===null?sc(r):Me=l}function Rx(r){var l=r,c=l.alternate;switch(l.tag){case 15:case 0:l=Y0(c,l,l.pendingProps,l.type,void 0,Oe);break;case 11:l=Y0(c,l,l.pendingProps,l.type.render,l.ref,Oe);break;case 5:Ef(l);default:tx(c,l),l=Me=Ay(l,fi),l=Z0(c,l,fi)}r.memoizedProps=r.pendingProps,l===null?sc(r):Me=l}function Go(r,l,c,f){ni=Hr=null,Ef(l),Io=null,Vl=0;var m=l.return;try{if(CT(r,m,l,c,Oe)){Ze=1,Ga(r,fn(c,r.current)),Me=null;return}}catch(y){if(m!==null)throw Me=m,y;Ze=1,Ga(r,fn(c,r.current)),Me=null;return}l.flags&32768?(De||f===1?r=!0:qo||(Oe&536870912)!==0?r=!1:(Ki=r=!0,(f===2||f===9||f===3||f===6)&&(f=Zt.current,f!==null&&f.tag===13&&(f.flags|=16384))),Dx(l,r)):sc(l)}function sc(r){var l=r;do{if((l.flags&32768)!==0){Dx(l,Ki);return}r=l.return;var c=TT(l.alternate,l,fi);if(c!==null){Me=c;return}if(l=l.sibling,l!==null){Me=l;return}Me=l=r}while(l!==null);Ze===0&&(Ze=5)}function Dx(r,l){do{var c=MT(r.alternate,r);if(c!==null){c.flags&=32767,Me=c;return}if(c=r.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!l&&(r=r.sibling,r!==null)){Me=r;return}Me=r=c}while(r!==null);Ze=6,Me=null}function Nx(r,l,c,f,m,y,C,M,j){r.cancelPendingCommit=null;do ac();while(dt!==0);if((ze&6)!==0)throw Error(i(327));if(l!==null){if(l===r.current)throw Error(i(177));if(y=l.lanes|l.childLanes,y|=Jd,pE(r,c,y,C,M,j),r===$e&&(Me=$e=null,Oe=0),Wo=l,Qi=r,hi=c,lh=y,sh=m,Sx=f,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,HT(ua,function(){return Ix(),null})):(r.callbackNode=null,r.callbackPriority=0),f=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||f){f=q.T,q.T=null,m=ee.p,ee.p=2,C=ze,ze|=4;try{AT(r,l,c)}finally{ze=C,ee.p=m,q.T=f}}dt=1,jx(),zx(),Lx()}}function jx(){if(dt===1){dt=0;var r=Qi,l=Wo,c=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||c){c=q.T,q.T=null;var f=ee.p;ee.p=2;var m=ze;ze|=4;try{hx(l,r);var y=wh,C=by(r.containerInfo),M=y.focusedElem,j=y.selectionRange;if(C!==M&&M&&M.ownerDocument&&xy(M.ownerDocument.documentElement,M)){if(j!==null&&Wd(M)){var P=j.start,G=j.end;if(G===void 0&&(G=P),"selectionStart"in M)M.selectionStart=P,M.selectionEnd=Math.min(G,M.value.length);else{var J=M.ownerDocument||document,V=J&&J.defaultView||window;if(V.getSelection){var F=V.getSelection(),ue=M.textContent.length,be=Math.min(j.start,ue),Ue=j.end===void 0?be:Math.min(j.end,ue);!F.extend&&be>Ue&&(C=Ue,Ue=be,be=C);var H=yy(M,be),I=yy(M,Ue);if(H&&I&&(F.rangeCount!==1||F.anchorNode!==H.node||F.anchorOffset!==H.offset||F.focusNode!==I.node||F.focusOffset!==I.offset)){var $=J.createRange();$.setStart(H.node,H.offset),F.removeAllRanges(),be>Ue?(F.addRange($),F.extend(I.node,I.offset)):($.setEnd(I.node,I.offset),F.addRange($))}}}}for(J=[],F=M;F=F.parentNode;)F.nodeType===1&&J.push({element:F,left:F.scrollLeft,top:F.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<J.length;M++){var X=J[M];X.element.scrollLeft=X.left,X.element.scrollTop=X.top}}vc=!!Sh,wh=Sh=null}finally{ze=m,ee.p=f,q.T=c}}r.current=l,dt=2}}function zx(){if(dt===2){dt=0;var r=Qi,l=Wo,c=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||c){c=q.T,q.T=null;var f=ee.p;ee.p=2;var m=ze;ze|=4;try{ax(r,l.alternate,l)}finally{ze=m,ee.p=f,q.T=c}}dt=3}}function Lx(){if(dt===4||dt===3){dt=0,oE();var r=Qi,l=Wo,c=hi,f=Sx;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?dt=5:(dt=0,Wo=Qi=null,Bx(r,r.pendingLanes));var m=r.pendingLanes;if(m===0&&(Ji=null),Md(c),l=l.stateNode,Kt&&typeof Kt.onCommitFiberRoot=="function")try{Kt.onCommitFiberRoot(El,l,void 0,(l.current.flags&128)===128)}catch{}if(f!==null){l=q.T,m=ee.p,ee.p=2,q.T=null;try{for(var y=r.onRecoverableError,C=0;C<f.length;C++){var M=f[C];y(M.value,{componentStack:M.stack})}}finally{q.T=l,ee.p=m}}(hi&3)!==0&&ac(),Hn(r),m=r.pendingLanes,(c&261930)!==0&&(m&42)!==0?r===ah?ss++:(ss=0,ah=r):ss=0,as(0)}}function Bx(r,l){(r.pooledCacheLanes&=l)===0&&(l=r.pooledCache,l!=null&&(r.pooledCache=null,$l(l)))}function ac(){return jx(),zx(),Lx(),Ix()}function Ix(){if(dt!==5)return!1;var r=Qi,l=lh;lh=0;var c=Md(hi),f=q.T,m=ee.p;try{ee.p=32>c?32:c,q.T=null,c=sh,sh=null;var y=Qi,C=hi;if(dt=0,Wo=Qi=null,hi=0,(ze&6)!==0)throw Error(i(331));var M=ze;if(ze|=4,xx(y.current),mx(y,y.current,C,c),ze=M,as(0,!1),Kt&&typeof Kt.onPostCommitFiberRoot=="function")try{Kt.onPostCommitFiberRoot(El,y)}catch{}return!0}finally{ee.p=m,q.T=f,Bx(r,l)}}function _x(r,l,c){l=fn(c,l),l=Uf(r.stateNode,l,2),r=Fi(r,l,2),r!==null&&(Ml(r,2),Hn(r))}function Be(r,l,c){if(r.tag===3)_x(r,r,c);else for(;l!==null;){if(l.tag===3){_x(l,r,c);break}else if(l.tag===1){var f=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Ji===null||!Ji.has(f))){r=fn(c,r),c=H0(2),f=Fi(l,c,2),f!==null&&(U0(c,f,l,r),Ml(f,2),Hn(f));break}}l=l.return}}function dh(r,l,c){var f=r.pingCache;if(f===null){f=r.pingCache=new DT;var m=new Set;f.set(l,m)}else m=f.get(l),m===void 0&&(m=new Set,f.set(l,m));m.has(c)||(ih=!0,m.add(c),r=BT.bind(null,r,l,c),l.then(r,r))}function BT(r,l,c){var f=r.pingCache;f!==null&&f.delete(l),r.pingedLanes|=r.suspendedLanes&c,r.warmLanes&=~c,$e===r&&(Oe&c)===c&&(Ze===4||Ze===3&&(Oe&62914560)===Oe&&300>Gt()-nc?(ze&2)===0&&Yo(r,0):rh|=c,Fo===Oe&&(Fo=0)),Hn(r)}function Hx(r,l){l===0&&(l=jg()),r=Br(r,l),r!==null&&(Ml(r,l),Hn(r))}function IT(r){var l=r.memoizedState,c=0;l!==null&&(c=l.retryLane),Hx(r,c)}function _T(r,l){var c=0;switch(r.tag){case 31:case 13:var f=r.stateNode,m=r.memoizedState;m!==null&&(c=m.retryLane);break;case 19:f=r.stateNode;break;case 22:f=r.stateNode._retryCache;break;default:throw Error(i(314))}f!==null&&f.delete(l),Hx(r,c)}function HT(r,l){return Cd(r,l)}var cc=null,Ko=null,fh=!1,uc=!1,hh=!1,er=0;function Hn(r){r!==Ko&&r.next===null&&(Ko===null?cc=Ko=r:Ko=Ko.next=r),uc=!0,fh||(fh=!0,$T())}function as(r,l){if(!hh&&uc){hh=!0;do for(var c=!1,f=cc;f!==null;){if(r!==0){var m=f.pendingLanes;if(m===0)var y=0;else{var C=f.suspendedLanes,M=f.pingedLanes;y=(1<<31-Xt(42|r)+1)-1,y&=m&~(C&~M),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(c=!0,Vx(f,y))}else y=Oe,y=pa(f,f===$e?y:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(y&3)===0||Tl(f,y)||(c=!0,Vx(f,y));f=f.next}while(c);hh=!1}}function UT(){Ux()}function Ux(){uc=fh=!1;var r=0;er!==0&&JT()&&(r=er);for(var l=Gt(),c=null,f=cc;f!==null;){var m=f.next,y=$x(f,l);y===0?(f.next=null,c===null?cc=m:c.next=m,m===null&&(Ko=c)):(c=f,(r!==0||(y&3)!==0)&&(uc=!0)),f=m}dt!==0&&dt!==5||as(r),er!==0&&(er=0)}function $x(r,l){for(var c=r.suspendedLanes,f=r.pingedLanes,m=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var C=31-Xt(y),M=1<<C,j=m[C];j===-1?((M&c)===0||(M&f)!==0)&&(m[C]=hE(M,l)):j<=l&&(r.expiredLanes|=M),y&=~M}if(l=$e,c=Oe,c=pa(r,r===l?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f=r.callbackNode,c===0||r===l&&(Le===2||Le===9)||r.cancelPendingCommit!==null)return f!==null&&f!==null&&kd(f),r.callbackNode=null,r.callbackPriority=0;if((c&3)===0||Tl(r,c)){if(l=c&-c,l===r.callbackPriority)return l;switch(f!==null&&kd(f),Md(c)){case 2:case 8:c=Dg;break;case 32:c=ua;break;case 268435456:c=Ng;break;default:c=ua}return f=Px.bind(null,r),c=Cd(c,f),r.callbackPriority=l,r.callbackNode=c,l}return f!==null&&f!==null&&kd(f),r.callbackPriority=2,r.callbackNode=null,2}function Px(r,l){if(dt!==0&&dt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var c=r.callbackNode;if(ac()&&r.callbackNode!==c)return null;var f=Oe;return f=pa(r,r===$e?f:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f===0?null:(Cx(r,f,l),$x(r,Gt()),r.callbackNode!=null&&r.callbackNode===c?Px.bind(null,r):null)}function Vx(r,l){if(ac())return null;Cx(r,l,!0)}function $T(){ZT(function(){(ze&6)!==0?Cd(Rg,UT):Ux()})}function ph(){if(er===0){var r=zo;r===0&&(r=da,da<<=1,(da&261888)===0&&(da=256)),er=r}return er}function qx(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:xa(""+r)}function Fx(r,l){var c=l.ownerDocument.createElement("input");return c.name=l.name,c.value=l.value,r.id&&c.setAttribute("form",r.id),l.parentNode.insertBefore(c,l),r=new FormData(r),c.parentNode.removeChild(c),r}function PT(r,l,c,f,m){if(l==="submit"&&c&&c.stateNode===m){var y=qx((m[It]||null).action),C=f.submitter;C&&(l=(l=C[It]||null)?qx(l.formAction):C.getAttribute("formAction"),l!==null&&(y=l,C=null));var M=new wa("action","action",null,f,m);r.push({event:M,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(er!==0){var j=C?Fx(m,C):new FormData(m);zf(c,{pending:!0,data:j,method:m.method,action:y},null,j)}}else typeof y=="function"&&(M.preventDefault(),j=C?Fx(m,C):new FormData(m),zf(c,{pending:!0,data:j,method:m.method,action:y},y,j))},currentTarget:m}]})}}for(var mh=0;mh<Xd.length;mh++){var gh=Xd[mh],VT=gh.toLowerCase(),qT=gh[0].toUpperCase()+gh.slice(1);Mn(VT,"on"+qT)}Mn(wy,"onAnimationEnd"),Mn(Cy,"onAnimationIteration"),Mn(ky,"onAnimationStart"),Mn("dblclick","onDoubleClick"),Mn("focusin","onFocus"),Mn("focusout","onBlur"),Mn(lT,"onTransitionRun"),Mn(sT,"onTransitionStart"),Mn(aT,"onTransitionCancel"),Mn(Ey,"onTransitionEnd"),vo("onMouseEnter",["mouseout","mouseover"]),vo("onMouseLeave",["mouseout","mouseover"]),vo("onPointerEnter",["pointerout","pointerover"]),vo("onPointerLeave",["pointerout","pointerover"]),Nr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Nr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Nr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Nr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Nr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Nr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),FT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(cs));function Wx(r,l){l=(l&4)!==0;for(var c=0;c<r.length;c++){var f=r[c],m=f.event;f=f.listeners;e:{var y=void 0;if(l)for(var C=f.length-1;0<=C;C--){var M=f[C],j=M.instance,P=M.currentTarget;if(M=M.listener,j!==y&&m.isPropagationStopped())break e;y=M,m.currentTarget=P;try{y(m)}catch(G){Ea(G)}m.currentTarget=null,y=j}else for(C=0;C<f.length;C++){if(M=f[C],j=M.instance,P=M.currentTarget,M=M.listener,j!==y&&m.isPropagationStopped())break e;y=M,m.currentTarget=P;try{y(m)}catch(G){Ea(G)}m.currentTarget=null,y=j}}}}function Ae(r,l){var c=l[Ad];c===void 0&&(c=l[Ad]=new Set);var f=r+"__bubble";c.has(f)||(Yx(l,r,2,!1),c.add(f))}function yh(r,l,c){var f=0;l&&(f|=4),Yx(c,r,f,l)}var dc="_reactListening"+Math.random().toString(36).slice(2);function xh(r){if(!r[dc]){r[dc]=!0,Ug.forEach(function(c){c!=="selectionchange"&&(FT.has(c)||yh(c,!1,r),yh(c,!0,r))});var l=r.nodeType===9?r:r.ownerDocument;l===null||l[dc]||(l[dc]=!0,yh("selectionchange",!1,l))}}function Yx(r,l,c,f){switch(wb(l)){case 2:var m=bM;break;case 8:m=vM;break;default:m=jh}c=m.bind(null,l,c,r),m=void 0,!Id||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(m=!0),f?m!==void 0?r.addEventListener(l,c,{capture:!0,passive:m}):r.addEventListener(l,c,!0):m!==void 0?r.addEventListener(l,c,{passive:m}):r.addEventListener(l,c,!1)}function bh(r,l,c,f,m){var y=f;if((l&1)===0&&(l&2)===0&&f!==null)e:for(;;){if(f===null)return;var C=f.tag;if(C===3||C===4){var M=f.stateNode.containerInfo;if(M===m)break;if(C===4)for(C=f.return;C!==null;){var j=C.tag;if((j===3||j===4)&&C.stateNode.containerInfo===m)return;C=C.return}for(;M!==null;){if(C=yo(M),C===null)return;if(j=C.tag,j===5||j===6||j===26||j===27){f=y=C;continue e}M=M.parentNode}}f=f.return}Qg(function(){var P=y,G=Ld(c),J=[];e:{var V=Ty.get(r);if(V!==void 0){var F=wa,ue=r;switch(r){case"keypress":if(va(c)===0)break e;case"keydown":case"keyup":F=_E;break;case"focusin":ue="focus",F=$d;break;case"focusout":ue="blur",F=$d;break;case"beforeblur":case"afterblur":F=$d;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":F=ty;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":F=TE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":F=$E;break;case wy:case Cy:case ky:F=OE;break;case Ey:F=VE;break;case"scroll":case"scrollend":F=kE;break;case"wheel":F=FE;break;case"copy":case"cut":case"paste":F=DE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":F=iy;break;case"toggle":case"beforetoggle":F=YE}var be=(l&4)!==0,Ue=!be&&(r==="scroll"||r==="scrollend"),H=be?V!==null?V+"Capture":null:V;be=[];for(var I=P,$;I!==null;){var X=I;if($=X.stateNode,X=X.tag,X!==5&&X!==26&&X!==27||$===null||H===null||(X=Rl(I,H),X!=null&&be.push(us(I,X,$))),Ue)break;I=I.return}0<be.length&&(V=new F(V,ue,null,c,G),J.push({event:V,listeners:be}))}}if((l&7)===0){e:{if(V=r==="mouseover"||r==="pointerover",F=r==="mouseout"||r==="pointerout",V&&c!==zd&&(ue=c.relatedTarget||c.fromElement)&&(yo(ue)||ue[go]))break e;if((F||V)&&(V=G.window===G?G:(V=G.ownerDocument)?V.defaultView||V.parentWindow:window,F?(ue=c.relatedTarget||c.toElement,F=P,ue=ue?yo(ue):null,ue!==null&&(Ue=s(ue),be=ue.tag,ue!==Ue||be!==5&&be!==27&&be!==6)&&(ue=null)):(F=null,ue=P),F!==ue)){if(be=ty,X="onMouseLeave",H="onMouseEnter",I="mouse",(r==="pointerout"||r==="pointerover")&&(be=iy,X="onPointerLeave",H="onPointerEnter",I="pointer"),Ue=F==null?V:Ol(F),$=ue==null?V:Ol(ue),V=new be(X,I+"leave",F,c,G),V.target=Ue,V.relatedTarget=$,X=null,yo(G)===P&&(be=new be(H,I+"enter",ue,c,G),be.target=$,be.relatedTarget=Ue,X=be),Ue=X,F&&ue)t:{for(be=WT,H=F,I=ue,$=0,X=H;X;X=be(X))$++;X=0;for(var ge=I;ge;ge=be(ge))X++;for(;0<$-X;)H=be(H),$--;for(;0<X-$;)I=be(I),X--;for(;$--;){if(H===I||I!==null&&H===I.alternate){be=H;break t}H=be(H),I=be(I)}be=null}else be=null;F!==null&&Gx(J,V,F,be,!1),ue!==null&&Ue!==null&&Gx(J,Ue,ue,be,!0)}}e:{if(V=P?Ol(P):window,F=V.nodeName&&V.nodeName.toLowerCase(),F==="select"||F==="input"&&V.type==="file")var Ne=dy;else if(cy(V))if(fy)Ne=iT;else{Ne=tT;var de=eT}else F=V.nodeName,!F||F.toLowerCase()!=="input"||V.type!=="checkbox"&&V.type!=="radio"?P&&jd(P.elementType)&&(Ne=dy):Ne=nT;if(Ne&&(Ne=Ne(r,P))){uy(J,Ne,c,G);break e}de&&de(r,V,P),r==="focusout"&&P&&V.type==="number"&&P.memoizedProps.value!=null&&Nd(V,"number",V.value)}switch(de=P?Ol(P):window,r){case"focusin":(cy(de)||de.contentEditable==="true")&&(To=de,Yd=P,_l=null);break;case"focusout":_l=Yd=To=null;break;case"mousedown":Gd=!0;break;case"contextmenu":case"mouseup":case"dragend":Gd=!1,vy(J,c,G);break;case"selectionchange":if(oT)break;case"keydown":case"keyup":vy(J,c,G)}var Ee;if(Vd)e:{switch(r){case"compositionstart":var Re="onCompositionStart";break e;case"compositionend":Re="onCompositionEnd";break e;case"compositionupdate":Re="onCompositionUpdate";break e}Re=void 0}else Eo?sy(r,c)&&(Re="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(Re="onCompositionStart");Re&&(ry&&c.locale!=="ko"&&(Eo||Re!=="onCompositionStart"?Re==="onCompositionEnd"&&Eo&&(Ee=Zg()):(_i=G,_d="value"in _i?_i.value:_i.textContent,Eo=!0)),de=fc(P,Re),0<de.length&&(Re=new ny(Re,r,null,c,G),J.push({event:Re,listeners:de}),Ee?Re.data=Ee:(Ee=ay(c),Ee!==null&&(Re.data=Ee)))),(Ee=KE?XE(r,c):JE(r,c))&&(Re=fc(P,"onBeforeInput"),0<Re.length&&(de=new ny("onBeforeInput","beforeinput",null,c,G),J.push({event:de,listeners:Re}),de.data=Ee)),PT(J,r,P,c,G)}Wx(J,l)})}function us(r,l,c){return{instance:r,listener:l,currentTarget:c}}function fc(r,l){for(var c=l+"Capture",f=[];r!==null;){var m=r,y=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||y===null||(m=Rl(r,c),m!=null&&f.unshift(us(r,m,y)),m=Rl(r,l),m!=null&&f.push(us(r,m,y))),r.tag===3)return f;r=r.return}return[]}function WT(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Gx(r,l,c,f,m){for(var y=l._reactName,C=[];c!==null&&c!==f;){var M=c,j=M.alternate,P=M.stateNode;if(M=M.tag,j!==null&&j===f)break;M!==5&&M!==26&&M!==27||P===null||(j=P,m?(P=Rl(c,y),P!=null&&C.unshift(us(c,P,j))):m||(P=Rl(c,y),P!=null&&C.push(us(c,P,j)))),c=c.return}C.length!==0&&r.push({event:l,listeners:C})}var YT=/\r\n?/g,GT=/\u0000|\uFFFD/g;function Kx(r){return(typeof r=="string"?r:""+r).replace(YT,`
`).replace(GT,"")}function Xx(r,l){return l=Kx(l),Kx(r)===l}function He(r,l,c,f,m,y){switch(c){case"children":typeof f=="string"?l==="body"||l==="textarea"&&f===""||wo(r,f):(typeof f=="number"||typeof f=="bigint")&&l!=="body"&&wo(r,""+f);break;case"className":ga(r,"class",f);break;case"tabIndex":ga(r,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":ga(r,c,f);break;case"style":Xg(r,f,y);break;case"data":if(l!=="object"){ga(r,"data",f);break}case"src":case"href":if(f===""&&(l!=="a"||c!=="href")){r.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(c);break}f=xa(""+f),r.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){r.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(c==="formAction"?(l!=="input"&&He(r,l,"name",m.name,m,null),He(r,l,"formEncType",m.formEncType,m,null),He(r,l,"formMethod",m.formMethod,m,null),He(r,l,"formTarget",m.formTarget,m,null)):(He(r,l,"encType",m.encType,m,null),He(r,l,"method",m.method,m,null),He(r,l,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(c);break}f=xa(""+f),r.setAttribute(c,f);break;case"onClick":f!=null&&(r.onclick=Qn);break;case"onScroll":f!=null&&Ae("scroll",r);break;case"onScrollEnd":f!=null&&Ae("scrollend",r);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(i(60));r.innerHTML=c}}break;case"multiple":r.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":r.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){r.removeAttribute("xlink:href");break}c=xa(""+f),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(c,""+f):r.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(c,""):r.removeAttribute(c);break;case"capture":case"download":f===!0?r.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(c,f):r.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?r.setAttribute(c,f):r.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?r.removeAttribute(c):r.setAttribute(c,f);break;case"popover":Ae("beforetoggle",r),Ae("toggle",r),ma(r,"popover",f);break;case"xlinkActuate":Jn(r,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Jn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Jn(r,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Jn(r,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Jn(r,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Jn(r,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Jn(r,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Jn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Jn(r,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":ma(r,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=wE.get(c)||c,ma(r,c,f))}}function vh(r,l,c,f,m,y){switch(c){case"style":Xg(r,f,y);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(i(60));r.innerHTML=c}}break;case"children":typeof f=="string"?wo(r,f):(typeof f=="number"||typeof f=="bigint")&&wo(r,""+f);break;case"onScroll":f!=null&&Ae("scroll",r);break;case"onScrollEnd":f!=null&&Ae("scrollend",r);break;case"onClick":f!=null&&(r.onclick=Qn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$g.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(m=c.endsWith("Capture"),l=c.slice(2,m?c.length-7:void 0),y=r[It]||null,y=y!=null?y[c]:null,typeof y=="function"&&r.removeEventListener(l,y,m),typeof f=="function")){typeof y!="function"&&y!==null&&(c in r?r[c]=null:r.hasAttribute(c)&&r.removeAttribute(c)),r.addEventListener(l,f,m);break e}c in r?r[c]=f:f===!0?r.setAttribute(c,""):ma(r,c,f)}}}function wt(r,l,c){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ae("error",r),Ae("load",r);var f=!1,m=!1,y;for(y in c)if(c.hasOwnProperty(y)){var C=c[y];if(C!=null)switch(y){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,l));default:He(r,l,y,C,c,null)}}m&&He(r,l,"srcSet",c.srcSet,c,null),f&&He(r,l,"src",c.src,c,null);return;case"input":Ae("invalid",r);var M=y=C=m=null,j=null,P=null;for(f in c)if(c.hasOwnProperty(f)){var G=c[f];if(G!=null)switch(f){case"name":m=G;break;case"type":C=G;break;case"checked":j=G;break;case"defaultChecked":P=G;break;case"value":y=G;break;case"defaultValue":M=G;break;case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(i(137,l));break;default:He(r,l,f,G,c,null)}}Wg(r,y,M,j,P,C,m,!1);return;case"select":Ae("invalid",r),f=C=y=null;for(m in c)if(c.hasOwnProperty(m)&&(M=c[m],M!=null))switch(m){case"value":y=M;break;case"defaultValue":C=M;break;case"multiple":f=M;default:He(r,l,m,M,c,null)}l=y,c=C,r.multiple=!!f,l!=null?So(r,!!f,l,!1):c!=null&&So(r,!!f,c,!0);return;case"textarea":Ae("invalid",r),y=m=f=null;for(C in c)if(c.hasOwnProperty(C)&&(M=c[C],M!=null))switch(C){case"value":f=M;break;case"defaultValue":m=M;break;case"children":y=M;break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(i(91));break;default:He(r,l,C,M,c,null)}Gg(r,f,m,y);return;case"option":for(j in c)c.hasOwnProperty(j)&&(f=c[j],f!=null)&&(j==="selected"?r.selected=f&&typeof f!="function"&&typeof f!="symbol":He(r,l,j,f,c,null));return;case"dialog":Ae("beforetoggle",r),Ae("toggle",r),Ae("cancel",r),Ae("close",r);break;case"iframe":case"object":Ae("load",r);break;case"video":case"audio":for(f=0;f<cs.length;f++)Ae(cs[f],r);break;case"image":Ae("error",r),Ae("load",r);break;case"details":Ae("toggle",r);break;case"embed":case"source":case"link":Ae("error",r),Ae("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(P in c)if(c.hasOwnProperty(P)&&(f=c[P],f!=null))switch(P){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,l));default:He(r,l,P,f,c,null)}return;default:if(jd(l)){for(G in c)c.hasOwnProperty(G)&&(f=c[G],f!==void 0&&vh(r,l,G,f,c,void 0));return}}for(M in c)c.hasOwnProperty(M)&&(f=c[M],f!=null&&He(r,l,M,f,c,null))}function KT(r,l,c,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,y=null,C=null,M=null,j=null,P=null,G=null;for(F in c){var J=c[F];if(c.hasOwnProperty(F)&&J!=null)switch(F){case"checked":break;case"value":break;case"defaultValue":j=J;default:f.hasOwnProperty(F)||He(r,l,F,null,f,J)}}for(var V in f){var F=f[V];if(J=c[V],f.hasOwnProperty(V)&&(F!=null||J!=null))switch(V){case"type":y=F;break;case"name":m=F;break;case"checked":P=F;break;case"defaultChecked":G=F;break;case"value":C=F;break;case"defaultValue":M=F;break;case"children":case"dangerouslySetInnerHTML":if(F!=null)throw Error(i(137,l));break;default:F!==J&&He(r,l,V,F,f,J)}}Dd(r,C,M,j,P,G,y,m);return;case"select":F=C=M=V=null;for(y in c)if(j=c[y],c.hasOwnProperty(y)&&j!=null)switch(y){case"value":break;case"multiple":F=j;default:f.hasOwnProperty(y)||He(r,l,y,null,f,j)}for(m in f)if(y=f[m],j=c[m],f.hasOwnProperty(m)&&(y!=null||j!=null))switch(m){case"value":V=y;break;case"defaultValue":M=y;break;case"multiple":C=y;default:y!==j&&He(r,l,m,y,f,j)}l=M,c=C,f=F,V!=null?So(r,!!c,V,!1):!!f!=!!c&&(l!=null?So(r,!!c,l,!0):So(r,!!c,c?[]:"",!1));return;case"textarea":F=V=null;for(M in c)if(m=c[M],c.hasOwnProperty(M)&&m!=null&&!f.hasOwnProperty(M))switch(M){case"value":break;case"children":break;default:He(r,l,M,null,f,m)}for(C in f)if(m=f[C],y=c[C],f.hasOwnProperty(C)&&(m!=null||y!=null))switch(C){case"value":V=m;break;case"defaultValue":F=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==y&&He(r,l,C,m,f,y)}Yg(r,V,F);return;case"option":for(var ue in c)V=c[ue],c.hasOwnProperty(ue)&&V!=null&&!f.hasOwnProperty(ue)&&(ue==="selected"?r.selected=!1:He(r,l,ue,null,f,V));for(j in f)V=f[j],F=c[j],f.hasOwnProperty(j)&&V!==F&&(V!=null||F!=null)&&(j==="selected"?r.selected=V&&typeof V!="function"&&typeof V!="symbol":He(r,l,j,V,f,F));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var be in c)V=c[be],c.hasOwnProperty(be)&&V!=null&&!f.hasOwnProperty(be)&&He(r,l,be,null,f,V);for(P in f)if(V=f[P],F=c[P],f.hasOwnProperty(P)&&V!==F&&(V!=null||F!=null))switch(P){case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(i(137,l));break;default:He(r,l,P,V,f,F)}return;default:if(jd(l)){for(var Ue in c)V=c[Ue],c.hasOwnProperty(Ue)&&V!==void 0&&!f.hasOwnProperty(Ue)&&vh(r,l,Ue,void 0,f,V);for(G in f)V=f[G],F=c[G],!f.hasOwnProperty(G)||V===F||V===void 0&&F===void 0||vh(r,l,G,V,f,F);return}}for(var H in c)V=c[H],c.hasOwnProperty(H)&&V!=null&&!f.hasOwnProperty(H)&&He(r,l,H,null,f,V);for(J in f)V=f[J],F=c[J],!f.hasOwnProperty(J)||V===F||V==null&&F==null||He(r,l,J,V,f,F)}function Jx(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function XT(){if(typeof performance.getEntriesByType=="function"){for(var r=0,l=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var m=c[f],y=m.transferSize,C=m.initiatorType,M=m.duration;if(y&&M&&Jx(C)){for(C=0,M=m.responseEnd,f+=1;f<c.length;f++){var j=c[f],P=j.startTime;if(P>M)break;var G=j.transferSize,J=j.initiatorType;G&&Jx(J)&&(j=j.responseEnd,C+=G*(j<M?1:(M-P)/(j-P)))}if(--f,l+=8*(y+C)/(m.duration/1e3),r++,10<r)break}}if(0<r)return l/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Sh=null,wh=null;function hc(r){return r.nodeType===9?r:r.ownerDocument}function Qx(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Zx(r,l){if(r===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&l==="foreignObject"?0:r}function Ch(r,l){return r==="textarea"||r==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var kh=null;function JT(){var r=window.event;return r&&r.type==="popstate"?r===kh?!1:(kh=r,!0):(kh=null,!1)}var eb=typeof setTimeout=="function"?setTimeout:void 0,QT=typeof clearTimeout=="function"?clearTimeout:void 0,tb=typeof Promise=="function"?Promise:void 0,ZT=typeof queueMicrotask=="function"?queueMicrotask:typeof tb<"u"?function(r){return tb.resolve(null).then(r).catch(eM)}:eb;function eM(r){setTimeout(function(){throw r})}function tr(r){return r==="head"}function nb(r,l){var c=l,f=0;do{var m=c.nextSibling;if(r.removeChild(c),m&&m.nodeType===8)if(c=m.data,c==="/$"||c==="/&"){if(f===0){r.removeChild(m),Zo(l);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")ds(r.ownerDocument.documentElement);else if(c==="head"){c=r.ownerDocument.head,ds(c);for(var y=c.firstChild;y;){var C=y.nextSibling,M=y.nodeName;y[Al]||M==="SCRIPT"||M==="STYLE"||M==="LINK"&&y.rel.toLowerCase()==="stylesheet"||c.removeChild(y),y=C}}else c==="body"&&ds(r.ownerDocument.body);c=m}while(c);Zo(l)}function ib(r,l){var c=r;r=0;do{var f=c.nextSibling;if(c.nodeType===1?l?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(l?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(r===0)break;r--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||r++;c=f}while(c)}function Eh(r){var l=r.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var c=l;switch(l=l.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Eh(c),Od(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}r.removeChild(c)}}function tM(r,l,c,f){for(;r.nodeType===1;){var m=c;if(r.nodeName.toLowerCase()!==l.toLowerCase()){if(!f&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(f){if(!r[Al])switch(l){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==m.rel||r.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||r.getAttribute("title")!==(m.title==null?null:m.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(m.src==null?null:m.src)||r.getAttribute("type")!==(m.type==null?null:m.type)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(l==="input"&&r.type==="hidden"){var y=m.name==null?null:""+m.name;if(m.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=yn(r.nextSibling),r===null)break}return null}function nM(r,l,c){if(l==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!c||(r=yn(r.nextSibling),r===null))return null;return r}function rb(r,l){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=yn(r.nextSibling),r===null))return null;return r}function Th(r){return r.data==="$?"||r.data==="$~"}function Mh(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function iM(r,l){var c=r.ownerDocument;if(r.data==="$~")r._reactRetry=l;else if(r.data!=="$?"||c.readyState!=="loading")l();else{var f=function(){l(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),r._reactRetry=f}}function yn(r){for(;r!=null;r=r.nextSibling){var l=r.nodeType;if(l===1||l===3)break;if(l===8){if(l=r.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return r}var Ah=null;function ob(r){r=r.nextSibling;for(var l=0;r;){if(r.nodeType===8){var c=r.data;if(c==="/$"||c==="/&"){if(l===0)return yn(r.nextSibling);l--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||l++}r=r.nextSibling}return null}function lb(r){r=r.previousSibling;for(var l=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(l===0)return r;l--}else c!=="/$"&&c!=="/&"||l++}r=r.previousSibling}return null}function sb(r,l,c){switch(l=hc(c),r){case"html":if(r=l.documentElement,!r)throw Error(i(452));return r;case"head":if(r=l.head,!r)throw Error(i(453));return r;case"body":if(r=l.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function ds(r){for(var l=r.attributes;l.length;)r.removeAttributeNode(l[0]);Od(r)}var xn=new Map,ab=new Set;function pc(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var pi=ee.d;ee.d={f:rM,r:oM,D:lM,C:sM,L:aM,m:cM,X:dM,S:uM,M:fM};function rM(){var r=pi.f(),l=oc();return r||l}function oM(r){var l=xo(r);l!==null&&l.tag===5&&l.type==="form"?E0(l):pi.r(r)}var Xo=typeof document>"u"?null:document;function cb(r,l,c){var f=Xo;if(f&&typeof l=="string"&&l){var m=un(l);m='link[rel="'+r+'"][href="'+m+'"]',typeof c=="string"&&(m+='[crossorigin="'+c+'"]'),ab.has(m)||(ab.add(m),r={rel:r,crossOrigin:c,href:l},f.querySelector(m)===null&&(l=f.createElement("link"),wt(l,"link",r),ft(l),f.head.appendChild(l)))}}function lM(r){pi.D(r),cb("dns-prefetch",r,null)}function sM(r,l){pi.C(r,l),cb("preconnect",r,l)}function aM(r,l,c){pi.L(r,l,c);var f=Xo;if(f&&r&&l){var m='link[rel="preload"][as="'+un(l)+'"]';l==="image"&&c&&c.imageSrcSet?(m+='[imagesrcset="'+un(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(m+='[imagesizes="'+un(c.imageSizes)+'"]')):m+='[href="'+un(r)+'"]';var y=m;switch(l){case"style":y=Jo(r);break;case"script":y=Qo(r)}xn.has(y)||(r=g({rel:"preload",href:l==="image"&&c&&c.imageSrcSet?void 0:r,as:l},c),xn.set(y,r),f.querySelector(m)!==null||l==="style"&&f.querySelector(fs(y))||l==="script"&&f.querySelector(hs(y))||(l=f.createElement("link"),wt(l,"link",r),ft(l),f.head.appendChild(l)))}}function cM(r,l){pi.m(r,l);var c=Xo;if(c&&r){var f=l&&typeof l.as=="string"?l.as:"script",m='link[rel="modulepreload"][as="'+un(f)+'"][href="'+un(r)+'"]',y=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Qo(r)}if(!xn.has(y)&&(r=g({rel:"modulepreload",href:r},l),xn.set(y,r),c.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(hs(y)))return}f=c.createElement("link"),wt(f,"link",r),ft(f),c.head.appendChild(f)}}}function uM(r,l,c){pi.S(r,l,c);var f=Xo;if(f&&r){var m=bo(f).hoistableStyles,y=Jo(r);l=l||"default";var C=m.get(y);if(!C){var M={loading:0,preload:null};if(C=f.querySelector(fs(y)))M.loading=5;else{r=g({rel:"stylesheet",href:r,"data-precedence":l},c),(c=xn.get(y))&&Oh(r,c);var j=C=f.createElement("link");ft(j),wt(j,"link",r),j._p=new Promise(function(P,G){j.onload=P,j.onerror=G}),j.addEventListener("load",function(){M.loading|=1}),j.addEventListener("error",function(){M.loading|=2}),M.loading|=4,mc(C,l,f)}C={type:"stylesheet",instance:C,count:1,state:M},m.set(y,C)}}}function dM(r,l){pi.X(r,l);var c=Xo;if(c&&r){var f=bo(c).hoistableScripts,m=Qo(r),y=f.get(m);y||(y=c.querySelector(hs(m)),y||(r=g({src:r,async:!0},l),(l=xn.get(m))&&Rh(r,l),y=c.createElement("script"),ft(y),wt(y,"link",r),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(m,y))}}function fM(r,l){pi.M(r,l);var c=Xo;if(c&&r){var f=bo(c).hoistableScripts,m=Qo(r),y=f.get(m);y||(y=c.querySelector(hs(m)),y||(r=g({src:r,async:!0,type:"module"},l),(l=xn.get(m))&&Rh(r,l),y=c.createElement("script"),ft(y),wt(y,"link",r),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(m,y))}}function ub(r,l,c,f){var m=(m=Y.current)?pc(m):null;if(!m)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(l=Jo(c.href),c=bo(m).hoistableStyles,f=c.get(l),f||(f={type:"style",instance:null,count:0,state:null},c.set(l,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){r=Jo(c.href);var y=bo(m).hoistableStyles,C=y.get(r);if(C||(m=m.ownerDocument||m,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,C),(y=m.querySelector(fs(r)))&&!y._p&&(C.instance=y,C.state.loading=5),xn.has(r)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},xn.set(r,c),y||hM(m,r,c,C.state))),l&&f===null)throw Error(i(528,""));return C}if(l&&f!==null)throw Error(i(529,""));return null;case"script":return l=c.async,c=c.src,typeof c=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Qo(c),c=bo(m).hoistableScripts,f=c.get(l),f||(f={type:"script",instance:null,count:0,state:null},c.set(l,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Jo(r){return'href="'+un(r)+'"'}function fs(r){return'link[rel="stylesheet"]['+r+"]"}function db(r){return g({},r,{"data-precedence":r.precedence,precedence:null})}function hM(r,l,c,f){r.querySelector('link[rel="preload"][as="style"]['+l+"]")?f.loading=1:(l=r.createElement("link"),f.preload=l,l.addEventListener("load",function(){return f.loading|=1}),l.addEventListener("error",function(){return f.loading|=2}),wt(l,"link",c),ft(l),r.head.appendChild(l))}function Qo(r){return'[src="'+un(r)+'"]'}function hs(r){return"script[async]"+r}function fb(r,l,c){if(l.count++,l.instance===null)switch(l.type){case"style":var f=r.querySelector('style[data-href~="'+un(c.href)+'"]');if(f)return l.instance=f,ft(f),f;var m=g({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(r.ownerDocument||r).createElement("style"),ft(f),wt(f,"style",m),mc(f,c.precedence,r),l.instance=f;case"stylesheet":m=Jo(c.href);var y=r.querySelector(fs(m));if(y)return l.state.loading|=4,l.instance=y,ft(y),y;f=db(c),(m=xn.get(m))&&Oh(f,m),y=(r.ownerDocument||r).createElement("link"),ft(y);var C=y;return C._p=new Promise(function(M,j){C.onload=M,C.onerror=j}),wt(y,"link",f),l.state.loading|=4,mc(y,c.precedence,r),l.instance=y;case"script":return y=Qo(c.src),(m=r.querySelector(hs(y)))?(l.instance=m,ft(m),m):(f=c,(m=xn.get(y))&&(f=g({},c),Rh(f,m)),r=r.ownerDocument||r,m=r.createElement("script"),ft(m),wt(m,"link",f),r.head.appendChild(m),l.instance=m);case"void":return null;default:throw Error(i(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(f=l.instance,l.state.loading|=4,mc(f,c.precedence,r));return l.instance}function mc(r,l,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,y=m,C=0;C<f.length;C++){var M=f[C];if(M.dataset.precedence===l)y=M;else if(y!==m)break}y?y.parentNode.insertBefore(r,y.nextSibling):(l=c.nodeType===9?c.head:c,l.insertBefore(r,l.firstChild))}function Oh(r,l){r.crossOrigin==null&&(r.crossOrigin=l.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=l.referrerPolicy),r.title==null&&(r.title=l.title)}function Rh(r,l){r.crossOrigin==null&&(r.crossOrigin=l.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=l.referrerPolicy),r.integrity==null&&(r.integrity=l.integrity)}var gc=null;function hb(r,l,c){if(gc===null){var f=new Map,m=gc=new Map;m.set(c,f)}else m=gc,f=m.get(c),f||(f=new Map,m.set(c,f));if(f.has(r))return f;for(f.set(r,null),c=c.getElementsByTagName(r),m=0;m<c.length;m++){var y=c[m];if(!(y[Al]||y[xt]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var C=y.getAttribute(l)||"";C=r+C;var M=f.get(C);M?M.push(y):f.set(C,[y])}}return f}function pb(r,l,c){r=r.ownerDocument||r,r.head.insertBefore(c,l==="title"?r.querySelector("head > title"):null)}function pM(r,l,c){if(c===1||l.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;return l.rel==="stylesheet"?(r=l.disabled,typeof l.precedence=="string"&&r==null):!0;case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function mb(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function mM(r,l,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var m=Jo(f.href),y=l.querySelector(fs(m));if(y){l=y._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(r.count++,r=yc.bind(r),l.then(r,r)),c.state.loading|=4,c.instance=y,ft(y);return}y=l.ownerDocument||l,f=db(f),(m=xn.get(m))&&Oh(f,m),y=y.createElement("link"),ft(y);var C=y;C._p=new Promise(function(M,j){C.onload=M,C.onerror=j}),wt(y,"link",f),c.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(c,l),(l=c.state.preload)&&(c.state.loading&3)===0&&(r.count++,c=yc.bind(r),l.addEventListener("load",c),l.addEventListener("error",c))}}var Dh=0;function gM(r,l){return r.stylesheets&&r.count===0&&bc(r,r.stylesheets),0<r.count||0<r.imgCount?function(c){var f=setTimeout(function(){if(r.stylesheets&&bc(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+l);0<r.imgBytes&&Dh===0&&(Dh=62500*XT());var m=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&bc(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>Dh?50:800)+l);return r.unsuspend=c,function(){r.unsuspend=null,clearTimeout(f),clearTimeout(m)}}:null}function yc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)bc(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var xc=null;function bc(r,l){r.stylesheets=null,r.unsuspend!==null&&(r.count++,xc=new Map,l.forEach(yM,r),xc=null,yc.call(r))}function yM(r,l){if(!(l.state.loading&4)){var c=xc.get(r);if(c)var f=c.get(null);else{c=new Map,xc.set(r,c);for(var m=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<m.length;y++){var C=m[y];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(c.set(C.dataset.precedence,C),f=C)}f&&c.set(null,f)}m=l.instance,C=m.getAttribute("data-precedence"),y=c.get(C)||f,y===f&&c.set(null,m),c.set(C,m),this.count++,f=yc.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),y?y.parentNode.insertBefore(m,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(m,r.firstChild)),l.state.loading|=4}}var ps={$$typeof:D,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function xM(r,l,c,f,m,y,C,M,j){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ed(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ed(0),this.hiddenUpdates=Ed(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=y,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=j,this.incompleteTransitions=new Map}function gb(r,l,c,f,m,y,C,M,j,P,G,J){return r=new xM(r,l,c,C,j,P,G,J,M),l=1,y===!0&&(l|=24),y=Qt(3,null,null,l),r.current=y,y.stateNode=r,l=uf(),l.refCount++,r.pooledCache=l,l.refCount++,y.memoizedState={element:f,isDehydrated:c,cache:l},pf(y),r}function yb(r){return r?(r=Oo,r):Oo}function xb(r,l,c,f,m,y){m=yb(m),f.context===null?f.context=m:f.pendingContext=m,f=qi(l),f.payload={element:c},y=y===void 0?null:y,y!==null&&(f.callback=y),c=Fi(r,f,l),c!==null&&(Vt(c,r,l),Fl(c,r,l))}function bb(r,l){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<l?c:l}}function Nh(r,l){bb(r,l),(r=r.alternate)&&bb(r,l)}function vb(r){if(r.tag===13||r.tag===31){var l=Br(r,67108864);l!==null&&Vt(l,r,67108864),Nh(r,67108864)}}function Sb(r){if(r.tag===13||r.tag===31){var l=rn();l=Td(l);var c=Br(r,l);c!==null&&Vt(c,r,l),Nh(r,l)}}var vc=!0;function bM(r,l,c,f){var m=q.T;q.T=null;var y=ee.p;try{ee.p=2,jh(r,l,c,f)}finally{ee.p=y,q.T=m}}function vM(r,l,c,f){var m=q.T;q.T=null;var y=ee.p;try{ee.p=8,jh(r,l,c,f)}finally{ee.p=y,q.T=m}}function jh(r,l,c,f){if(vc){var m=zh(f);if(m===null)bh(r,l,f,Sc,c),Cb(r,f);else if(wM(m,r,l,c,f))f.stopPropagation();else if(Cb(r,f),l&4&&-1<SM.indexOf(r)){for(;m!==null;){var y=xo(m);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var C=Dr(y.pendingLanes);if(C!==0){var M=y;for(M.pendingLanes|=2,M.entangledLanes|=2;C;){var j=1<<31-Xt(C);M.entanglements[1]|=j,C&=~j}Hn(y),(ze&6)===0&&(ic=Gt()+500,as(0))}}break;case 31:case 13:M=Br(y,2),M!==null&&Vt(M,y,2),oc(),Nh(y,2)}if(y=zh(f),y===null&&bh(r,l,f,Sc,c),y===m)break;m=y}m!==null&&f.stopPropagation()}else bh(r,l,f,null,c)}}function zh(r){return r=Ld(r),Lh(r)}var Sc=null;function Lh(r){if(Sc=null,r=yo(r),r!==null){var l=s(r);if(l===null)r=null;else{var c=l.tag;if(c===13){if(r=a(l),r!==null)return r;r=null}else if(c===31){if(r=u(l),r!==null)return r;r=null}else if(c===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;r=null}else l!==r&&(r=null)}}return Sc=r,null}function wb(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(lE()){case Rg:return 2;case Dg:return 8;case ua:case sE:return 32;case Ng:return 268435456;default:return 32}default:return 32}}var Bh=!1,nr=null,ir=null,rr=null,ms=new Map,gs=new Map,or=[],SM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Cb(r,l){switch(r){case"focusin":case"focusout":nr=null;break;case"dragenter":case"dragleave":ir=null;break;case"mouseover":case"mouseout":rr=null;break;case"pointerover":case"pointerout":ms.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":gs.delete(l.pointerId)}}function ys(r,l,c,f,m,y){return r===null||r.nativeEvent!==y?(r={blockedOn:l,domEventName:c,eventSystemFlags:f,nativeEvent:y,targetContainers:[m]},l!==null&&(l=xo(l),l!==null&&vb(l)),r):(r.eventSystemFlags|=f,l=r.targetContainers,m!==null&&l.indexOf(m)===-1&&l.push(m),r)}function wM(r,l,c,f,m){switch(l){case"focusin":return nr=ys(nr,r,l,c,f,m),!0;case"dragenter":return ir=ys(ir,r,l,c,f,m),!0;case"mouseover":return rr=ys(rr,r,l,c,f,m),!0;case"pointerover":var y=m.pointerId;return ms.set(y,ys(ms.get(y)||null,r,l,c,f,m)),!0;case"gotpointercapture":return y=m.pointerId,gs.set(y,ys(gs.get(y)||null,r,l,c,f,m)),!0}return!1}function kb(r){var l=yo(r.target);if(l!==null){var c=s(l);if(c!==null){if(l=c.tag,l===13){if(l=a(c),l!==null){r.blockedOn=l,_g(r.priority,function(){Sb(c)});return}}else if(l===31){if(l=u(c),l!==null){r.blockedOn=l,_g(r.priority,function(){Sb(c)});return}}else if(l===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function wc(r){if(r.blockedOn!==null)return!1;for(var l=r.targetContainers;0<l.length;){var c=zh(r.nativeEvent);if(c===null){c=r.nativeEvent;var f=new c.constructor(c.type,c);zd=f,c.target.dispatchEvent(f),zd=null}else return l=xo(c),l!==null&&vb(l),r.blockedOn=c,!1;l.shift()}return!0}function Eb(r,l,c){wc(r)&&c.delete(l)}function CM(){Bh=!1,nr!==null&&wc(nr)&&(nr=null),ir!==null&&wc(ir)&&(ir=null),rr!==null&&wc(rr)&&(rr=null),ms.forEach(Eb),gs.forEach(Eb)}function Cc(r,l){r.blockedOn===l&&(r.blockedOn=null,Bh||(Bh=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,CM)))}var kc=null;function Tb(r){kc!==r&&(kc=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){kc===r&&(kc=null);for(var l=0;l<r.length;l+=3){var c=r[l],f=r[l+1],m=r[l+2];if(typeof f!="function"){if(Lh(f||c)===null)continue;break}var y=xo(c);y!==null&&(r.splice(l,3),l-=3,zf(y,{pending:!0,data:m,method:c.method,action:f},f,m))}}))}function Zo(r){function l(j){return Cc(j,r)}nr!==null&&Cc(nr,r),ir!==null&&Cc(ir,r),rr!==null&&Cc(rr,r),ms.forEach(l),gs.forEach(l);for(var c=0;c<or.length;c++){var f=or[c];f.blockedOn===r&&(f.blockedOn=null)}for(;0<or.length&&(c=or[0],c.blockedOn===null);)kb(c),c.blockedOn===null&&or.shift();if(c=(r.ownerDocument||r).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var m=c[f],y=c[f+1],C=m[It]||null;if(typeof y=="function")C||Tb(c);else if(C){var M=null;if(y&&y.hasAttribute("formAction")){if(m=y,C=y[It]||null)M=C.formAction;else if(Lh(m)!==null)continue}else M=C.action;typeof M=="function"?c[f+1]=M:(c.splice(f,3),f-=3),Tb(c)}}}function Mb(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(C){return m=C})},focusReset:"manual",scroll:"manual"})}function l(){m!==null&&(m(),m=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,m=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),m!==null&&(m(),m=null)}}}function Ih(r){this._internalRoot=r}Ec.prototype.render=Ih.prototype.render=function(r){var l=this._internalRoot;if(l===null)throw Error(i(409));var c=l.current,f=rn();xb(c,f,r,l,null,null)},Ec.prototype.unmount=Ih.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var l=r.containerInfo;xb(r.current,2,null,r,null,null),oc(),l[go]=null}};function Ec(r){this._internalRoot=r}Ec.prototype.unstable_scheduleHydration=function(r){if(r){var l=Ig();r={blockedOn:null,target:r,priority:l};for(var c=0;c<or.length&&l!==0&&l<or[c].priority;c++);or.splice(c,0,r),c===0&&kb(r)}};var Ab=e.version;if(Ab!=="19.2.3")throw Error(i(527,Ab,"19.2.3"));ee.findDOMNode=function(r){var l=r._reactInternals;if(l===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=h(l),r=r!==null?p(r):null,r=r===null?null:r.stateNode,r};var kM={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tc.isDisabled&&Tc.supportsFiber)try{El=Tc.inject(kM),Kt=Tc}catch{}}return bs.createRoot=function(r,l){if(!o(r))throw Error(i(299));var c=!1,f="",m=L0,y=B0,C=I0;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(m=l.onUncaughtError),l.onCaughtError!==void 0&&(y=l.onCaughtError),l.onRecoverableError!==void 0&&(C=l.onRecoverableError)),l=gb(r,1,!1,null,null,c,f,null,m,y,C,Mb),r[go]=l.current,xh(r),new Ih(l)},bs.hydrateRoot=function(r,l,c){if(!o(r))throw Error(i(299));var f=!1,m="",y=L0,C=B0,M=I0,j=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onUncaughtError!==void 0&&(y=c.onUncaughtError),c.onCaughtError!==void 0&&(C=c.onCaughtError),c.onRecoverableError!==void 0&&(M=c.onRecoverableError),c.formState!==void 0&&(j=c.formState)),l=gb(r,1,!0,l,c??null,f,m,j,y,C,M,Mb),l.context=yb(null),c=l.current,f=rn(),f=Td(f),m=qi(f),m.callback=null,Fi(c,m,f),c=f,l.current.lanes=c,Ml(l,c),Hn(l),r[go]=l.current,xh(r),new Ec(l)},bs.version="19.2.3",bs}var _b;function jM(){if(_b)return Uh.exports;_b=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Uh.exports=NM(),Uh.exports}var zM=jM();const LM=Tm(zM);var Hb="popstate";function BM(t={}){function e(o,s){let{pathname:a="/",search:u="",hash:d=""}=ho(o.location.hash.substring(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),Lp("",{pathname:a,search:u,hash:d},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(o,s){let a=o.document.querySelector("base"),u="";if(a&&a.getAttribute("href")){let d=o.location.href,h=d.indexOf("#");u=h===-1?d:d.slice(0,h)}return u+"#"+(typeof s=="string"?s:Vs(s))}function i(o,s){an(o.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(s)})`)}return _M(e,n,i,t)}function Ke(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function an(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function IM(){return Math.random().toString(36).substring(2,10)}function Ub(t,e){return{usr:t.state,key:t.key,idx:e}}function Lp(t,e,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ho(e):e,state:n,key:e&&e.key||i||IM()}}function Vs({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function ho(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function _M(t,e,n,i={}){let{window:o=document.defaultView,v5Compat:s=!1}=i,a=o.history,u="POP",d=null,h=p();h==null&&(h=0,a.replaceState({...a.state,idx:h},""));function p(){return(a.state||{idx:null}).idx}function g(){u="POP";let w=p(),E=w==null?null:w-h;h=w,d&&d({action:u,location:k.location,delta:E})}function x(w,E){u="PUSH";let A=Lp(k.location,w,E);n&&n(A,w),h=p()+1;let D=Ub(A,h),L=k.createHref(A);try{a.pushState(D,"",L)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;o.location.assign(L)}s&&d&&d({action:u,location:k.location,delta:1})}function v(w,E){u="REPLACE";let A=Lp(k.location,w,E);n&&n(A,w),h=p();let D=Ub(A,h),L=k.createHref(A);a.replaceState(D,"",L),s&&d&&d({action:u,location:k.location,delta:0})}function S(w){return HM(w)}let k={get action(){return u},get location(){return t(o,a)},listen(w){if(d)throw new Error("A history only accepts one active listener");return o.addEventListener(Hb,g),d=w,()=>{o.removeEventListener(Hb,g),d=null}},createHref(w){return e(o,w)},createURL:S,encodeLocation(w){let E=S(w);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:x,replace:v,go(w){return a.go(w)}};return k}function HM(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ke(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:Vs(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function gS(t,e,n="/"){return UM(t,e,n,!1)}function UM(t,e,n,i){let o=typeof e=="string"?ho(e):e,s=Di(o.pathname||"/",n);if(s==null)return null;let a=yS(t);$M(a);let u=null;for(let d=0;u==null&&d<a.length;++d){let h=QM(s);u=XM(a[d],h,i)}return u}function yS(t,e=[],n=[],i="",o=!1){let s=(a,u,d=o,h)=>{let p={relativePath:h===void 0?a.path||"":h,caseSensitive:a.caseSensitive===!0,childrenIndex:u,route:a};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(i)&&d)return;Ke(p.relativePath.startsWith(i),`Absolute route path "${p.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(i.length)}let g=Mi([i,p.relativePath]),x=n.concat(p);a.children&&a.children.length>0&&(Ke(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),yS(a.children,e,x,g,d)),!(a.path==null&&!a.index)&&e.push({path:g,score:GM(g,a.index),routesMeta:x})};return t.forEach((a,u)=>{if(a.path===""||!a.path?.includes("?"))s(a,u);else for(let d of xS(a.path))s(a,u,!0,d)}),e}function xS(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,o=n.endsWith("?"),s=n.replace(/\?$/,"");if(i.length===0)return o?[s,""]:[s];let a=xS(i.join("/")),u=[];return u.push(...a.map(d=>d===""?s:[s,d].join("/"))),o&&u.push(...a),u.map(d=>t.startsWith("/")&&d===""?"/":d)}function $M(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:KM(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var PM=/^:[\w-]+$/,VM=3,qM=2,FM=1,WM=10,YM=-2,$b=t=>t==="*";function GM(t,e){let n=t.split("/"),i=n.length;return n.some($b)&&(i+=YM),e&&(i+=qM),n.filter(o=>!$b(o)).reduce((o,s)=>o+(PM.test(s)?VM:s===""?FM:WM),i)}function KM(t,e){return t.length===e.length&&t.slice(0,-1).every((i,o)=>i===e[o])?t[t.length-1]-e[e.length-1]:0}function XM(t,e,n=!1){let{routesMeta:i}=t,o={},s="/",a=[];for(let u=0;u<i.length;++u){let d=i[u],h=u===i.length-1,p=s==="/"?e:e.slice(s.length)||"/",g=ou({path:d.relativePath,caseSensitive:d.caseSensitive,end:h},p),x=d.route;if(!g&&h&&n&&!i[i.length-1].route.index&&(g=ou({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},p)),!g)return null;Object.assign(o,g.params),a.push({params:o,pathname:Mi([s,g.pathname]),pathnameBase:nA(Mi([s,g.pathnameBase])),route:x}),g.pathnameBase!=="/"&&(s=Mi([s,g.pathnameBase]))}return a}function ou(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=JM(t.path,t.caseSensitive,t.end),o=e.match(n);if(!o)return null;let s=o[0],a=s.replace(/(.)\/+$/,"$1"),u=o.slice(1);return{params:i.reduce((h,{paramName:p,isOptional:g},x)=>{if(p==="*"){let S=u[x]||"";a=s.slice(0,s.length-S.length).replace(/(.)\/+$/,"$1")}const v=u[x];return g&&!v?h[p]=void 0:h[p]=(v||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:a,pattern:t}}function JM(t,e=!1,n=!0){an(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,u,d)=>(i.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),i]}function QM(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return an(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Di(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}var bS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ZM=t=>bS.test(t);function eA(t,e="/"){let{pathname:n,search:i="",hash:o=""}=typeof t=="string"?ho(t):t,s;if(n)if(ZM(n))s=n;else{if(n.includes("//")){let a=n;n=n.replace(/\/\/+/g,"/"),an(!1,`Pathnames cannot have embedded double slashes - normalizing ${a} -> ${n}`)}n.startsWith("/")?s=Pb(n.substring(1),"/"):s=Pb(n,e)}else s=e;return{pathname:s,search:iA(i),hash:rA(o)}}function Pb(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function qh(t,e,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function tA(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function vS(t){let e=tA(t);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function SS(t,e,n,i=!1){let o;typeof t=="string"?o=ho(t):(o={...t},Ke(!o.pathname||!o.pathname.includes("?"),qh("?","pathname","search",o)),Ke(!o.pathname||!o.pathname.includes("#"),qh("#","pathname","hash",o)),Ke(!o.search||!o.search.includes("#"),qh("#","search","hash",o)));let s=t===""||o.pathname==="",a=s?"/":o.pathname,u;if(a==null)u=n;else{let g=e.length-1;if(!i&&a.startsWith("..")){let x=a.split("/");for(;x[0]==="..";)x.shift(),g-=1;o.pathname=x.join("/")}u=g>=0?e[g]:"/"}let d=eA(o,u),h=a&&a!=="/"&&a.endsWith("/"),p=(s||a===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(h||p)&&(d.pathname+="/"),d}var Mi=t=>t.join("/").replace(/\/\/+/g,"/"),nA=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),iA=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,rA=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,oA=class{constructor(t,e,n,i=!1){this.status=t,this.statusText=e||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function lA(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function sA(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var wS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function CS(t,e){let n=t;if(typeof n!="string"||!bS.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,o=!1;if(wS)try{let s=new URL(window.location.href),a=n.startsWith("//")?new URL(s.protocol+n):new URL(n),u=Di(a.pathname,e);a.origin===s.origin&&u!=null?n=u+a.search+a.hash:o=!0}catch{an(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:o,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var kS=["POST","PUT","PATCH","DELETE"];new Set(kS);var aA=["GET",...kS];new Set(aA);var Sl=R.createContext(null);Sl.displayName="DataRouter";var Qu=R.createContext(null);Qu.displayName="DataRouterState";var cA=R.createContext(!1),ES=R.createContext({isTransitioning:!1});ES.displayName="ViewTransition";var uA=R.createContext(new Map);uA.displayName="Fetchers";var dA=R.createContext(null);dA.displayName="Await";var Tn=R.createContext(null);Tn.displayName="Navigation";var na=R.createContext(null);na.displayName="Location";var Xn=R.createContext({outlet:null,matches:[],isDataRoute:!1});Xn.displayName="Route";var Mm=R.createContext(null);Mm.displayName="RouteError";var TS="REACT_ROUTER_ERROR",fA="REDIRECT",hA="ROUTE_ERROR_RESPONSE";function pA(t){if(t.startsWith(`${TS}:${fA}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function mA(t){if(t.startsWith(`${TS}:${hA}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new oA(e.status,e.statusText,e.data)}catch{}}function gA(t,{relative:e}={}){Ke(ia(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=R.useContext(Tn),{hash:o,pathname:s,search:a}=ra(t,{relative:e}),u=s;return n!=="/"&&(u=s==="/"?n:Mi([n,s])),i.createHref({pathname:u,search:a,hash:o})}function ia(){return R.useContext(na)!=null}function Ni(){return Ke(ia(),"useLocation() may be used only in the context of a <Router> component."),R.useContext(na).location}var MS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function AS(t){R.useContext(Tn).static||R.useLayoutEffect(t)}function Er(){let{isDataRoute:t}=R.useContext(Xn);return t?DA():yA()}function yA(){Ke(ia(),"useNavigate() may be used only in the context of a <Router> component.");let t=R.useContext(Sl),{basename:e,navigator:n}=R.useContext(Tn),{matches:i}=R.useContext(Xn),{pathname:o}=Ni(),s=JSON.stringify(vS(i)),a=R.useRef(!1);return AS(()=>{a.current=!0}),R.useCallback((d,h={})=>{if(an(a.current,MS),!a.current)return;if(typeof d=="number"){n.go(d);return}let p=SS(d,JSON.parse(s),o,h.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Mi([e,p.pathname])),(h.replace?n.replace:n.push)(p,h.state,h)},[e,n,s,o,t])}var xA=R.createContext(null);function bA(t){let e=R.useContext(Xn).outlet;return R.useMemo(()=>e&&R.createElement(xA.Provider,{value:t},e),[e,t])}function ra(t,{relative:e}={}){let{matches:n}=R.useContext(Xn),{pathname:i}=Ni(),o=JSON.stringify(vS(n));return R.useMemo(()=>SS(t,JSON.parse(o),i,e==="path"),[t,o,i,e])}function vA(t,e){return OS(t,e)}function OS(t,e,n,i,o){Ke(ia(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=R.useContext(Tn),{matches:a}=R.useContext(Xn),u=a[a.length-1],d=u?u.params:{},h=u?u.pathname:"/",p=u?u.pathnameBase:"/",g=u&&u.route;{let A=g&&g.path||"";DS(h,!g||A.endsWith("*")||A.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${A}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${A}"> to <Route path="${A==="/"?"*":`${A}/*`}">.`)}let x=Ni(),v;if(e){let A=typeof e=="string"?ho(e):e;Ke(p==="/"||A.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${A.pathname}" was given in the \`location\` prop.`),v=A}else v=x;let S=v.pathname||"/",k=S;if(p!=="/"){let A=p.replace(/^\//,"").split("/");k="/"+S.replace(/^\//,"").split("/").slice(A.length).join("/")}let w=gS(t,{pathname:k});an(g||w!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),an(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=EA(w&&w.map(A=>Object.assign({},A,{params:Object.assign({},d,A.params),pathname:Mi([p,s.encodeLocation?s.encodeLocation(A.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?p:Mi([p,s.encodeLocation?s.encodeLocation(A.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:A.pathnameBase])})),a,n,i,o);return e&&E?R.createElement(na.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},E):E}function SA(){let t=RA(),e=lA(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:i},s={padding:"2px 4px",backgroundColor:i},a=null;return console.error("Error handled by React Router default ErrorBoundary:",t),a=R.createElement(R.Fragment,null,R.createElement("p",null," Hey developer "),R.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",R.createElement("code",{style:s},"ErrorBoundary")," or"," ",R.createElement("code",{style:s},"errorElement")," prop on your route.")),R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},e),n?R.createElement("pre",{style:o},n):null,a)}var wA=R.createElement(SA,null),RS=class extends R.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=mA(t.digest);n&&(t=n)}let e=t!==void 0?R.createElement(Xn.Provider,{value:this.props.routeContext},R.createElement(Mm.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?R.createElement(CA,{error:t},e):e}};RS.contextType=cA;var Fh=new WeakMap;function CA({children:t,error:e}){let{basename:n}=R.useContext(Tn);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=pA(e.digest);if(i){let o=Fh.get(e);if(o)throw o;let s=CS(i.location,n);if(wS&&!Fh.get(e))if(s.isExternal||i.reloadDocument)window.location.href=s.absoluteURL||s.to;else{const a=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(s.to,{replace:i.replace}));throw Fh.set(e,a),a}return R.createElement("meta",{httpEquiv:"refresh",content:`0;url=${s.absoluteURL||s.to}`})}}return t}function kA({routeContext:t,match:e,children:n}){let i=R.useContext(Sl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),R.createElement(Xn.Provider,{value:t},n)}function EA(t,e=[],n=null,i=null,o=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let s=t,a=n?.errors;if(a!=null){let p=s.findIndex(g=>g.route.id&&a?.[g.route.id]!==void 0);Ke(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),s=s.slice(0,Math.min(s.length,p+1))}let u=!1,d=-1;if(n)for(let p=0;p<s.length;p++){let g=s[p];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(d=p),g.route.id){let{loaderData:x,errors:v}=n,S=g.route.loader&&!x.hasOwnProperty(g.route.id)&&(!v||v[g.route.id]===void 0);if(g.route.lazy||S){u=!0,d>=0?s=s.slice(0,d+1):s=[s[0]];break}}}let h=n&&i?(p,g)=>{i(p,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:sA(n.matches),errorInfo:g})}:void 0;return s.reduceRight((p,g,x)=>{let v,S=!1,k=null,w=null;n&&(v=a&&g.route.id?a[g.route.id]:void 0,k=g.route.errorElement||wA,u&&(d<0&&x===0?(DS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),S=!0,w=null):d===x&&(S=!0,w=g.route.hydrateFallbackElement||null)));let E=e.concat(s.slice(0,x+1)),A=()=>{let D;return v?D=k:S?D=w:g.route.Component?D=R.createElement(g.route.Component,null):g.route.element?D=g.route.element:D=p,R.createElement(kA,{match:g,routeContext:{outlet:p,matches:E,isDataRoute:n!=null},children:D})};return n&&(g.route.ErrorBoundary||g.route.errorElement||x===0)?R.createElement(RS,{location:n.location,revalidation:n.revalidation,component:k,error:v,children:A(),routeContext:{outlet:null,matches:E,isDataRoute:!0},onError:h}):A()},null)}function Am(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function TA(t){let e=R.useContext(Sl);return Ke(e,Am(t)),e}function MA(t){let e=R.useContext(Qu);return Ke(e,Am(t)),e}function AA(t){let e=R.useContext(Xn);return Ke(e,Am(t)),e}function Om(t){let e=AA(t),n=e.matches[e.matches.length-1];return Ke(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function OA(){return Om("useRouteId")}function RA(){let t=R.useContext(Mm),e=MA("useRouteError"),n=Om("useRouteError");return t!==void 0?t:e.errors?.[n]}function DA(){let{router:t}=TA("useNavigate"),e=Om("useNavigate"),n=R.useRef(!1);return AS(()=>{n.current=!0}),R.useCallback(async(o,s={})=>{an(n.current,MS),n.current&&(typeof o=="number"?await t.navigate(o):await t.navigate(o,{fromRouteId:e,...s}))},[t,e])}var Vb={};function DS(t,e,n){!e&&!Vb[t]&&(Vb[t]=!0,an(!1,n))}R.memo(NA);function NA({routes:t,future:e,state:n,onError:i}){return OS(t,void 0,n,i,e)}function jA(t){return bA(t.context)}function vi(t){Ke(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function zA({basename:t="/",children:e=null,location:n,navigationType:i="POP",navigator:o,static:s=!1,unstable_useTransitions:a}){Ke(!ia(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=t.replace(/^\/*/,"/"),d=R.useMemo(()=>({basename:u,navigator:o,static:s,unstable_useTransitions:a,future:{}}),[u,o,s,a]);typeof n=="string"&&(n=ho(n));let{pathname:h="/",search:p="",hash:g="",state:x=null,key:v="default"}=n,S=R.useMemo(()=>{let k=Di(h,u);return k==null?null:{location:{pathname:k,search:p,hash:g,state:x,key:v},navigationType:i}},[u,h,p,g,x,v,i]);return an(S!=null,`<Router basename="${u}"> is not able to match the URL "${h}${p}${g}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:R.createElement(Tn.Provider,{value:d},R.createElement(na.Provider,{children:e,value:S}))}function LA({children:t,location:e}){return vA(Bp(t),e)}function Bp(t,e=[]){let n=[];return R.Children.forEach(t,(i,o)=>{if(!R.isValidElement(i))return;let s=[...e,o];if(i.type===R.Fragment){n.push.apply(n,Bp(i.props.children,s));return}Ke(i.type===vi,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ke(!i.props.index||!i.props.children,"An index route cannot have child routes.");let a={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(a.children=Bp(i.props.children,s)),n.push(a)}),n}var Kc="get",Xc="application/x-www-form-urlencoded";function Zu(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function BA(t){return Zu(t)&&t.tagName.toLowerCase()==="button"}function IA(t){return Zu(t)&&t.tagName.toLowerCase()==="form"}function _A(t){return Zu(t)&&t.tagName.toLowerCase()==="input"}function HA(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function UA(t,e){return t.button===0&&(!e||e==="_self")&&!HA(t)}function Ip(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let i=t[n];return e.concat(Array.isArray(i)?i.map(o=>[n,o]):[[n,i]])},[]))}function $A(t,e){let n=Ip(t);return e&&e.forEach((i,o)=>{n.has(o)||e.getAll(o).forEach(s=>{n.append(o,s)})}),n}var Mc=null;function PA(){if(Mc===null)try{new FormData(document.createElement("form"),0),Mc=!1}catch{Mc=!0}return Mc}var VA=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Wh(t){return t!=null&&!VA.has(t)?(an(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Xc}"`),null):t}function qA(t,e){let n,i,o,s,a;if(IA(t)){let u=t.getAttribute("action");i=u?Di(u,e):null,n=t.getAttribute("method")||Kc,o=Wh(t.getAttribute("enctype"))||Xc,s=new FormData(t)}else if(BA(t)||_A(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=t.getAttribute("formaction")||u.getAttribute("action");if(i=d?Di(d,e):null,n=t.getAttribute("formmethod")||u.getAttribute("method")||Kc,o=Wh(t.getAttribute("formenctype"))||Wh(u.getAttribute("enctype"))||Xc,s=new FormData(u,t),!PA()){let{name:h,type:p,value:g}=t;if(p==="image"){let x=h?`${h}.`:"";s.append(`${x}x`,"0"),s.append(`${x}y`,"0")}else h&&s.append(h,g)}}else{if(Zu(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Kc,i=null,o=Xc,a=t}return s&&o==="text/plain"&&(a=s,s=void 0),{action:i,method:n.toLowerCase(),encType:o,formData:s,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Rm(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function FA(t,e,n){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return i.pathname==="/"?i.pathname=`_root.${n}`:e&&Di(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function WA(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function YA(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function GA(t,e,n){let i=await Promise.all(t.map(async o=>{let s=e.routes[o.route.id];if(s){let a=await WA(s,n);return a.links?a.links():[]}return[]}));return QA(i.flat(1).filter(YA).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function qb(t,e,n,i,o,s){let a=(d,h)=>n[h]?d.route.id!==n[h].route.id:!0,u=(d,h)=>n[h].pathname!==d.pathname||n[h].route.path?.endsWith("*")&&n[h].params["*"]!==d.params["*"];return s==="assets"?e.filter((d,h)=>a(d,h)||u(d,h)):s==="data"?e.filter((d,h)=>{let p=i.routes[d.route.id];if(!p||!p.hasLoader)return!1;if(a(d,h)||u(d,h))return!0;if(d.route.shouldRevalidate){let g=d.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function KA(t,e,{includeHydrateFallback:n}={}){return XA(t.map(i=>{let o=e.routes[i.route.id];if(!o)return[];let s=[o.module];return o.clientActionModule&&(s=s.concat(o.clientActionModule)),o.clientLoaderModule&&(s=s.concat(o.clientLoaderModule)),n&&o.hydrateFallbackModule&&(s=s.concat(o.hydrateFallbackModule)),o.imports&&(s=s.concat(o.imports)),s}).flat(1))}function XA(t){return[...new Set(t)]}function JA(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}function QA(t,e){let n=new Set;return new Set(e),t.reduce((i,o)=>{let s=JSON.stringify(JA(o));return n.has(s)||(n.add(s),i.push({key:s,link:o})),i},[])}function NS(){let t=R.useContext(Sl);return Rm(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function ZA(){let t=R.useContext(Qu);return Rm(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Dm=R.createContext(void 0);Dm.displayName="FrameworkContext";function jS(){let t=R.useContext(Dm);return Rm(t,"You must render this element inside a <HydratedRouter> element"),t}function eO(t,e){let n=R.useContext(Dm),[i,o]=R.useState(!1),[s,a]=R.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:h,onMouseLeave:p,onTouchStart:g}=e,x=R.useRef(null);R.useEffect(()=>{if(t==="render"&&a(!0),t==="viewport"){let k=E=>{E.forEach(A=>{a(A.isIntersecting)})},w=new IntersectionObserver(k,{threshold:.5});return x.current&&w.observe(x.current),()=>{w.disconnect()}}},[t]),R.useEffect(()=>{if(i){let k=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(k)}}},[i]);let v=()=>{o(!0)},S=()=>{o(!1),a(!1)};return n?t!=="intent"?[s,x,{}]:[s,x,{onFocus:vs(u,v),onBlur:vs(d,S),onMouseEnter:vs(h,v),onMouseLeave:vs(p,S),onTouchStart:vs(g,v)}]:[!1,x,{}]}function vs(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function tO({page:t,...e}){let{router:n}=NS(),i=R.useMemo(()=>gS(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?R.createElement(iO,{page:t,matches:i,...e}):null}function nO(t){let{manifest:e,routeModules:n}=jS(),[i,o]=R.useState([]);return R.useEffect(()=>{let s=!1;return GA(t,e,n).then(a=>{s||o(a)}),()=>{s=!0}},[t,e,n]),i}function iO({page:t,matches:e,...n}){let i=Ni(),{manifest:o,routeModules:s}=jS(),{basename:a}=NS(),{loaderData:u,matches:d}=ZA(),h=R.useMemo(()=>qb(t,e,d,o,i,"data"),[t,e,d,o,i]),p=R.useMemo(()=>qb(t,e,d,o,i,"assets"),[t,e,d,o,i]),g=R.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let S=new Set,k=!1;if(e.forEach(E=>{let A=o.routes[E.route.id];!A||!A.hasLoader||(!h.some(D=>D.route.id===E.route.id)&&E.route.id in u&&s[E.route.id]?.shouldRevalidate||A.hasClientLoader?k=!0:S.add(E.route.id))}),S.size===0)return[];let w=FA(t,a,"data");return k&&S.size>0&&w.searchParams.set("_routes",e.filter(E=>S.has(E.route.id)).map(E=>E.route.id).join(",")),[w.pathname+w.search]},[a,u,i,o,h,e,t,s]),x=R.useMemo(()=>KA(p,o),[p,o]),v=nO(p);return R.createElement(R.Fragment,null,g.map(S=>R.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...n})),x.map(S=>R.createElement("link",{key:S,rel:"modulepreload",href:S,...n})),v.map(({key:S,link:k})=>R.createElement("link",{key:S,nonce:n.nonce,...k})))}function rO(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var oO=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{oO&&(window.__reactRouterVersion="7.11.0")}catch{}function lO({basename:t,children:e,unstable_useTransitions:n,window:i}){let o=R.useRef();o.current==null&&(o.current=BM({window:i,v5Compat:!0}));let s=o.current,[a,u]=R.useState({action:s.action,location:s.location}),d=R.useCallback(h=>{n===!1?u(h):R.startTransition(()=>u(h))},[n]);return R.useLayoutEffect(()=>s.listen(d),[s,d]),R.createElement(zA,{basename:t,children:e,location:a.location,navigationType:a.action,navigator:s,unstable_useTransitions:n})}var zS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LS=R.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:o,reloadDocument:s,replace:a,state:u,target:d,to:h,preventScrollReset:p,viewTransition:g,unstable_defaultShouldRevalidate:x,...v},S){let{basename:k,unstable_useTransitions:w}=R.useContext(Tn),E=typeof h=="string"&&zS.test(h),A=CS(h,k);h=A.to;let D=gA(h,{relative:o}),[L,T,z]=eO(i,v),N=uO(h,{replace:a,state:u,target:d,preventScrollReset:p,relative:o,viewTransition:g,unstable_defaultShouldRevalidate:x,unstable_useTransitions:w});function B(W){e&&e(W),W.defaultPrevented||N(W)}let _=R.createElement("a",{...v,...z,href:A.absoluteURL||D,onClick:A.isExternal||s?e:B,ref:rO(S,T),target:d,"data-discover":!E&&n==="render"?"true":void 0});return L&&!E?R.createElement(R.Fragment,null,_,R.createElement(tO,{page:D})):_});LS.displayName="Link";var sO=R.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:o=!1,style:s,to:a,viewTransition:u,children:d,...h},p){let g=ra(a,{relative:h.relative}),x=Ni(),v=R.useContext(Qu),{navigator:S,basename:k}=R.useContext(Tn),w=v!=null&&mO(g)&&u===!0,E=S.encodeLocation?S.encodeLocation(g).pathname:g.pathname,A=x.pathname,D=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(A=A.toLowerCase(),D=D?D.toLowerCase():null,E=E.toLowerCase()),D&&k&&(D=Di(D,k)||D);const L=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let T=A===E||!o&&A.startsWith(E)&&A.charAt(L)==="/",z=D!=null&&(D===E||!o&&D.startsWith(E)&&D.charAt(E.length)==="/"),N={isActive:T,isPending:z,isTransitioning:w},B=T?e:void 0,_;typeof i=="function"?_=i(N):_=[i,T?"active":null,z?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let W=typeof s=="function"?s(N):s;return R.createElement(LS,{...h,"aria-current":B,className:_,ref:p,style:W,to:a,viewTransition:u},typeof d=="function"?d(N):d)});sO.displayName="NavLink";var aO=R.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:o,state:s,method:a=Kc,action:u,onSubmit:d,relative:h,preventScrollReset:p,viewTransition:g,unstable_defaultShouldRevalidate:x,...v},S)=>{let{unstable_useTransitions:k}=R.useContext(Tn),w=hO(),E=pO(u,{relative:h}),A=a.toLowerCase()==="get"?"get":"post",D=typeof u=="string"&&zS.test(u),L=T=>{if(d&&d(T),T.defaultPrevented)return;T.preventDefault();let z=T.nativeEvent.submitter,N=z?.getAttribute("formmethod")||a,B=()=>w(z||T.currentTarget,{fetcherKey:e,method:N,navigate:n,replace:o,state:s,relative:h,preventScrollReset:p,viewTransition:g,unstable_defaultShouldRevalidate:x});k&&n!==!1?R.startTransition(()=>B()):B()};return R.createElement("form",{ref:S,method:A,action:E,onSubmit:i?d:L,...v,"data-discover":!D&&t==="render"?"true":void 0})});aO.displayName="Form";function cO(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function BS(t){let e=R.useContext(Sl);return Ke(e,cO(t)),e}function uO(t,{target:e,replace:n,state:i,preventScrollReset:o,relative:s,viewTransition:a,unstable_defaultShouldRevalidate:u,unstable_useTransitions:d}={}){let h=Er(),p=Ni(),g=ra(t,{relative:s});return R.useCallback(x=>{if(UA(x,e)){x.preventDefault();let v=n!==void 0?n:Vs(p)===Vs(g),S=()=>h(t,{replace:v,state:i,preventScrollReset:o,relative:s,viewTransition:a,unstable_defaultShouldRevalidate:u});d?R.startTransition(()=>S()):S()}},[p,h,g,n,i,e,t,o,s,a,u,d])}function IS(t){an(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=R.useRef(Ip(t)),n=R.useRef(!1),i=Ni(),o=R.useMemo(()=>$A(i.search,n.current?null:e.current),[i.search]),s=Er(),a=R.useCallback((u,d)=>{const h=Ip(typeof u=="function"?u(new URLSearchParams(o)):u);n.current=!0,s("?"+h,d)},[s,o]);return[o,a]}var dO=0,fO=()=>`__${String(++dO)}__`;function hO(){let{router:t}=BS("useSubmit"),{basename:e}=R.useContext(Tn),n=OA(),i=t.fetch,o=t.navigate;return R.useCallback(async(s,a={})=>{let{action:u,method:d,encType:h,formData:p,body:g}=qA(s,e);if(a.navigate===!1){let x=a.fetcherKey||fO();await i(x,n,a.action||u,{unstable_defaultShouldRevalidate:a.unstable_defaultShouldRevalidate,preventScrollReset:a.preventScrollReset,formData:p,body:g,formMethod:a.method||d,formEncType:a.encType||h,flushSync:a.flushSync})}else await o(a.action||u,{unstable_defaultShouldRevalidate:a.unstable_defaultShouldRevalidate,preventScrollReset:a.preventScrollReset,formData:p,body:g,formMethod:a.method||d,formEncType:a.encType||h,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[i,o,e,n])}function pO(t,{relative:e}={}){let{basename:n}=R.useContext(Tn),i=R.useContext(Xn);Ke(i,"useFormAction must be used inside a RouteContext");let[o]=i.matches.slice(-1),s={...ra(t||".",{relative:e})},a=Ni();if(t==null){s.search=a.search;let u=new URLSearchParams(s.search),d=u.getAll("index");if(d.some(p=>p==="")){u.delete("index"),d.filter(g=>g).forEach(g=>u.append("index",g));let p=u.toString();s.search=p?`?${p}`:""}}return(!t||t===".")&&o.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(s.pathname=s.pathname==="/"?n:Mi([n,s.pathname])),Vs(s)}function mO(t,{relative:e}={}){let n=R.useContext(ES);Ke(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=BS("useViewTransitionState"),o=ra(t,{relative:e});if(!n.isTransitioning)return!1;let s=Di(n.currentLocation.pathname,i)||n.currentLocation.pathname,a=Di(n.nextLocation.pathname,i)||n.nextLocation.pathname;return ou(o.pathname,a)!=null||ou(o.pathname,s)!=null}var gO=mS();const yO=Tm(gO),Wt=({isOpen:t,type:e="confirm",title:n,message:i,onConfirm:o,onCancel:s,defaultValue:a=""})=>{const[u,d]=R.useState(a),h=R.useRef(null);if(R.useEffect(()=>{t&&e==="input"&&h.current&&(h.current.focus(),h.current.select()),t&&d(a)},[t,e,a]),!t)return null;const p=()=>{e==="input"?o(u):o()},g=x=>{x.key==="Enter"&&p(),x.key==="Escape"&&s()};return b.jsx("div",{style:xO,children:b.jsxs("div",{style:bO,children:[b.jsx("div",{style:vO,children:n}),b.jsxs("div",{style:SO,children:[b.jsx("p",{style:{margin:"0 0 15px 0",lineHeight:"1.5"},children:i}),e==="input"&&b.jsx("input",{ref:h,type:"text",value:u,onChange:x=>d(x.target.value),onKeyDown:g,style:wO})]}),b.jsxs("div",{style:CO,children:[b.jsx("button",{onClick:s,style:kO,children:"Cancel"}),b.jsx("button",{onClick:p,style:EO,children:e==="input"?"Create":"Confirm"})]})]})})},xO={position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(2px)"},bO={background:"var(--bg-panel)",border:"1px solid var(--border)",borderRadius:"8px",width:"350px",boxShadow:"0 10px 30px rgba(0,0,0,0.5)",animation:"fadeIn 0.2s ease-out"},vO={padding:"15px",borderBottom:"1px solid var(--border)",fontWeight:"bold",color:"var(--text-main)",fontSize:"14px"},SO={padding:"20px",color:"var(--text-muted)",fontSize:"13px"},wO={width:"100%",padding:"8px",background:"var(--bg-app)",border:"1px solid var(--border)",color:"var(--text-main)",borderRadius:"4px",outline:"none",fontSize:"14px"},CO={padding:"10px 15px",background:"var(--bg-header)",borderTop:"1px solid var(--border)",display:"flex",justifyContent:"flex-end",gap:"10px",borderBottomLeftRadius:"8px",borderBottomRightRadius:"8px"},_S={padding:"6px 15px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",border:"none"},kO={..._S,background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border)"},EO={..._S,background:"var(--accent)",color:"white",fontWeight:"bold"};class TO extends Ri.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null,showAlertModal:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,n){console.error("App crashed:",e,n),this.setState({error:e,errorInfo:n})}handleReset=()=>{window.location.reload()};render(){return this.state.hasError?b.jsxs("div",{style:MO,children:[b.jsxs("div",{style:AO,children:[b.jsx("h1",{style:{margin:"0 0 10px 0",color:"#e74c3c"},children:" Something Went Wrong"}),b.jsx("p",{style:{color:"#ccc",marginBottom:"20px"},children:"Seymour encountered an error and couldn't recover."}),b.jsxs("details",{style:{marginBottom:"20px",background:"#222",padding:"10px",borderRadius:"4px"},children:[b.jsx("summary",{style:{cursor:"pointer",color:"#888",fontSize:"12px"},children:"Technical Details (for debugging)"}),b.jsxs("pre",{style:{fontSize:"11px",color:"#666",overflow:"auto",marginTop:"10px"},children:[this.state.error&&this.state.error.toString(),this.state.errorInfo&&this.state.errorInfo.componentStack]})]}),b.jsxs("div",{style:{display:"flex",gap:"10px"},children:[b.jsx("button",{onClick:this.handleReset,style:Fb,children:" Reload App"}),b.jsx("button",{onClick:()=>{const e=`${this.state.error}
${this.state.errorInfo?.componentStack}`;navigator.clipboard.writeText(e),this.setState({showAlertModal:!0})},style:{...Fb,background:"#333"},children:" Copy Error"})]}),b.jsx("p",{style:{fontSize:"11px",color:"#666",marginTop:"20px"},children:" Tip: Try exporting your project (File  Save) before reloading to prevent data loss."})]}),b.jsx(Wt,{isOpen:this.state.showAlertModal,onClose:()=>this.setState({showAlertModal:!1}),title:"Error Copied",message:"Error details copied! Please report this bug.",type:"alert"})]}):this.props.children}}const MO={height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#0a0a0a",color:"white",fontFamily:"sans-serif"},AO={maxWidth:"500px",padding:"40px",background:"#1a1a1a",border:"1px solid #333",borderRadius:"8px",boxShadow:"0 10px 30px rgba(0,0,0,0.5)"},Fb={padding:"10px 20px",background:"#5c8bd6",border:"none",borderRadius:"4px",color:"white",fontWeight:"bold",cursor:"pointer",fontSize:"14px"},_p=(t,e)=>e.some(n=>t instanceof n);let Wb,Yb;function OO(){return Wb||(Wb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function RO(){return Yb||(Yb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Hp=new WeakMap,Yh=new WeakMap,ed=new WeakMap;function DO(t){const e=new Promise((n,i)=>{const o=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{n(to(t.result)),o()},a=()=>{i(t.error),o()};t.addEventListener("success",s),t.addEventListener("error",a)});return ed.set(e,t),e}function NO(t){if(Hp.has(t))return;const e=new Promise((n,i)=>{const o=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{n(),o()},a=()=>{i(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});Hp.set(t,e)}let Up={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Hp.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return to(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function HS(t){Up=t(Up)}function jO(t){return RO().includes(t)?function(...e){return t.apply($p(this),e),to(this.request)}:function(...e){return to(t.apply($p(this),e))}}function zO(t){return typeof t=="function"?jO(t):(t instanceof IDBTransaction&&NO(t),_p(t,OO())?new Proxy(t,Up):t)}function to(t){if(t instanceof IDBRequest)return DO(t);if(Yh.has(t))return Yh.get(t);const e=zO(t);return e!==t&&(Yh.set(t,e),ed.set(e,t)),e}const $p=t=>ed.get(t);function LO(t,e,{blocked:n,upgrade:i,blocking:o,terminated:s}={}){const a=indexedDB.open(t,e),u=to(a);return i&&a.addEventListener("upgradeneeded",d=>{i(to(a.result),d.oldVersion,d.newVersion,to(a.transaction),d)}),n&&a.addEventListener("blocked",d=>n(d.oldVersion,d.newVersion,d)),u.then(d=>{s&&d.addEventListener("close",()=>s()),o&&d.addEventListener("versionchange",h=>o(h.oldVersion,h.newVersion,h))}).catch(()=>{}),u}const BO=["get","getKey","getAll","getAllKeys","count"],IO=["put","add","delete","clear"],Gh=new Map;function Gb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Gh.get(e))return Gh.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,o=IO.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(o||BO.includes(n)))return;const s=async function(a,...u){const d=this.transaction(a,o?"readwrite":"readonly");let h=d.store;return i&&(h=h.index(u.shift())),(await Promise.all([h[n](...u),o&&d.done]))[0]};return Gh.set(e,s),s}HS(t=>({...t,get:(e,n,i)=>Gb(e,n)||t.get(e,n,i),has:(e,n)=>!!Gb(e,n)||t.has(e,n)}));const _O=["continue","continuePrimaryKey","advance"],Kb={},Pp=new WeakMap,US=new WeakMap,HO={get(t,e){if(!_O.includes(e))return t[e];let n=Kb[e];return n||(n=Kb[e]=function(...i){Pp.set(this,US.get(this)[e](...i))}),n}};async function*UO(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const n=new Proxy(e,HO);for(US.set(n,e),ed.set(n,$p(e));e;)yield n,e=await(Pp.get(n)||e.continue()),Pp.delete(n)}function Xb(t,e){return e===Symbol.asyncIterator&&_p(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&_p(t,[IDBIndex,IDBObjectStore])}HS(t=>({...t,get(e,n,i){return Xb(e,n)?UO:t.get(e,n,i)},has(e,n){return Xb(e,n)||t.has(e,n)}}));const $O="seymour_db",PO=1;async function $S(){return LO($O,PO,{upgrade(t){t.objectStoreNames.contains("kv")||t.createObjectStore("kv")}})}async function Ac(t){return await(await $S()).get("kv",t)??null}async function Oc(t,e){await(await $S()).put("kv",e,t)}const PS=R.createContext(),VO=({children:t})=>{const e={title:"Untitled Project",globalNotes:"",settings:{fontSize:18,zoom:100,fontFamily:"serif",customFonts:[]},manuscript:{chapters:[{id:1,title:"Chapter 1",content:"<p>Once upon a time...</p>",synopsis:"",notes:""}]},lore:{characters:[],folders:[{id:"root_char",name:"Characters",parentId:null,isOpen:!0},{id:"root_loc",name:"Locations",parentId:null,isOpen:!0},{id:"root_misc",name:"Unsorted",parentId:null,isOpen:!0}]},worldMap:{imageSrc:null,pins:[]},timeline:[],relationships:[]},[n,i]=R.useState(e),[o,s]=R.useState(!1),[a,u]=R.useState(!1),[d,h]=R.useState(""),[p,g]=R.useState(""),[x,v]=R.useState("alert"),S=(T,z="Alert",N="alert")=>{h(T),g(z),v(N),u(!0)},k=T=>{try{if(!T||typeof T!="object"||!T.manuscript||!Array.isArray(T.manuscript.chapters)||!T.lore||!Array.isArray(T.lore.characters))return!1;for(let z of T.manuscript.chapters)if(!z.id||!z.title||!z.content)return!1;return!0}catch(z){return console.error("Validation error:",z),!1}},w=T=>({...e,...T,manuscript:{...e.manuscript,...T.manuscript||{}},lore:{...e.lore,...T.lore||{},folders:T.lore?.folders||e.lore.folders,characters:T.lore?.characters||[]},settings:{...e.settings,...T.settings||{}},timeline:Array.isArray(T.timeline)?T.timeline:[],relationships:Array.isArray(T.relationships)?T.relationships:[]});R.useEffect(()=>{(async()=>{try{const T=await Ac("seymour_data");if(T){if(!k(T)){console.warn(" Corrupt save data detected. Using backup or defaults.");const z=await Ac("seymour_data_backup");if(z&&k(z)){console.log(" Loaded from backup"),i(w(z)),s(!0);return}S(" Your save file appears corrupted. Starting fresh. Please load a backup if you have one.","Corrupted Save File"),s(!0);return}i(w(T)),console.log(" Project loaded successfully")}}catch(T){console.error(" Failed to load from IndexedDB:",T),S("Error loading project. Starting with a fresh project.","Load Error")}finally{s(!0)}})()},[]);const E=R.useRef(null);R.useEffect(()=>{if(o)return E.current&&clearTimeout(E.current),E.current=setTimeout(async()=>{try{const T=await Ac("seymour_data");T&&await Oc("seymour_data_backup",T),await Oc("seymour_data",n),console.log(" Saved to IndexedDB (with backup)")}catch(T){console.error(" IndexedDB save failed:",T),S(" Save failed. Your browser may be blocking storage.","Save Error")}},600),()=>{E.current&&clearTimeout(E.current)}},[n,o]),R.useEffect(()=>{if(!o)return;const T=async()=>{if(document.visibilityState==="hidden")try{const z=await Ac("seymour_data");z&&await Oc("seymour_data_backup",z),await Oc("seymour_data",n)}catch(z){console.warn("visibility save failed:",z)}};return document.addEventListener("visibilitychange",T),()=>document.removeEventListener("visibilitychange",T)},[n,o]);const A=async()=>{try{if("showSaveFilePicker"in window){const T=`${n.title||"project"}_${new Date().toISOString().slice(0,10)}.json`,N=await(await window.showSaveFilePicker({suggestedName:T,types:[{description:"Seymour Project Files",accept:{"application/json":[".json"]}}]})).createWritable();await N.write(JSON.stringify(n,null,2)),await N.close(),console.log(" File saved successfully")}else{const T=JSON.stringify(n,null,2),z=new Blob([T],{type:"application/json"}),N=URL.createObjectURL(z),B=document.createElement("a");B.href=N,B.download=`${n.title||"project"}_${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(N),console.log(" Exported to disk (fallback)")}}catch(T){if(T.name==="AbortError"){console.log("Save cancelled by user");return}console.error(" Export failed:",T),S("Failed to export project.","Export Error")}},D=T=>{const z=new FileReader;z.onload=async N=>{try{const B=JSON.parse(N.target.result);if(!k(B)){S(" Invalid project file. Please check the file and try again.","Invalid File");return}i(w(B)),S(" Project loaded successfully!","Success")}catch(B){console.error(" Import failed:",B),S("Error reading file. Make sure it's a valid Seymour project.","Import Error")}},z.onerror=()=>S("Failed to read file.","File Read Error"),z.readAsText(T)},L={uid:"offline-user",email:"offline@local"};return b.jsxs(PS.Provider,{value:{user:L,projectData:n,setProjectData:i,saveToDisk:A,loadFromDisk:D},children:[t,b.jsx(Wt,{isOpen:a,onClose:()=>u(!1),title:p,message:d,type:x})]})},Tt=()=>R.useContext(PS),qO=()=>{const{projectData:t,setProjectData:e}=Tt(),n=Er(),i=Ni(),[o,s]=R.useState({isOpen:!1,type:"confirm",title:"",message:"",onConfirm:()=>{}}),[a,u]=R.useState(null),[d,h]=R.useState(!1),[p,g]=R.useState(""),x=()=>s({...o,isOpen:!1}),v=()=>{const T=Date.now(),z={id:T,title:"New Chapter",content:"<p>Start writing here...</p>"},N={...t.manuscript};N.chapters||(N.chapters=[]),N.chapters.push(z),e({...t,manuscript:N}),g(""),n(`/editor?id=${T}`)},S=T=>{n(T)},k=T=>i.pathname==="/editor"&&i.search===`?id=${T}`,w=(T,z)=>{T.stopPropagation(),s({isOpen:!0,type:"confirm",title:"Delete Chapter?",message:"This will remove the chapter from your manuscript.",onConfirm:()=>E(z)})},E=T=>{const z=t.manuscript.chapters,N=z.find(W=>W.id===T),B=z.indexOf(N);u({data:N,index:B});const _=z.filter(W=>W.id!==T);e({...t,manuscript:{...t.manuscript,chapters:_}}),x(),h(!0),i.search.includes(T)&&n("/editor"),setTimeout(()=>{h(!1)},15e3)},A=()=>{if(!a)return;const T=[...t.manuscript.chapters];T.splice(a.index,0,a.data),e({...t,manuscript:{...t.manuscript,chapters:T}}),h(!1),u(null)},L=(t.manuscript.chapters||[]).filter(T=>T.title.toLowerCase().includes(p.toLowerCase()));return b.jsxs("aside",{style:FO,children:[b.jsx(Wt,{isOpen:o.isOpen,type:o.type,title:o.title,message:o.message,onConfirm:o.onConfirm,onCancel:x}),b.jsx("div",{style:Jb,children:"BINDER"}),b.jsxs("nav",{style:{display:"flex",flexDirection:"column",marginBottom:"10px",flexShrink:0},children:[b.jsx("button",{onClick:()=>S("/lore"),style:i.pathname==="/lore"?el:Xr,children:" World Database"}),b.jsx("button",{onClick:()=>S("/map"),style:i.pathname==="/map"?el:Xr,children:" World Map"}),b.jsx("button",{onClick:()=>S("/scratchpad"),style:i.pathname==="/scratchpad"?el:Xr,children:" Global Scratchpad"}),b.jsx("button",{onClick:()=>n("/timeline"),style:i.pathname==="/timeline"?el:Xr,children:" The Chronicle"}),b.jsx("button",{onClick:()=>n("/web"),style:i.pathname==="/web"?el:Xr,children:" The Web"})]}),b.jsx("div",{style:Jb,children:"MANUSCRIPT"}),b.jsx("div",{style:{padding:"0 10px 10px 10px",borderBottom:"1px solid var(--border)"},children:b.jsx("input",{type:"text",placeholder:" Filter chapters...",value:p,onChange:T=>g(T.target.value),style:WO})}),b.jsxs("nav",{style:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column",minHeight:0},children:[L.map(T=>b.jsxs("div",{onClick:()=>S(`/editor?id=${T.id}`),className:"chapter-row",style:k(T.id)?el:Xr,children:[b.jsxs("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis"},children:[" ",T.title]}),b.jsx("button",{onClick:z=>w(z,T.id),className:"delete-chapter-btn",title:"Delete Chapter",children:""})]},T.id)),L.length===0&&p&&b.jsx("div",{style:{padding:"15px",fontSize:"12px",color:"var(--text-muted)",textAlign:"center"},children:"No chapters found."})]}),b.jsxs("div",{style:{padding:"10px",borderTop:"1px solid var(--border)",flexShrink:0,position:"relative"},children:[d&&b.jsxs("div",{style:GO,children:[b.jsx("span",{children:"Chapter deleted."}),b.jsx("button",{onClick:A,style:KO,children:"UNDO"})]}),b.jsx("button",{onClick:v,style:YO,children:"+ Add Chapter"})]}),b.jsx("style",{children:`
        .chapter-row { display: flex !important; align-items: center; justify-content: space-between; }
        .delete-chapter-btn { 
            background: none; border: none; color: #666; cursor: pointer; 
            font-size: 14px; padding: 0 5px; opacity: 0; transition: opacity 0.2s;
        }
        .chapter-row:hover .delete-chapter-btn { opacity: 1; }
        .delete-chapter-btn:hover { color: red; font-weight: bold; }
      `})]})},FO={width:"220px",background:"var(--bg-panel)",borderRight:"1px solid var(--border)",display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},Jb={padding:"15px 10px 5px 10px",fontWeight:"bold",fontSize:"11px",color:"var(--text-muted)",letterSpacing:"1px",flexShrink:0},Xr={background:"transparent",border:"none",color:"var(--text-muted)",textAlign:"left",padding:"6px 15px",cursor:"pointer",fontSize:"13px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flexShrink:0,minHeight:"28px"},el={...Xr,background:"var(--bg-header)",color:"var(--text-main)",borderLeft:"3px solid var(--accent)"},WO={width:"100%",background:"var(--bg-app)",border:"1px solid var(--border)",color:"var(--text-main)",padding:"6px",borderRadius:"4px",fontSize:"12px",outline:"none"},YO={width:"100%",background:"transparent",border:"1px dashed var(--border)",color:"var(--text-muted)",padding:"8px",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},GO={position:"absolute",top:"-40px",left:"10px",right:"10px",background:"var(--text-main)",color:"var(--bg-app)",padding:"8px 12px",borderRadius:"4px",fontSize:"12px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 4px 10px rgba(0,0,0,0.5)",animation:"fadeIn 0.2s ease-out",zIndex:10},KO={background:"transparent",border:"none",color:"var(--accent)",fontWeight:"bold",cursor:"pointer",fontSize:"11px",textDecoration:"underline"},XO=()=>{const[t,e]=R.useState(""),[n,i]=R.useState(null),[o,s]=R.useState([]),[a,u]=R.useState(!1),[d,h]=R.useState(null),p=async x=>{if(x.preventDefault(),!!t.trim()){u(!0),h(null),i(null),s([]);try{const v=await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${t}`);if(!v.ok)throw new Error("Word not found.");const S=await v.json();i(S[0]);const w=await(await fetch(`https://api.datamuse.com/words?rel_syn=${t}`)).json();s(w.slice(0,15))}catch(v){h(v.message)}finally{u(!1)}}},g=x=>{e(x),document.getElementById("word-search-btn").click()};return b.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",color:"var(--text-main)"},children:[b.jsxs("form",{onSubmit:p,style:{display:"flex",gap:"5px",marginBottom:"15px"},children:[b.jsx("input",{type:"text",value:t,onChange:x=>e(x.target.value),placeholder:"Look up a word...",style:JO}),b.jsx("button",{id:"word-search-btn",type:"submit",style:QO,disabled:a,children:a?"...":""})]}),d&&b.jsx("div",{style:{color:"#e74c3c",fontSize:"13px",textAlign:"center",marginTop:"20px"},children:d}),b.jsxs("div",{style:{flex:1,overflowY:"auto",paddingRight:"5px"},children:[n&&b.jsxs("div",{children:[b.jsxs("div",{style:{borderBottom:"1px solid var(--border)",paddingBottom:"10px",marginBottom:"15px"},children:[b.jsx("h2",{style:{margin:"0 0 5px 0",fontSize:"24px",textTransform:"capitalize"},children:n.word}),b.jsx("div",{style:{fontSize:"12px",color:"var(--accent)",fontFamily:"monospace"},children:n.phonetic})]}),o.length>0&&b.jsxs("div",{style:{marginBottom:"20px"},children:[b.jsx("div",{style:Qb,children:"SYNONYMS"}),b.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"5px"},children:o.map((x,v)=>b.jsx("span",{onClick:()=>g(x.word),style:ZO,children:x.word},v))})]}),n.meanings.map((x,v)=>b.jsxs("div",{style:{marginBottom:"20px"},children:[b.jsx("div",{style:{...Qb,color:"var(--text-main)",fontStyle:"italic"},children:x.partOfSpeech}),b.jsx("ul",{style:{paddingLeft:"15px",margin:"5px 0",fontSize:"13px",lineHeight:"1.5",color:"var(--text-muted)"},children:x.definitions.slice(0,3).map((S,k)=>b.jsxs("li",{style:{marginBottom:"5px"},children:[S.definition,S.example&&b.jsxs("div",{style:{color:"#666",fontSize:"11px",marginTop:"2px"},children:['"',S.example,'"']})]},k))})]},v))]}),!n&&!a&&!d&&b.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",fontSize:"12px",marginTop:"40px"},children:"Enter a word above to find definitions and synonyms."})]})]})},JO={flex:1,background:"var(--bg-app)",border:"1px solid var(--border)",color:"var(--text-main)",padding:"8px",borderRadius:"4px",outline:"none"},QO={background:"var(--bg-header)",border:"1px solid var(--border)",color:"var(--text-main)",width:"40px",borderRadius:"4px",cursor:"pointer"},Qb={fontSize:"10px",fontWeight:"bold",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"1px",marginBottom:"8px"},ZO={background:"rgba(255,255,255,0.05)",border:"1px solid var(--border)",borderRadius:"12px",padding:"2px 10px",fontSize:"11px",color:"var(--accent)",cursor:"pointer",transition:"all 0.2s"},VS=document.createElement("style");VS.innerHTML=`
  span[style*="cursor: pointer"]:hover { background: var(--accent) !important; color: white !important; }
`;document.head.appendChild(VS);const qS=({folder:t,allFolders:e,allItems:n,level:i,onToggle:o,onCreateFolder:s,onCreateItem:a,onNavigate:u,onDeleteFolder:d,onMoveItem:h,onDeleteItem:p,onReorderFolders:g})=>{const x=e.filter(T=>T.parentId===t.id),v=n.filter(T=>T.folderId===t.id),S=t.isOpen,k=`${i*15+10}px`,w=T=>{T.stopPropagation(),T.dataTransfer.setData("dragType","folder"),T.dataTransfer.setData("folderId",t.id),T.dataTransfer.effectAllowed="move"},E=T=>{T.preventDefault(),T.stopPropagation(),T.currentTarget.style.borderTop="2px solid var(--accent)"},A=T=>{T.preventDefault(),T.currentTarget.style.borderTop="1px solid transparent"},D=T=>{if(T.preventDefault(),T.stopPropagation(),T.currentTarget.style.borderTop="1px solid transparent",T.dataTransfer.getData("dragType")==="folder"){const N=T.dataTransfer.getData("folderId");N!==t.id&&g(N,t.id)}else{const N=T.dataTransfer.getData("itemId");N&&h(N,t.id)}},L=(T,z)=>{T.stopPropagation(),T.dataTransfer.setData("dragType","item"),T.dataTransfer.setData("itemId",z)};return b.jsxs("div",{style:{userSelect:"none"},children:[b.jsxs("div",{className:"omnibus-row",style:{...Vp,paddingLeft:k},draggable:"true",onDragStart:w,onDragOver:E,onDragLeave:A,onDrop:D,children:[b.jsxs("div",{onClick:()=>o(t.id),style:{display:"flex",alignItems:"center",gap:"5px",flex:1,cursor:"pointer",overflow:"hidden",minWidth:0},children:[b.jsx("span",{style:{fontSize:"10px",color:"var(--text-muted)",flexShrink:0},children:S?"":""}),b.jsxs("span",{style:{fontWeight:"bold",color:"var(--accent)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[" ",t.name]})]}),b.jsxs("div",{className:"folder-actions",style:{display:"flex",gap:"2px",marginLeft:"5px"},children:[b.jsx("button",{onClick:T=>{T.stopPropagation(),s(t.id)},className:"icon-btn",title:"New Subfolder",children:"+"}),b.jsx("button",{onClick:T=>{T.stopPropagation(),a(t.id)},className:"icon-btn",title:"New Item",children:"+"}),b.jsx("button",{onClick:T=>{T.stopPropagation(),d(t.id)},className:"icon-btn delete-btn",title:"Delete",children:""})]})]}),S&&b.jsxs("div",{children:[x.map(T=>b.jsx(qS,{folder:T,allFolders:e,allItems:n,level:i+1,onToggle:o,onCreateFolder:s,onCreateItem:a,onNavigate:u,onDeleteFolder:d,onMoveItem:h,onDeleteItem:p,onReorderFolders:g},T.id)),v.map(T=>b.jsxs("div",{onClick:()=>u(T.id),className:"omnibus-item",draggable:"true",onDragStart:z=>L(z,T.id),style:{...Vp,paddingLeft:`${(i+1)*15+15}px`,cursor:"grab"},children:[b.jsx("span",{style:{flex:1,color:"var(--text-main)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:T.name}),b.jsx("button",{onClick:z=>{z.stopPropagation(),p(T.id)},className:"icon-btn delete-item-btn",title:"Delete Entity",children:""})]},T.id)),x.length===0&&v.length===0&&b.jsx("div",{style:{paddingLeft:`${(i+1)*15+15}px`,fontSize:"11px",color:"#555",fontStyle:"italic",paddingTop:"5px",paddingBottom:"5px"},children:"(Empty)"})]})]})},eR=()=>{const{projectData:t,setProjectData:e}=Tt(),n=Er(),[i,o]=R.useState({isOpen:!1,type:"confirm",title:"",message:"",onConfirm:()=>{}}),[s,a]=R.useState("lore"),[u,d]=R.useState("");R.useEffect(()=>{if(t.lore&&!t.lore.folders){const B=[{id:"root_char",name:"Characters",parentId:null,isOpen:!0},{id:"root_loc",name:"Locations",parentId:null,isOpen:!0},{id:"root_misc",name:"Unsorted",parentId:null,isOpen:!0}];e({...t,lore:{...t.lore,folders:B}})}},[t]);const h=B=>{e({...t,lore:{...t.lore,...B}})},p=()=>o({...i,isOpen:!1}),g=B=>{const _=t.lore.folders.map(W=>W.id===B?{...W,isOpen:!W.isOpen}:W);h({folders:_})},x=B=>{o({isOpen:!0,type:"input",title:B?"New Sub-Folder":"New Root Folder",message:"Name:",defaultValue:"New Folder",onConfirm:_=>{if(!_)return;const W={id:Date.now().toString(),name:_,parentId:B,isOpen:!0};h({folders:[...t.lore.folders||[],W]}),p()}})},v=B=>{const _=Date.now(),W={id:_,folderId:B,name:"New Entity",type:"character",imageSrc:null,sections:[{id:1,title:"Identity",blocks:[]}]};h({characters:[...t.lore.characters||[],W]}),n(`/lore?id=${_}`)},S=B=>{o({isOpen:!0,type:"confirm",title:"Delete Folder?",message:"Items inside will be moved to Unsorted.",onConfirm:()=>{const _=t.lore.characters.map(oe=>oe.folderId===B?{...oe,folderId:"root_misc"}:oe),W=t.lore.folders.filter(oe=>oe.id!==B);h({folders:W,characters:_}),p()}})},k=(B,_)=>{const W=t.lore.characters.find(re=>re.id==B),oe=t.lore.folders.find(re=>re.id===_);!W||!oe||W.folderId===_||o({isOpen:!0,type:"confirm",title:"Move Item",message:`Move "${W.name}" to folder "${oe.name}"?`,onConfirm:()=>{const re=t.lore.characters.map(fe=>fe.id==B?{...fe,folderId:_}:fe);h({characters:re}),p()}})},w=B=>{o({isOpen:!0,type:"confirm",title:"Delete Entity?",message:"Permanently delete this item?",onConfirm:()=>{const _=t.lore.characters.filter(W=>W.id!==B);h({characters:_}),window.location.search.includes(B)&&n("/lore"),p()}})},E=(B,_)=>{if(B===_)return;const W=[...t.lore.folders],oe=W.findIndex(he=>he.id===B),re=W.findIndex(he=>he.id===_);if(oe===-1||re===-1)return;const[fe]=W.splice(oe,1);W.splice(re,0,fe),h({folders:W})},A=B=>{e({...t,globalNotes:B.target.value})},D=t.lore?.folders||[],L=t.lore?.characters||[],T=D.filter(B=>B.parentId===null),N=(()=>{if(!u)return[];const B=u.toLowerCase();return L.filter(_=>{const W=_.name?.toLowerCase().includes(B),oe=Array.isArray(_.aliases)&&_.aliases.some(re=>re.toLowerCase().includes(B));return W||oe})})();return b.jsxs("aside",{style:tR,children:[b.jsx(Wt,{isOpen:i.isOpen,type:i.type,title:i.title,message:i.message,defaultValue:i.defaultValue,onConfirm:i.onConfirm,onCancel:p}),b.jsxs("div",{style:rR,children:[b.jsx("button",{onClick:()=>a("lore"),style:s==="lore"?Kh:Jc,children:" Tree"}),b.jsx("button",{onClick:()=>a("notes"),style:s==="notes"?Kh:Jc,children:" Notes"}),b.jsx("button",{onClick:()=>a("dict"),style:s==="dict"?Kh:Jc,children:" Dict"})]}),b.jsxs("div",{style:nR,children:[s==="lore"&&b.jsxs(b.Fragment,{children:[b.jsxs("div",{style:iR,children:[b.jsx("span",{children:"OMNIBUS TREE"}),b.jsx("button",{onClick:()=>x(null),className:"icon-btn",style:{fontSize:"14px",fontWeight:"bold"},children:"+"})]}),b.jsx("div",{style:{padding:"8px 10px",borderBottom:"1px solid var(--border)"},children:b.jsx("input",{type:"text",placeholder:" Filter Name/Tag...",value:u,onChange:B=>d(B.target.value),style:oR})}),b.jsx("div",{className:"custom-scrollbar",style:{flex:1,overflowY:"auto",paddingBottom:"20px"},children:u?b.jsxs("div",{style:{padding:"5px"},children:[N.length===0&&b.jsx("div",{style:{padding:"10px",color:"#666",fontSize:"12px",fontStyle:"italic"},children:"No matches found."}),N.map(B=>b.jsxs("div",{onClick:()=>n(`/lore?id=${B.id}`),className:"omnibus-item",style:{...Vp,cursor:"pointer",borderRadius:"4px",marginBottom:"2px",display:"flex",alignItems:"center"},children:[b.jsx("span",{style:{fontSize:"12px",marginRight:"6px"},children:""}),b.jsxs("div",{style:{flex:1,overflow:"hidden"},children:[b.jsx("div",{style:{fontWeight:"bold",fontSize:"13px",color:"var(--text-main)"},children:B.name}),B.aliases&&B.aliases.length>0&&b.jsx("div",{style:{fontSize:"10px",color:"var(--accent)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:B.aliases.join(", ")})]})]},B.id))]}):T.map(B=>b.jsx(qS,{folder:B,allFolders:D,allItems:L,level:0,onToggle:g,onCreateFolder:x,onCreateItem:v,onNavigate:_=>n(`/lore?id=${_}`),onDeleteFolder:S,onMoveItem:k,onDeleteItem:w,onReorderFolders:E},B.id))})]}),s==="notes"&&b.jsx("textarea",{value:t.globalNotes||"",onChange:A,placeholder:"Global scratchpad...",style:lR,className:"custom-scrollbar"}),s==="dict"&&b.jsx("div",{style:{padding:"15px",height:"100%"},className:"custom-scrollbar",children:b.jsx(XO,{})})]}),b.jsx("style",{children:`
        /* UPDATED ROW STYLE FOR FLEX */
        .omnibus-row { display: flex !important; align-items: center; justify-content: space-between; }
        
        .icon-btn { background: transparent; border: none; color: var(--text-muted); cursor: pointer; font-size: 10px; padding: 2px 4px; opacity: 0; transition: opacity 0.2s; }
        .folder-actions .icon-btn { opacity: 0; }
        
        /* SHOW BUTTONS ON HOVER */
        .omnibus-row:hover .folder-actions .icon-btn { opacity: 1; }
        .omnibus-row:hover { background-color: rgba(0,0,0,0.2); }
        
        .icon-btn:hover { color: var(--text-main); background: rgba(255,255,255,0.1); border-radius: 4px; }
        .delete-btn:hover { color: red !important; }

        .delete-item-btn { opacity: 0; }
        .omnibus-item:hover .delete-item-btn { opacity: 1; }
        .omnibus-item:hover { background-color: var(--accent); color: white !important; }

        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: transparent; }
        .custom-scrollbar:hover::-webkit-scrollbar-thumb { background: #444; border-radius: 2px; }
      `})]})},tR={width:"250px",background:"var(--bg-panel)",borderLeft:"1px solid var(--border)",display:"flex",flexDirection:"column",height:"100%"},nR={flex:1,overflowY:"hidden",display:"flex",flexDirection:"column"},iR={padding:"10px",background:"var(--bg-header)",borderBottom:"1px solid var(--border)",fontWeight:"bold",fontSize:"11px",color:"var(--text-muted)",letterSpacing:"1px",display:"flex",justifyContent:"space-between",alignItems:"center"},Vp={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px 8px",borderBottom:"1px solid transparent",minHeight:"28px"},rR={display:"flex",borderBottom:"1px solid var(--border)"},Jc={flex:1,background:"transparent",border:"none",color:"var(--text-muted)",padding:"10px 5px",cursor:"pointer",fontSize:"11px",fontWeight:"bold",borderBottom:"2px solid transparent"},Kh={...Jc,background:"var(--bg-header)",color:"var(--text-main)",borderBottom:"2px solid var(--accent)"},oR={width:"100%",background:"var(--bg-app)",border:"1px solid var(--border)",color:"var(--text-main)",padding:"6px",borderRadius:"4px",fontSize:"12px",outline:"none"},lR={width:"100%",height:"100%",background:"transparent",border:"none",color:"var(--text-main)",fontSize:"14px",lineHeight:"1.5",outline:"none",resize:"none",padding:"15px"},sR=({isOpen:t,onClose:e})=>{const{projectData:n}=Tt(),[i,o]=R.useState([]),[s,a]=R.useState("html"),[u,d]=R.useState({includeTitles:!0,pageBreaks:!0}),[h,p]=R.useState(!1);R.useEffect(()=>{t&&n.manuscript.chapters&&o(n.manuscript.chapters.map(E=>E.id))},[t,n]);const g=E=>{i.includes(E)?o(i.filter(A=>A!==E)):o([...i,E])},x=()=>o(n.manuscript.chapters.map(E=>E.id)),v=()=>o([]),S=E=>{const A=document.createElement("DIV");return A.innerHTML=E,A.textContent||A.innerText||""},k=()=>{const E=n.manuscript.chapters.filter(D=>i.includes(D.id));if(E.length===0)return null;let A="";return["html","doc","pdf"].includes(s)?(A+=`
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="utf-8">
          <title>${n.title||"Export"}</title>
          <style>
            body { font-family: 'Times New Roman', serif; line-height: 1.6; max-width: 800px; margin: 0 auto; padding: 40px; color: black; background: white; }
            h1 { text-align: center; margin-top: 100px; margin-bottom: 50px; page-break-before: always; }
            p { margin-bottom: 1em; text-indent: 2em; }
            .page-break { page-break-after: always; }
            img { max-width: 100%; height: auto; }
          </style>
        </head>
        <body>
      `,E.forEach((D,L)=>{u.pageBreaks&&L>0&&(A+='<div class="page-break"></div>'),u.includeTitles&&(A+=`<h1>${D.title}</h1>`),A+=D.content}),A+="</body></html>"):s==="txt"?E.forEach((D,L)=>{L>0&&(A+=`

------------------------------------------------

`),u.includeTitles&&(A+=`${D.title.toUpperCase()}

`);let T=D.content.replace(/<\/p>/g,`

`).replace(/<br>/g,`
`);A+=S(T)}):s==="md"&&E.forEach((D,L)=>{L>0&&(A+=`

---

`),u.includeTitles&&(A+=`# ${D.title}

`);let T=D.content.replace(/<b>/g,"**").replace(/<\/b>/g,"**").replace(/<i>/g,"*").replace(/<\/i>/g,"*").replace(/<\/p>/g,`

`);A+=S(T)}),A},w=()=>{const E=k();if(!E){p(!0);return}if(s==="pdf"){const N=window.open("","_blank");N.document.write(E),N.document.close(),N.focus(),setTimeout(()=>{N.print(),N.close()},500),e();return}let A="text/plain",D="txt";s==="html"&&(A="text/html",D="html"),s==="doc"&&(A="application/msword",D="doc"),s==="md"&&(A="text/markdown",D="md");const L=new Blob([E],{type:A}),T=URL.createObjectURL(L),z=document.createElement("a");z.href=T,z.download=`${n.title||"Draft"}_Export.${D}`,document.body.appendChild(z),z.click(),document.body.removeChild(z),e()};return t?b.jsxs("div",{style:aR,children:[b.jsxs("div",{style:cR,children:[b.jsx("div",{style:uR,children:"Compile Manuscript"}),b.jsx("div",{style:dR,children:b.jsxs("div",{style:{display:"flex",gap:"20px",height:"300px"},children:[b.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",borderRight:"1px solid var(--border)",paddingRight:"15px"},children:[b.jsx("div",{style:{fontWeight:"bold",marginBottom:"10px",fontSize:"12px",color:"var(--text-muted)"},children:"SELECT CHAPTERS"}),b.jsx("div",{style:{flex:1,overflowY:"auto",background:"var(--bg-app)",border:"1px solid var(--border)",borderRadius:"4px",padding:"5px"},children:n.manuscript.chapters.map(E=>b.jsxs("label",{style:hR,children:[b.jsx("input",{type:"checkbox",checked:i.includes(E.id),onChange:()=>g(E.id),style:{marginRight:"8px"}}),b.jsx("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:E.title})]},E.id))}),b.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:[b.jsx("button",{onClick:x,style:Zb,children:"All"}),b.jsx("button",{onClick:v,style:Zb,children:"None"})]})]}),b.jsxs("div",{style:{width:"180px",display:"flex",flexDirection:"column",gap:"15px"},children:[b.jsxs("div",{children:[b.jsx("div",{style:ev,children:"FORMAT"}),b.jsxs("select",{value:s,onChange:E=>a(E.target.value),style:pR,children:[b.jsx("option",{value:"html",children:"HTML (Web Book)"}),b.jsx("option",{value:"doc",children:"DOC (Word)"}),b.jsx("option",{value:"pdf",children:"PDF (Print)"}),b.jsx("option",{value:"txt",children:"TXT (Plain Text)"}),b.jsx("option",{value:"md",children:"Markdown"})]})]}),b.jsxs("div",{children:[b.jsx("div",{style:ev,children:"OPTIONS"}),b.jsxs("label",{style:tv,children:[b.jsx("input",{type:"checkbox",checked:u.includeTitles,onChange:E=>d({...u,includeTitles:E.target.checked})}),"Include Titles"]}),["html","doc","pdf"].includes(s)&&b.jsxs("label",{style:tv,children:[b.jsx("input",{type:"checkbox",checked:u.pageBreaks,onChange:E=>d({...u,pageBreaks:E.target.checked})}),"Page Breaks"]})]}),b.jsxs("div",{style:{marginTop:"auto",fontSize:"11px",color:"var(--text-muted)",lineHeight:"1.4"},children:[s==="doc"&&"Note: Generates a Word-compatible file. Save as .docx inside Word.",s==="pdf"&&"Note: Opens Print dialog. Choose 'Save as PDF'."]})]})]})}),b.jsxs("div",{style:fR,children:[b.jsx("button",{onClick:e,style:mR,children:"Cancel"}),b.jsxs("button",{onClick:w,style:gR,children:["Export ",s.toUpperCase()]})]})]}),b.jsx(Wt,{isOpen:h,type:"alert",title:"Selection Required",message:"Please select at least one chapter to export.",onConfirm:()=>p(!1)})]}):null},aR={position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",zIndex:3e3,display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(2px)"},cR={background:"var(--bg-panel)",border:"1px solid var(--border)",borderRadius:"8px",width:"600px",boxShadow:"0 10px 30px rgba(0,0,0,0.5)"},uR={padding:"15px",borderBottom:"1px solid var(--border)",fontWeight:"bold",color:"var(--text-main)",fontSize:"14px"},dR={padding:"20px",color:"var(--text-main)",fontSize:"13px"},fR={padding:"10px 15px",background:"var(--bg-header)",borderTop:"1px solid var(--border)",display:"flex",justifyContent:"flex-end",gap:"10px",borderBottomLeftRadius:"8px",borderBottomRightRadius:"8px"},hR={display:"flex",alignItems:"center",padding:"4px",cursor:"pointer",borderBottom:"1px solid rgba(255,255,255,0.05)"},Zb={flex:1,padding:"4px",background:"var(--bg-header)",border:"1px solid var(--border)",color:"var(--text-muted)",fontSize:"10px",cursor:"pointer",borderRadius:"3px"},ev={fontWeight:"bold",fontSize:"11px",color:"var(--text-muted)",marginBottom:"5px"},pR={width:"100%",padding:"6px",background:"var(--bg-app)",border:"1px solid var(--border)",color:"var(--text-main)",borderRadius:"4px"},tv={display:"flex",gap:"8px",alignItems:"center",marginBottom:"8px",cursor:"pointer"},FS={padding:"8px 20px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",border:"none"},mR={...FS,background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border)"},gR={...FS,background:"var(--accent)",color:"white",fontWeight:"bold"},yR=({isOpen:t,onClose:e})=>{const{projectData:n}=Tt(),[i,o]=R.useState([]),[s,a]=R.useState("json"),[u,d]=R.useState(!1);R.useEffect(()=>{t&&n.lore.characters&&o(n.lore.characters.map(w=>w.id))},[t,n]);const h=w=>{i.includes(w)?o(i.filter(E=>E!==w)):o([...i,w])},p=()=>o(n.lore.characters.map(w=>w.id)),g=()=>o([]),x=w=>{const E=document.createElement("DIV");return E.innerHTML=w,E.textContent||E.innerText||""},v=w=>{if(w.biography&&w.biography.trim().length>0)return w.biography;if(!w.sections||w.sections.length===0)return"";for(let E of w.sections)for(let A of E.blocks)if(["summary","description","biography"].includes(A.label.toLowerCase())&&A.content)return A.content;return""},S=()=>{const w=n.lore.characters.filter(E=>i.includes(E.id));switch(s){case"json":return JSON.stringify(w,null,2);case"html":let E=`<html><head><title>${n.title||"Project"} - Lore Cards</title></head><body>`;return E+=`<h1>${n.title||"Project"} - Lore Cards</h1>`,w.forEach(L=>{E+='<div style="margin-bottom: 30px; border: 1px solid #ccc; padding: 20px;">',E+=`<h2>${L.name||"Unnamed"}</h2>`,L.aliases&&L.aliases.length>0&&(E+=`<p><strong>Aliases:</strong> ${L.aliases.join(", ")}</p>`),E+=`<p><strong>Type:</strong> ${L.type||"Unknown"}</p>`;const T=v(L);T&&(E+=`<div><strong>Biography:</strong><br>${T}</div>`),E+="</div>"}),E+="</body></html>",E;case"txt":let A=`${n.title||"Project"} - Lore Cards

`;return w.forEach((L,T)=>{A+=`${T+1}. ${L.name||"Unnamed"}
`,L.aliases&&L.aliases.length>0&&(A+=`   Aliases: ${L.aliases.join(", ")}
`),A+=`   Type: ${L.type||"Unknown"}
`;const z=x(v(L));z&&(A+=`   Biography: ${z}
`),A+=`
`}),A;case"md":let D=`# ${n.title||"Project"} - Lore Cards

`;return w.forEach(L=>{D+=`## ${L.name||"Unnamed"}

`,L.aliases&&L.aliases.length>0&&(D+=`**Aliases:** ${L.aliases.join(", ")}

`),D+=`**Type:** ${L.type||"Unknown"}

`;const T=x(v(L));T&&(D+=`**Biography:**
${T}

`),D+=`---

`}),D;default:return JSON.stringify(w,null,2)}},k=()=>{if(i.length===0){d(!0);return}const w=S(),E=`${n.title||"project"}_lore_cards_${new Date().toISOString().slice(0,10)}`,A={json:"application/json",html:"text/html",txt:"text/plain",md:"text/markdown"},D=new Blob([w],{type:A[s]||"text/plain"}),L=URL.createObjectURL(D),T=document.createElement("a");T.href=L,T.download=`${E}.${s}`,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(L),e()};return t?b.jsxs(b.Fragment,{children:[b.jsx("div",{style:nv,children:b.jsxs("div",{style:iv,children:[b.jsx("div",{style:rv,children:"Export Lore Cards"}),b.jsxs("div",{style:ov,children:[b.jsxs("div",{style:{marginBottom:"20px"},children:[b.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold"},children:"Export Format:"}),b.jsxs("select",{value:s,onChange:w=>a(w.target.value),style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc",background:"var(--bg-input)",color:"var(--text-main)",width:"200px"},children:[b.jsx("option",{value:"json",children:"JSON"}),b.jsx("option",{value:"html",children:"HTML"}),b.jsx("option",{value:"txt",children:"Plain Text"}),b.jsx("option",{value:"md",children:"Markdown"})]})]}),b.jsxs("div",{style:{marginBottom:"20px"},children:[b.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"},children:[b.jsx("button",{onClick:p,style:{padding:"5px 10px",fontSize:"12px"},children:"Select All"}),b.jsx("button",{onClick:g,style:{padding:"5px 10px",fontSize:"12px"},children:"Select None"})]}),b.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",border:"1px solid #ccc",borderRadius:"4px",padding:"10px"},children:n.lore.characters.map(w=>b.jsxs("label",{style:{display:"block",padding:"5px",marginBottom:"5px",background:i.includes(w.id)?"rgba(0,123,255,0.1)":"transparent",borderRadius:"3px",cursor:"pointer"},children:[b.jsx("input",{type:"checkbox",checked:i.includes(w.id),onChange:()=>h(w.id),style:{marginRight:"8px"}}),w.name||"Unnamed"," (",w.type||"Unknown",")"]},w.id))})]}),b.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[b.jsx("button",{onClick:e,style:{padding:"10px 20px"},children:"Cancel"}),b.jsxs("button",{onClick:k,style:{padding:"10px 20px",background:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:["Export ",i.length," Card",i.length!==1?"s":""]})]})]})]})}),u&&b.jsx("div",{style:nv,children:b.jsxs("div",{style:iv,children:[b.jsx("div",{style:rv,children:"No Cards Selected"}),b.jsxs("div",{style:ov,children:[b.jsx("p",{children:"Please select at least one lore card to export."}),b.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:b.jsx("button",{onClick:()=>d(!1),style:{padding:"10px 20px"},children:"OK"})})]})]})})]}):null},nv={position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",zIndex:3e3,display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(2px)"},iv={background:"var(--bg-panel)",border:"1px solid var(--border)",borderRadius:"8px",width:"600px",boxShadow:"0 10px 30px rgba(0,0,0,0.5)"},rv={padding:"15px",borderBottom:"1px solid var(--border)",fontWeight:"bold",color:"var(--text-main)",fontSize:"14px"},ov={padding:"20px",color:"var(--text-main)",fontSize:"13px"},xR={title:"Untitled Project",manuscript:{chapters:[{id:1,title:"Chapter 1",content:"<p>Once upon a time...</p>"}]},lore:{characters:[],folders:[{id:"root_char",name:"Characters",parentId:null,isOpen:!0},{id:"root_loc",name:"Locations",parentId:null,isOpen:!0},{id:"root_misc",name:"Unsorted",parentId:null,isOpen:!0}]},worldMap:{imageSrc:null,pins:[]}},bR=({toggleTheme:t,isZenMode:e,toggleZenMode:n})=>{const{projectData:i,setProjectData:o}=Tt(),s=Er(),[a,u]=R.useState(null),[d,h]=R.useState(!1),[p,g]=R.useState(!1),[x,v]=R.useState({isOpen:!1,type:"confirm",title:"",message:"",onConfirm:()=>{}}),S=()=>v({...x,isOpen:!1}),k=R.useRef(null);R.useEffect(()=>{const z=N=>{k.current&&!k.current.contains(N.target)&&u(null)};return document.addEventListener("mousedown",z),()=>document.removeEventListener("mousedown",z)},[]);const w=()=>{u(null),v({isOpen:!0,type:"confirm",title:"Create New Project?",message:" Warning: Any unsaved changes to the current project will be lost. Make sure to Save first.",onConfirm:()=>{o(xR),s("/"),S()}})},E=()=>{D(i,i.title||"project"),u(null)},A=()=>{u(null),v({isOpen:!0,type:"input",title:"Save Project As...",message:"Enter a name for this version:",defaultValue:i.title||"New Project",onConfirm:z=>{const N={...i,title:z};o(N),D(N,z),S()}})},D=(z,N)=>{const B="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(z)),_=document.createElement("a");_.setAttribute("href",B),_.setAttribute("download",`${N}.json`),document.body.appendChild(_),_.click(),_.remove()},L=z=>{const N=z.target.files[0];if(!N)return;const B=new FileReader;B.onload=_=>{try{const W=JSON.parse(_.target.result);o(W),alert("Project Loaded Successfully!"),s("/")}catch{alert("Failed to load project file. It might be corrupted.")}},B.readAsText(N),u(null)},T=({label:z,name:N,children:B})=>b.jsxs("div",{style:{position:"relative"},children:[b.jsx("div",{onClick:()=>u(a===N?null:N),style:{...SR,background:a===N?"rgba(255,255,255,0.1)":"transparent"},children:z}),a===N&&b.jsx("div",{style:wR,children:B})]});return b.jsxs(b.Fragment,{children:[b.jsx(sR,{isOpen:d,onClose:()=>h(!1)}),b.jsx(yR,{isOpen:p,onClose:()=>g(!1)}),b.jsx(Wt,{isOpen:x.isOpen,type:x.type,title:x.title,message:x.message,defaultValue:x.defaultValue,onConfirm:x.onConfirm,onCancel:S}),b.jsxs("div",{ref:k,style:vR,children:[b.jsxs("div",{style:{fontWeight:"bold",marginRight:"20px",color:"var(--accent)",letterSpacing:"1px"},children:["SEYMOUR",i.title&&b.jsxs("span",{style:{fontWeight:"normal",color:"#666",fontSize:"12px",marginLeft:"10px"},children:[" ",i.title]})]}),b.jsxs("div",{style:{display:"flex"},children:[b.jsxs(T,{label:"File",name:"file",children:[b.jsx("button",{style:mi,onClick:w,children:" New Project"}),b.jsx("div",{style:{height:1,background:"#444",margin:"5px 0"}}),b.jsxs("label",{style:mi,children:[" Load Project...",b.jsx("input",{type:"file",accept:".json",onChange:L,style:{display:"none"}})]}),b.jsx("div",{style:{height:1,background:"#444",margin:"5px 0"}}),b.jsx("button",{style:mi,onClick:E,children:" Save"}),b.jsx("button",{style:mi,onClick:A,children:" Save As..."}),b.jsx("div",{style:{height:1,background:"#444",margin:"5px 0"}}),b.jsx("button",{style:mi,onClick:()=>{h(!0),u(null)},children:" Compile Manuscript..."}),b.jsx("button",{style:mi,onClick:()=>{g(!0),u(null)},children:" Export Lore Cards..."})]}),b.jsxs(T,{label:"View",name:"view",children:[b.jsx("button",{style:mi,onClick:t,children:" Toggle Theme"}),b.jsx("button",{style:mi,onClick:n,children:e?"Show Sidebars":"Zen Mode (Hide Sidebars)"})]}),b.jsx(T,{label:"Help",name:"help",children:b.jsx("button",{style:mi,onClick:()=>alert(`Seymour v4.0

The Ultimate World Building Tool.`),children:"About Seymour"})})]})]})]})},vR={height:"35px",background:"#1a1a1a",borderBottom:"1px solid #333",display:"flex",alignItems:"center",padding:"0 15px",fontSize:"13px",color:"#ccc",userSelect:"none",zIndex:2e3},SR={padding:"4px 10px",cursor:"pointer",borderRadius:"4px",marginRight:"5px"},wR={position:"absolute",top:"100%",left:0,background:"#252525",border:"1px solid #444",borderRadius:"4px",padding:"5px 0",minWidth:"180px",boxShadow:"0 10px 20px rgba(0,0,0,0.5)",zIndex:2001},mi={display:"block",width:"100%",padding:"8px 15px",textAlign:"left",background:"transparent",border:"none",color:"#eee",cursor:"pointer",fontSize:"12px",textDecoration:"none"},WS=document.createElement("style");WS.innerHTML=`
  button:hover { background-color: rgba(255,255,255,0.1) !important; }
`;document.head.appendChild(WS);const CR=({toggleTheme:t,toggleZenMode:e})=>{const{projectData:n}=Tt(),i=Er(),[o,s]=R.useState(!1),[a,u]=R.useState(""),[d,h]=R.useState([]),[p,g]=R.useState(0),x=R.useRef(null);R.useEffect(()=>{const k=w=>{(w.ctrlKey||w.metaKey)&&w.key==="k"&&(w.preventDefault(),s(E=>!E)),o&&(w.key==="Escape"?s(!1):w.key==="ArrowDown"?(w.preventDefault(),g(E=>(E+1)%d.length)):w.key==="ArrowUp"?(w.preventDefault(),g(E=>(E-1+d.length)%d.length)):w.key==="Enter"&&(w.preventDefault(),S(d[p])))};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[o,d,p]),R.useEffect(()=>{o&&(u(""),g(0),setTimeout(()=>x.current?.focus(),50))},[o]),R.useEffect(()=>{if(!o)return;if(!a){h(v());return}const k=a.toLowerCase(),w=[];(n.manuscript?.chapters||[]).forEach(T=>{T.title.toLowerCase().includes(k)&&w.push({id:T.id,type:"Chapter",label:T.title,icon:"",action:()=>i(`/editor?id=${T.id}`)})}),(n.lore?.characters||[]).forEach(T=>{const z=T.name.toLowerCase().includes(k),N=T.aliases?.some(B=>B.toLowerCase().includes(k));(z||N)&&w.push({id:T.id,type:"Lore",label:T.name,icon:"",sub:N?`Matches alias "${k}"`:null,action:()=>i(`/lore?id=${T.id}`)})});const D=n.worldMap;(Array.isArray(D)?D:D?[D]:[]).forEach(T=>{const z=T.name||"Global Map";z.toLowerCase().includes(k)&&w.push({id:T.id||"default",type:"Map",label:z,icon:"",action:()=>i("/map")})}),v().forEach(T=>{T.label.toLowerCase().includes(k)&&w.push(T)}),h(w.slice(0,10)),g(0)},[a,o,n]);const v=()=>[{type:"Action",label:"Toggle Dark/Light Mode",icon:"",action:t},{type:"Action",label:"Toggle Zen Mode",icon:"",action:e},{type:"Nav",label:"Go to Timeline",icon:"",action:()=>i("/timeline")},{type:"Nav",label:"Go to The Web",icon:"",action:()=>i("/web")},{type:"Nav",label:"Go to Scratchpad",icon:"",action:()=>i("/scratchpad")}],S=k=>{k&&k.action&&(k.action(),s(!1))};return o?b.jsx("div",{style:kR,onClick:()=>s(!1),children:b.jsxs("div",{style:ER,onClick:k=>k.stopPropagation(),children:[b.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",borderBottom:"1px solid var(--border)"},children:[b.jsx("span",{style:{marginRight:"10px",fontSize:"16px"},children:""}),b.jsx("input",{ref:x,type:"text",placeholder:"Type a command or search...",value:a,onChange:k=>u(k.target.value),style:TR}),b.jsx("span",{style:{fontSize:"10px",color:"var(--text-muted)",border:"1px solid var(--border)",padding:"2px 6px",borderRadius:"4px"},children:"ESC"})]}),b.jsxs("div",{style:{maxHeight:"400px",overflowY:"auto",padding:"8px 0"},children:[d.map((k,w)=>b.jsxs("div",{onMouseEnter:()=>g(w),onClick:()=>S(k),style:{...MR,background:w===p?"var(--accent)":"transparent",color:w===p?"#fff":"var(--text-main)"},children:[b.jsx("div",{style:{width:"24px",textAlign:"center",marginRight:"10px"},children:k.icon}),b.jsxs("div",{style:{flex:1},children:[b.jsx("div",{style:{fontWeight:"bold",fontSize:"14px"},children:k.label}),k.sub&&b.jsx("div",{style:{fontSize:"11px",opacity:.8},children:k.sub})]}),b.jsx("div",{style:{fontSize:"10px",opacity:.6,textTransform:"uppercase"},children:k.type})]},w)),d.length===0&&b.jsx("div",{style:{padding:"15px",textAlign:"center",color:"var(--text-muted)",fontSize:"13px"},children:"No results found."})]}),b.jsxs("div",{style:AR,children:[b.jsxs("span",{children:["Use ",b.jsx("b",{children:""})," ",b.jsx("b",{children:""})," to navigate"]}),b.jsxs("span",{children:[b.jsx("b",{children:"Enter"})," to select"]})]})]})}):null},kR={position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",backdropFilter:"blur(2px)",zIndex:9999,display:"flex",justifyContent:"center",alignItems:"flex-start",paddingTop:"15vh"},ER={width:"600px",maxWidth:"90%",background:"var(--bg-panel)",border:"1px solid var(--border)",borderRadius:"8px",boxShadow:"0 20px 50px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column",overflow:"hidden"},TR={flex:1,background:"transparent",border:"none",fontSize:"18px",color:"var(--text-main)",outline:"none"},MR={padding:"10px 16px",cursor:"pointer",display:"flex",alignItems:"center",borderLeft:"2px solid transparent"},AR={padding:"8px 16px",background:"var(--bg-header)",borderTop:"1px solid var(--border)",display:"flex",justifyContent:"space-between",color:"var(--text-muted)",fontSize:"10px"},OR=({theme:t,toggleTheme:e})=>{const[n,i]=R.useState(!1),[o,s]=R.useState(!0),[a,u]=R.useState(!0),d=220,h=250,{saveToDisk:p}=Tt(),g=()=>{i(!n)};return R.useEffect(()=>(window.electronAPI&&(window.electronAPI.onMenuToggleTheme(()=>{e()}),window.electronAPI.onMenuZenMode(()=>{g()}),window.electronAPI.onMenuFind(()=>{console.log("Find activated from menu")})),()=>{window.electronAPI&&(window.electronAPI.removeAllListeners("menu-toggle-theme"),window.electronAPI.removeAllListeners("menu-zen-mode"),window.electronAPI.removeAllListeners("menu-find"))}),[e]),b.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",background:"var(--bg-app)",color:"var(--text-main)",overflow:"hidden"},children:[b.jsx(CR,{toggleTheme:e,toggleZenMode:g}),b.jsx(bR,{toggleTheme:e,isZenMode:n,toggleZenMode:g}),!n&&b.jsxs("div",{style:RR,children:[b.jsx("button",{onClick:()=>s(!o),style:lv,title:"Toggle Binder",children:o?" Binder":" Show Binder"}),b.jsx("div",{style:{flex:1}}),b.jsx("button",{onClick:()=>u(!a),style:lv,title:"Toggle Lore Panel",children:a?"Lore & Notes ":" Show Lore"})]}),b.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[!n&&o&&b.jsx("div",{style:{width:d,display:"flex",flexShrink:0,borderRight:"1px solid var(--border)"},children:b.jsx("div",{style:{flex:1,overflow:"hidden"},children:b.jsx(qO,{})})}),b.jsx("main",{style:{flex:1,position:"relative",overflow:"hidden",background:"var(--paper)",minWidth:0},children:b.jsx(jA,{})}),!n&&a&&b.jsx("div",{style:{width:h,display:"flex",flexShrink:0,borderLeft:"1px solid var(--border)"},children:b.jsx("div",{style:{flex:1,overflow:"hidden"},children:b.jsx(eR,{})})})]}),b.jsxs("footer",{style:DR.footer,children:[b.jsx("span",{children:"Ready."}),b.jsx("span",{children:"Auto-Save: Active"})]})]})},RR={height:"24px",background:"var(--bg-panel)",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",padding:"0 8px",flexShrink:0},lv={background:"transparent",border:"none",color:"var(--text-muted)",fontSize:"10px",cursor:"pointer",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.5px"},DR={footer:{height:"24px",background:"var(--bg-header)",borderTop:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 15px",fontSize:"11px",color:"var(--text-muted)",flexShrink:0}},sv=({value:t,onChange:e,placeholder:n,style:i})=>{const o=R.useRef(null),s=()=>{const a=o.current;a&&(a.style.height="auto",a.style.height=`${a.scrollHeight}px`)};return R.useEffect(()=>{s()},[t]),b.jsx("textarea",{ref:o,value:t,onChange:a=>{e(a.target.value),s()},placeholder:n,rows:1,style:{width:"100%",resize:"none",overflow:"hidden",background:"transparent",border:"none",color:"inherit",fontFamily:"inherit",fontSize:"inherit",outline:"none",padding:"0",minHeight:"20px",...i}})},NR=({imageSrc:t,onSave:e,onCancel:n})=>{const[i,o]=R.useState({x:0,y:0}),[s,a]=R.useState(1),[u,d]=R.useState(0),[h,p]=R.useState(!1),[g,x]=R.useState({x:0,y:0}),v=R.useRef(null),S=A=>{p(!0),x({x:A.clientX-i.x,y:A.clientY-i.y})},k=A=>{h&&o({x:A.clientX-g.x,y:A.clientY-g.y})},w=()=>{p(!1)},E=()=>{const A={backgroundImage:`url(${t})`,backgroundPosition:`${i.x}px ${i.y}px`,backgroundSize:`${s*100}%`,transform:`rotate(${u}deg)`};e(A)};return b.jsx("div",{style:jR,children:b.jsxs("div",{style:zR,children:[b.jsx("h3",{children:"Adjust Image"}),b.jsxs("div",{style:LR,onMouseMove:k,onMouseUp:w,onMouseLeave:w,children:[b.jsx("div",{ref:v,onMouseDown:S,style:{...BR,backgroundImage:`url(${t})`,backgroundPosition:`${i.x}px ${i.y}px`,backgroundSize:`${s*100}%`,transform:`rotate(${u}deg)`,cursor:h?"grabbing":"grab"}}),b.jsx("div",{style:IR})]}),b.jsxs("div",{style:_R,children:[b.jsxs("div",{style:av,children:[b.jsx("label",{children:"Zoom"}),b.jsx("input",{type:"range",min:"1",max:"5",step:"0.1",value:s,onChange:A=>a(parseFloat(A.target.value)),style:{width:"100%"}})]}),b.jsxs("div",{style:av,children:[b.jsx("label",{children:"Rotate"}),b.jsx("input",{type:"range",min:"0",max:"360",step:"1",value:u,onChange:A=>d(parseInt(A.target.value)),style:{width:"100%"}})]})]}),b.jsxs("div",{style:HR,children:[b.jsx("button",{onClick:n,style:$R,children:"Cancel"}),b.jsx("button",{onClick:E,style:UR,children:"Set Image"})]})]})})},jR={position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},zR={background:"#333",color:"white",padding:"20px",borderRadius:"8px",width:"400px",display:"flex",flexDirection:"column",gap:"20px"},LR={width:"300px",height:"300px",margin:"0 auto",position:"relative",overflow:"hidden",background:"#000",borderRadius:"4px",border:"1px solid #555"},BR={width:"100%",height:"100%",backgroundRepeat:"no-repeat"},IR={pointerEvents:"none",position:"absolute",top:0,left:0,right:0,bottom:0,border:"2px solid rgba(255, 255, 255, 0.5)",boxShadow:"inset 0 0 20px rgba(0,0,0,0.5)"},_R={display:"flex",flexDirection:"column",gap:"10px"},av={display:"grid",gridTemplateColumns:"60px 1fr",alignItems:"center",gap:"10px",fontSize:"12px"},HR={display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"10px"},UR={background:"#5c8bd6",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",fontWeight:"bold",cursor:"pointer"},$R={background:"transparent",color:"#aaa",border:"1px solid #555",padding:"8px 16px",borderRadius:"4px",cursor:"pointer"},YS=(t,e=800,n=800,i=.7)=>new Promise((o,s)=>{const a=new FileReader;a.onload=u=>{const d=new Image;d.onload=()=>{let h=d.width,p=d.height;h>p?h>e&&(p=Math.round(p*e/h),h=e):p>n&&(h=Math.round(h*n/p),p=n);const g=document.createElement("canvas");g.width=h,g.height=p;const x=g.getContext("2d");x.imageSmoothingEnabled=!0,x.imageSmoothingQuality="high",x.drawImage(d,0,0,h,p);const v=g.toDataURL("image/jpeg",i),S=u.target.result.length,k=v.length,w=((1-k/S)*100).toFixed(1);console.log(` Compressed image: ${(S/1024).toFixed(0)}KB  ${(k/1024).toFixed(0)}KB (${w}% reduction)`),o(v)},d.onerror=()=>s(new Error("Failed to load image")),d.src=u.target.result},a.onerror=()=>s(new Error("Failed to read file")),a.readAsDataURL(t)}),PR=({projectData:t,setProjectData:e,searchParams:n,setSearchParams:i})=>{const o=n.get("folderId")||null,s=t.lore.folders||[],a=t.lore.characters||[],u=s.filter(D=>D.parentId===o),d=a.filter(D=>D.folderId===o),h=s.find(D=>D.id===o),[p,g]=R.useState({isOpen:!1,type:"input",title:"",onConfirm:()=>{}}),x=D=>i({folderId:D}),v=D=>i({id:D}),S=()=>{h&&(h.parentId===null?i({}):i({folderId:h.parentId}))},k=()=>{g({isOpen:!0,type:"input",title:"New Folder Name",onConfirm:D=>{const L={id:`folder_${Date.now()}`,name:D||"Untitled Folder",parentId:o,isOpen:!0};e({...t,lore:{...t.lore,folders:[...s,L]}}),g({...p,isOpen:!1})}})},w=()=>{g({isOpen:!0,type:"input",title:"New Entity Name",onConfirm:D=>{const L={id:Date.now(),name:D||"Unnamed Entity",aliases:[],folderId:o,type:"Character",imageSrc:null,biography:"",sections:[]};e({...t,lore:{...t.lore,characters:[...a,L]}}),g({...p,isOpen:!1})}})},E=(D,L)=>{if(window.confirm("Delete this?"))if(L==="folder"){const T=s.filter(z=>z.id!==D);e({...t,lore:{...t.lore,folders:T}})}else{const T=a.filter(z=>z.id!==D);e({...t,lore:{...t.lore,characters:T}})}},A=D=>{if(D.biography&&D.biography.trim().length>0)return D.biography;if(!D.sections||D.sections.length===0)return"";for(let L of D.sections)for(let T of L.blocks)if(["summary","description","biography"].includes(T.label.toLowerCase())&&T.content)return T.content;return""};return b.jsxs("div",{style:{padding:"40px",maxWidth:"1200px",margin:"0 auto"},children:[b.jsx(Wt,{isOpen:p.isOpen,type:p.type,title:p.title,onConfirm:p.onConfirm,onCancel:()=>g({...p,isOpen:!1})}),b.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"30px",paddingBottom:"15px",borderBottom:"1px solid var(--border)"},children:[b.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[b.jsx("button",{onClick:S,disabled:!o,style:{...qR,opacity:o?1:.3},children:" Up"}),b.jsxs("span",{style:{fontSize:"18px",fontWeight:"bold",color:"var(--text-main)"},children:[" / ",h?h.name:"Home"]})]}),b.jsxs("div",{style:{display:"flex",gap:"10px"},children:[b.jsx("button",{onClick:k,style:uv,children:"+ New Folder"}),b.jsx("button",{onClick:w,style:{...uv,background:"var(--accent)",color:"white",border:"none"},children:"+ New Entity"})]})]}),b.jsxs("div",{style:FR,children:[u.map(D=>b.jsxs("div",{onClick:()=>x(D.id),style:dv,className:"explorer-card",children:[b.jsx("div",{style:{fontSize:"40px",marginBottom:"10px"},children:""}),b.jsx("div",{style:fv,children:D.name}),b.jsx("div",{style:hv,children:"Folder"}),b.jsx("div",{style:{position:"absolute",top:5,right:5,cursor:"pointer",color:"#666"},onClick:L=>{L.stopPropagation(),E(D.id,"folder")},children:""})]},D.id)),d.map(D=>b.jsxs("div",{onClick:()=>v(D.id),style:{...dv,height:"240px"},className:"explorer-card",children:[b.jsx("div",{style:WR,children:D.imageSrc?b.jsx("div",{style:{width:"100%",height:"100%",...D.imageStyles,backgroundImage:`url(${D.imageSrc})`,backgroundRepeat:"no-repeat",backgroundSize:"cover"}}):b.jsx("span",{style:{fontSize:"30px"},children:""})}),b.jsx("div",{style:fv,children:D.name}),b.jsx("div",{style:hv,children:D.type||"Entity"}),b.jsx("div",{style:YR,children:A(D)||b.jsx("span",{style:{fontStyle:"italic",opacity:.5},children:"No description..."})}),b.jsx("div",{style:{position:"absolute",top:5,right:5,cursor:"pointer",color:"#666"},onClick:L=>{L.stopPropagation(),E(D.id,"item")},children:""})]},D.id)),u.length===0&&d.length===0&&b.jsx("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"50px",color:"var(--text-muted)"},children:"This folder is empty."})]})]})},VR=({character:t,projectData:e,setProjectData:n,charIndex:i})=>{const[o,s]=R.useState(null),[a,u]=R.useState(!1),[d,h]=R.useState({isOpen:!1,type:"confirm",title:"",message:"",onConfirm:()=>{}}),p=()=>h({...d,isOpen:!1}),g=B=>{const _={...e.lore},W={...t,...B};_.characters[i]=W,n({...e,lore:_})},x=B=>{if(B.key==="Enter"){B.preventDefault();const _=B.target.value.trim();_&&!t.aliases?.includes(_)&&(g({aliases:[...t.aliases||[],_]}),B.target.value="")}},v=B=>{g({aliases:(t.aliases||[]).filter(_=>_!==B)})},k=(()=>{const B=e.lore.folders||[],_=(W,oe)=>{const re=B.filter(he=>he.parentId===W);let fe=[];return re.forEach(he=>{fe.push({id:he.id,name:he.name,depth:oe}),fe.push(..._(he.id,oe+1))}),fe};return _(null,0)})(),w=async B=>{const _=B.target.files[0];if(!_)return;const W=(_.size/1024/1024).toFixed(2);console.log(` Original file size: ${W}MB`);try{const oe=await YS(_,600,600,.75);s(oe),u(!0)}catch(oe){console.error("Image compression failed:",oe),alert("Failed to process image. Please try a smaller file.")}B.target.value=""},E=B=>{g({imageStyles:B,imageSrc:o}),u(!1)},A=()=>g({sections:[...t.sections||[],{id:Date.now(),title:"New Section",blocks:[]}]}),D=(B,_)=>g({sections:t.sections.map(W=>W.id===B?{...W,title:_}:W)}),L=B=>{h({isOpen:!0,type:"confirm",title:"Delete Section",message:"Remove this entire section?",onConfirm:()=>{g({sections:t.sections.filter(_=>_.id!==B)}),p()}})},T=B=>g({sections:t.sections.map(_=>_.id===B?{..._,blocks:[..._.blocks,{id:Date.now(),label:"New Field",content:""}]}:_)}),z=(B,_,W,oe)=>g({sections:t.sections.map(re=>re.id===B?{...re,blocks:re.blocks.map(fe=>fe.id===_?{...fe,[W]:oe}:fe)}:re)}),N=(B,_)=>g({sections:t.sections.map(W=>W.id===B?{...W,blocks:W.blocks.filter(oe=>oe.id!==_)}:W)});return b.jsxs("div",{style:{padding:"40px",maxWidth:"1200px",margin:"0 auto",paddingBottom:"100px"},children:[b.jsx(Wt,{isOpen:d.isOpen,type:d.type,title:d.title,message:d.message,onConfirm:d.onConfirm,onCancel:p}),a&&b.jsx(NR,{imageSrc:o,onSave:E,onCancel:()=>u(!1)}),b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"20px",borderBottom:"1px solid var(--border)",paddingBottom:"20px"},children:[b.jsxs("div",{style:{flex:1},children:[b.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",marginBottom:"5px"},children:[b.jsx("span",{style:{fontSize:"11px",color:"var(--text-muted)"},children:"FOLDER:"}),b.jsxs("select",{value:t.folderId||"",onChange:B=>g({folderId:B.target.value}),style:GR,children:[b.jsx("option",{value:"",children:"Root"}),k.map(B=>b.jsx("option",{value:B.id,children:"".repeat(B.depth*3)+(B.depth>0?" ":"")+B.name},B.id))]})]}),b.jsx("input",{type:"text",value:t.name||"",onChange:B=>g({name:B.target.value}),style:{background:"transparent",border:"none",fontSize:"32px",fontWeight:"bold",color:"var(--text-main)",width:"100%",outline:"none"},placeholder:"Entity Name"}),b.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginTop:"10px",alignItems:"center"},children:[b.jsx("span",{style:{fontSize:"12px",color:"var(--text-muted)",marginRight:"5px"},children:"Aliases/Tags:"}),(t.aliases||[]).map((B,_)=>b.jsxs("div",{style:l2,children:[B,b.jsx("button",{onClick:()=>v(B),style:s2,children:""})]},_)),b.jsx("input",{type:"text",placeholder:"+ Add Tag (Enter)",onKeyDown:x,style:a2})]}),b.jsxs("div",{style:{marginTop:"15px"},children:[b.jsx("div",{style:{fontSize:"11px",fontWeight:"bold",color:"var(--text-muted)",marginBottom:"5px",letterSpacing:"1px"},children:"BIOGRAPHY / DESCRIPTION"}),b.jsx("div",{style:{background:"var(--bg-panel)",border:"1px solid var(--border)",borderRadius:"4px",padding:"10px"},children:b.jsx(sv,{value:t.biography||"",onChange:B=>g({biography:B}),placeholder:"Write a brief biography or description..."})})]})]}),b.jsx("div",{style:KR,children:b.jsxs("label",{style:{cursor:"pointer",display:"block",height:"100%",width:"100%"},children:[t.imageSrc?b.jsx("div",{style:{width:"100%",height:"100%",...t.imageStyles,backgroundImage:`url(${t.imageSrc})`,backgroundRepeat:"no-repeat",backgroundSize:"cover"}}):b.jsx("div",{style:XR,children:b.jsx("span",{style:{fontSize:"24px"},children:""})}),b.jsx("input",{type:"file",accept:"image/*",onChange:w,style:{display:"none"}})]})})]}),(t.sections||[]).map(B=>b.jsxs("div",{style:{marginBottom:"40px"},children:[b.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"15px",borderBottom:"1px solid var(--border)"},children:[b.jsx("input",{type:"text",value:B.title,onChange:_=>D(B.id,_.target.value),style:JR}),b.jsx("button",{onClick:()=>L(B.id),style:i2,children:"Delete Section"})]}),b.jsxs("div",{style:QR,children:[B.blocks.map(_=>b.jsxs("div",{style:ZR,children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[b.jsx("input",{type:"text",value:_.label,onChange:W=>z(B.id,_.id,"label",W.target.value),style:e2}),b.jsx("button",{onClick:()=>N(B.id,_.id),style:n2,children:""})]}),b.jsx("div",{style:t2,children:b.jsx(sv,{value:_.content,onChange:W=>z(B.id,_.id,"content",W)})})]},_.id)),b.jsx("button",{onClick:()=>T(B.id),style:r2,children:"+ Add Field"})]})]},B.id)),b.jsx("button",{onClick:A,style:o2,children:"+ Create New Section"})]})},cv=()=>{const{projectData:t,setProjectData:e}=Tt(),[n,i]=IS();if(!t||!t.lore)return b.jsx("div",{style:{padding:"40px",color:"#888"},children:"Loading..."});const o=n.get("id");if(o){const s=t.lore.characters.findIndex(a=>a.id.toString()===o);return s===-1?b.jsxs("div",{style:{padding:40},children:["Entity not found. ",b.jsx("button",{onClick:()=>i({}),children:"Go Back"})]}):b.jsx(VR,{character:t.lore.characters[s],projectData:t,setProjectData:e,charIndex:s})}else return b.jsx(PR,{projectData:t,setProjectData:e,searchParams:n,setSearchParams:i})},qR={background:"var(--bg-header)",border:"1px solid var(--border)",padding:"5px 15px",borderRadius:"4px",color:"var(--text-main)",cursor:"pointer",fontWeight:"bold"},uv={background:"var(--bg-panel)",border:"1px solid var(--border)",padding:"6px 12px",borderRadius:"4px",color:"var(--text-main)",cursor:"pointer",fontSize:"13px",fontWeight:"bold"},FR={display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(160px, 1fr))",gap:"20px"},dv={background:"var(--bg-panel)",border:"1px solid var(--border)",borderRadius:"8px",padding:"15px",display:"flex",flexDirection:"column",alignItems:"center",cursor:"pointer",justifyContent:"flex-start",position:"relative",transition:"0.2s",overflow:"hidden"},WR={width:"60px",height:"60px",borderRadius:"50%",background:"#000",overflow:"hidden",marginBottom:"10px",border:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"center",color:"#888",flexShrink:0},fv={fontWeight:"bold",fontSize:"13px",textAlign:"center",color:"var(--text-main)",width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},hv={fontSize:"10px",color:"var(--text-muted)",marginBottom:"8px"},YR={fontSize:"11px",color:"#888",textAlign:"center",width:"100%",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:4,WebkitBoxOrient:"vertical",lineHeight:"1.4",padding:"0 5px",marginTop:"5px"},GR={background:"var(--bg-header)",color:"var(--accent)",border:"1px solid var(--border)",borderRadius:"4px",padding:"2px 8px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",outline:"none",minWidth:"150px"},KR={width:"150px",height:"150px",borderRadius:"8px",border:"2px dashed var(--border)",background:"var(--bg-panel)",overflow:"hidden",marginLeft:"20px",flexShrink:0},XR={width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"var(--text-muted)"},JR={background:"transparent",border:"none",fontSize:"18px",fontWeight:"bold",color:"var(--accent)",padding:"5px 0",width:"100%",outline:"none",textTransform:"uppercase",letterSpacing:"1px"},QR={display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"15px",alignItems:"start"},ZR={background:"var(--bg-panel)",border:"1px solid var(--border)",borderRadius:"4px",padding:"12px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},e2={background:"transparent",border:"none",color:"var(--text-muted)",fontSize:"11px",fontWeight:"bold",textTransform:"uppercase",width:"80%",outline:"none"},t2={marginTop:"5px",color:"var(--text-main)",fontSize:"14px",lineHeight:"1.5"},n2={background:"none",border:"none",color:"#666",cursor:"pointer",fontSize:"12px"},i2={background:"none",border:"none",color:"#888",fontSize:"11px",cursor:"pointer",whiteSpace:"nowrap"},r2={background:"transparent",border:"1px dashed var(--border)",color:"var(--text-muted)",borderRadius:"4px",cursor:"pointer",minHeight:"80px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"13px"},o2={display:"block",width:"100%",padding:"15px",marginTop:"30px",background:"var(--bg-header)",border:"1px dashed var(--border)",color:"var(--text-main)",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},l2={background:"var(--bg-app)",border:"1px solid var(--accent)",color:"var(--text-main)",borderRadius:"12px",padding:"2px 8px",fontSize:"11px",display:"flex",alignItems:"center",gap:"5px"},s2={background:"none",border:"none",color:"var(--accent)",cursor:"pointer",fontSize:"12px",fontWeight:"bold",padding:0},a2={background:"transparent",border:"1px dashed var(--border)",borderRadius:"12px",color:"var(--text-muted)",fontSize:"11px",padding:"2px 8px",width:"120px",outline:"none"},c2=".explorer-card:hover { transform: translateY(-3px); box-shadow: 0 4px 12px rgba(0,0,0,0.3); border-color: var(--accent) !important; }",GS=document.createElement("style");GS.innerHTML=c2;document.head.appendChild(GS);var Xh={exports:{}},Jh={};var pv;function u2(){if(pv)return Jh;pv=1;var t=ta();function e(g,x){return g===x&&(g!==0||1/g===1/x)||g!==g&&x!==x}var n=typeof Object.is=="function"?Object.is:e,i=t.useState,o=t.useEffect,s=t.useLayoutEffect,a=t.useDebugValue;function u(g,x){var v=x(),S=i({inst:{value:v,getSnapshot:x}}),k=S[0].inst,w=S[1];return s(function(){k.value=v,k.getSnapshot=x,d(k)&&w({inst:k})},[g,v,x]),o(function(){return d(k)&&w({inst:k}),g(function(){d(k)&&w({inst:k})})},[g]),a(v),v}function d(g){var x=g.getSnapshot;g=g.value;try{var v=x();return!n(g,v)}catch{return!0}}function h(g,x){return x()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:u;return Jh.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:p,Jh}var mv;function KS(){return mv||(mv=1,Xh.exports=u2()),Xh.exports}var XS=KS();function Ct(t){this.content=t}Ct.prototype={constructor:Ct,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var i=n&&n!=t?this.remove(n):this,o=i.find(t),s=i.content.slice();return o==-1?s.push(n||t,e):(s[o+1]=e,n&&(s[o]=n)),new Ct(s)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new Ct(n)},addToStart:function(t,e){return new Ct([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new Ct(n)},addBefore:function(t,e,n){var i=this.remove(e),o=i.content.slice(),s=i.find(t);return o.splice(s==-1?o.length:s,0,e,n),new Ct(o)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=Ct.from(t),t.size?new Ct(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=Ct.from(t),t.size?new Ct(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=Ct.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};Ct.from=function(t){if(t instanceof Ct)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new Ct(e)};function JS(t,e,n){for(let i=0;;i++){if(i==t.childCount||i==e.childCount)return t.childCount==e.childCount?null:n;let o=t.child(i),s=e.child(i);if(o==s){n+=o.nodeSize;continue}if(!o.sameMarkup(s))return n;if(o.isText&&o.text!=s.text){for(let a=0;o.text[a]==s.text[a];a++)n++;return n}if(o.content.size||s.content.size){let a=JS(o.content,s.content,n+1);if(a!=null)return a}n+=o.nodeSize}}function QS(t,e,n,i){for(let o=t.childCount,s=e.childCount;;){if(o==0||s==0)return o==s?null:{a:n,b:i};let a=t.child(--o),u=e.child(--s),d=a.nodeSize;if(a==u){n-=d,i-=d;continue}if(!a.sameMarkup(u))return{a:n,b:i};if(a.isText&&a.text!=u.text){let h=0,p=Math.min(a.text.length,u.text.length);for(;h<p&&a.text[a.text.length-h-1]==u.text[u.text.length-h-1];)h++,n--,i--;return{a:n,b:i}}if(a.content.size||u.content.size){let h=QS(a.content,u.content,n-1,i-1);if(h)return h}n-=d,i-=d}}class Q{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let i=0;i<e.length;i++)this.size+=e[i].nodeSize}nodesBetween(e,n,i,o=0,s){for(let a=0,u=0;u<n;a++){let d=this.content[a],h=u+d.nodeSize;if(h>e&&i(d,o+u,s||null,a)!==!1&&d.content.size){let p=u+1;d.nodesBetween(Math.max(0,e-p),Math.min(d.content.size,n-p),i,o+p)}u=h}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,i,o){let s="",a=!0;return this.nodesBetween(e,n,(u,d)=>{let h=u.isText?u.text.slice(Math.max(e,d)-d,n-d):u.isLeaf?o?typeof o=="function"?o(u):o:u.type.spec.leafText?u.type.spec.leafText(u):"":"";u.isBlock&&(u.isLeaf&&h||u.isTextblock)&&i&&(a?a=!1:s+=i),s+=h},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,i=e.firstChild,o=this.content.slice(),s=0;for(n.isText&&n.sameMarkup(i)&&(o[o.length-1]=n.withText(n.text+i.text),s=1);s<e.content.length;s++)o.push(e.content[s]);return new Q(o,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let i=[],o=0;if(n>e)for(let s=0,a=0;a<n;s++){let u=this.content[s],d=a+u.nodeSize;d>e&&((a<e||d>n)&&(u.isText?u=u.cut(Math.max(0,e-a),Math.min(u.text.length,n-a)):u=u.cut(Math.max(0,e-a-1),Math.min(u.content.size,n-a-1))),i.push(u),o+=u.nodeSize),a=d}return new Q(i,o)}cutByIndex(e,n){return e==n?Q.empty:e==0&&n==this.content.length?this:new Q(this.content.slice(e,n))}replaceChild(e,n){let i=this.content[e];if(i==n)return this;let o=this.content.slice(),s=this.size+n.nodeSize-i.nodeSize;return o[e]=n,new Q(o,s)}addToStart(e){return new Q([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Q(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,i=0;n<this.content.length;n++){let o=this.content[n];e(o,i,n),i+=o.nodeSize}}findDiffStart(e,n=0){return JS(this,e,n)}findDiffEnd(e,n=this.size,i=e.size){return QS(this,e,n,i)}findIndex(e){if(e==0)return Rc(0,e);if(e==this.size)return Rc(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,i=0;;n++){let o=this.child(n),s=i+o.nodeSize;if(s>=e)return s==e?Rc(n+1,s):Rc(n,i);i=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return Q.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new Q(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Q.empty;let n,i=0;for(let o=0;o<e.length;o++){let s=e[o];i+=s.nodeSize,o&&s.isText&&e[o-1].sameMarkup(s)?(n||(n=e.slice(0,o)),n[n.length-1]=s.withText(n[n.length-1].text+s.text)):n&&n.push(s)}return new Q(n||e,i)}static from(e){if(!e)return Q.empty;if(e instanceof Q)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Q([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Q.empty=new Q([],0);const Qh={index:0,offset:0};function Rc(t,e){return Qh.index=t,Qh.offset=e,Qh}function lu(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!lu(t[i],e[i]))return!1}else{for(let i in t)if(!(i in e)||!lu(t[i],e[i]))return!1;for(let i in e)if(!(i in t))return!1}return!0}let Pe=class qp{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,i=!1;for(let o=0;o<e.length;o++){let s=e[o];if(this.eq(s))return e;if(this.type.excludes(s.type))n||(n=e.slice(0,o));else{if(s.type.excludes(this.type))return e;!i&&s.type.rank>this.type.rank&&(n||(n=e.slice(0,o)),n.push(this),i=!0),n&&n.push(s)}}return n||(n=e.slice()),i||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&lu(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let i=e.marks[n.type];if(!i)throw new RangeError(`There is no mark type ${n.type} in this schema`);let o=i.create(n.attrs);return i.checkAttrs(o.attrs),o}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let i=0;i<e.length;i++)if(!e[i].eq(n[i]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return qp.none;if(e instanceof qp)return[e];let n=e.slice();return n.sort((i,o)=>i.type.rank-o.type.rank),n}};Pe.none=[];class su extends Error{}class se{constructor(e,n,i){this.content=e,this.openStart=n,this.openEnd=i}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let i=ew(this.content,e+this.openStart,n);return i&&new se(i,this.openStart,this.openEnd)}removeBetween(e,n){return new se(ZS(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return se.empty;let i=n.openStart||0,o=n.openEnd||0;if(typeof i!="number"||typeof o!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new se(Q.fromJSON(e,n.content),i,o)}static maxOpen(e,n=!0){let i=0,o=0;for(let s=e.firstChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.firstChild)i++;for(let s=e.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)o++;return new se(e,i,o)}}se.empty=new se(Q.empty,0,0);function ZS(t,e,n){let{index:i,offset:o}=t.findIndex(e),s=t.maybeChild(i),{index:a,offset:u}=t.findIndex(n);if(o==e||s.isText){if(u!=n&&!t.child(a).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(i!=a)throw new RangeError("Removing non-flat range");return t.replaceChild(i,s.copy(ZS(s.content,e-o-1,n-o-1)))}function ew(t,e,n,i){let{index:o,offset:s}=t.findIndex(e),a=t.maybeChild(o);if(s==e||a.isText)return i&&!i.canReplace(o,o,n)?null:t.cut(0,e).append(n).append(t.cut(e));let u=ew(a.content,e-s-1,n,a);return u&&t.replaceChild(o,a.copy(u))}function d2(t,e,n){if(n.openStart>t.depth)throw new su("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new su("Inconsistent open depths");return tw(t,e,n,0)}function tw(t,e,n,i){let o=t.index(i),s=t.node(i);if(o==e.index(i)&&i<t.depth-n.openStart){let a=tw(t,e,n,i+1);return s.copy(s.content.replaceChild(o,a))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==i&&e.depth==i){let a=t.parent,u=a.content;return io(a,u.cut(0,t.parentOffset).append(n.content).append(u.cut(e.parentOffset)))}else{let{start:a,end:u}=f2(n,t);return io(s,iw(t,a,u,e,i))}else return io(s,au(t,e,i))}function nw(t,e){if(!e.type.compatibleContent(t.type))throw new su("Cannot join "+e.type.name+" onto "+t.type.name)}function Fp(t,e,n){let i=t.node(n);return nw(i,e.node(n)),i}function no(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function js(t,e,n,i){let o=(e||t).node(n),s=0,a=e?e.index(n):o.childCount;t&&(s=t.index(n),t.depth>n?s++:t.textOffset&&(no(t.nodeAfter,i),s++));for(let u=s;u<a;u++)no(o.child(u),i);e&&e.depth==n&&e.textOffset&&no(e.nodeBefore,i)}function io(t,e){return t.type.checkContent(e),t.copy(e)}function iw(t,e,n,i,o){let s=t.depth>o&&Fp(t,e,o+1),a=i.depth>o&&Fp(n,i,o+1),u=[];return js(null,t,o,u),s&&a&&e.index(o)==n.index(o)?(nw(s,a),no(io(s,iw(t,e,n,i,o+1)),u)):(s&&no(io(s,au(t,e,o+1)),u),js(e,n,o,u),a&&no(io(a,au(n,i,o+1)),u)),js(i,null,o,u),new Q(u)}function au(t,e,n){let i=[];if(js(null,t,n,i),t.depth>n){let o=Fp(t,e,n+1);no(io(o,au(t,e,n+1)),i)}return js(e,null,n,i),new Q(i)}function f2(t,e){let n=e.depth-t.openStart,o=e.node(n).copy(t.content);for(let s=n-1;s>=0;s--)o=e.node(s).copy(Q.from(o));return{start:o.resolveNoCache(t.openStart+n),end:o.resolveNoCache(o.content.size-t.openEnd-n)}}class qs{constructor(e,n,i){this.pos=e,this.path=n,this.parentOffset=i,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let i=this.pos-this.path[this.path.length-1],o=e.child(n);return i?e.child(n).cut(i):o}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let i=this.path[n*3],o=n==0?0:this.path[n*3-1]+1;for(let s=0;s<e;s++)o+=i.child(s).nodeSize;return o}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return Pe.none;if(this.textOffset)return e.child(n).marks;let i=e.maybeChild(n-1),o=e.maybeChild(n);if(!i){let u=i;i=o,o=u}let s=i.marks;for(var a=0;a<s.length;a++)s[a].type.spec.inclusive===!1&&(!o||!s[a].isInSet(o.marks))&&(s=s[a--].removeFromSet(s));return s}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let i=n.marks,o=e.parent.maybeChild(e.index());for(var s=0;s<i.length;s++)i[s].type.spec.inclusive===!1&&(!o||!i[s].isInSet(o.marks))&&(i=i[s--].removeFromSet(i));return i}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let i=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);i>=0;i--)if(e.pos<=this.end(i)&&(!n||n(this.node(i))))return new cu(this,e,i);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let i=[],o=0,s=n;for(let a=e;;){let{index:u,offset:d}=a.content.findIndex(s),h=s-d;if(i.push(a,u,o+d),!h||(a=a.child(u),a.isText))break;s=h-1,o+=d+1}return new qs(n,i,s)}static resolveCached(e,n){let i=gv.get(e);if(i)for(let s=0;s<i.elts.length;s++){let a=i.elts[s];if(a.pos==n)return a}else gv.set(e,i=new h2);let o=i.elts[i.i]=qs.resolve(e,n);return i.i=(i.i+1)%p2,o}}class h2{constructor(){this.elts=[],this.i=0}}const p2=12,gv=new WeakMap;class cu{constructor(e,n,i){this.$from=e,this.$to=n,this.depth=i}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const m2=Object.create(null);let yr=class Wp{constructor(e,n,i,o=Pe.none){this.type=e,this.attrs=n,this.marks=o,this.content=i||Q.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,i,o=0){this.content.nodesBetween(e,n,i,o,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,i,o){return this.content.textBetween(e,n,i,o)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,i){return this.type==e&&lu(this.attrs,n||e.defaultAttrs||m2)&&Pe.sameSet(this.marks,i||Pe.none)}copy(e=null){return e==this.content?this:new Wp(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Wp(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,i=!1){if(e==n)return se.empty;let o=this.resolve(e),s=this.resolve(n),a=i?0:o.sharedDepth(n),u=o.start(a),h=o.node(a).content.cut(o.pos-u,s.pos-u);return new se(h,o.depth-a,s.depth-a)}replace(e,n,i){return d2(this.resolve(e),this.resolve(n),i)}nodeAt(e){for(let n=this;;){let{index:i,offset:o}=n.content.findIndex(e);if(n=n.maybeChild(i),!n)return null;if(o==e||n.isText)return n;e-=o+1}}childAfter(e){let{index:n,offset:i}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:i}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:i}=this.content.findIndex(e);if(i<e)return{node:this.content.child(n),index:n,offset:i};let o=this.content.child(n-1);return{node:o,index:n-1,offset:i-o.nodeSize}}resolve(e){return qs.resolveCached(this,e)}resolveNoCache(e){return qs.resolve(this,e)}rangeHasMark(e,n,i){let o=!1;return n>e&&this.nodesBetween(e,n,s=>(i.isInSet(s.marks)&&(o=!0),!o)),o}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),rw(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,i=Q.empty,o=0,s=i.childCount){let a=this.contentMatchAt(e).matchFragment(i,o,s),u=a&&a.matchFragment(this.content,n);if(!u||!u.validEnd)return!1;for(let d=o;d<s;d++)if(!this.type.allowsMarks(i.child(d).marks))return!1;return!0}canReplaceWith(e,n,i,o){if(o&&!this.type.allowsMarks(o))return!1;let s=this.contentMatchAt(e).matchType(i),a=s&&s.matchFragment(this.content,n);return a?a.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Pe.none;for(let n=0;n<this.marks.length;n++){let i=this.marks[n];i.type.checkAttrs(i.attrs),e=i.addToSet(e)}if(!Pe.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let i;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");i=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,i)}let o=Q.fromJSON(e,n.content),s=e.nodeType(n.type).create(n.attrs,o,i);return s.type.checkAttrs(s.attrs),s}};yr.prototype.text=void 0;class uu extends yr{constructor(e,n,i,o){if(super(e,n,null,o),!i)throw new RangeError("Empty text nodes are not allowed");this.text=i}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):rw(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new uu(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new uu(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function rw(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class so{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let i=new g2(e,n);if(i.next==null)return so.empty;let o=ow(i);i.next&&i.err("Unexpected trailing text");let s=C2(w2(o));return k2(s,i),s}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,i=e.childCount){let o=this;for(let s=n;o&&s<i;s++)o=o.matchType(e.child(s).type);return o}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let i=0;i<e.next.length;i++)if(this.next[n].type==e.next[i].type)return!0;return!1}fillBefore(e,n=!1,i=0){let o=[this];function s(a,u){let d=a.matchFragment(e,i);if(d&&(!n||d.validEnd))return Q.from(u.map(h=>h.createAndFill()));for(let h=0;h<a.next.length;h++){let{type:p,next:g}=a.next[h];if(!(p.isText||p.hasRequiredAttrs())&&o.indexOf(g)==-1){o.push(g);let x=s(g,u.concat(p));if(x)return x}}return null}return s(this,[])}findWrapping(e){for(let i=0;i<this.wrapCache.length;i+=2)if(this.wrapCache[i]==e)return this.wrapCache[i+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),i=[{match:this,type:null,via:null}];for(;i.length;){let o=i.shift(),s=o.match;if(s.matchType(e)){let a=[];for(let u=o;u.type;u=u.via)a.push(u.type);return a.reverse()}for(let a=0;a<s.next.length;a++){let{type:u,next:d}=s.next[a];!u.isLeaf&&!u.hasRequiredAttrs()&&!(u.name in n)&&(!o.type||d.validEnd)&&(i.push({match:u.contentMatch,type:u,via:o}),n[u.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(i){e.push(i);for(let o=0;o<i.next.length;o++)e.indexOf(i.next[o].next)==-1&&n(i.next[o].next)}return n(this),e.map((i,o)=>{let s=o+(i.validEnd?"*":" ")+" ";for(let a=0;a<i.next.length;a++)s+=(a?", ":"")+i.next[a].type.name+"->"+e.indexOf(i.next[a].next);return s}).join(`
`)}}so.empty=new so(!0);class g2{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function ow(t){let e=[];do e.push(y2(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function y2(t){let e=[];do e.push(x2(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function x2(t){let e=S2(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=b2(t,e);else break;return e}function yv(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function b2(t,e){let n=yv(t),i=n;return t.eat(",")&&(t.next!="}"?i=yv(t):i=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:i,expr:e}}function v2(t,e){let n=t.nodeTypes,i=n[e];if(i)return[i];let o=[];for(let s in n){let a=n[s];a.isInGroup(e)&&o.push(a)}return o.length==0&&t.err("No node type or group '"+e+"' found"),o}function S2(t){if(t.eat("(")){let e=ow(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=v2(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function w2(t){let e=[[]];return o(s(t,0),n()),e;function n(){return e.push([])-1}function i(a,u,d){let h={term:d,to:u};return e[a].push(h),h}function o(a,u){a.forEach(d=>d.to=u)}function s(a,u){if(a.type=="choice")return a.exprs.reduce((d,h)=>d.concat(s(h,u)),[]);if(a.type=="seq")for(let d=0;;d++){let h=s(a.exprs[d],u);if(d==a.exprs.length-1)return h;o(h,u=n())}else if(a.type=="star"){let d=n();return i(u,d),o(s(a.expr,d),d),[i(d)]}else if(a.type=="plus"){let d=n();return o(s(a.expr,u),d),o(s(a.expr,d),d),[i(d)]}else{if(a.type=="opt")return[i(u)].concat(s(a.expr,u));if(a.type=="range"){let d=u;for(let h=0;h<a.min;h++){let p=n();o(s(a.expr,d),p),d=p}if(a.max==-1)o(s(a.expr,d),d);else for(let h=a.min;h<a.max;h++){let p=n();i(d,p),o(s(a.expr,d),p),d=p}return[i(d)]}else{if(a.type=="name")return[i(u,void 0,a.value)];throw new Error("Unknown expr type")}}}}function lw(t,e){return e-t}function xv(t,e){let n=[];return i(e),n.sort(lw);function i(o){let s=t[o];if(s.length==1&&!s[0].term)return i(s[0].to);n.push(o);for(let a=0;a<s.length;a++){let{term:u,to:d}=s[a];!u&&n.indexOf(d)==-1&&i(d)}}}function C2(t){let e=Object.create(null);return n(xv(t,0));function n(i){let o=[];i.forEach(a=>{t[a].forEach(({term:u,to:d})=>{if(!u)return;let h;for(let p=0;p<o.length;p++)o[p][0]==u&&(h=o[p][1]);xv(t,d).forEach(p=>{h||o.push([u,h=[]]),h.indexOf(p)==-1&&h.push(p)})})});let s=e[i.join(",")]=new so(i.indexOf(t.length-1)>-1);for(let a=0;a<o.length;a++){let u=o[a][1].sort(lw);s.next.push({type:o[a][0],next:e[u.join(",")]||n(u)})}return s}}function k2(t,e){for(let n=0,i=[t];n<i.length;n++){let o=i[n],s=!o.validEnd,a=[];for(let u=0;u<o.next.length;u++){let{type:d,next:h}=o.next[u];a.push(d.name),s&&!(d.isText||d.hasRequiredAttrs())&&(s=!1),i.indexOf(h)==-1&&i.push(h)}s&&e.err("Only non-generatable nodes ("+a.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function sw(t){let e=Object.create(null);for(let n in t){let i=t[n];if(!i.hasDefault)return null;e[n]=i.default}return e}function aw(t,e){let n=Object.create(null);for(let i in t){let o=e&&e[i];if(o===void 0){let s=t[i];if(s.hasDefault)o=s.default;else throw new RangeError("No value supplied for attribute "+i)}n[i]=o}return n}function cw(t,e,n,i){for(let o in e)if(!(o in t))throw new RangeError(`Unsupported attribute ${o} for ${n} of type ${o}`);for(let o in t){let s=t[o];s.validate&&s.validate(e[o])}}function uw(t,e){let n=Object.create(null);if(e)for(let i in e)n[i]=new T2(t,i,e[i]);return n}let bv=class dw{constructor(e,n,i){this.name=e,this.schema=n,this.spec=i,this.markSet=null,this.groups=i.group?i.group.split(" "):[],this.attrs=uw(e,i.attrs),this.defaultAttrs=sw(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(i.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==so.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:aw(this.attrs,e)}create(e=null,n,i){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new yr(this,this.computeAttrs(e),Q.from(n),Pe.setFrom(i))}createChecked(e=null,n,i){return n=Q.from(n),this.checkContent(n),new yr(this,this.computeAttrs(e),n,Pe.setFrom(i))}createAndFill(e=null,n,i){if(e=this.computeAttrs(e),n=Q.from(n),n.size){let a=this.contentMatch.fillBefore(n);if(!a)return null;n=a.append(n)}let o=this.contentMatch.matchFragment(n),s=o&&o.fillBefore(Q.empty,!0);return s?new yr(this,e,n.append(s),Pe.setFrom(i)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let i=0;i<e.childCount;i++)if(!this.allowsMarks(e.child(i).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){cw(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let i=0;i<e.length;i++)this.allowsMarkType(e[i].type)?n&&n.push(e[i]):n||(n=e.slice(0,i));return n?n.length?n:Pe.none:e}static compile(e,n){let i=Object.create(null);e.forEach((s,a)=>i[s]=new dw(s,n,a));let o=n.spec.topNode||"doc";if(!i[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!i.text)throw new RangeError("Every schema needs a 'text' type");for(let s in i.text.attrs)throw new RangeError("The text node type should not have attributes");return i}};function E2(t,e,n){let i=n.split("|");return o=>{let s=o===null?"null":typeof o;if(i.indexOf(s)<0)throw new RangeError(`Expected value of type ${i} for attribute ${e} on type ${t}, got ${s}`)}}class T2{constructor(e,n,i){this.hasDefault=Object.prototype.hasOwnProperty.call(i,"default"),this.default=i.default,this.validate=typeof i.validate=="string"?E2(e,n,i.validate):i.validate}get isRequired(){return!this.hasDefault}}class td{constructor(e,n,i,o){this.name=e,this.rank=n,this.schema=i,this.spec=o,this.attrs=uw(e,o.attrs),this.excluded=null;let s=sw(this.attrs);this.instance=s?new Pe(this,s):null}create(e=null){return!e&&this.instance?this.instance:new Pe(this,aw(this.attrs,e))}static compile(e,n){let i=Object.create(null),o=0;return e.forEach((s,a)=>i[s]=new td(s,o++,n,a)),i}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){cw(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class fw{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let o in e)n[o]=e[o];n.nodes=Ct.from(e.nodes),n.marks=Ct.from(e.marks||{}),this.nodes=bv.compile(this.spec.nodes,this),this.marks=td.compile(this.spec.marks,this);let i=Object.create(null);for(let o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");let s=this.nodes[o],a=s.spec.content||"",u=s.spec.marks;if(s.contentMatch=i[a]||(i[a]=so.parse(a,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=u=="_"?null:u?vv(this,u.split(" ")):u==""||!s.inlineContent?[]:null}for(let o in this.marks){let s=this.marks[o],a=s.spec.excludes;s.excluded=a==null?[s]:a==""?[]:vv(this,a.split(" "))}this.nodeFromJSON=o=>yr.fromJSON(this,o),this.markFromJSON=o=>Pe.fromJSON(this,o),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,i,o){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof bv){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,i,o)}text(e,n){let i=this.nodes.text;return new uu(i,i.defaultAttrs,e,Pe.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function vv(t,e){let n=[];for(let i=0;i<e.length;i++){let o=e[i],s=t.marks[o],a=s;if(s)n.push(s);else for(let u in t.marks){let d=t.marks[u];(o=="_"||d.spec.group&&d.spec.group.split(" ").indexOf(o)>-1)&&n.push(a=d)}if(!a)throw new SyntaxError("Unknown mark type: '"+e[i]+"'")}return n}function M2(t){return t.tag!=null}function A2(t){return t.style!=null}class xr{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let i=this.matchedStyles=[];n.forEach(o=>{if(M2(o))this.tags.push(o);else if(A2(o)){let s=/[^=]*/.exec(o.style)[0];i.indexOf(s)<0&&i.push(s),this.styles.push(o)}}),this.normalizeLists=!this.tags.some(o=>{if(!/^(ul|ol)\b/.test(o.tag)||!o.node)return!1;let s=e.nodes[o.node];return s.contentMatch.matchType(s)})}parse(e,n={}){let i=new wv(this,n,!1);return i.addAll(e,Pe.none,n.from,n.to),i.finish()}parseSlice(e,n={}){let i=new wv(this,n,!0);return i.addAll(e,Pe.none,n.from,n.to),se.maxOpen(i.finish())}matchTag(e,n,i){for(let o=i?this.tags.indexOf(i)+1:0;o<this.tags.length;o++){let s=this.tags[o];if(D2(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||n.matchesContext(s.context))){if(s.getAttrs){let a=s.getAttrs(e);if(a===!1)continue;s.attrs=a||void 0}return s}}}matchStyle(e,n,i,o){for(let s=o?this.styles.indexOf(o)+1:0;s<this.styles.length;s++){let a=this.styles[s],u=a.style;if(!(u.indexOf(e)!=0||a.context&&!i.matchesContext(a.context)||u.length>e.length&&(u.charCodeAt(e.length)!=61||u.slice(e.length+1)!=n))){if(a.getAttrs){let d=a.getAttrs(n);if(d===!1)continue;a.attrs=d||void 0}return a}}}static schemaRules(e){let n=[];function i(o){let s=o.priority==null?50:o.priority,a=0;for(;a<n.length;a++){let u=n[a];if((u.priority==null?50:u.priority)<s)break}n.splice(a,0,o)}for(let o in e.marks){let s=e.marks[o].spec.parseDOM;s&&s.forEach(a=>{i(a=Cv(a)),a.mark||a.ignore||a.clearMark||(a.mark=o)})}for(let o in e.nodes){let s=e.nodes[o].spec.parseDOM;s&&s.forEach(a=>{i(a=Cv(a)),a.node||a.ignore||a.mark||(a.node=o)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new xr(e,xr.schemaRules(e)))}}const hw={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},O2={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},pw={ol:!0,ul:!0},Fs=1,Yp=2,zs=4;function Sv(t,e,n){return e!=null?(e?Fs:0)|(e==="full"?Yp:0):t&&t.whitespace=="pre"?Fs|Yp:n&~zs}class Dc{constructor(e,n,i,o,s,a){this.type=e,this.attrs=n,this.marks=i,this.solid=o,this.options=a,this.content=[],this.activeMarks=Pe.none,this.match=s||(a&zs?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(Q.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let i=this.type.contentMatch,o;return(o=i.findWrapping(e.type))?(this.match=i,o):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Fs)){let i=this.content[this.content.length-1],o;if(i&&i.isText&&(o=/[ \t\r\n\u000c]+$/.exec(i.text))){let s=i;i.text.length==o[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-o[0].length))}}let n=Q.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(Q.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!hw.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class wv{constructor(e,n,i){this.parser=e,this.options=n,this.isOpen=i,this.open=0,this.localPreserveWS=!1;let o=n.topNode,s,a=Sv(null,n.preserveWhitespace,0)|(i?zs:0);o?s=new Dc(o.type,o.attrs,Pe.none,!0,n.topMatch||o.type.contentMatch,a):i?s=new Dc(null,null,Pe.none,!0,null,a):s=new Dc(e.schema.topNodeType,null,Pe.none,!0,null,a),this.nodes=[s],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let i=e.nodeValue,o=this.top,s=o.options&Yp?"full":this.localPreserveWS||(o.options&Fs)>0,{schema:a}=this.parser;if(s==="full"||o.inlineContext(e)||/[^ \t\r\n\u000c]/.test(i)){if(s)if(s==="full")i=i.replace(/\r\n?/g,`
`);else if(a.linebreakReplacement&&/[\r\n]/.test(i)&&this.top.findWrapping(a.linebreakReplacement.create())){let u=i.split(/\r?\n|\r/);for(let d=0;d<u.length;d++)d&&this.insertNode(a.linebreakReplacement.create(),n,!0),u[d]&&this.insertNode(a.text(u[d]),n,!/\S/.test(u[d]));i=""}else i=i.replace(/\r?\n|\r/g," ");else if(i=i.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(i)&&this.open==this.nodes.length-1){let u=o.content[o.content.length-1],d=e.previousSibling;(!u||d&&d.nodeName=="BR"||u.isText&&/[ \t\r\n\u000c]$/.test(u.text))&&(i=i.slice(1))}i&&this.insertNode(a.text(i),n,!/\S/.test(i)),this.findInText(e)}else this.findInside(e)}addElement(e,n,i){let o=this.localPreserveWS,s=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let a=e.nodeName.toLowerCase(),u;pw.hasOwnProperty(a)&&this.parser.normalizeLists&&R2(e);let d=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(u=this.parser.matchTag(e,this,i));e:if(d?d.ignore:O2.hasOwnProperty(a))this.findInside(e),this.ignoreFallback(e,n);else if(!d||d.skip||d.closeParent){d&&d.closeParent?this.open=Math.max(0,this.open-1):d&&d.skip.nodeType&&(e=d.skip);let h,p=this.needsBlock;if(hw.hasOwnProperty(a))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),h=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let g=d&&d.skip?n:this.readStyles(e,n);g&&this.addAll(e,g),h&&this.sync(s),this.needsBlock=p}else{let h=this.readStyles(e,n);h&&this.addElementByRule(e,d,h,d.consuming===!1?u:void 0)}this.localPreserveWS=o}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let i=e.style;if(i&&i.length)for(let o=0;o<this.parser.matchedStyles.length;o++){let s=this.parser.matchedStyles[o],a=i.getPropertyValue(s);if(a)for(let u=void 0;;){let d=this.parser.matchStyle(s,a,this,u);if(!d)break;if(d.ignore)return null;if(d.clearMark?n=n.filter(h=>!d.clearMark(h)):n=n.concat(this.parser.schema.marks[d.mark].create(d.attrs)),d.consuming===!1)u=d;else break}}return n}addElementByRule(e,n,i,o){let s,a;if(n.node)if(a=this.parser.schema.nodes[n.node],a.isLeaf)this.insertNode(a.create(n.attrs),i,e.nodeName=="BR")||this.leafFallback(e,i);else{let d=this.enter(a,n.attrs||null,i,n.preserveWhitespace);d&&(s=!0,i=d)}else{let d=this.parser.schema.marks[n.mark];i=i.concat(d.create(n.attrs))}let u=this.top;if(a&&a.isLeaf)this.findInside(e);else if(o)this.addElement(e,i,o);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(d=>this.insertNode(d,i,!1));else{let d=e;typeof n.contentElement=="string"?d=e.querySelector(n.contentElement):typeof n.contentElement=="function"?d=n.contentElement(e):n.contentElement&&(d=n.contentElement),this.findAround(e,d,!0),this.addAll(d,i),this.findAround(e,d,!1)}s&&this.sync(u)&&this.open--}addAll(e,n,i,o){let s=i||0;for(let a=i?e.childNodes[i]:e.firstChild,u=o==null?null:e.childNodes[o];a!=u;a=a.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(a,n);this.findAtPoint(e,s)}findPlace(e,n,i){let o,s;for(let a=this.open,u=0;a>=0;a--){let d=this.nodes[a],h=d.findWrapping(e);if(h&&(!o||o.length>h.length+u)&&(o=h,s=d,!h.length))break;if(d.solid){if(i)break;u+=2}}if(!o)return null;this.sync(s);for(let a=0;a<o.length;a++)n=this.enterInner(o[a],null,n,!1);return n}insertNode(e,n,i){if(e.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(n=this.enterInner(s,null,n))}let o=this.findPlace(e,n,i);if(o){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(e.type));let a=Pe.none;for(let u of o.concat(e.marks))(s.type?s.type.allowsMarkType(u.type):kv(u.type,e.type))&&(a=u.addToSet(a));return s.content.push(e.mark(a)),!0}return!1}enter(e,n,i,o){let s=this.findPlace(e.create(n),i,!1);return s&&(s=this.enterInner(e,n,i,!0,o)),s}enterInner(e,n,i,o=!1,s){this.closeExtra();let a=this.top;a.match=a.match&&a.match.matchType(e);let u=Sv(e,s,a.options);a.options&zs&&a.content.length==0&&(u|=zs);let d=Pe.none;return i=i.filter(h=>(a.type?a.type.allowsMarkType(h.type):kv(h.type,e))?(d=h.addToSet(d),!1):!0),this.nodes.push(new Dc(e,n,d,o,null,u)),this.open++,i}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Fs)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let i=this.nodes[n].content;for(let o=i.length-1;o>=0;o--)e+=i[o].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].node==e&&this.find[i].offset==n&&(this.find[i].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,i){if(e!=n&&this.find)for(let o=0;o<this.find.length;o++)this.find[o].pos==null&&e.nodeType==1&&e.contains(this.find[o].node)&&n.compareDocumentPosition(this.find[o].node)&(i?2:4)&&(this.find[o].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),i=this.options.context,o=!this.isOpen&&(!i||i.parent.type==this.nodes[0].type),s=-(i?i.depth+1:0)+(o?0:1),a=(u,d)=>{for(;u>=0;u--){let h=n[u];if(h==""){if(u==n.length-1||u==0)continue;for(;d>=s;d--)if(a(u-1,d))return!0;return!1}else{let p=d>0||d==0&&o?this.nodes[d].type:i&&d>=s?i.node(d-s).type:null;if(!p||p.name!=h&&!p.isInGroup(h))return!1;d--}}return!0};return a(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(i&&i.isTextblock&&i.defaultAttrs)return i}for(let n in this.parser.schema.nodes){let i=this.parser.schema.nodes[n];if(i.isTextblock&&i.defaultAttrs)return i}}}function R2(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let i=e.nodeType==1?e.nodeName.toLowerCase():null;i&&pw.hasOwnProperty(i)&&n?(n.appendChild(e),e=n):i=="li"?n=e:i&&(n=null)}}function D2(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Cv(t){let e={};for(let n in t)e[n]=t[n];return e}function kv(t,e){let n=e.schema.nodes;for(let i in n){let o=n[i];if(!o.allowsMarkType(t))continue;let s=[],a=u=>{s.push(u);for(let d=0;d<u.edgeCount;d++){let{type:h,next:p}=u.edge(d);if(h==e||s.indexOf(p)<0&&a(p))return!0}};if(a(o.contentMatch))return!0}}class po{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},i){i||(i=Zh(n).createDocumentFragment());let o=i,s=[];return e.forEach(a=>{if(s.length||a.marks.length){let u=0,d=0;for(;u<s.length&&d<a.marks.length;){let h=a.marks[d];if(!this.marks[h.type.name]){d++;continue}if(!h.eq(s[u][0])||h.type.spec.spanning===!1)break;u++,d++}for(;u<s.length;)o=s.pop()[1];for(;d<a.marks.length;){let h=a.marks[d++],p=this.serializeMark(h,a.isInline,n);p&&(s.push([h,o]),o.appendChild(p.dom),o=p.contentDOM||p.dom)}}o.appendChild(this.serializeNodeInner(a,n))}),i}serializeNodeInner(e,n){let{dom:i,contentDOM:o}=Qc(Zh(n),this.nodes[e.type.name](e),null,e.attrs);if(o){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,o)}return i}serializeNode(e,n={}){let i=this.serializeNodeInner(e,n);for(let o=e.marks.length-1;o>=0;o--){let s=this.serializeMark(e.marks[o],e.isInline,n);s&&((s.contentDOM||s.dom).appendChild(i),i=s.dom)}return i}serializeMark(e,n,i={}){let o=this.marks[e.type.name];return o&&Qc(Zh(i),o(e,n),null,e.attrs)}static renderSpec(e,n,i=null,o){return Qc(e,n,i,o)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new po(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=Ev(e.nodes);return n.text||(n.text=i=>i.text),n}static marksFromSchema(e){return Ev(e.marks)}}function Ev(t){let e={};for(let n in t){let i=t[n].spec.toDOM;i&&(e[n]=i)}return e}function Zh(t){return t.document||window.document}const Tv=new WeakMap;function N2(t){let e=Tv.get(t);return e===void 0&&Tv.set(t,e=j2(t)),e}function j2(t){let e=null;function n(i){if(i&&typeof i=="object")if(Array.isArray(i))if(typeof i[0]=="string")e||(e=[]),e.push(i);else for(let o=0;o<i.length;o++)n(i[o]);else for(let o in i)n(i[o])}return n(t),e}function Qc(t,e,n,i){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let o=e[0],s;if(typeof o!="string")throw new RangeError("Invalid array passed to renderSpec");if(i&&(s=N2(i))&&s.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let a=o.indexOf(" ");a>0&&(n=o.slice(0,a),o=o.slice(a+1));let u,d=n?t.createElementNS(n,o):t.createElement(o),h=e[1],p=1;if(h&&typeof h=="object"&&h.nodeType==null&&!Array.isArray(h)){p=2;for(let g in h)if(h[g]!=null){let x=g.indexOf(" ");x>0?d.setAttributeNS(g.slice(0,x),g.slice(x+1),h[g]):g=="style"&&d.style?d.style.cssText=h[g]:d.setAttribute(g,h[g])}}for(let g=p;g<e.length;g++){let x=e[g];if(x===0){if(g<e.length-1||g>p)throw new RangeError("Content hole must be the only child of its parent node");return{dom:d,contentDOM:d}}else{let{dom:v,contentDOM:S}=Qc(t,x,n,i);if(d.appendChild(v),S){if(u)throw new RangeError("Multiple content holes");u=S}}}return{dom:d,contentDOM:u}}const mw=65535,gw=Math.pow(2,16);function z2(t,e){return t+e*gw}function Mv(t){return t&mw}function L2(t){return(t-(t&mw))/gw}const yw=1,xw=2,Zc=4,bw=8;class Gp{constructor(e,n,i){this.pos=e,this.delInfo=n,this.recover=i}get deleted(){return(this.delInfo&bw)>0}get deletedBefore(){return(this.delInfo&(yw|Zc))>0}get deletedAfter(){return(this.delInfo&(xw|Zc))>0}get deletedAcross(){return(this.delInfo&Zc)>0}}class on{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&on.empty)return on.empty}recover(e){let n=0,i=Mv(e);if(!this.inverted)for(let o=0;o<i;o++)n+=this.ranges[o*3+2]-this.ranges[o*3+1];return this.ranges[i*3]+n+L2(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,i){let o=0,s=this.inverted?2:1,a=this.inverted?1:2;for(let u=0;u<this.ranges.length;u+=3){let d=this.ranges[u]-(this.inverted?o:0);if(d>e)break;let h=this.ranges[u+s],p=this.ranges[u+a],g=d+h;if(e<=g){let x=h?e==d?-1:e==g?1:n:n,v=d+o+(x<0?0:p);if(i)return v;let S=e==(n<0?d:g)?null:z2(u/3,e-d),k=e==d?xw:e==g?yw:Zc;return(n<0?e!=d:e!=g)&&(k|=bw),new Gp(v,k,S)}o+=p-h}return i?e+o:new Gp(e+o,0,null)}touches(e,n){let i=0,o=Mv(n),s=this.inverted?2:1,a=this.inverted?1:2;for(let u=0;u<this.ranges.length;u+=3){let d=this.ranges[u]-(this.inverted?i:0);if(d>e)break;let h=this.ranges[u+s],p=d+h;if(e<=p&&u==o*3)return!0;i+=this.ranges[u+a]-h}return!1}forEach(e){let n=this.inverted?2:1,i=this.inverted?1:2;for(let o=0,s=0;o<this.ranges.length;o+=3){let a=this.ranges[o],u=a-(this.inverted?s:0),d=a+(this.inverted?0:s),h=this.ranges[o+n],p=this.ranges[o+i];e(u,u+h,d,d+p),s+=p-h}}invert(){return new on(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?on.empty:new on(e<0?[0,-e,0]:[0,0,e])}}on.empty=new on([]);class Ws{constructor(e,n,i=0,o=e?e.length:0){this.mirror=n,this.from=i,this.to=o,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new Ws(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,i=this._maps.length;n<e._maps.length;n++){let o=e.getMirror(n);this.appendMap(e._maps[n],o!=null&&o<n?i+o:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,i=this._maps.length+e._maps.length;n>=0;n--){let o=e.getMirror(n);this.appendMap(e._maps[n].invert(),o!=null&&o>n?i-o-1:void 0)}}invert(){let e=new Ws;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let i=this.from;i<this.to;i++)e=this._maps[i].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,i){let o=0;for(let s=this.from;s<this.to;s++){let a=this._maps[s],u=a.mapResult(e,n);if(u.recover!=null){let d=this.getMirror(s);if(d!=null&&d>s&&d<this.to){s=d,e=this._maps[d].recover(u.recover);continue}}o|=u.delInfo,e=u.pos}return i?e:new Gp(e,o,null)}}const ep=Object.create(null);class Dt{getMap(){return on.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let i=ep[n.stepType];if(!i)throw new RangeError(`No step type ${n.stepType} defined`);return i.fromJSON(e,n)}static jsonID(e,n){if(e in ep)throw new RangeError("Duplicate use of step JSON ID "+e);return ep[e]=n,n.prototype.jsonID=e,n}}class ct{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new ct(e,null)}static fail(e){return new ct(null,e)}static fromReplace(e,n,i,o){try{return ct.ok(e.replace(n,i,o))}catch(s){if(s instanceof su)return ct.fail(s.message);throw s}}}function Nm(t,e,n){let i=[];for(let o=0;o<t.childCount;o++){let s=t.child(o);s.content.size&&(s=s.copy(Nm(s.content,e,s))),s.isInline&&(s=e(s,n,o)),i.push(s)}return Q.fromArray(i)}class pr extends Dt{constructor(e,n,i){super(),this.from=e,this.to=n,this.mark=i}apply(e){let n=e.slice(this.from,this.to),i=e.resolve(this.from),o=i.node(i.sharedDepth(this.to)),s=new se(Nm(n.content,(a,u)=>!a.isAtom||!u.type.allowsMarkType(this.mark.type)?a:a.mark(this.mark.addToSet(a.marks)),o),n.openStart,n.openEnd);return ct.fromReplace(e,this.from,this.to,s)}invert(){return new Dn(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1);return n.deleted&&i.deleted||n.pos>=i.pos?null:new pr(n.pos,i.pos,this.mark)}merge(e){return e instanceof pr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new pr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new pr(n.from,n.to,e.markFromJSON(n.mark))}}Dt.jsonID("addMark",pr);class Dn extends Dt{constructor(e,n,i){super(),this.from=e,this.to=n,this.mark=i}apply(e){let n=e.slice(this.from,this.to),i=new se(Nm(n.content,o=>o.mark(this.mark.removeFromSet(o.marks)),e),n.openStart,n.openEnd);return ct.fromReplace(e,this.from,this.to,i)}invert(){return new pr(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1);return n.deleted&&i.deleted||n.pos>=i.pos?null:new Dn(n.pos,i.pos,this.mark)}merge(e){return e instanceof Dn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Dn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Dn(n.from,n.to,e.markFromJSON(n.mark))}}Dt.jsonID("removeMark",Dn);class mr extends Dt{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return ct.fail("No node at mark step's position");let i=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return ct.fromReplace(e,this.pos,this.pos+1,new se(Q.from(i),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let i=this.mark.addToSet(n.marks);if(i.length==n.marks.length){for(let o=0;o<n.marks.length;o++)if(!n.marks[o].isInSet(i))return new mr(this.pos,n.marks[o]);return new mr(this.pos,this.mark)}}return new ao(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new mr(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new mr(n.pos,e.markFromJSON(n.mark))}}Dt.jsonID("addNodeMark",mr);class ao extends Dt{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return ct.fail("No node at mark step's position");let i=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return ct.fromReplace(e,this.pos,this.pos+1,new se(Q.from(i),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new mr(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new ao(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new ao(n.pos,e.markFromJSON(n.mark))}}Dt.jsonID("removeNodeMark",ao);class pt extends Dt{constructor(e,n,i,o=!1){super(),this.from=e,this.to=n,this.slice=i,this.structure=o}apply(e){return this.structure&&Kp(e,this.from,this.to)?ct.fail("Structure replace would overwrite content"):ct.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new on([this.from,this.to-this.from,this.slice.size])}invert(e){return new pt(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1);return n.deletedAcross&&i.deletedAcross?null:new pt(n.pos,Math.max(n.pos,i.pos),this.slice,this.structure)}merge(e){if(!(e instanceof pt)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?se.empty:new se(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new pt(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?se.empty:new se(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new pt(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new pt(n.from,n.to,se.fromJSON(e,n.slice),!!n.structure)}}Dt.jsonID("replace",pt);class gt extends Dt{constructor(e,n,i,o,s,a,u=!1){super(),this.from=e,this.to=n,this.gapFrom=i,this.gapTo=o,this.slice=s,this.insert=a,this.structure=u}apply(e){if(this.structure&&(Kp(e,this.from,this.gapFrom)||Kp(e,this.gapTo,this.to)))return ct.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return ct.fail("Gap is not a flat range");let i=this.slice.insertAt(this.insert,n.content);return i?ct.fromReplace(e,this.from,this.to,i):ct.fail("Content does not fit in gap")}getMap(){return new on([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new gt(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1),o=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),s=this.to==this.gapTo?i.pos:e.map(this.gapTo,1);return n.deletedAcross&&i.deletedAcross||o<n.pos||s>i.pos?null:new gt(n.pos,i.pos,o,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new gt(n.from,n.to,n.gapFrom,n.gapTo,se.fromJSON(e,n.slice),n.insert,!!n.structure)}}Dt.jsonID("replaceAround",gt);function Kp(t,e,n){let i=t.resolve(e),o=n-e,s=i.depth;for(;o>0&&s>0&&i.indexAfter(s)==i.node(s).childCount;)s--,o--;if(o>0){let a=i.node(s).maybeChild(i.indexAfter(s));for(;o>0;){if(!a||a.isLeaf)return!0;a=a.firstChild,o--}}return!1}function B2(t,e,n,i){let o=[],s=[],a,u;t.doc.nodesBetween(e,n,(d,h,p)=>{if(!d.isInline)return;let g=d.marks;if(!i.isInSet(g)&&p.type.allowsMarkType(i.type)){let x=Math.max(h,e),v=Math.min(h+d.nodeSize,n),S=i.addToSet(g);for(let k=0;k<g.length;k++)g[k].isInSet(S)||(a&&a.to==x&&a.mark.eq(g[k])?a.to=v:o.push(a=new Dn(x,v,g[k])));u&&u.to==x?u.to=v:s.push(u=new pr(x,v,i))}}),o.forEach(d=>t.step(d)),s.forEach(d=>t.step(d))}function I2(t,e,n,i){let o=[],s=0;t.doc.nodesBetween(e,n,(a,u)=>{if(!a.isInline)return;s++;let d=null;if(i instanceof td){let h=a.marks,p;for(;p=i.isInSet(h);)(d||(d=[])).push(p),h=p.removeFromSet(h)}else i?i.isInSet(a.marks)&&(d=[i]):d=a.marks;if(d&&d.length){let h=Math.min(u+a.nodeSize,n);for(let p=0;p<d.length;p++){let g=d[p],x;for(let v=0;v<o.length;v++){let S=o[v];S.step==s-1&&g.eq(o[v].style)&&(x=S)}x?(x.to=h,x.step=s):o.push({style:g,from:Math.max(u,e),to:h,step:s})}}}),o.forEach(a=>t.step(new Dn(a.from,a.to,a.style)))}function jm(t,e,n,i=n.contentMatch,o=!0){let s=t.doc.nodeAt(e),a=[],u=e+1;for(let d=0;d<s.childCount;d++){let h=s.child(d),p=u+h.nodeSize,g=i.matchType(h.type);if(!g)a.push(new pt(u,p,se.empty));else{i=g;for(let x=0;x<h.marks.length;x++)n.allowsMarkType(h.marks[x].type)||t.step(new Dn(u,p,h.marks[x]));if(o&&h.isText&&n.whitespace!="pre"){let x,v=/\r?\n|\r/g,S;for(;x=v.exec(h.text);)S||(S=new se(Q.from(n.schema.text(" ",n.allowedMarks(h.marks))),0,0)),a.push(new pt(u+x.index,u+x.index+x[0].length,S))}}u=p}if(!i.validEnd){let d=i.fillBefore(Q.empty,!0);t.replace(u,u,new se(d,0,0))}for(let d=a.length-1;d>=0;d--)t.step(a[d])}function _2(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function wl(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let i=t.depth,o=0,s=0;;--i){let a=t.$from.node(i),u=t.$from.index(i)+o,d=t.$to.indexAfter(i)-s;if(i<t.depth&&a.canReplace(u,d,n))return i;if(i==0||a.type.spec.isolating||!_2(a,u,d))break;u&&(o=1),d<a.childCount&&(s=1)}return null}function H2(t,e,n){let{$from:i,$to:o,depth:s}=e,a=i.before(s+1),u=o.after(s+1),d=a,h=u,p=Q.empty,g=0;for(let S=s,k=!1;S>n;S--)k||i.index(S)>0?(k=!0,p=Q.from(i.node(S).copy(p)),g++):d--;let x=Q.empty,v=0;for(let S=s,k=!1;S>n;S--)k||o.after(S+1)<o.end(S)?(k=!0,x=Q.from(o.node(S).copy(x)),v++):h++;t.step(new gt(d,h,a,u,new se(p.append(x),g,v),p.size-g,!0))}function zm(t,e,n=null,i=t){let o=U2(t,e),s=o&&$2(i,e);return s?o.map(Av).concat({type:e,attrs:n}).concat(s.map(Av)):null}function Av(t){return{type:t,attrs:null}}function U2(t,e){let{parent:n,startIndex:i,endIndex:o}=t,s=n.contentMatchAt(i).findWrapping(e);if(!s)return null;let a=s.length?s[0]:e;return n.canReplaceWith(i,o,a)?s:null}function $2(t,e){let{parent:n,startIndex:i,endIndex:o}=t,s=n.child(i),a=e.contentMatch.findWrapping(s.type);if(!a)return null;let d=(a.length?a[a.length-1]:e).contentMatch;for(let h=i;d&&h<o;h++)d=d.matchType(n.child(h).type);return!d||!d.validEnd?null:a}function P2(t,e,n){let i=Q.empty;for(let a=n.length-1;a>=0;a--){if(i.size){let u=n[a].type.contentMatch.matchFragment(i);if(!u||!u.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}i=Q.from(n[a].type.create(n[a].attrs,i))}let o=e.start,s=e.end;t.step(new gt(o,s,o,s,new se(i,0,0),n.length,!0))}function V2(t,e,n,i,o){if(!i.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=t.steps.length;t.doc.nodesBetween(e,n,(a,u)=>{let d=typeof o=="function"?o(a):o;if(a.isTextblock&&!a.hasMarkup(i,d)&&q2(t.doc,t.mapping.slice(s).map(u),i)){let h=null;if(i.schema.linebreakReplacement){let v=i.whitespace=="pre",S=!!i.contentMatch.matchType(i.schema.linebreakReplacement);v&&!S?h=!1:!v&&S&&(h=!0)}h===!1&&Sw(t,a,u,s),jm(t,t.mapping.slice(s).map(u,1),i,void 0,h===null);let p=t.mapping.slice(s),g=p.map(u,1),x=p.map(u+a.nodeSize,1);return t.step(new gt(g,x,g+1,x-1,new se(Q.from(i.create(d,null,a.marks)),0,0),1,!0)),h===!0&&vw(t,a,u,s),!1}})}function vw(t,e,n,i){e.forEach((o,s)=>{if(o.isText){let a,u=/\r?\n|\r/g;for(;a=u.exec(o.text);){let d=t.mapping.slice(i).map(n+1+s+a.index);t.replaceWith(d,d+1,e.type.schema.linebreakReplacement.create())}}})}function Sw(t,e,n,i){e.forEach((o,s)=>{if(o.type==o.type.schema.linebreakReplacement){let a=t.mapping.slice(i).map(n+1+s);t.replaceWith(a,a+1,e.type.schema.text(`
`))}})}function q2(t,e,n){let i=t.resolve(e),o=i.index();return i.parent.canReplaceWith(o,o+1,n)}function F2(t,e,n,i,o){let s=t.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let a=n.create(i,null,o||s.marks);if(s.isLeaf)return t.replaceWith(e,e+s.nodeSize,a);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new gt(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new se(Q.from(a),0,0),1,!0))}function Ai(t,e,n=1,i){let o=t.resolve(e),s=o.depth-n,a=i&&i[i.length-1]||o.parent;if(s<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!a.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(let h=o.depth-1,p=n-2;h>s;h--,p--){let g=o.node(h),x=o.index(h);if(g.type.spec.isolating)return!1;let v=g.content.cutByIndex(x,g.childCount),S=i&&i[p+1];S&&(v=v.replaceChild(0,S.type.create(S.attrs)));let k=i&&i[p]||g;if(!g.canReplace(x+1,g.childCount)||!k.type.validContent(v))return!1}let u=o.indexAfter(s),d=i&&i[0];return o.node(s).canReplaceWith(u,u,d?d.type:o.node(s+1).type)}function W2(t,e,n=1,i){let o=t.doc.resolve(e),s=Q.empty,a=Q.empty;for(let u=o.depth,d=o.depth-n,h=n-1;u>d;u--,h--){s=Q.from(o.node(u).copy(s));let p=i&&i[h];a=Q.from(p?p.type.create(p.attrs,a):o.node(u).copy(a))}t.step(new pt(e,e,new se(s.append(a),n,n),!0))}function Tr(t,e){let n=t.resolve(e),i=n.index();return ww(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(i,i+1)}function Y2(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:i}=t.type.schema;for(let o=0;o<e.childCount;o++){let s=e.child(o),a=s.type==i?t.type.schema.nodes.text:s.type;if(n=n.matchType(a),!n||!t.type.allowsMarks(s.marks))return!1}return n.validEnd}function ww(t,e){return!!(t&&e&&!t.isLeaf&&Y2(t,e))}function nd(t,e,n=-1){let i=t.resolve(e);for(let o=i.depth;;o--){let s,a,u=i.index(o);if(o==i.depth?(s=i.nodeBefore,a=i.nodeAfter):n>0?(s=i.node(o+1),u++,a=i.node(o).maybeChild(u)):(s=i.node(o).maybeChild(u-1),a=i.node(o+1)),s&&!s.isTextblock&&ww(s,a)&&i.node(o).canReplace(u,u+1))return e;if(o==0)break;e=n<0?i.before(o):i.after(o)}}function G2(t,e,n){let i=null,{linebreakReplacement:o}=t.doc.type.schema,s=t.doc.resolve(e-n),a=s.node().type;if(o&&a.inlineContent){let p=a.whitespace=="pre",g=!!a.contentMatch.matchType(o);p&&!g?i=!1:!p&&g&&(i=!0)}let u=t.steps.length;if(i===!1){let p=t.doc.resolve(e+n);Sw(t,p.node(),p.before(),u)}a.inlineContent&&jm(t,e+n-1,a,s.node().contentMatchAt(s.index()),i==null);let d=t.mapping.slice(u),h=d.map(e-n);if(t.step(new pt(h,d.map(e+n,-1),se.empty,!0)),i===!0){let p=t.doc.resolve(h);vw(t,p.node(),p.before(),t.steps.length)}return t}function K2(t,e,n){let i=t.resolve(e);if(i.parent.canReplaceWith(i.index(),i.index(),n))return e;if(i.parentOffset==0)for(let o=i.depth-1;o>=0;o--){let s=i.index(o);if(i.node(o).canReplaceWith(s,s,n))return i.before(o+1);if(s>0)return null}if(i.parentOffset==i.parent.content.size)for(let o=i.depth-1;o>=0;o--){let s=i.indexAfter(o);if(i.node(o).canReplaceWith(s,s,n))return i.after(o+1);if(s<i.node(o).childCount)return null}return null}function Cw(t,e,n){let i=t.resolve(e);if(!n.content.size)return e;let o=n.content;for(let s=0;s<n.openStart;s++)o=o.firstChild.content;for(let s=1;s<=(n.openStart==0&&n.size?2:1);s++)for(let a=i.depth;a>=0;a--){let u=a==i.depth?0:i.pos<=(i.start(a+1)+i.end(a+1))/2?-1:1,d=i.index(a)+(u>0?1:0),h=i.node(a),p=!1;if(s==1)p=h.canReplace(d,d,o);else{let g=h.contentMatchAt(d).findWrapping(o.firstChild.type);p=g&&h.canReplaceWith(d,d,g[0])}if(p)return u==0?i.pos:u<0?i.before(a+1):i.after(a+1)}return null}function id(t,e,n=e,i=se.empty){if(e==n&&!i.size)return null;let o=t.resolve(e),s=t.resolve(n);return kw(o,s,i)?new pt(e,n,i):new X2(o,s,i).fit()}function kw(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class X2{constructor(e,n,i){this.$from=e,this.$to=n,this.unplaced=i,this.frontier=[],this.placed=Q.empty;for(let o=0;o<=e.depth;o++){let s=e.node(o);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(o))})}for(let o=e.depth;o>0;o--)this.placed=Q.from(e.node(o).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let h=this.findFittable();h?this.placeNodes(h):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,i=this.$from,o=this.close(e<0?this.$to:i.doc.resolve(e));if(!o)return null;let s=this.placed,a=i.depth,u=o.depth;for(;a&&u&&s.childCount==1;)s=s.firstChild.content,a--,u--;let d=new se(s,a,u);return e>-1?new gt(i.pos,e,this.$to.pos,this.$to.end(),d,n):d.size||i.pos!=this.$to.pos?new pt(i.pos,o.pos,d):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,i=0,o=this.unplaced.openEnd;i<e;i++){let s=n.firstChild;if(n.childCount>1&&(o=0),s.type.spec.isolating&&o<=i){e=i;break}n=s.content}for(let n=1;n<=2;n++)for(let i=n==1?e:this.unplaced.openStart;i>=0;i--){let o,s=null;i?(s=tp(this.unplaced.content,i-1).firstChild,o=s.content):o=this.unplaced.content;let a=o.firstChild;for(let u=this.depth;u>=0;u--){let{type:d,match:h}=this.frontier[u],p,g=null;if(n==1&&(a?h.matchType(a.type)||(g=h.fillBefore(Q.from(a),!1)):s&&d.compatibleContent(s.type)))return{sliceDepth:i,frontierDepth:u,parent:s,inject:g};if(n==2&&a&&(p=h.findWrapping(a.type)))return{sliceDepth:i,frontierDepth:u,parent:s,wrap:p};if(s&&h.matchType(s.type))break}}}openMore(){let{content:e,openStart:n,openEnd:i}=this.unplaced,o=tp(e,n);return!o.childCount||o.firstChild.isLeaf?!1:(this.unplaced=new se(e,n+1,Math.max(i,o.size+n>=e.size-i?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:i}=this.unplaced,o=tp(e,n);if(o.childCount<=1&&n>0){let s=e.size-n<=n+o.size;this.unplaced=new se(Ts(e,n-1,1),n-1,s?n-1:i)}else this.unplaced=new se(Ts(e,n,1),n,i)}placeNodes({sliceDepth:e,frontierDepth:n,parent:i,inject:o,wrap:s}){for(;this.depth>n;)this.closeFrontierNode();if(s)for(let k=0;k<s.length;k++)this.openFrontierNode(s[k]);let a=this.unplaced,u=i?i.content:a.content,d=a.openStart-e,h=0,p=[],{match:g,type:x}=this.frontier[n];if(o){for(let k=0;k<o.childCount;k++)p.push(o.child(k));g=g.matchFragment(o)}let v=u.size+e-(a.content.size-a.openEnd);for(;h<u.childCount;){let k=u.child(h),w=g.matchType(k.type);if(!w)break;h++,(h>1||d==0||k.content.size)&&(g=w,p.push(Ew(k.mark(x.allowedMarks(k.marks)),h==1?d:0,h==u.childCount?v:-1)))}let S=h==u.childCount;S||(v=-1),this.placed=Ms(this.placed,n,Q.from(p)),this.frontier[n].match=g,S&&v<0&&i&&i.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let k=0,w=u;k<v;k++){let E=w.lastChild;this.frontier.push({type:E.type,match:E.contentMatchAt(E.childCount)}),w=E.content}this.unplaced=S?e==0?se.empty:new se(Ts(a.content,e-1,1),e-1,v<0?a.openEnd:e-1):new se(Ts(a.content,e,h),a.openStart,a.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!np(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:i}=this.$to,o=this.$to.after(i);for(;i>1&&o==this.$to.end(--i);)++o;return o}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:i,type:o}=this.frontier[n],s=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),a=np(e,n,o,i,s);if(a){for(let u=n-1;u>=0;u--){let{match:d,type:h}=this.frontier[u],p=np(e,u,h,d,!0);if(!p||p.childCount)continue e}return{depth:n,fit:a,move:s?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Ms(this.placed,n.depth,n.fit)),e=n.move;for(let i=n.depth+1;i<=e.depth;i++){let o=e.node(i),s=o.type.contentMatch.fillBefore(o.content,!0,e.index(i));this.openFrontierNode(o.type,o.attrs,s)}return e}openFrontierNode(e,n=null,i){let o=this.frontier[this.depth];o.match=o.match.matchType(e),this.placed=Ms(this.placed,this.depth,Q.from(e.create(n,i))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(Q.empty,!0);n.childCount&&(this.placed=Ms(this.placed,this.frontier.length,n))}}function Ts(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Ts(t.firstChild.content,e-1,n)))}function Ms(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Ms(t.lastChild.content,e-1,n)))}function tp(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function Ew(t,e,n){if(e<=0)return t;let i=t.content;return e>1&&(i=i.replaceChild(0,Ew(i.firstChild,e-1,i.childCount==1?n-1:0))),e>0&&(i=t.type.contentMatch.fillBefore(i).append(i),n<=0&&(i=i.append(t.type.contentMatch.matchFragment(i).fillBefore(Q.empty,!0)))),t.copy(i)}function np(t,e,n,i,o){let s=t.node(e),a=o?t.indexAfter(e):t.index(e);if(a==s.childCount&&!n.compatibleContent(s.type))return null;let u=i.fillBefore(s.content,!0,a);return u&&!J2(n,s.content,a)?u:null}function J2(t,e,n){for(let i=n;i<e.childCount;i++)if(!t.allowsMarks(e.child(i).marks))return!0;return!1}function Q2(t){return t.spec.defining||t.spec.definingForContent}function Z2(t,e,n,i){if(!i.size)return t.deleteRange(e,n);let o=t.doc.resolve(e),s=t.doc.resolve(n);if(kw(o,s,i))return t.step(new pt(e,n,i));let a=Mw(o,s);a[a.length-1]==0&&a.pop();let u=-(o.depth+1);a.unshift(u);for(let x=o.depth,v=o.pos-1;x>0;x--,v--){let S=o.node(x).type.spec;if(S.defining||S.definingAsContext||S.isolating)break;a.indexOf(x)>-1?u=x:o.before(x)==v&&a.splice(1,0,-x)}let d=a.indexOf(u),h=[],p=i.openStart;for(let x=i.content,v=0;;v++){let S=x.firstChild;if(h.push(S),v==i.openStart)break;x=S.content}for(let x=p-1;x>=0;x--){let v=h[x],S=Q2(v.type);if(S&&!v.sameMarkup(o.node(Math.abs(u)-1)))p=x;else if(S||!v.type.isTextblock)break}for(let x=i.openStart;x>=0;x--){let v=(x+p+1)%(i.openStart+1),S=h[v];if(S)for(let k=0;k<a.length;k++){let w=a[(k+d)%a.length],E=!0;w<0&&(E=!1,w=-w);let A=o.node(w-1),D=o.index(w-1);if(A.canReplaceWith(D,D,S.type,S.marks))return t.replace(o.before(w),E?s.after(w):n,new se(Tw(i.content,0,i.openStart,v),v,i.openEnd))}}let g=t.steps.length;for(let x=a.length-1;x>=0&&(t.replace(e,n,i),!(t.steps.length>g));x--){let v=a[x];v<0||(e=o.before(v),n=s.after(v))}}function Tw(t,e,n,i,o){if(e<n){let s=t.firstChild;t=t.replaceChild(0,s.copy(Tw(s.content,e+1,n,i,s)))}if(e>i){let s=o.contentMatchAt(0),a=s.fillBefore(t).append(t);t=a.append(s.matchFragment(a).fillBefore(Q.empty,!0))}return t}function eD(t,e,n,i){if(!i.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let o=K2(t.doc,e,i.type);o!=null&&(e=n=o)}t.replaceRange(e,n,new se(Q.from(i),0,0))}function tD(t,e,n){let i=t.doc.resolve(e),o=t.doc.resolve(n),s=Mw(i,o);for(let a=0;a<s.length;a++){let u=s[a],d=a==s.length-1;if(d&&u==0||i.node(u).type.contentMatch.validEnd)return t.delete(i.start(u),o.end(u));if(u>0&&(d||i.node(u-1).canReplace(i.index(u-1),o.indexAfter(u-1))))return t.delete(i.before(u),o.after(u))}for(let a=1;a<=i.depth&&a<=o.depth;a++)if(e-i.start(a)==i.depth-a&&n>i.end(a)&&o.end(a)-n!=o.depth-a&&i.start(a-1)==o.start(a-1)&&i.node(a-1).canReplace(i.index(a-1),o.index(a-1)))return t.delete(i.before(a),n);t.delete(e,n)}function Mw(t,e){let n=[],i=Math.min(t.depth,e.depth);for(let o=i;o>=0;o--){let s=t.start(o);if(s<t.pos-(t.depth-o)||e.end(o)>e.pos+(e.depth-o)||t.node(o).type.spec.isolating||e.node(o).type.spec.isolating)break;(s==e.start(o)||o==t.depth&&o==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&o&&e.start(o-1)==s-1)&&n.push(o)}return n}class al extends Dt{constructor(e,n,i){super(),this.pos=e,this.attr=n,this.value=i}apply(e){let n=e.nodeAt(this.pos);if(!n)return ct.fail("No node at attribute step's position");let i=Object.create(null);for(let s in n.attrs)i[s]=n.attrs[s];i[this.attr]=this.value;let o=n.type.create(i,null,n.marks);return ct.fromReplace(e,this.pos,this.pos+1,new se(Q.from(o),0,n.isLeaf?0:1))}getMap(){return on.empty}invert(e){return new al(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new al(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new al(n.pos,n.attr,n.value)}}Dt.jsonID("attr",al);class Ys extends Dt{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let o in e.attrs)n[o]=e.attrs[o];n[this.attr]=this.value;let i=e.type.create(n,e.content,e.marks);return ct.ok(i)}getMap(){return on.empty}invert(e){return new Ys(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Ys(n.attr,n.value)}}Dt.jsonID("docAttr",Ys);let dl=class extends Error{};dl=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};dl.prototype=Object.create(Error.prototype);dl.prototype.constructor=dl;dl.prototype.name="TransformError";class Aw{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Ws}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new dl(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,i=se.empty){let o=id(this.doc,e,n,i);return o&&this.step(o),this}replaceWith(e,n,i){return this.replace(e,n,new se(Q.from(i),0,0))}delete(e,n){return this.replace(e,n,se.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,i){return Z2(this,e,n,i),this}replaceRangeWith(e,n,i){return eD(this,e,n,i),this}deleteRange(e,n){return tD(this,e,n),this}lift(e,n){return H2(this,e,n),this}join(e,n=1){return G2(this,e,n),this}wrap(e,n){return P2(this,e,n),this}setBlockType(e,n=e,i,o=null){return V2(this,e,n,i,o),this}setNodeMarkup(e,n,i=null,o){return F2(this,e,n,i,o),this}setNodeAttribute(e,n,i){return this.step(new al(e,n,i)),this}setDocAttribute(e,n){return this.step(new Ys(e,n)),this}addNodeMark(e,n){return this.step(new mr(e,n)),this}removeNodeMark(e,n){let i=this.doc.nodeAt(e);if(!i)throw new RangeError("No node at position "+e);if(n instanceof Pe)n.isInSet(i.marks)&&this.step(new ao(e,n));else{let o=i.marks,s,a=[];for(;s=n.isInSet(o);)a.push(new ao(e,s)),o=s.removeFromSet(o);for(let u=a.length-1;u>=0;u--)this.step(a[u])}return this}split(e,n=1,i){return W2(this,e,n,i),this}addMark(e,n,i){return B2(this,e,n,i),this}removeMark(e,n,i){return I2(this,e,n,i),this}clearIncompatible(e,n,i){return jm(this,e,n,i),this}}const ip=Object.create(null);class ve{constructor(e,n,i){this.$anchor=e,this.$head=n,this.ranges=i||[new Ow(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=se.empty){let i=n.content.lastChild,o=null;for(let u=0;u<n.openEnd;u++)o=i,i=i.lastChild;let s=e.steps.length,a=this.ranges;for(let u=0;u<a.length;u++){let{$from:d,$to:h}=a[u],p=e.mapping.slice(s);e.replaceRange(p.map(d.pos),p.map(h.pos),u?se.empty:n),u==0&&Dv(e,s,(i?i.isInline:o&&o.isTextblock)?-1:1)}}replaceWith(e,n){let i=e.steps.length,o=this.ranges;for(let s=0;s<o.length;s++){let{$from:a,$to:u}=o[s],d=e.mapping.slice(i),h=d.map(a.pos),p=d.map(u.pos);s?e.deleteRange(h,p):(e.replaceRangeWith(h,p,n),Dv(e,i,n.isInline?-1:1))}}static findFrom(e,n,i=!1){let o=e.parent.inlineContent?new Se(e):il(e.node(0),e.parent,e.pos,e.index(),n,i);if(o)return o;for(let s=e.depth-1;s>=0;s--){let a=n<0?il(e.node(0),e.node(s),e.before(s+1),e.index(s),n,i):il(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,n,i);if(a)return a}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new ln(e.node(0))}static atStart(e){return il(e,e,0,0,1)||new ln(e)}static atEnd(e){return il(e,e,e.content.size,e.childCount,-1)||new ln(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let i=ip[n.type];if(!i)throw new RangeError(`No selection type ${n.type} defined`);return i.fromJSON(e,n)}static jsonID(e,n){if(e in ip)throw new RangeError("Duplicate use of selection JSON ID "+e);return ip[e]=n,n.prototype.jsonID=e,n}getBookmark(){return Se.between(this.$anchor,this.$head).getBookmark()}}ve.prototype.visible=!0;class Ow{constructor(e,n){this.$from=e,this.$to=n}}let Ov=!1;function Rv(t){!Ov&&!t.parent.inlineContent&&(Ov=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class Se extends ve{constructor(e,n=e){Rv(e),Rv(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let i=e.resolve(n.map(this.head));if(!i.parent.inlineContent)return ve.near(i);let o=e.resolve(n.map(this.anchor));return new Se(o.parent.inlineContent?o:i,i)}replace(e,n=se.empty){if(super.replace(e,n),n==se.empty){let i=this.$from.marksAcross(this.$to);i&&e.ensureMarks(i)}}eq(e){return e instanceof Se&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new rd(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Se(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,i=n){let o=e.resolve(n);return new this(o,i==n?o:e.resolve(i))}static between(e,n,i){let o=e.pos-n.pos;if((!i||o)&&(i=o>=0?1:-1),!n.parent.inlineContent){let s=ve.findFrom(n,i,!0)||ve.findFrom(n,-i,!0);if(s)n=s.$head;else return ve.near(n,i)}return e.parent.inlineContent||(o==0?e=n:(e=(ve.findFrom(e,-i,!0)||ve.findFrom(e,i,!0)).$anchor,e.pos<n.pos!=o<0&&(e=n))),new Se(e,n)}}ve.jsonID("text",Se);class rd{constructor(e,n){this.anchor=e,this.head=n}map(e){return new rd(e.map(this.anchor),e.map(this.head))}resolve(e){return Se.between(e.resolve(this.anchor),e.resolve(this.head))}}class xe extends ve{constructor(e){let n=e.nodeAfter,i=e.node(0).resolve(e.pos+n.nodeSize);super(e,i),this.node=n}map(e,n){let{deleted:i,pos:o}=n.mapResult(this.anchor),s=e.resolve(o);return i?ve.near(s):new xe(s)}content(){return new se(Q.from(this.node),0,0)}eq(e){return e instanceof xe&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Lm(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new xe(e.resolve(n.anchor))}static create(e,n){return new xe(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}xe.prototype.visible=!1;ve.jsonID("node",xe);class Lm{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:i}=e.mapResult(this.anchor);return n?new rd(i,i):new Lm(i)}resolve(e){let n=e.resolve(this.anchor),i=n.nodeAfter;return i&&xe.isSelectable(i)?new xe(n):ve.near(n)}}class ln extends ve{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=se.empty){if(n==se.empty){e.delete(0,e.doc.content.size);let i=ve.atStart(e.doc);i.eq(e.selection)||e.setSelection(i)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new ln(e)}map(e){return new ln(e)}eq(e){return e instanceof ln}getBookmark(){return nD}}ve.jsonID("all",ln);const nD={map(){return this},resolve(t){return new ln(t)}};function il(t,e,n,i,o,s=!1){if(e.inlineContent)return Se.create(t,n);for(let a=i-(o>0?0:1);o>0?a<e.childCount:a>=0;a+=o){let u=e.child(a);if(u.isAtom){if(!s&&xe.isSelectable(u))return xe.create(t,n-(o<0?u.nodeSize:0))}else{let d=il(t,u,n+o,o<0?u.childCount:0,o,s);if(d)return d}n+=u.nodeSize*o}return null}function Dv(t,e,n){let i=t.steps.length-1;if(i<e)return;let o=t.steps[i];if(!(o instanceof pt||o instanceof gt))return;let s=t.mapping.maps[i],a;s.forEach((u,d,h,p)=>{a==null&&(a=p)}),t.setSelection(ve.near(t.doc.resolve(a),n))}const Nv=1,Nc=2,jv=4;class iD extends Aw{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Nv)&~Nc,this.storedMarks=null,this}get selectionSet(){return(this.updated&Nv)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Nc,this}ensureMarks(e){return Pe.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Nc)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Nc,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let i=this.selection;return n&&(e=e.mark(this.storedMarks||(i.empty?i.$from.marks():i.$from.marksAcross(i.$to)||Pe.none))),i.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,i){let o=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(o.text(e),!0):this.deleteSelection();{if(i==null&&(i=n),!e)return this.deleteRange(n,i);let s=this.storedMarks;if(!s){let a=this.doc.resolve(n);s=i==n?a.marks():a.marksAcross(this.doc.resolve(i))}return this.replaceRangeWith(n,i,o.text(e,s)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection(ve.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=jv,this}get scrolledIntoView(){return(this.updated&jv)>0}}function zv(t,e){return!e||!t?t:t.bind(e)}class As{constructor(e,n,i){this.name=e,this.init=zv(n.init,i),this.apply=zv(n.apply,i)}}const rD=[new As("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new As("selection",{init(t,e){return t.selection||ve.atStart(e.doc)},apply(t){return t.selection}}),new As("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,i){return i.selection.$cursor?t.storedMarks:null}}),new As("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class rp{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=rD.slice(),n&&n.forEach(i=>{if(this.pluginsByKey[i.key])throw new RangeError("Adding different instances of a keyed plugin ("+i.key+")");this.plugins.push(i),this.pluginsByKey[i.key]=i,i.spec.state&&this.fields.push(new As(i.key,i.spec.state,i))})}}class sl{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let i=0;i<this.config.plugins.length;i++)if(i!=n){let o=this.config.plugins[i];if(o.spec.filterTransaction&&!o.spec.filterTransaction.call(o,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],i=this.applyInner(e),o=null;for(;;){let s=!1;for(let a=0;a<this.config.plugins.length;a++){let u=this.config.plugins[a];if(u.spec.appendTransaction){let d=o?o[a].n:0,h=o?o[a].state:this,p=d<n.length&&u.spec.appendTransaction.call(u,d?n.slice(d):n,h,i);if(p&&i.filterTransaction(p,a)){if(p.setMeta("appendedTransaction",e),!o){o=[];for(let g=0;g<this.config.plugins.length;g++)o.push(g<a?{state:i,n:n.length}:{state:this,n:0})}n.push(p),i=i.applyInner(p),s=!0}o&&(o[a]={state:i,n:n.length})}}if(!s)return{state:i,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new sl(this.config),i=this.config.fields;for(let o=0;o<i.length;o++){let s=i[o];n[s.name]=s.apply(e,this[s.name],this,n)}return n}get tr(){return new iD(this)}static create(e){let n=new rp(e.doc?e.doc.type.schema:e.schema,e.plugins),i=new sl(n);for(let o=0;o<n.fields.length;o++)i[n.fields[o].name]=n.fields[o].init(e,i);return i}reconfigure(e){let n=new rp(this.schema,e.plugins),i=n.fields,o=new sl(n);for(let s=0;s<i.length;s++){let a=i[s].name;o[a]=this.hasOwnProperty(a)?this[a]:i[s].init(e,o)}return o}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(i=>i.toJSON())),e&&typeof e=="object")for(let i in e){if(i=="doc"||i=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let o=e[i],s=o.spec.state;s&&s.toJSON&&(n[i]=s.toJSON.call(o,this[o.key]))}return n}static fromJSON(e,n,i){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let o=new rp(e.schema,e.plugins),s=new sl(o);return o.fields.forEach(a=>{if(a.name=="doc")s.doc=yr.fromJSON(e.schema,n.doc);else if(a.name=="selection")s.selection=ve.fromJSON(s.doc,n.selection);else if(a.name=="storedMarks")n.storedMarks&&(s.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(i)for(let u in i){let d=i[u],h=d.spec.state;if(d.key==a.name&&h&&h.fromJSON&&Object.prototype.hasOwnProperty.call(n,u)){s[a.name]=h.fromJSON.call(d,e,n[u],s);return}}s[a.name]=a.init(e,s)}}),s}}function Rw(t,e,n){for(let i in t){let o=t[i];o instanceof Function?o=o.bind(e):i=="handleDOMEvents"&&(o=Rw(o,e,{})),n[i]=o}return n}class Ye{constructor(e){this.spec=e,this.props={},e.props&&Rw(e.props,this,this.props),this.key=e.key?e.key.key:Dw("plugin")}getState(e){return e[this.key]}}const op=Object.create(null);function Dw(t){return t in op?t+"$"+ ++op[t]:(op[t]=0,t+"$")}class Xe{constructor(e="key"){this.key=Dw(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Bm=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function Nw(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const jw=(t,e,n)=>{let i=Nw(t,n);if(!i)return!1;let o=Im(i);if(!o){let a=i.blockRange(),u=a&&wl(a);return u==null?!1:(e&&e(t.tr.lift(a,u).scrollIntoView()),!0)}let s=o.nodeBefore;if(Pw(t,o,e,-1))return!0;if(i.parent.content.size==0&&(fl(s,"end")||xe.isSelectable(s)))for(let a=i.depth;;a--){let u=id(t.doc,i.before(a),i.after(a),se.empty);if(u&&u.slice.size<u.to-u.from){if(e){let d=t.tr.step(u);d.setSelection(fl(s,"end")?ve.findFrom(d.doc.resolve(d.mapping.map(o.pos,-1)),-1):xe.create(d.doc,o.pos-s.nodeSize)),e(d.scrollIntoView())}return!0}if(a==1||i.node(a-1).childCount>1)break}return s.isAtom&&o.depth==i.depth-1?(e&&e(t.tr.delete(o.pos-s.nodeSize,o.pos).scrollIntoView()),!0):!1},oD=(t,e,n)=>{let i=Nw(t,n);if(!i)return!1;let o=Im(i);return o?zw(t,o,e):!1},lD=(t,e,n)=>{let i=Bw(t,n);if(!i)return!1;let o=_m(i);return o?zw(t,o,e):!1};function zw(t,e,n){let i=e.nodeBefore,o=i,s=e.pos-1;for(;!o.isTextblock;s--){if(o.type.spec.isolating)return!1;let p=o.lastChild;if(!p)return!1;o=p}let a=e.nodeAfter,u=a,d=e.pos+1;for(;!u.isTextblock;d++){if(u.type.spec.isolating)return!1;let p=u.firstChild;if(!p)return!1;u=p}let h=id(t.doc,s,d,se.empty);if(!h||h.from!=s||h instanceof pt&&h.slice.size>=d-s)return!1;if(n){let p=t.tr.step(h);p.setSelection(Se.create(p.doc,s)),n(p.scrollIntoView())}return!0}function fl(t,e,n=!1){for(let i=t;i;i=e=="start"?i.firstChild:i.lastChild){if(i.isTextblock)return!0;if(n&&i.childCount!=1)return!1}return!1}const Lw=(t,e,n)=>{let{$head:i,empty:o}=t.selection,s=i;if(!o)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):i.parentOffset>0)return!1;s=Im(i)}let a=s&&s.nodeBefore;return!a||!xe.isSelectable(a)?!1:(e&&e(t.tr.setSelection(xe.create(t.doc,s.pos-a.nodeSize)).scrollIntoView()),!0)};function Im(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function Bw(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const Iw=(t,e,n)=>{let i=Bw(t,n);if(!i)return!1;let o=_m(i);if(!o)return!1;let s=o.nodeAfter;if(Pw(t,o,e,1))return!0;if(i.parent.content.size==0&&(fl(s,"start")||xe.isSelectable(s))){let a=id(t.doc,i.before(),i.after(),se.empty);if(a&&a.slice.size<a.to-a.from){if(e){let u=t.tr.step(a);u.setSelection(fl(s,"start")?ve.findFrom(u.doc.resolve(u.mapping.map(o.pos)),1):xe.create(u.doc,u.mapping.map(o.pos))),e(u.scrollIntoView())}return!0}}return s.isAtom&&o.depth==i.depth-1?(e&&e(t.tr.delete(o.pos,o.pos+s.nodeSize).scrollIntoView()),!0):!1},_w=(t,e,n)=>{let{$head:i,empty:o}=t.selection,s=i;if(!o)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):i.parentOffset<i.parent.content.size)return!1;s=_m(i)}let a=s&&s.nodeAfter;return!a||!xe.isSelectable(a)?!1:(e&&e(t.tr.setSelection(xe.create(t.doc,s.pos)).scrollIntoView()),!0)};function _m(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const sD=(t,e)=>{let n=t.selection,i=n instanceof xe,o;if(i){if(n.node.isTextblock||!Tr(t.doc,n.from))return!1;o=n.from}else if(o=nd(t.doc,n.from,-1),o==null)return!1;if(e){let s=t.tr.join(o);i&&s.setSelection(xe.create(s.doc,o-t.doc.resolve(o).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},aD=(t,e)=>{let n=t.selection,i;if(n instanceof xe){if(n.node.isTextblock||!Tr(t.doc,n.to))return!1;i=n.to}else if(i=nd(t.doc,n.to,1),i==null)return!1;return e&&e(t.tr.join(i).scrollIntoView()),!0},cD=(t,e)=>{let{$from:n,$to:i}=t.selection,o=n.blockRange(i),s=o&&wl(o);return s==null?!1:(e&&e(t.tr.lift(o,s).scrollIntoView()),!0)},Hw=(t,e)=>{let{$head:n,$anchor:i}=t.selection;return!n.parent.type.spec.code||!n.sameParent(i)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function Hm(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const uD=(t,e)=>{let{$head:n,$anchor:i}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(i))return!1;let o=n.node(-1),s=n.indexAfter(-1),a=Hm(o.contentMatchAt(s));if(!a||!o.canReplaceWith(s,s,a))return!1;if(e){let u=n.after(),d=t.tr.replaceWith(u,u,a.createAndFill());d.setSelection(ve.near(d.doc.resolve(u),1)),e(d.scrollIntoView())}return!0},Uw=(t,e)=>{let n=t.selection,{$from:i,$to:o}=n;if(n instanceof ln||i.parent.inlineContent||o.parent.inlineContent)return!1;let s=Hm(o.parent.contentMatchAt(o.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let a=(!i.parentOffset&&o.index()<o.parent.childCount?i:o).pos,u=t.tr.insert(a,s.createAndFill());u.setSelection(Se.create(u.doc,a+1)),e(u.scrollIntoView())}return!0},$w=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let s=n.before();if(Ai(t.doc,s))return e&&e(t.tr.split(s).scrollIntoView()),!0}let i=n.blockRange(),o=i&&wl(i);return o==null?!1:(e&&e(t.tr.lift(i,o).scrollIntoView()),!0)};function dD(t){return(e,n)=>{let{$from:i,$to:o}=e.selection;if(e.selection instanceof xe&&e.selection.node.isBlock)return!i.parentOffset||!Ai(e.doc,i.pos)?!1:(n&&n(e.tr.split(i.pos).scrollIntoView()),!0);if(!i.depth)return!1;let s=[],a,u,d=!1,h=!1;for(let v=i.depth;;v--)if(i.node(v).isBlock){d=i.end(v)==i.pos+(i.depth-v),h=i.start(v)==i.pos-(i.depth-v),u=Hm(i.node(v-1).contentMatchAt(i.indexAfter(v-1))),s.unshift(d&&u?{type:u}:null),a=v;break}else{if(v==1)return!1;s.unshift(null)}let p=e.tr;(e.selection instanceof Se||e.selection instanceof ln)&&p.deleteSelection();let g=p.mapping.map(i.pos),x=Ai(p.doc,g,s.length,s);if(x||(s[0]=u?{type:u}:null,x=Ai(p.doc,g,s.length,s)),!x)return!1;if(p.split(g,s.length,s),!d&&h&&i.node(a).type!=u){let v=p.mapping.map(i.before(a)),S=p.doc.resolve(v);u&&i.node(a-1).canReplaceWith(S.index(),S.index()+1,u)&&p.setNodeMarkup(p.mapping.map(i.before(a)),u)}return n&&n(p.scrollIntoView()),!0}}const fD=dD(),hD=(t,e)=>{let{$from:n,to:i}=t.selection,o,s=n.sharedDepth(i);return s==0?!1:(o=n.before(s),e&&e(t.tr.setSelection(xe.create(t.doc,o))),!0)};function pD(t,e,n){let i=e.nodeBefore,o=e.nodeAfter,s=e.index();return!i||!o||!i.type.compatibleContent(o.type)?!1:!i.content.size&&e.parent.canReplace(s-1,s)?(n&&n(t.tr.delete(e.pos-i.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(o.isTextblock||Tr(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function Pw(t,e,n,i){let o=e.nodeBefore,s=e.nodeAfter,a,u,d=o.type.spec.isolating||s.type.spec.isolating;if(!d&&pD(t,e,n))return!0;let h=!d&&e.parent.canReplace(e.index(),e.index()+1);if(h&&(a=(u=o.contentMatchAt(o.childCount)).findWrapping(s.type))&&u.matchType(a[0]||s.type).validEnd){if(n){let v=e.pos+s.nodeSize,S=Q.empty;for(let E=a.length-1;E>=0;E--)S=Q.from(a[E].create(null,S));S=Q.from(o.copy(S));let k=t.tr.step(new gt(e.pos-1,v,e.pos,v,new se(S,1,0),a.length,!0)),w=k.doc.resolve(v+2*a.length);w.nodeAfter&&w.nodeAfter.type==o.type&&Tr(k.doc,w.pos)&&k.join(w.pos),n(k.scrollIntoView())}return!0}let p=s.type.spec.isolating||i>0&&d?null:ve.findFrom(e,1),g=p&&p.$from.blockRange(p.$to),x=g&&wl(g);if(x!=null&&x>=e.depth)return n&&n(t.tr.lift(g,x).scrollIntoView()),!0;if(h&&fl(s,"start",!0)&&fl(o,"end")){let v=o,S=[];for(;S.push(v),!v.isTextblock;)v=v.lastChild;let k=s,w=1;for(;!k.isTextblock;k=k.firstChild)w++;if(v.canReplace(v.childCount,v.childCount,k.content)){if(n){let E=Q.empty;for(let D=S.length-1;D>=0;D--)E=Q.from(S[D].copy(E));let A=t.tr.step(new gt(e.pos-S.length,e.pos+s.nodeSize,e.pos+w,e.pos+s.nodeSize-w,new se(E,S.length,0),0,!0));n(A.scrollIntoView())}return!0}}return!1}function Vw(t){return function(e,n){let i=e.selection,o=t<0?i.$from:i.$to,s=o.depth;for(;o.node(s).isInline;){if(!s)return!1;s--}return o.node(s).isTextblock?(n&&n(e.tr.setSelection(Se.create(e.doc,t<0?o.start(s):o.end(s)))),!0):!1}}const mD=Vw(-1),gD=Vw(1);function yD(t,e=null){return function(n,i){let{$from:o,$to:s}=n.selection,a=o.blockRange(s),u=a&&zm(a,t,e);return u?(i&&i(n.tr.wrap(a,u).scrollIntoView()),!0):!1}}function Lv(t,e=null){return function(n,i){let o=!1;for(let s=0;s<n.selection.ranges.length&&!o;s++){let{$from:{pos:a},$to:{pos:u}}=n.selection.ranges[s];n.doc.nodesBetween(a,u,(d,h)=>{if(o)return!1;if(!(!d.isTextblock||d.hasMarkup(t,e)))if(d.type==t)o=!0;else{let p=n.doc.resolve(h),g=p.index();o=p.parent.canReplaceWith(g,g+1,t)}})}if(!o)return!1;if(i){let s=n.tr;for(let a=0;a<n.selection.ranges.length;a++){let{$from:{pos:u},$to:{pos:d}}=n.selection.ranges[a];s.setBlockType(u,d,t,e)}i(s.scrollIntoView())}return!0}}function Um(...t){return function(e,n,i){for(let o=0;o<t.length;o++)if(t[o](e,n,i))return!0;return!1}}Um(Bm,jw,Lw);Um(Bm,Iw,_w);Um(Hw,Uw,$w,fD);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function xD(t,e=null){return function(n,i){let{$from:o,$to:s}=n.selection,a=o.blockRange(s);if(!a)return!1;let u=i?n.tr:null;return bD(u,a,t,e)?(i&&i(u.scrollIntoView()),!0):!1}}function bD(t,e,n,i=null){let o=!1,s=e,a=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let d=a.resolve(e.start-2);s=new cu(d,d,e.depth),e.endIndex<e.parent.childCount&&(e=new cu(e.$from,a.resolve(e.$to.end(e.depth)),e.depth)),o=!0}let u=zm(s,n,i,e);return u?(t&&vD(t,e,u,o,n),!0):!1}function vD(t,e,n,i,o){let s=Q.empty;for(let p=n.length-1;p>=0;p--)s=Q.from(n[p].type.create(n[p].attrs,s));t.step(new gt(e.start-(i?2:0),e.end,e.start,e.end,new se(s,0,0),n.length,!0));let a=0;for(let p=0;p<n.length;p++)n[p].type==o&&(a=p+1);let u=n.length-a,d=e.start+n.length-(i?2:0),h=e.parent;for(let p=e.startIndex,g=e.endIndex,x=!0;p<g;p++,x=!1)!x&&Ai(t.doc,d,u)&&(t.split(d,u),d+=2*u),d+=h.child(p).nodeSize;return t}function SD(t){return function(e,n){let{$from:i,$to:o}=e.selection,s=i.blockRange(o,a=>a.childCount>0&&a.firstChild.type==t);return s?n?i.node(s.depth-1).type==t?wD(e,n,t,s):CD(e,n,s):!0:!1}}function wD(t,e,n,i){let o=t.tr,s=i.end,a=i.$to.end(i.depth);s<a&&(o.step(new gt(s-1,a,s,a,new se(Q.from(n.create(null,i.parent.copy())),1,0),1,!0)),i=new cu(o.doc.resolve(i.$from.pos),o.doc.resolve(a),i.depth));const u=wl(i);if(u==null)return!1;o.lift(i,u);let d=o.doc.resolve(o.mapping.map(s,-1)-1);return Tr(o.doc,d.pos)&&d.nodeBefore.type==d.nodeAfter.type&&o.join(d.pos),e(o.scrollIntoView()),!0}function CD(t,e,n){let i=t.tr,o=n.parent;for(let v=n.end,S=n.endIndex-1,k=n.startIndex;S>k;S--)v-=o.child(S).nodeSize,i.delete(v-1,v+1);let s=i.doc.resolve(n.start),a=s.nodeAfter;if(i.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let u=n.startIndex==0,d=n.endIndex==o.childCount,h=s.node(-1),p=s.index(-1);if(!h.canReplace(p+(u?0:1),p+1,a.content.append(d?Q.empty:Q.from(o))))return!1;let g=s.pos,x=g+a.nodeSize;return i.step(new gt(g-(u?1:0),x+(d?1:0),g+1,x-1,new se((u?Q.empty:Q.from(o.copy(Q.empty))).append(d?Q.empty:Q.from(o.copy(Q.empty))),u?0:1,d?0:1),u?0:1)),e(i.scrollIntoView()),!0}function kD(t){return function(e,n){let{$from:i,$to:o}=e.selection,s=i.blockRange(o,h=>h.childCount>0&&h.firstChild.type==t);if(!s)return!1;let a=s.startIndex;if(a==0)return!1;let u=s.parent,d=u.child(a-1);if(d.type!=t)return!1;if(n){let h=d.lastChild&&d.lastChild.type==u.type,p=Q.from(h?t.create():null),g=new se(Q.from(t.create(null,Q.from(u.type.create(null,p)))),h?3:1,0),x=s.start,v=s.end;n(e.tr.step(new gt(x-(h?3:1),v,x,v,g,1,!0)).scrollIntoView())}return!0}}const kt=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},hl=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let Xp=null;const Ci=function(t,e,n){let i=Xp||(Xp=document.createRange());return i.setEnd(t,n??t.nodeValue.length),i.setStart(t,e||0),i},ED=function(){Xp=null},co=function(t,e,n,i){return n&&(Bv(t,e,n,i,-1)||Bv(t,e,n,i,1))},TD=/^(img|br|input|textarea|hr)$/i;function Bv(t,e,n,i,o){for(var s;;){if(t==n&&e==i)return!0;if(e==(o<0?0:wn(t))){let a=t.parentNode;if(!a||a.nodeType!=1||oa(t)||TD.test(t.nodeName)||t.contentEditable=="false")return!1;e=kt(t)+(o<0?0:1),t=a}else if(t.nodeType==1){let a=t.childNodes[e+(o<0?-1:0)];if(a.nodeType==1&&a.contentEditable=="false")if(!((s=a.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)e+=o;else return!1;else t=a,e=o<0?wn(t):0}else return!1}}function wn(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function MD(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=wn(t)}else if(t.parentNode&&!oa(t))e=kt(t),t=t.parentNode;else return null}}function AD(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!oa(t))e=kt(t)+1,t=t.parentNode;else return null}}function OD(t,e,n){for(let i=e==0,o=e==wn(t);i||o;){if(t==n)return!0;let s=kt(t);if(t=t.parentNode,!t)return!1;i=i&&s==0,o=o&&s==wn(t)}}function oa(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const od=function(t){return t.focusNode&&co(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Jr(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function RD(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function DD(t,e,n){if(t.caretPositionFromPoint)try{let i=t.caretPositionFromPoint(e,n);if(i)return{node:i.offsetNode,offset:Math.min(wn(i.offsetNode),i.offset)}}catch{}if(t.caretRangeFromPoint){let i=t.caretRangeFromPoint(e,n);if(i)return{node:i.startContainer,offset:Math.min(wn(i.startContainer),i.startOffset)}}}const Wn=typeof navigator<"u"?navigator:null,Iv=typeof document<"u"?document:null,Mr=Wn&&Wn.userAgent||"",Jp=/Edge\/(\d+)/.exec(Mr),qw=/MSIE \d/.exec(Mr),Qp=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Mr),Ft=!!(qw||Qp||Jp),br=qw?document.documentMode:Qp?+Qp[1]:Jp?+Jp[1]:0,Cn=!Ft&&/gecko\/(\d+)/i.test(Mr);Cn&&+(/Firefox\/(\d+)/.exec(Mr)||[0,0])[1];const Zp=!Ft&&/Chrome\/(\d+)/.exec(Mr),mt=!!Zp,Fw=Zp?+Zp[1]:0,Rt=!Ft&&!!Wn&&/Apple Computer/.test(Wn.vendor),pl=Rt&&(/Mobile\/\w+/.test(Mr)||!!Wn&&Wn.maxTouchPoints>2),Sn=pl||(Wn?/Mac/.test(Wn.platform):!1),Ww=Wn?/Win/.test(Wn.platform):!1,Ei=/Android \d/.test(Mr),la=!!Iv&&"webkitFontSmoothing"in Iv.documentElement.style,ND=la?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function jD(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function gi(t,e){return typeof t=="number"?t:t[e]}function zD(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,i=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*i}}function _v(t,e,n){let i=t.someProp("scrollThreshold")||0,o=t.someProp("scrollMargin")||5,s=t.dom.ownerDocument;for(let a=n||t.dom;a;){if(a.nodeType!=1){a=hl(a);continue}let u=a,d=u==s.body,h=d?jD(s):zD(u),p=0,g=0;if(e.top<h.top+gi(i,"top")?g=-(h.top-e.top+gi(o,"top")):e.bottom>h.bottom-gi(i,"bottom")&&(g=e.bottom-e.top>h.bottom-h.top?e.top+gi(o,"top")-h.top:e.bottom-h.bottom+gi(o,"bottom")),e.left<h.left+gi(i,"left")?p=-(h.left-e.left+gi(o,"left")):e.right>h.right-gi(i,"right")&&(p=e.right-h.right+gi(o,"right")),p||g)if(d)s.defaultView.scrollBy(p,g);else{let v=u.scrollLeft,S=u.scrollTop;g&&(u.scrollTop+=g),p&&(u.scrollLeft+=p);let k=u.scrollLeft-v,w=u.scrollTop-S;e={left:e.left-k,top:e.top-w,right:e.right-k,bottom:e.bottom-w}}let x=d?"fixed":getComputedStyle(a).position;if(/^(fixed|sticky)$/.test(x))break;a=x=="absolute"?a.offsetParent:hl(a)}}function LD(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),i,o;for(let s=(e.left+e.right)/2,a=n+1;a<Math.min(innerHeight,e.bottom);a+=5){let u=t.root.elementFromPoint(s,a);if(!u||u==t.dom||!t.dom.contains(u))continue;let d=u.getBoundingClientRect();if(d.top>=n-20){i=u,o=d.top;break}}return{refDOM:i,refTop:o,stack:Yw(t.dom)}}function Yw(t){let e=[],n=t.ownerDocument;for(let i=t;i&&(e.push({dom:i,top:i.scrollTop,left:i.scrollLeft}),t!=n);i=hl(i));return e}function BD({refDOM:t,refTop:e,stack:n}){let i=t?t.getBoundingClientRect().top:0;Gw(n,i==0?0:i-e)}function Gw(t,e){for(let n=0;n<t.length;n++){let{dom:i,top:o,left:s}=t[n];i.scrollTop!=o+e&&(i.scrollTop=o+e),i.scrollLeft!=s&&(i.scrollLeft=s)}}let tl=null;function ID(t){if(t.setActive)return t.setActive();if(tl)return t.focus(tl);let e=Yw(t);t.focus(tl==null?{get preventScroll(){return tl={preventScroll:!0},!0}}:void 0),tl||(tl=!1,Gw(e,0))}function Kw(t,e){let n,i=2e8,o,s=0,a=e.top,u=e.top,d,h;for(let p=t.firstChild,g=0;p;p=p.nextSibling,g++){let x;if(p.nodeType==1)x=p.getClientRects();else if(p.nodeType==3)x=Ci(p).getClientRects();else continue;for(let v=0;v<x.length;v++){let S=x[v];if(S.top<=a&&S.bottom>=u){a=Math.max(S.bottom,a),u=Math.min(S.top,u);let k=S.left>e.left?S.left-e.left:S.right<e.left?e.left-S.right:0;if(k<i){n=p,i=k,o=k&&n.nodeType==3?{left:S.right<e.left?S.right:S.left,top:e.top}:e,p.nodeType==1&&k&&(s=g+(e.left>=(S.left+S.right)/2?1:0));continue}}else S.top>e.top&&!d&&S.left<=e.left&&S.right>=e.left&&(d=p,h={left:Math.max(S.left,Math.min(S.right,e.left)),top:S.top});!n&&(e.left>=S.right&&e.top>=S.top||e.left>=S.left&&e.top>=S.bottom)&&(s=g+1)}}return!n&&d&&(n=d,o=h,i=0),n&&n.nodeType==3?_D(n,o):!n||i&&n.nodeType==1?{node:t,offset:s}:Kw(n,o)}function _D(t,e){let n=t.nodeValue.length,i=document.createRange(),o;for(let s=0;s<n;s++){i.setEnd(t,s+1),i.setStart(t,s);let a=ar(i,1);if(a.top!=a.bottom&&$m(e,a)){o={node:t,offset:s+(e.left>=(a.left+a.right)/2?1:0)};break}}return i.detach(),o||{node:t,offset:0}}function $m(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function HD(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function UD(t,e,n){let{node:i,offset:o}=Kw(e,n),s=-1;if(i.nodeType==1&&!i.firstChild){let a=i.getBoundingClientRect();s=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return t.docView.posFromDOM(i,o,s)}function $D(t,e,n,i){let o=-1;for(let s=e,a=!1;s!=t.dom;){let u=t.docView.nearestDesc(s,!0),d;if(!u)return null;if(u.dom.nodeType==1&&(u.node.isBlock&&u.parent||!u.contentDOM)&&((d=u.dom.getBoundingClientRect()).width||d.height)&&(u.node.isBlock&&u.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(u.dom.nodeName)&&(!a&&d.left>i.left||d.top>i.top?o=u.posBefore:(!a&&d.right<i.left||d.bottom<i.top)&&(o=u.posAfter),a=!0),!u.contentDOM&&o<0&&!u.node.isText))return(u.node.isBlock?i.top<(d.top+d.bottom)/2:i.left<(d.left+d.right)/2)?u.posBefore:u.posAfter;s=u.dom.parentNode}return o>-1?o:t.docView.posFromDOM(e,n,-1)}function Xw(t,e,n){let i=t.childNodes.length;if(i&&n.top<n.bottom)for(let o=Math.max(0,Math.min(i-1,Math.floor(i*(e.top-n.top)/(n.bottom-n.top))-2)),s=o;;){let a=t.childNodes[s];if(a.nodeType==1){let u=a.getClientRects();for(let d=0;d<u.length;d++){let h=u[d];if($m(e,h))return Xw(a,e,h)}}if((s=(s+1)%i)==o)break}return t}function PD(t,e){let n=t.dom.ownerDocument,i,o=0,s=DD(n,e.left,e.top);s&&({node:i,offset:o}=s);let a=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),u;if(!a||!t.dom.contains(a.nodeType!=1?a.parentNode:a)){let h=t.dom.getBoundingClientRect();if(!$m(e,h)||(a=Xw(t.dom,e,h),!a))return null}if(Rt)for(let h=a;i&&h;h=hl(h))h.draggable&&(i=void 0);if(a=HD(a,e),i){if(Cn&&i.nodeType==1&&(o=Math.min(o,i.childNodes.length),o<i.childNodes.length)){let p=i.childNodes[o],g;p.nodeName=="IMG"&&(g=p.getBoundingClientRect()).right<=e.left&&g.bottom>e.top&&o++}let h;la&&o&&i.nodeType==1&&(h=i.childNodes[o-1]).nodeType==1&&h.contentEditable=="false"&&h.getBoundingClientRect().top>=e.top&&o--,i==t.dom&&o==i.childNodes.length-1&&i.lastChild.nodeType==1&&e.top>i.lastChild.getBoundingClientRect().bottom?u=t.state.doc.content.size:(o==0||i.nodeType!=1||i.childNodes[o-1].nodeName!="BR")&&(u=$D(t,i,o,e))}u==null&&(u=UD(t,a,e));let d=t.docView.nearestDesc(a,!0);return{pos:u,inside:d?d.posAtStart-d.border:-1}}function Hv(t){return t.top<t.bottom||t.left<t.right}function ar(t,e){let n=t.getClientRects();if(n.length){let i=n[e<0?0:n.length-1];if(Hv(i))return i}return Array.prototype.find.call(n,Hv)||t.getBoundingClientRect()}const VD=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Jw(t,e,n){let{node:i,offset:o,atom:s}=t.docView.domFromPos(e,n<0?-1:1),a=la||Cn;if(i.nodeType==3)if(a&&(VD.test(i.nodeValue)||(n<0?!o:o==i.nodeValue.length))){let d=ar(Ci(i,o,o),n);if(Cn&&o&&/\s/.test(i.nodeValue[o-1])&&o<i.nodeValue.length){let h=ar(Ci(i,o-1,o-1),-1);if(h.top==d.top){let p=ar(Ci(i,o,o+1),-1);if(p.top!=d.top)return Ss(p,p.left<h.left)}}return d}else{let d=o,h=o,p=n<0?1:-1;return n<0&&!o?(h++,p=-1):n>=0&&o==i.nodeValue.length?(d--,p=1):n<0?d--:h++,Ss(ar(Ci(i,d,h),p),p<0)}if(!t.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&o&&(n<0||o==wn(i))){let d=i.childNodes[o-1];if(d.nodeType==1)return lp(d.getBoundingClientRect(),!1)}if(s==null&&o<wn(i)){let d=i.childNodes[o];if(d.nodeType==1)return lp(d.getBoundingClientRect(),!0)}return lp(i.getBoundingClientRect(),n>=0)}if(s==null&&o&&(n<0||o==wn(i))){let d=i.childNodes[o-1],h=d.nodeType==3?Ci(d,wn(d)-(a?0:1)):d.nodeType==1&&(d.nodeName!="BR"||!d.nextSibling)?d:null;if(h)return Ss(ar(h,1),!1)}if(s==null&&o<wn(i)){let d=i.childNodes[o];for(;d.pmViewDesc&&d.pmViewDesc.ignoreForCoords;)d=d.nextSibling;let h=d?d.nodeType==3?Ci(d,0,a?0:1):d.nodeType==1?d:null:null;if(h)return Ss(ar(h,-1),!0)}return Ss(ar(i.nodeType==3?Ci(i):i,-n),n>=0)}function Ss(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function lp(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function Qw(t,e,n){let i=t.state,o=t.root.activeElement;i!=e&&t.updateState(e),o!=t.dom&&t.focus();try{return n()}finally{i!=e&&t.updateState(i),o!=t.dom&&o&&o.focus()}}function qD(t,e,n){let i=e.selection,o=n=="up"?i.$from:i.$to;return Qw(t,e,()=>{let{node:s}=t.docView.domFromPos(o.pos,n=="up"?-1:1);for(;;){let u=t.docView.nearestDesc(s,!0);if(!u)break;if(u.node.isBlock){s=u.contentDOM||u.dom;break}s=u.dom.parentNode}let a=Jw(t,o.pos,1);for(let u=s.firstChild;u;u=u.nextSibling){let d;if(u.nodeType==1)d=u.getClientRects();else if(u.nodeType==3)d=Ci(u,0,u.nodeValue.length).getClientRects();else continue;for(let h=0;h<d.length;h++){let p=d[h];if(p.bottom>p.top+1&&(n=="up"?a.top-p.top>(p.bottom-a.top)*2:p.bottom-a.bottom>(a.bottom-p.top)*2))return!1}}return!0})}const FD=/[\u0590-\u08ac]/;function WD(t,e,n){let{$head:i}=e.selection;if(!i.parent.isTextblock)return!1;let o=i.parentOffset,s=!o,a=o==i.parent.content.size,u=t.domSelection();return u?!FD.test(i.parent.textContent)||!u.modify?n=="left"||n=="backward"?s:a:Qw(t,e,()=>{let{focusNode:d,focusOffset:h,anchorNode:p,anchorOffset:g}=t.domSelectionRange(),x=u.caretBidiLevel;u.modify("move",n,"character");let v=i.depth?t.docView.domAfterPos(i.before()):t.dom,{focusNode:S,focusOffset:k}=t.domSelectionRange(),w=S&&!v.contains(S.nodeType==1?S:S.parentNode)||d==S&&h==k;try{u.collapse(p,g),d&&(d!=p||h!=g)&&u.extend&&u.extend(d,h)}catch{}return x!=null&&(u.caretBidiLevel=x),w}):i.pos==i.start()||i.pos==i.end()}let Uv=null,$v=null,Pv=!1;function YD(t,e,n){return Uv==e&&$v==n?Pv:(Uv=e,$v=n,Pv=n=="up"||n=="down"?qD(t,e,n):WD(t,e,n))}const kn=0,Vv=1,Qr=2,Yn=3;class sa{constructor(e,n,i,o){this.parent=e,this.children=n,this.dom=i,this.contentDOM=o,this.dirty=kn,i.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,i){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,i=this.posAtStart;;n++){let o=this.children[n];if(o==e)return i;i+=o.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,i){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(i<0){let s,a;if(e==this.contentDOM)s=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((a=s.pmViewDesc)&&a.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(a)+a.size:this.posAtStart}else{let s,a;if(e==this.contentDOM)s=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((a=s.pmViewDesc)&&a.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(a):this.posAtEnd}let o;if(e==this.dom&&this.contentDOM)o=n>kt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))o=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let s=e;;s=s.parentNode){if(s==this.dom){o=!1;break}if(s.previousSibling)break}if(o==null&&n==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){o=!0;break}if(s.nextSibling)break}}return o??i>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let i=!0,o=e;o;o=o.parentNode){let s=this.getDesc(o),a;if(s&&(!n||s.node))if(i&&(a=s.nodeDOM)&&!(a.nodeType==1?a.contains(e.nodeType==1?e:e.parentNode):a==e))i=!1;else return s}}getDesc(e){let n=e.pmViewDesc;for(let i=n;i;i=i.parent)if(i==this)return n}posFromDOM(e,n,i){for(let o=e;o;o=o.parentNode){let s=this.getDesc(o);if(s)return s.localPosFromDOM(e,n,i)}return-1}descAt(e){for(let n=0,i=0;n<this.children.length;n++){let o=this.children[n],s=i+o.size;if(i==e&&s!=i){for(;!o.border&&o.children.length;)for(let a=0;a<o.children.length;a++){let u=o.children[a];if(u.size){o=u;break}}return o}if(e<s)return o.descAt(e-i-o.border);i=s}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let i=0,o=0;for(let s=0;i<this.children.length;i++){let a=this.children[i],u=s+a.size;if(u>e||a instanceof eC){o=e-s;break}s=u}if(o)return this.children[i].domFromPos(o-this.children[i].border,n);for(let s;i&&!(s=this.children[i-1]).size&&s instanceof Zw&&s.side>=0;i--);if(n<=0){let s,a=!0;for(;s=i?this.children[i-1]:null,!(!s||s.dom.parentNode==this.contentDOM);i--,a=!1);return s&&n&&a&&!s.border&&!s.domAtom?s.domFromPos(s.size,n):{node:this.contentDOM,offset:s?kt(s.dom)+1:0}}else{let s,a=!0;for(;s=i<this.children.length?this.children[i]:null,!(!s||s.dom.parentNode==this.contentDOM);i++,a=!1);return s&&a&&!s.border&&!s.domAtom?s.domFromPos(0,n):{node:this.contentDOM,offset:s?kt(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,i=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let o=-1,s=-1;for(let a=i,u=0;;u++){let d=this.children[u],h=a+d.size;if(o==-1&&e<=h){let p=a+d.border;if(e>=p&&n<=h-d.border&&d.node&&d.contentDOM&&this.contentDOM.contains(d.contentDOM))return d.parseRange(e,n,p);e=a;for(let g=u;g>0;g--){let x=this.children[g-1];if(x.size&&x.dom.parentNode==this.contentDOM&&!x.emptyChildAt(1)){o=kt(x.dom)+1;break}e-=x.size}o==-1&&(o=0)}if(o>-1&&(h>n||u==this.children.length-1)){n=h;for(let p=u+1;p<this.children.length;p++){let g=this.children[p];if(g.size&&g.dom.parentNode==this.contentDOM&&!g.emptyChildAt(-1)){s=kt(g.dom);break}n+=g.size}s==-1&&(s=this.contentDOM.childNodes.length);break}a=h}return{node:this.contentDOM,from:e,to:n,fromOffset:o,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:i}=this.domFromPos(e,0);if(n.nodeType!=1||i==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[i]}setSelection(e,n,i,o=!1){let s=Math.min(e,n),a=Math.max(e,n);for(let v=0,S=0;v<this.children.length;v++){let k=this.children[v],w=S+k.size;if(s>S&&a<w)return k.setSelection(e-S-k.border,n-S-k.border,i,o);S=w}let u=this.domFromPos(e,e?-1:1),d=n==e?u:this.domFromPos(n,n?-1:1),h=i.root.getSelection(),p=i.domSelectionRange(),g=!1;if((Cn||Rt)&&e==n){let{node:v,offset:S}=u;if(v.nodeType==3){if(g=!!(S&&v.nodeValue[S-1]==`
`),g&&S==v.nodeValue.length)for(let k=v,w;k;k=k.parentNode){if(w=k.nextSibling){w.nodeName=="BR"&&(u=d={node:w.parentNode,offset:kt(w)+1});break}let E=k.pmViewDesc;if(E&&E.node&&E.node.isBlock)break}}else{let k=v.childNodes[S-1];g=k&&(k.nodeName=="BR"||k.contentEditable=="false")}}if(Cn&&p.focusNode&&p.focusNode!=d.node&&p.focusNode.nodeType==1){let v=p.focusNode.childNodes[p.focusOffset];v&&v.contentEditable=="false"&&(o=!0)}if(!(o||g&&Rt)&&co(u.node,u.offset,p.anchorNode,p.anchorOffset)&&co(d.node,d.offset,p.focusNode,p.focusOffset))return;let x=!1;if((h.extend||e==n)&&!(g&&Cn)){h.collapse(u.node,u.offset);try{e!=n&&h.extend(d.node,d.offset),x=!0}catch{}}if(!x){if(e>n){let S=u;u=d,d=S}let v=document.createRange();v.setEnd(d.node,d.offset),v.setStart(u.node,u.offset),h.removeAllRanges(),h.addRange(v)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let i=0,o=0;o<this.children.length;o++){let s=this.children[o],a=i+s.size;if(i==a?e<=a&&n>=i:e<a&&n>i){let u=i+s.border,d=a-s.border;if(e>=u&&n<=d){this.dirty=e==i||n==a?Qr:Vv,e==u&&n==d&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=Yn:s.markDirty(e-u,n-u);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?Qr:Yn}i=a}this.dirty=Qr}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let i=e==1?Qr:Vv;n.dirty<i&&(n.dirty=i)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class Zw extends sa{constructor(e,n,i,o){let s,a=n.type.toDOM;if(typeof a=="function"&&(a=a(i,()=>{if(!s)return o;if(s.parent)return s.parent.posBeforeChild(s)})),!n.type.spec.raw){if(a.nodeType!=1){let u=document.createElement("span");u.appendChild(a),a=u}a.contentEditable="false",a.classList.add("ProseMirror-widget")}super(e,[],a,null),this.widget=n,this.widget=n,s=this}matchesWidget(e){return this.dirty==kn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class GD extends sa{constructor(e,n,i,o){super(e,[],n,null),this.textDOM=i,this.text=o}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class uo extends sa{constructor(e,n,i,o,s){super(e,[],i,o),this.mark=n,this.spec=s}static create(e,n,i,o){let s=o.nodeViews[n.type.name],a=s&&s(n,o,i);return(!a||!a.dom)&&(a=po.renderSpec(document,n.type.spec.toDOM(n,i),null,n.attrs)),new uo(e,n,a.dom,a.contentDOM||a.dom,a)}parseRule(){return this.dirty&Yn||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Yn&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=kn){let i=this.parent;for(;!i.node;)i=i.parent;i.dirty<this.dirty&&(i.dirty=this.dirty),this.dirty=kn}}slice(e,n,i){let o=uo.create(this.parent,this.mark,!0,i),s=this.children,a=this.size;n<a&&(s=tm(s,n,a,i)),e>0&&(s=tm(s,0,e,i));for(let u=0;u<s.length;u++)s[u].parent=o;return o.children=s,o}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class vr extends sa{constructor(e,n,i,o,s,a,u,d,h){super(e,[],s,a),this.node=n,this.outerDeco=i,this.innerDeco=o,this.nodeDOM=u}static create(e,n,i,o,s,a){let u=s.nodeViews[n.type.name],d,h=u&&u(n,s,()=>{if(!d)return a;if(d.parent)return d.parent.posBeforeChild(d)},i,o),p=h&&h.dom,g=h&&h.contentDOM;if(n.isText){if(!p)p=document.createTextNode(n.text);else if(p.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else p||({dom:p,contentDOM:g}=po.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!g&&!n.isText&&p.nodeName!="BR"&&(p.hasAttribute("contenteditable")||(p.contentEditable="false"),n.type.spec.draggable&&(p.draggable=!0));let x=p;return p=iC(p,i,n),h?d=new KD(e,n,i,o,p,g||null,x,h,s,a+1):n.isText?new ld(e,n,i,o,p,x,s):new vr(e,n,i,o,p,g||null,x,s,a+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let i=this.children[n];if(this.dom.contains(i.dom.parentNode)){e.contentElement=i.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Q.empty)}return e}matchesNode(e,n,i){return this.dirty==kn&&e.eq(this.node)&&du(n,this.outerDeco)&&i.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let i=this.node.inlineContent,o=n,s=e.composing?this.localCompositionInfo(e,n):null,a=s&&s.pos>-1?s:null,u=s&&s.pos<0,d=new JD(this,a&&a.node,e);eN(this.node,this.innerDeco,(h,p,g)=>{h.spec.marks?d.syncToMarks(h.spec.marks,i,e):h.type.side>=0&&!g&&d.syncToMarks(p==this.node.childCount?Pe.none:this.node.child(p).marks,i,e),d.placeWidget(h,e,o)},(h,p,g,x)=>{d.syncToMarks(h.marks,i,e);let v;d.findNodeMatch(h,p,g,x)||u&&e.state.selection.from>o&&e.state.selection.to<o+h.nodeSize&&(v=d.findIndexWithChild(s.node))>-1&&d.updateNodeAt(h,p,g,v,e)||d.updateNextNode(h,p,g,e,x,o)||d.addNode(h,p,g,e,o),o+=h.nodeSize}),d.syncToMarks([],i,e),this.node.isTextblock&&d.addTextblockHacks(),d.destroyRest(),(d.changed||this.dirty==Qr)&&(a&&this.protectLocalComposition(e,a),tC(this.contentDOM,this.children,e),pl&&tN(this.dom))}localCompositionInfo(e,n){let{from:i,to:o}=e.state.selection;if(!(e.state.selection instanceof Se)||i<n||o>n+this.node.content.size)return null;let s=e.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let a=s.nodeValue,u=nN(this.node.content,a,i-n,o-n);return u<0?null:{node:s,pos:u,text:a}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:i,text:o}){if(this.getDesc(n))return;let s=n;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let a=new GD(this,s,n,o);e.input.compositionNodes.push(a),this.children=tm(this.children,i,i+o.length,e,a)}update(e,n,i,o){return this.dirty==Yn||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,i,o),!0)}updateInner(e,n,i,o){this.updateOuterDeco(n),this.node=e,this.innerDeco=i,this.contentDOM&&this.updateChildren(o,this.posAtStart),this.dirty=kn}updateOuterDeco(e){if(du(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,i=this.dom;this.dom=nC(this.dom,this.nodeDOM,em(this.outerDeco,this.node,n),em(e,this.node,n)),this.dom!=i&&(i.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function qv(t,e,n,i,o){iC(i,e,t);let s=new vr(void 0,t,e,n,i,i,i,o,0);return s.contentDOM&&s.updateChildren(o,0),s}class ld extends vr{constructor(e,n,i,o,s,a,u){super(e,n,i,o,s,null,a,u,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,i,o){return this.dirty==Yn||this.dirty!=kn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=kn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,o.trackWrites==this.nodeDOM&&(o.trackWrites=null)),this.node=e,this.dirty=kn,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,i){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,i)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,i){let o=this.node.cut(e,n),s=document.createTextNode(o.text);return new ld(this.parent,o,this.outerDeco,this.innerDeco,s,s,i)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Yn)}get domAtom(){return!1}isText(e){return this.node.text==e}}class eC extends sa{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==kn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class KD extends vr{constructor(e,n,i,o,s,a,u,d,h,p){super(e,n,i,o,s,a,u,h,p),this.spec=d}update(e,n,i,o){if(this.dirty==Yn)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let s=this.spec.update(e,n,i);return s&&this.updateInner(e,n,i,o),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,i,o)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,i,o){this.spec.setSelection?this.spec.setSelection(e,n,i.root):super.setSelection(e,n,i,o)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function tC(t,e,n){let i=t.firstChild,o=!1;for(let s=0;s<e.length;s++){let a=e[s],u=a.dom;if(u.parentNode==t){for(;u!=i;)i=Fv(i),o=!0;i=i.nextSibling}else o=!0,t.insertBefore(u,i);if(a instanceof uo){let d=i?i.previousSibling:t.lastChild;tC(a.contentDOM,a.children,n),i=d?d.nextSibling:t.firstChild}}for(;i;)i=Fv(i),o=!0;o&&n.trackWrites==t&&(n.trackWrites=null)}const Ls=function(t){t&&(this.nodeName=t)};Ls.prototype=Object.create(null);const Zr=[new Ls];function em(t,e,n){if(t.length==0)return Zr;let i=n?Zr[0]:new Ls,o=[i];for(let s=0;s<t.length;s++){let a=t[s].type.attrs;if(a){a.nodeName&&o.push(i=new Ls(a.nodeName));for(let u in a){let d=a[u];d!=null&&(n&&o.length==1&&o.push(i=new Ls(e.isInline?"span":"div")),u=="class"?i.class=(i.class?i.class+" ":"")+d:u=="style"?i.style=(i.style?i.style+";":"")+d:u!="nodeName"&&(i[u]=d))}}}return o}function nC(t,e,n,i){if(n==Zr&&i==Zr)return e;let o=e;for(let s=0;s<i.length;s++){let a=i[s],u=n[s];if(s){let d;u&&u.nodeName==a.nodeName&&o!=t&&(d=o.parentNode)&&d.nodeName.toLowerCase()==a.nodeName||(d=document.createElement(a.nodeName),d.pmIsDeco=!0,d.appendChild(o),u=Zr[0]),o=d}XD(o,u||Zr[0],a)}return o}function XD(t,e,n){for(let i in e)i!="class"&&i!="style"&&i!="nodeName"&&!(i in n)&&t.removeAttribute(i);for(let i in n)i!="class"&&i!="style"&&i!="nodeName"&&n[i]!=e[i]&&t.setAttribute(i,n[i]);if(e.class!=n.class){let i=e.class?e.class.split(" ").filter(Boolean):[],o=n.class?n.class.split(" ").filter(Boolean):[];for(let s=0;s<i.length;s++)o.indexOf(i[s])==-1&&t.classList.remove(i[s]);for(let s=0;s<o.length;s++)i.indexOf(o[s])==-1&&t.classList.add(o[s]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let i=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,o;for(;o=i.exec(e.style);)t.style.removeProperty(o[1])}n.style&&(t.style.cssText+=n.style)}}function iC(t,e,n){return nC(t,t,Zr,em(e,n,t.nodeType!=1))}function du(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function Fv(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class JD{constructor(e,n,i){this.lock=n,this.view=i,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=QD(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let i=e;i<n;i++)this.top.children[i].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,i){let o=0,s=this.stack.length>>1,a=Math.min(s,e.length);for(;o<a&&(o==s-1?this.top:this.stack[o+1<<1]).matchesMark(e[o])&&e[o].type.spec.spanning!==!1;)o++;for(;o<s;)this.destroyRest(),this.top.dirty=kn,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let u=-1;for(let d=this.index;d<Math.min(this.index+3,this.top.children.length);d++){let h=this.top.children[d];if(h.matchesMark(e[s])&&!this.isLocked(h.dom)){u=d;break}}if(u>-1)u>this.index&&(this.changed=!0,this.destroyBetween(this.index,u)),this.top=this.top.children[this.index];else{let d=uo.create(this.top,e[s],n,i);this.top.children.splice(this.index,0,d),this.top=d,this.changed=!0}this.index=0,s++}}findNodeMatch(e,n,i,o){let s=-1,a;if(o>=this.preMatch.index&&(a=this.preMatch.matches[o-this.preMatch.index]).parent==this.top&&a.matchesNode(e,n,i))s=this.top.children.indexOf(a,this.index);else for(let u=this.index,d=Math.min(this.top.children.length,u+5);u<d;u++){let h=this.top.children[u];if(h.matchesNode(e,n,i)&&!this.preMatch.matched.has(h)){s=u;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,n,i,o,s){let a=this.top.children[o];return a.dirty==Yn&&a.dom==a.contentDOM&&(a.dirty=Qr),a.update(e,n,i,s)?(this.destroyBetween(this.index,o),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let i=e.pmViewDesc;if(i){for(let o=this.index;o<this.top.children.length;o++)if(this.top.children[o]==i)return o}return-1}e=n}}updateNextNode(e,n,i,o,s,a){for(let u=this.index;u<this.top.children.length;u++){let d=this.top.children[u];if(d instanceof vr){let h=this.preMatch.matched.get(d);if(h!=null&&h!=s)return!1;let p=d.dom,g,x=this.isLocked(p)&&!(e.isText&&d.node&&d.node.isText&&d.nodeDOM.nodeValue==e.text&&d.dirty!=Yn&&du(n,d.outerDeco));if(!x&&d.update(e,n,i,o))return this.destroyBetween(this.index,u),d.dom!=p&&(this.changed=!0),this.index++,!0;if(!x&&(g=this.recreateWrapper(d,e,n,i,o,a)))return this.destroyBetween(this.index,u),this.top.children[this.index]=g,g.contentDOM&&(g.dirty=Qr,g.updateChildren(o,a+1),g.dirty=kn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,i,o,s,a){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!du(i,e.outerDeco)||!o.eq(e.innerDeco))return null;let u=vr.create(this.top,n,i,o,s,a);if(u.contentDOM){u.children=e.children,e.children=[];for(let d of u.children)d.parent=u}return e.destroy(),u}addNode(e,n,i,o,s){let a=vr.create(this.top,e,n,i,o,s);a.contentDOM&&a.updateChildren(o,s+1),this.top.children.splice(this.index++,0,a),this.changed=!0}placeWidget(e,n,i){let o=this.index<this.top.children.length?this.top.children[this.index]:null;if(o&&o.matchesWidget(e)&&(e==o.widget||!o.widget.type.toDOM.parentNode))this.index++;else{let s=new Zw(this.top,e,n,i);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof uo;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof ld)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Rt||mt)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let i=document.createElement(e);e=="IMG"&&(i.className="ProseMirror-separator",i.alt=""),e=="BR"&&(i.className="ProseMirror-trailingBreak");let o=new eC(this.top,[],i,null);n!=this.top?n.children.push(o):n.children.splice(this.index++,0,o),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function QD(t,e){let n=e,i=n.children.length,o=t.childCount,s=new Map,a=[];e:for(;o>0;){let u;for(;;)if(i){let h=n.children[i-1];if(h instanceof uo)n=h,i=h.children.length;else{u=h,i--;break}}else{if(n==e)break e;i=n.parent.children.indexOf(n),n=n.parent}let d=u.node;if(d){if(d!=t.child(o-1))break;--o,s.set(u,o),a.push(u)}}return{index:o,matched:s,matches:a.reverse()}}function ZD(t,e){return t.type.side-e.type.side}function eN(t,e,n,i){let o=e.locals(t),s=0;if(o.length==0){for(let h=0;h<t.childCount;h++){let p=t.child(h);i(p,o,e.forChild(s,p),h),s+=p.nodeSize}return}let a=0,u=[],d=null;for(let h=0;;){let p,g;for(;a<o.length&&o[a].to==s;){let w=o[a++];w.widget&&(p?(g||(g=[p])).push(w):p=w)}if(p)if(g){g.sort(ZD);for(let w=0;w<g.length;w++)n(g[w],h,!!d)}else n(p,h,!!d);let x,v;if(d)v=-1,x=d,d=null;else if(h<t.childCount)v=h,x=t.child(h++);else break;for(let w=0;w<u.length;w++)u[w].to<=s&&u.splice(w--,1);for(;a<o.length&&o[a].from<=s&&o[a].to>s;)u.push(o[a++]);let S=s+x.nodeSize;if(x.isText){let w=S;a<o.length&&o[a].from<w&&(w=o[a].from);for(let E=0;E<u.length;E++)u[E].to<w&&(w=u[E].to);w<S&&(d=x.cut(w-s),x=x.cut(0,w-s),S=w,v=-1)}else for(;a<o.length&&o[a].to<S;)a++;let k=x.isInline&&!x.isLeaf?u.filter(w=>!w.inline):u.slice();i(x,k,e.forChild(s,x),v),s=S}}function tN(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function nN(t,e,n,i){for(let o=0,s=0;o<t.childCount&&s<=i;){let a=t.child(o++),u=s;if(s+=a.nodeSize,!a.isText)continue;let d=a.text;for(;o<t.childCount;){let h=t.child(o++);if(s+=h.nodeSize,!h.isText)break;d+=h.text}if(s>=n){if(s>=i&&d.slice(i-e.length-u,i-u)==e)return i-e.length;let h=u<i?d.lastIndexOf(e,i-u-1):-1;if(h>=0&&h+e.length+u>=n)return u+h;if(n==i&&d.length>=i+e.length-u&&d.slice(i-u,i-u+e.length)==e)return i}}return-1}function tm(t,e,n,i,o){let s=[];for(let a=0,u=0;a<t.length;a++){let d=t[a],h=u,p=u+=d.size;h>=n||p<=e?s.push(d):(h<e&&s.push(d.slice(0,e-h,i)),o&&(s.push(o),o=void 0),p>n&&s.push(d.slice(n-h,d.size,i)))}return s}function Pm(t,e=null){let n=t.domSelectionRange(),i=t.state.doc;if(!n.focusNode)return null;let o=t.docView.nearestDesc(n.focusNode),s=o&&o.size==0,a=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(a<0)return null;let u=i.resolve(a),d,h;if(od(n)){for(d=a;o&&!o.node;)o=o.parent;let g=o.node;if(o&&g.isAtom&&xe.isSelectable(g)&&o.parent&&!(g.isInline&&OD(n.focusNode,n.focusOffset,o.dom))){let x=o.posBefore;h=new xe(a==x?u:i.resolve(x))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let g=a,x=a;for(let v=0;v<n.rangeCount;v++){let S=n.getRangeAt(v);g=Math.min(g,t.docView.posFromDOM(S.startContainer,S.startOffset,1)),x=Math.max(x,t.docView.posFromDOM(S.endContainer,S.endOffset,-1))}if(g<0)return null;[d,a]=x==t.state.selection.anchor?[x,g]:[g,x],u=i.resolve(a)}else d=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(d<0)return null}let p=i.resolve(d);if(!h){let g=e=="pointer"||t.state.selection.head<u.pos&&!s?1:-1;h=Vm(t,p,u,g)}return h}function rC(t){return t.editable?t.hasFocus():lC(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Oi(t,e=!1){let n=t.state.selection;if(oC(t,n),!!rC(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&mt){let i=t.domSelectionRange(),o=t.domObserver.currentSelection;if(i.anchorNode&&o.anchorNode&&co(i.anchorNode,i.anchorOffset,o.anchorNode,o.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)rN(t);else{let{anchor:i,head:o}=n,s,a;Wv&&!(n instanceof Se)&&(n.$from.parent.inlineContent||(s=Yv(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(a=Yv(t,n.to))),t.docView.setSelection(i,o,t,e),Wv&&(s&&Gv(s),a&&Gv(a)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&iN(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const Wv=Rt||mt&&Fw<63;function Yv(t,e){let{node:n,offset:i}=t.docView.domFromPos(e,0),o=i<n.childNodes.length?n.childNodes[i]:null,s=i?n.childNodes[i-1]:null;if(Rt&&o&&o.contentEditable=="false")return sp(o);if((!o||o.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(o)return sp(o);if(s)return sp(s)}}function sp(t){return t.contentEditable="true",Rt&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Gv(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function iN(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),i=n.anchorNode,o=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=i||n.anchorOffset!=o)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!rC(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function rN(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,i=n.nodeName=="IMG";i?e.collapse(n.parentNode,kt(n)+1):e.collapse(n,0),!i&&!t.state.selection.visible&&Ft&&br<=11&&(n.disabled=!0,n.disabled=!1)}function oC(t,e){if(e instanceof xe){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Kv(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Kv(t)}function Kv(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Vm(t,e,n,i){return t.someProp("createSelectionBetween",o=>o(t,e,n))||Se.between(e,n,i)}function Xv(t){return t.editable&&!t.hasFocus()?!1:lC(t)}function lC(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function oN(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return co(e.node,e.offset,n.anchorNode,n.anchorOffset)}function nm(t,e){let{$anchor:n,$head:i}=t.selection,o=e>0?n.max(i):n.min(i),s=o.parent.inlineContent?o.depth?t.doc.resolve(e>0?o.after():o.before()):null:o;return s&&ve.findFrom(s,e)}function cr(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function Jv(t,e,n){let i=t.state.selection;if(i instanceof Se)if(n.indexOf("s")>-1){let{$head:o}=i,s=o.textOffset?null:e<0?o.nodeBefore:o.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let a=t.state.doc.resolve(o.pos+s.nodeSize*(e<0?-1:1));return cr(t,new Se(i.$anchor,a))}else if(i.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let o=nm(t.state,e);return o&&o instanceof xe?cr(t,o):!1}else if(!(Sn&&n.indexOf("m")>-1)){let o=i.$head,s=o.textOffset?null:e<0?o.nodeBefore:o.nodeAfter,a;if(!s||s.isText)return!1;let u=e<0?o.pos-s.nodeSize:o.pos;return s.isAtom||(a=t.docView.descAt(u))&&!a.contentDOM?xe.isSelectable(s)?cr(t,new xe(e<0?t.state.doc.resolve(o.pos-s.nodeSize):o)):la?cr(t,new Se(t.state.doc.resolve(e<0?u:u+s.nodeSize))):!1:!1}}else return!1;else{if(i instanceof xe&&i.node.isInline)return cr(t,new Se(e>0?i.$to:i.$from));{let o=nm(t.state,e);return o?cr(t,o):!1}}}function fu(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Bs(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function nl(t,e){return e<0?lN(t):sN(t)}function lN(t){let e=t.domSelectionRange(),n=e.focusNode,i=e.focusOffset;if(!n)return;let o,s,a=!1;for(Cn&&n.nodeType==1&&i<fu(n)&&Bs(n.childNodes[i],-1)&&(a=!0);;)if(i>0){if(n.nodeType!=1)break;{let u=n.childNodes[i-1];if(Bs(u,-1))o=n,s=--i;else if(u.nodeType==3)n=u,i=n.nodeValue.length;else break}}else{if(sC(n))break;{let u=n.previousSibling;for(;u&&Bs(u,-1);)o=n.parentNode,s=kt(u),u=u.previousSibling;if(u)n=u,i=fu(n);else{if(n=n.parentNode,n==t.dom)break;i=0}}}a?im(t,n,i):o&&im(t,o,s)}function sN(t){let e=t.domSelectionRange(),n=e.focusNode,i=e.focusOffset;if(!n)return;let o=fu(n),s,a;for(;;)if(i<o){if(n.nodeType!=1)break;let u=n.childNodes[i];if(Bs(u,1))s=n,a=++i;else break}else{if(sC(n))break;{let u=n.nextSibling;for(;u&&Bs(u,1);)s=u.parentNode,a=kt(u)+1,u=u.nextSibling;if(u)n=u,i=0,o=fu(n);else{if(n=n.parentNode,n==t.dom)break;i=o=0}}}s&&im(t,s,a)}function sC(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function aN(t,e){for(;t&&e==t.childNodes.length&&!oa(t);)e=kt(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function cN(t,e){for(;t&&!e&&!oa(t);)e=kt(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function im(t,e,n){if(e.nodeType!=3){let s,a;(a=aN(e,n))?(e=a,n=0):(s=cN(e,n))&&(e=s,n=s.nodeValue.length)}let i=t.domSelection();if(!i)return;if(od(i)){let s=document.createRange();s.setEnd(e,n),s.setStart(e,n),i.removeAllRanges(),i.addRange(s)}else i.extend&&i.extend(e,n);t.domObserver.setCurSelection();let{state:o}=t;setTimeout(()=>{t.state==o&&Oi(t)},50)}function Qv(t,e){let n=t.state.doc.resolve(e);if(!(mt||Ww)&&n.parent.inlineContent){let o=t.coordsAtPos(e);if(e>n.start()){let s=t.coordsAtPos(e-1),a=(s.top+s.bottom)/2;if(a>o.top&&a<o.bottom&&Math.abs(s.left-o.left)>1)return s.left<o.left?"ltr":"rtl"}if(e<n.end()){let s=t.coordsAtPos(e+1),a=(s.top+s.bottom)/2;if(a>o.top&&a<o.bottom&&Math.abs(s.left-o.left)>1)return s.left>o.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function Zv(t,e,n){let i=t.state.selection;if(i instanceof Se&&!i.empty||n.indexOf("s")>-1||Sn&&n.indexOf("m")>-1)return!1;let{$from:o,$to:s}=i;if(!o.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let a=nm(t.state,e);if(a&&a instanceof xe)return cr(t,a)}if(!o.parent.inlineContent){let a=e<0?o:s,u=i instanceof ln?ve.near(a,e):ve.findFrom(a,e);return u?cr(t,u):!1}return!1}function e1(t,e){if(!(t.state.selection instanceof Se))return!0;let{$head:n,$anchor:i,empty:o}=t.state.selection;if(!n.sameParent(i))return!0;if(!o)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let a=t.state.tr;return e<0?a.delete(n.pos-s.nodeSize,n.pos):a.delete(n.pos,n.pos+s.nodeSize),t.dispatch(a),!0}return!1}function t1(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function uN(t){if(!Rt||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let i=e.firstChild;t1(t,i,"true"),setTimeout(()=>t1(t,i,"false"),20)}return!1}function dN(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function fN(t,e){let n=e.keyCode,i=dN(e);if(n==8||Sn&&n==72&&i=="c")return e1(t,-1)||nl(t,-1);if(n==46&&!e.shiftKey||Sn&&n==68&&i=="c")return e1(t,1)||nl(t,1);if(n==13||n==27)return!0;if(n==37||Sn&&n==66&&i=="c"){let o=n==37?Qv(t,t.state.selection.from)=="ltr"?-1:1:-1;return Jv(t,o,i)||nl(t,o)}else if(n==39||Sn&&n==70&&i=="c"){let o=n==39?Qv(t,t.state.selection.from)=="ltr"?1:-1:1;return Jv(t,o,i)||nl(t,o)}else{if(n==38||Sn&&n==80&&i=="c")return Zv(t,-1,i)||nl(t,-1);if(n==40||Sn&&n==78&&i=="c")return uN(t)||Zv(t,1,i)||nl(t,1);if(i==(Sn?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function qm(t,e){t.someProp("transformCopied",v=>{e=v(e,t)});let n=[],{content:i,openStart:o,openEnd:s}=e;for(;o>1&&s>1&&i.childCount==1&&i.firstChild.childCount==1;){o--,s--;let v=i.firstChild;n.push(v.type.name,v.attrs!=v.type.defaultAttrs?v.attrs:null),i=v.content}let a=t.someProp("clipboardSerializer")||po.fromSchema(t.state.schema),u=hC(),d=u.createElement("div");d.appendChild(a.serializeFragment(i,{document:u}));let h=d.firstChild,p,g=0;for(;h&&h.nodeType==1&&(p=fC[h.nodeName.toLowerCase()]);){for(let v=p.length-1;v>=0;v--){let S=u.createElement(p[v]);for(;d.firstChild;)S.appendChild(d.firstChild);d.appendChild(S),g++}h=d.firstChild}h&&h.nodeType==1&&h.setAttribute("data-pm-slice",`${o} ${s}${g?` -${g}`:""} ${JSON.stringify(n)}`);let x=t.someProp("clipboardTextSerializer",v=>v(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:d,text:x,slice:e}}function aC(t,e,n,i,o){let s=o.parent.type.spec.code,a,u;if(!n&&!e)return null;let d=!!e&&(i||s||!n);if(d){if(t.someProp("transformPastedText",x=>{e=x(e,s||i,t)}),s)return u=new se(Q.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",x=>{u=x(u,t,!0)}),u;let g=t.someProp("clipboardTextParser",x=>x(e,o,i,t));if(g)u=g;else{let x=o.marks(),{schema:v}=t.state,S=po.fromSchema(v);a=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(k=>{let w=a.appendChild(document.createElement("p"));k&&w.appendChild(S.serializeNode(v.text(k,x)))})}}else t.someProp("transformPastedHTML",g=>{n=g(n,t)}),a=gN(n),la&&yN(a);let h=a&&a.querySelector("[data-pm-slice]"),p=h&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(h.getAttribute("data-pm-slice")||"");if(p&&p[3])for(let g=+p[3];g>0;g--){let x=a.firstChild;for(;x&&x.nodeType!=1;)x=x.nextSibling;if(!x)break;a=x}if(u||(u=(t.someProp("clipboardParser")||t.someProp("domParser")||xr.fromSchema(t.state.schema)).parseSlice(a,{preserveWhitespace:!!(d||p),context:o,ruleFromNode(x){return x.nodeName=="BR"&&!x.nextSibling&&x.parentNode&&!hN.test(x.parentNode.nodeName)?{ignore:!0}:null}})),p)u=xN(n1(u,+p[1],+p[2]),p[4]);else if(u=se.maxOpen(pN(u.content,o),!0),u.openStart||u.openEnd){let g=0,x=0;for(let v=u.content.firstChild;g<u.openStart&&!v.type.spec.isolating;g++,v=v.firstChild);for(let v=u.content.lastChild;x<u.openEnd&&!v.type.spec.isolating;x++,v=v.lastChild);u=n1(u,g,x)}return t.someProp("transformPasted",g=>{u=g(u,t,d)}),u}const hN=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function pN(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let o=e.node(n).contentMatchAt(e.index(n)),s,a=[];if(t.forEach(u=>{if(!a)return;let d=o.findWrapping(u.type),h;if(!d)return a=null;if(h=a.length&&s.length&&uC(d,s,u,a[a.length-1],0))a[a.length-1]=h;else{a.length&&(a[a.length-1]=dC(a[a.length-1],s.length));let p=cC(u,d);a.push(p),o=o.matchType(p.type),s=d}}),a)return Q.from(a)}return t}function cC(t,e,n=0){for(let i=e.length-1;i>=n;i--)t=e[i].create(null,Q.from(t));return t}function uC(t,e,n,i,o){if(o<t.length&&o<e.length&&t[o]==e[o]){let s=uC(t,e,n,i.lastChild,o+1);if(s)return i.copy(i.content.replaceChild(i.childCount-1,s));if(i.contentMatchAt(i.childCount).matchType(o==t.length-1?n.type:t[o+1]))return i.copy(i.content.append(Q.from(cC(n,t,o+1))))}}function dC(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,dC(t.lastChild,e-1)),i=t.contentMatchAt(t.childCount).fillBefore(Q.empty,!0);return t.copy(n.append(i))}function rm(t,e,n,i,o,s){let a=e<0?t.firstChild:t.lastChild,u=a.content;return t.childCount>1&&(s=0),o<i-1&&(u=rm(u,e,n,i,o+1,s)),o>=n&&(u=e<0?a.contentMatchAt(0).fillBefore(u,s<=o).append(u):u.append(a.contentMatchAt(a.childCount).fillBefore(Q.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,a.copy(u))}function n1(t,e,n){return e<t.openStart&&(t=new se(rm(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new se(rm(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const fC={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let i1=null;function hC(){return i1||(i1=document.implementation.createHTMLDocument("title"))}let ap=null;function mN(t){let e=window.trustedTypes;return e?(ap||(ap=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),ap.createHTML(t)):t}function gN(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=hC().createElement("div"),i=/<([a-z][^>\s]+)/i.exec(t),o;if((o=i&&fC[i[1].toLowerCase()])&&(t=o.map(s=>"<"+s+">").join("")+t+o.map(s=>"</"+s+">").reverse().join("")),n.innerHTML=mN(t),o)for(let s=0;s<o.length;s++)n=n.querySelector(o[s])||n;return n}function yN(t){let e=t.querySelectorAll(mt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let i=e[n];i.childNodes.length==1&&i.textContent==""&&i.parentNode&&i.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),i)}}function xN(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,i;try{i=JSON.parse(e)}catch{return t}let{content:o,openStart:s,openEnd:a}=t;for(let u=i.length-2;u>=0;u-=2){let d=n.nodes[i[u]];if(!d||d.hasRequiredAttrs())break;o=Q.from(d.create(i[u+1],o)),s++,a++}return new se(o,s,a)}const Lt={},Bt={},bN={touchstart:!0,touchmove:!0};class vN{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function SN(t){for(let e in Lt){let n=Lt[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=i=>{CN(t,i)&&!Fm(t,i)&&(t.editable||!(i.type in Bt))&&n(t,i)},bN[e]?{passive:!0}:void 0)}Rt&&t.dom.addEventListener("input",()=>null),om(t)}function gr(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function wN(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function om(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=i=>Fm(t,i))})}function Fm(t,e){return t.someProp("handleDOMEvents",n=>{let i=n[e.type];return i?i(t,e)||e.defaultPrevented:!1})}function CN(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function kN(t,e){!Fm(t,e)&&Lt[e.type]&&(t.editable||!(e.type in Bt))&&Lt[e.type](t,e)}Bt.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!mC(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Ei&&mt&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),pl&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let i=Date.now();t.input.lastIOSEnter=i,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==i&&(t.someProp("handleKeyDown",o=>o(t,Jr(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",i=>i(t,n))||fN(t,n)?n.preventDefault():gr(t,"key")};Bt.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};Bt.keypress=(t,e)=>{let n=e;if(mC(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Sn&&n.metaKey)return;if(t.someProp("handleKeyPress",o=>o(t,n))){n.preventDefault();return}let i=t.state.selection;if(!(i instanceof Se)||!i.$from.sameParent(i.$to)){let o=String.fromCharCode(n.charCode),s=()=>t.state.tr.insertText(o).scrollIntoView();!/[\r\n]/.test(o)&&!t.someProp("handleTextInput",a=>a(t,i.$from.pos,i.$to.pos,o,s))&&t.dispatch(s()),n.preventDefault()}};function sd(t){return{left:t.clientX,top:t.clientY}}function EN(t,e){let n=e.x-t.clientX,i=e.y-t.clientY;return n*n+i*i<100}function Wm(t,e,n,i,o){if(i==-1)return!1;let s=t.state.doc.resolve(i);for(let a=s.depth+1;a>0;a--)if(t.someProp(e,u=>a>s.depth?u(t,n,s.nodeAfter,s.before(a),o,!0):u(t,n,s.node(a),s.before(a),o,!1)))return!0;return!1}function cl(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let i=t.state.tr.setSelection(e);i.setMeta("pointer",!0),t.dispatch(i)}function TN(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),i=n.nodeAfter;return i&&i.isAtom&&xe.isSelectable(i)?(cl(t,new xe(n)),!0):!1}function MN(t,e){if(e==-1)return!1;let n=t.state.selection,i,o;n instanceof xe&&(i=n.node);let s=t.state.doc.resolve(e);for(let a=s.depth+1;a>0;a--){let u=a>s.depth?s.nodeAfter:s.node(a);if(xe.isSelectable(u)){i&&n.$from.depth>0&&a>=n.$from.depth&&s.before(n.$from.depth+1)==n.$from.pos?o=s.before(n.$from.depth):o=s.before(a);break}}return o!=null?(cl(t,xe.create(t.state.doc,o)),!0):!1}function AN(t,e,n,i,o){return Wm(t,"handleClickOn",e,n,i)||t.someProp("handleClick",s=>s(t,e,i))||(o?MN(t,n):TN(t,n))}function ON(t,e,n,i){return Wm(t,"handleDoubleClickOn",e,n,i)||t.someProp("handleDoubleClick",o=>o(t,e,i))}function RN(t,e,n,i){return Wm(t,"handleTripleClickOn",e,n,i)||t.someProp("handleTripleClick",o=>o(t,e,i))||DN(t,n,i)}function DN(t,e,n){if(n.button!=0)return!1;let i=t.state.doc;if(e==-1)return i.inlineContent?(cl(t,Se.create(i,0,i.content.size)),!0):!1;let o=i.resolve(e);for(let s=o.depth+1;s>0;s--){let a=s>o.depth?o.nodeAfter:o.node(s),u=o.before(s);if(a.inlineContent)cl(t,Se.create(i,u+1,u+1+a.content.size));else if(xe.isSelectable(a))cl(t,xe.create(i,u));else continue;return!0}}function Ym(t){return hu(t)}const pC=Sn?"metaKey":"ctrlKey";Lt.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let i=Ym(t),o=Date.now(),s="singleClick";o-t.input.lastClick.time<500&&EN(n,t.input.lastClick)&&!n[pC]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?s="doubleClick":t.input.lastClick.type=="doubleClick"&&(s="tripleClick")),t.input.lastClick={time:o,x:n.clientX,y:n.clientY,type:s,button:n.button};let a=t.posAtCoords(sd(n));a&&(s=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new NN(t,a,n,!!i)):(s=="doubleClick"?ON:RN)(t,a.pos,a.inside,n)?n.preventDefault():gr(t,"pointer"))};class NN{constructor(e,n,i,o){this.view=e,this.pos=n,this.event=i,this.flushed=o,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!i[pC],this.allowDefault=i.shiftKey;let s,a;if(n.inside>-1)s=e.state.doc.nodeAt(n.inside),a=n.inside;else{let p=e.state.doc.resolve(n.pos);s=p.parent,a=p.depth?p.before():0}const u=o?null:i.target,d=u?e.docView.nearestDesc(u,!0):null;this.target=d&&d.nodeDOM.nodeType==1?d.nodeDOM:null;let{selection:h}=e.state;(i.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||h instanceof xe&&h.from<=a&&h.to>a)&&(this.mightDrag={node:s,pos:a,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Cn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),gr(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Oi(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(sd(e))),this.updateAllowDefault(e),this.allowDefault||!n?gr(this.view,"pointer"):AN(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Rt&&this.mightDrag&&!this.mightDrag.node.isAtom||mt&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(cl(this.view,ve.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):gr(this.view,"pointer")}move(e){this.updateAllowDefault(e),gr(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Lt.touchstart=t=>{t.input.lastTouch=Date.now(),Ym(t),gr(t,"pointer")};Lt.touchmove=t=>{t.input.lastTouch=Date.now(),gr(t,"pointer")};Lt.contextmenu=t=>Ym(t);function mC(t,e){return t.composing?!0:Rt&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const jN=Ei?5e3:-1;Bt.compositionstart=Bt.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof Se&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(i=>i.type.spec.inclusive===!1)||mt&&Ww&&zN(t)))t.markCursor=t.state.storedMarks||n.marks(),hu(t,!0),t.markCursor=null;else if(hu(t,!e.selection.empty),Cn&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let i=t.domSelectionRange();for(let o=i.focusNode,s=i.focusOffset;o&&o.nodeType==1&&s!=0;){let a=s<0?o.lastChild:o.childNodes[s-1];if(!a)break;if(a.nodeType==3){let u=t.domSelection();u&&u.collapse(a,a.nodeValue.length);break}else o=a,s=-1}}t.input.composing=!0}gC(t,jN)};function zN(t){let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(!e||e.nodeType!=1||n>=e.childNodes.length)return!1;let i=e.childNodes[n];return i.nodeType==1&&i.contentEditable=="false"}Bt.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,gC(t,20))};function gC(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>hu(t),e))}function yC(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=BN());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function LN(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=MD(e.focusNode,e.focusOffset),i=AD(e.focusNode,e.focusOffset);if(n&&i&&n!=i){let o=i.pmViewDesc,s=t.domObserver.lastChangedTextNode;if(n==s||i==s)return s;if(!o||!o.isText(i.nodeValue))return i;if(t.input.compositionNode==i){let a=n.pmViewDesc;if(!(!a||!a.isText(n.nodeValue)))return i}}return n||i}function BN(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function hu(t,e=!1){if(!(Ei&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),yC(t),e||t.docView&&t.docView.dirty){let n=Pm(t),i=t.state.selection;return n&&!n.eq(i)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!i.$from.node(i.$from.sharedDepth(i.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function IN(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let i=getSelection(),o=document.createRange();o.selectNodeContents(e),t.dom.blur(),i.removeAllRanges(),i.addRange(o),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const Gs=Ft&&br<15||pl&&ND<604;Lt.copy=Bt.cut=(t,e)=>{let n=e,i=t.state.selection,o=n.type=="cut";if(i.empty)return;let s=Gs?null:n.clipboardData,a=i.content(),{dom:u,text:d}=qm(t,a);s?(n.preventDefault(),s.clearData(),s.setData("text/html",u.innerHTML),s.setData("text/plain",d)):IN(t,u),o&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function _N(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function HN(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,i=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(i.contentEditable="true"),i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus();let o=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),i.parentNode&&i.parentNode.removeChild(i),n?Ks(t,i.value,null,o,e):Ks(t,i.textContent,i.innerHTML,o,e)},50)}function Ks(t,e,n,i,o){let s=aC(t,e,n,i,t.state.selection.$from);if(t.someProp("handlePaste",d=>d(t,o,s||se.empty)))return!0;if(!s)return!1;let a=_N(s),u=a?t.state.tr.replaceSelectionWith(a,i):t.state.tr.replaceSelection(s);return t.dispatch(u.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function xC(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Bt.paste=(t,e)=>{let n=e;if(t.composing&&!Ei)return;let i=Gs?null:n.clipboardData,o=t.input.shiftKey&&t.input.lastKeyCode!=45;i&&Ks(t,xC(i),i.getData("text/html"),o,n)?n.preventDefault():HN(t,n)};class bC{constructor(e,n,i){this.slice=e,this.move=n,this.node=i}}const UN=Sn?"altKey":"ctrlKey";function vC(t,e){let n=t.someProp("dragCopies",i=>!i(e));return n??!e[UN]}Lt.dragstart=(t,e)=>{let n=e,i=t.input.mouseDown;if(i&&i.done(),!n.dataTransfer)return;let o=t.state.selection,s=o.empty?null:t.posAtCoords(sd(n)),a;if(!(s&&s.pos>=o.from&&s.pos<=(o instanceof xe?o.to-1:o.to))){if(i&&i.mightDrag)a=xe.create(t.state.doc,i.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let g=t.docView.nearestDesc(n.target,!0);g&&g.node.type.spec.draggable&&g!=t.docView&&(a=xe.create(t.state.doc,g.posBefore))}}let u=(a||t.state.selection).content(),{dom:d,text:h,slice:p}=qm(t,u);(!n.dataTransfer.files.length||!mt||Fw>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Gs?"Text":"text/html",d.innerHTML),n.dataTransfer.effectAllowed="copyMove",Gs||n.dataTransfer.setData("text/plain",h),t.dragging=new bC(p,vC(t,n),a)};Lt.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};Bt.dragover=Bt.dragenter=(t,e)=>e.preventDefault();Bt.drop=(t,e)=>{try{$N(t,e,t.dragging)}finally{t.dragging=null}};function $N(t,e,n){if(!e.dataTransfer)return;let i=t.posAtCoords(sd(e));if(!i)return;let o=t.state.doc.resolve(i.pos),s=n&&n.slice;s?t.someProp("transformPasted",v=>{s=v(s,t,!1)}):s=aC(t,xC(e.dataTransfer),Gs?null:e.dataTransfer.getData("text/html"),!1,o);let a=!!(n&&vC(t,e));if(t.someProp("handleDrop",v=>v(t,e,s||se.empty,a))){e.preventDefault();return}if(!s)return;e.preventDefault();let u=s?Cw(t.state.doc,o.pos,s):o.pos;u==null&&(u=o.pos);let d=t.state.tr;if(a){let{node:v}=n;v?v.replace(d):d.deleteSelection()}let h=d.mapping.map(u),p=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,g=d.doc;if(p?d.replaceRangeWith(h,h,s.content.firstChild):d.replaceRange(h,h,s),d.doc.eq(g))return;let x=d.doc.resolve(h);if(p&&xe.isSelectable(s.content.firstChild)&&x.nodeAfter&&x.nodeAfter.sameMarkup(s.content.firstChild))d.setSelection(new xe(x));else{let v=d.mapping.map(u);d.mapping.maps[d.mapping.maps.length-1].forEach((S,k,w,E)=>v=E),d.setSelection(Vm(t,x,d.doc.resolve(v)))}t.focus(),t.dispatch(d.setMeta("uiEvent","drop"))}Lt.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Oi(t)},20))};Lt.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};Lt.beforeinput=(t,e)=>{if(mt&&Ei&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:i}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=i||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",s=>s(t,Jr(8,"Backspace")))))return;let{$cursor:o}=t.state.selection;o&&o.pos>0&&t.dispatch(t.state.tr.delete(o.pos-1,o.pos).scrollIntoView())},50)}};for(let t in Bt)Lt[t]=Bt[t];function Xs(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class pu{constructor(e,n){this.toDOM=e,this.spec=n||ro,this.side=this.spec.side||0}map(e,n,i,o){let{pos:s,deleted:a}=e.mapResult(n.from+o,this.side<0?-1:1);return a?null:new zt(s-i,s-i,this)}valid(){return!0}eq(e){return this==e||e instanceof pu&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Xs(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Sr{constructor(e,n){this.attrs=e,this.spec=n||ro}map(e,n,i,o){let s=e.map(n.from+o,this.spec.inclusiveStart?-1:1)-i,a=e.map(n.to+o,this.spec.inclusiveEnd?1:-1)-i;return s>=a?null:new zt(s,a,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Sr&&Xs(this.attrs,e.attrs)&&Xs(this.spec,e.spec)}static is(e){return e.type instanceof Sr}destroy(){}}class Gm{constructor(e,n){this.attrs=e,this.spec=n||ro}map(e,n,i,o){let s=e.mapResult(n.from+o,1);if(s.deleted)return null;let a=e.mapResult(n.to+o,-1);return a.deleted||a.pos<=s.pos?null:new zt(s.pos-i,a.pos-i,this)}valid(e,n){let{index:i,offset:o}=e.content.findIndex(n.from),s;return o==n.from&&!(s=e.child(i)).isText&&o+s.nodeSize==n.to}eq(e){return this==e||e instanceof Gm&&Xs(this.attrs,e.attrs)&&Xs(this.spec,e.spec)}destroy(){}}class zt{constructor(e,n,i){this.from=e,this.to=n,this.type=i}copy(e,n){return new zt(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,i){return this.type.map(e,this,n,i)}static widget(e,n,i){return new zt(e,e,new pu(n,i))}static inline(e,n,i,o){return new zt(e,n,new Sr(i,o))}static node(e,n,i,o){return new zt(e,n,new Gm(i,o))}get spec(){return this.type.spec}get inline(){return this.type instanceof Sr}get widget(){return this.type instanceof pu}}const rl=[],ro={};class Ge{constructor(e,n){this.local=e.length?e:rl,this.children=n.length?n:rl}static create(e,n){return n.length?mu(n,e,0,ro):Ot}find(e,n,i){let o=[];return this.findInner(e??0,n??1e9,o,0,i),o}findInner(e,n,i,o,s){for(let a=0;a<this.local.length;a++){let u=this.local[a];u.from<=n&&u.to>=e&&(!s||s(u.spec))&&i.push(u.copy(u.from+o,u.to+o))}for(let a=0;a<this.children.length;a+=3)if(this.children[a]<n&&this.children[a+1]>e){let u=this.children[a]+1;this.children[a+2].findInner(e-u,n-u,i,o+u,s)}}map(e,n,i){return this==Ot||e.maps.length==0?this:this.mapInner(e,n,0,0,i||ro)}mapInner(e,n,i,o,s){let a;for(let u=0;u<this.local.length;u++){let d=this.local[u].map(e,i,o);d&&d.type.valid(n,d)?(a||(a=[])).push(d):s.onRemove&&s.onRemove(this.local[u].spec)}return this.children.length?PN(this.children,a||[],e,n,i,o,s):a?new Ge(a.sort(oo),rl):Ot}add(e,n){return n.length?this==Ot?Ge.create(e,n):this.addInner(e,n,0):this}addInner(e,n,i){let o,s=0;e.forEach((u,d)=>{let h=d+i,p;if(p=wC(n,u,h)){for(o||(o=this.children.slice());s<o.length&&o[s]<d;)s+=3;o[s]==d?o[s+2]=o[s+2].addInner(u,p,h+1):o.splice(s,0,d,d+u.nodeSize,mu(p,u,h+1,ro)),s+=3}});let a=SC(s?CC(n):n,-i);for(let u=0;u<a.length;u++)a[u].type.valid(e,a[u])||a.splice(u--,1);return new Ge(a.length?this.local.concat(a).sort(oo):this.local,o||this.children)}remove(e){return e.length==0||this==Ot?this:this.removeInner(e,0)}removeInner(e,n){let i=this.children,o=this.local;for(let s=0;s<i.length;s+=3){let a,u=i[s]+n,d=i[s+1]+n;for(let p=0,g;p<e.length;p++)(g=e[p])&&g.from>u&&g.to<d&&(e[p]=null,(a||(a=[])).push(g));if(!a)continue;i==this.children&&(i=this.children.slice());let h=i[s+2].removeInner(a,u+1);h!=Ot?i[s+2]=h:(i.splice(s,3),s-=3)}if(o.length){for(let s=0,a;s<e.length;s++)if(a=e[s])for(let u=0;u<o.length;u++)o[u].eq(a,n)&&(o==this.local&&(o=this.local.slice()),o.splice(u--,1))}return i==this.children&&o==this.local?this:o.length||i.length?new Ge(o,i):Ot}forChild(e,n){if(this==Ot)return this;if(n.isLeaf)return Ge.empty;let i,o;for(let u=0;u<this.children.length;u+=3)if(this.children[u]>=e){this.children[u]==e&&(i=this.children[u+2]);break}let s=e+1,a=s+n.content.size;for(let u=0;u<this.local.length;u++){let d=this.local[u];if(d.from<a&&d.to>s&&d.type instanceof Sr){let h=Math.max(s,d.from)-s,p=Math.min(a,d.to)-s;h<p&&(o||(o=[])).push(d.copy(h,p))}}if(o){let u=new Ge(o.sort(oo),rl);return i?new fr([u,i]):u}return i||Ot}eq(e){if(this==e)return!0;if(!(e instanceof Ge)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return Km(this.localsInner(e))}localsInner(e){if(this==Ot)return rl;if(e.inlineContent||!this.local.some(Sr.is))return this.local;let n=[];for(let i=0;i<this.local.length;i++)this.local[i].type instanceof Sr||n.push(this.local[i]);return n}forEachSet(e){e(this)}}Ge.empty=new Ge([],[]);Ge.removeOverlap=Km;const Ot=Ge.empty;class fr{constructor(e){this.members=e}map(e,n){const i=this.members.map(o=>o.map(e,n,ro));return fr.from(i)}forChild(e,n){if(n.isLeaf)return Ge.empty;let i=[];for(let o=0;o<this.members.length;o++){let s=this.members[o].forChild(e,n);s!=Ot&&(s instanceof fr?i=i.concat(s.members):i.push(s))}return fr.from(i)}eq(e){if(!(e instanceof fr)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,i=!0;for(let o=0;o<this.members.length;o++){let s=this.members[o].localsInner(e);if(s.length)if(!n)n=s;else{i&&(n=n.slice(),i=!1);for(let a=0;a<s.length;a++)n.push(s[a])}}return n?Km(i?n:n.sort(oo)):rl}static from(e){switch(e.length){case 0:return Ot;case 1:return e[0];default:return new fr(e.every(n=>n instanceof Ge)?e:e.reduce((n,i)=>n.concat(i instanceof Ge?i:i.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function PN(t,e,n,i,o,s,a){let u=t.slice();for(let h=0,p=s;h<n.maps.length;h++){let g=0;n.maps[h].forEach((x,v,S,k)=>{let w=k-S-(v-x);for(let E=0;E<u.length;E+=3){let A=u[E+1];if(A<0||x>A+p-g)continue;let D=u[E]+p-g;v>=D?u[E+1]=x<=D?-2:-1:x>=p&&w&&(u[E]+=w,u[E+1]+=w)}g+=w}),p=n.maps[h].map(p,-1)}let d=!1;for(let h=0;h<u.length;h+=3)if(u[h+1]<0){if(u[h+1]==-2){d=!0,u[h+1]=-1;continue}let p=n.map(t[h]+s),g=p-o;if(g<0||g>=i.content.size){d=!0;continue}let x=n.map(t[h+1]+s,-1),v=x-o,{index:S,offset:k}=i.content.findIndex(g),w=i.maybeChild(S);if(w&&k==g&&k+w.nodeSize==v){let E=u[h+2].mapInner(n,w,p+1,t[h]+s+1,a);E!=Ot?(u[h]=g,u[h+1]=v,u[h+2]=E):(u[h+1]=-2,d=!0)}else d=!0}if(d){let h=VN(u,t,e,n,o,s,a),p=mu(h,i,0,a);e=p.local;for(let g=0;g<u.length;g+=3)u[g+1]<0&&(u.splice(g,3),g-=3);for(let g=0,x=0;g<p.children.length;g+=3){let v=p.children[g];for(;x<u.length&&u[x]<v;)x+=3;u.splice(x,0,p.children[g],p.children[g+1],p.children[g+2])}}return new Ge(e.sort(oo),u)}function SC(t,e){if(!e||!t.length)return t;let n=[];for(let i=0;i<t.length;i++){let o=t[i];n.push(new zt(o.from+e,o.to+e,o.type))}return n}function VN(t,e,n,i,o,s,a){function u(d,h){for(let p=0;p<d.local.length;p++){let g=d.local[p].map(i,o,h);g?n.push(g):a.onRemove&&a.onRemove(d.local[p].spec)}for(let p=0;p<d.children.length;p+=3)u(d.children[p+2],d.children[p]+h+1)}for(let d=0;d<t.length;d+=3)t[d+1]==-1&&u(t[d+2],e[d]+s+1);return n}function wC(t,e,n){if(e.isLeaf)return null;let i=n+e.nodeSize,o=null;for(let s=0,a;s<t.length;s++)(a=t[s])&&a.from>n&&a.to<i&&((o||(o=[])).push(a),t[s]=null);return o}function CC(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function mu(t,e,n,i){let o=[],s=!1;e.forEach((u,d)=>{let h=wC(t,u,d+n);if(h){s=!0;let p=mu(h,u,n+d+1,i);p!=Ot&&o.push(d,d+u.nodeSize,p)}});let a=SC(s?CC(t):t,-n).sort(oo);for(let u=0;u<a.length;u++)a[u].type.valid(e,a[u])||(i.onRemove&&i.onRemove(a[u].spec),a.splice(u--,1));return a.length||o.length?new Ge(a,o):Ot}function oo(t,e){return t.from-e.from||t.to-e.to}function Km(t){let e=t;for(let n=0;n<e.length-1;n++){let i=e[n];if(i.from!=i.to)for(let o=n+1;o<e.length;o++){let s=e[o];if(s.from==i.from){s.to!=i.to&&(e==t&&(e=t.slice()),e[o]=s.copy(s.from,i.to),r1(e,o+1,s.copy(i.to,s.to)));continue}else{s.from<i.to&&(e==t&&(e=t.slice()),e[n]=i.copy(i.from,s.from),r1(e,o,i.copy(s.from,i.to)));break}}}return e}function r1(t,e,n){for(;e<t.length&&oo(n,t[e])>0;)e++;t.splice(e,0,n)}function cp(t){let e=[];return t.someProp("decorations",n=>{let i=n(t.state);i&&i!=Ot&&e.push(i)}),t.cursorWrapper&&e.push(Ge.create(t.state.doc,[t.cursorWrapper.deco])),fr.from(e)}const qN={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},FN=Ft&&br<=11;class WN{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class YN{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new WN,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(i=>{for(let o=0;o<i.length;o++)this.queue.push(i[o]);Ft&&br<=11&&i.some(o=>o.type=="childList"&&o.removedNodes.length||o.type=="characterData"&&o.oldValue.length>o.target.nodeValue.length)?this.flushSoon():this.flush()}),FN&&(this.onCharData=i=>{this.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,qN)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Xv(this.view)){if(this.suppressingSelectionUpdates)return Oi(this.view);if(Ft&&br<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&co(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,i;for(let s=e.focusNode;s;s=hl(s))n.add(s);for(let s=e.anchorNode;s;s=hl(s))if(n.has(s)){i=s;break}let o=i&&this.view.docView.nearestDesc(i);if(o&&o.ignoreMutation({type:"selection",target:i.nodeType==3?i.parentNode:i}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let i=e.domSelectionRange(),o=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(i)&&Xv(e)&&!this.ignoreSelectionChange(i),s=-1,a=-1,u=!1,d=[];if(e.editable)for(let p=0;p<n.length;p++){let g=this.registerMutation(n[p],d);g&&(s=s<0?g.from:Math.min(g.from,s),a=a<0?g.to:Math.max(g.to,a),g.typeOver&&(u=!0))}if(Cn&&d.length){let p=d.filter(g=>g.nodeName=="BR");if(p.length==2){let[g,x]=p;g.parentNode&&g.parentNode.parentNode==x.parentNode?x.remove():g.remove()}else{let{focusNode:g}=this.currentSelection;for(let x of p){let v=x.parentNode;v&&v.nodeName=="LI"&&(!g||XN(e,g)!=v)&&x.remove()}}}else if((mt||Rt)&&d.some(p=>p.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let p of d)if(p.nodeName=="BR"&&p.parentNode){let g=p.nextSibling;g&&g.nodeType==1&&g.contentEditable=="false"&&p.parentNode.removeChild(p)}}let h=null;s<0&&o&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&od(i)&&(h=Pm(e))&&h.eq(ve.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Oi(e),this.currentSelection.set(i),e.scrollToSelection()):(s>-1||o)&&(s>-1&&(e.docView.markDirty(s,a),GN(e)),this.handleDOMChange(s,a,u,d),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(i)||Oi(e),this.currentSelection.set(i))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let i=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(i==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!i||i.ignoreMutation(e))return null;if(e.type=="childList"){for(let p=0;p<e.addedNodes.length;p++){let g=e.addedNodes[p];n.push(g),g.nodeType==3&&(this.lastChangedTextNode=g)}if(i.contentDOM&&i.contentDOM!=i.dom&&!i.contentDOM.contains(e.target))return{from:i.posBefore,to:i.posAfter};let o=e.previousSibling,s=e.nextSibling;if(Ft&&br<=11&&e.addedNodes.length)for(let p=0;p<e.addedNodes.length;p++){let{previousSibling:g,nextSibling:x}=e.addedNodes[p];(!g||Array.prototype.indexOf.call(e.addedNodes,g)<0)&&(o=g),(!x||Array.prototype.indexOf.call(e.addedNodes,x)<0)&&(s=x)}let a=o&&o.parentNode==e.target?kt(o)+1:0,u=i.localPosFromDOM(e.target,a,-1),d=s&&s.parentNode==e.target?kt(s):e.target.childNodes.length,h=i.localPosFromDOM(e.target,d,1);return{from:u,to:h}}else return e.type=="attributes"?{from:i.posAtStart-i.border,to:i.posAtEnd+i.border}:(this.lastChangedTextNode=e.target,{from:i.posAtStart,to:i.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let o1=new WeakMap,l1=!1;function GN(t){if(!o1.has(t)&&(o1.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Cn,l1)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),l1=!0}}function s1(t,e){let n=e.startContainer,i=e.startOffset,o=e.endContainer,s=e.endOffset,a=t.domAtPos(t.state.selection.anchor);return co(a.node,a.offset,o,s)&&([n,i,o,s]=[o,s,n,i]),{anchorNode:n,anchorOffset:i,focusNode:o,focusOffset:s}}function KN(t,e){if(e.getComposedRanges){let o=e.getComposedRanges(t.root)[0];if(o)return s1(t,o)}let n;function i(o){o.preventDefault(),o.stopImmediatePropagation(),n=o.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",i,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",i,!0),n?s1(t,n):null}function XN(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let i=t.docView.nearestDesc(n,!0);if(i&&i.node.isBlock)return n}return null}function JN(t,e,n){let{node:i,fromOffset:o,toOffset:s,from:a,to:u}=t.docView.parseRange(e,n),d=t.domSelectionRange(),h,p=d.anchorNode;if(p&&t.dom.contains(p.nodeType==1?p:p.parentNode)&&(h=[{node:p,offset:d.anchorOffset}],od(d)||h.push({node:d.focusNode,offset:d.focusOffset})),mt&&t.input.lastKeyCode===8)for(let w=s;w>o;w--){let E=i.childNodes[w-1],A=E.pmViewDesc;if(E.nodeName=="BR"&&!A){s=w;break}if(!A||A.size)break}let g=t.state.doc,x=t.someProp("domParser")||xr.fromSchema(t.state.schema),v=g.resolve(a),S=null,k=x.parse(i,{topNode:v.parent,topMatch:v.parent.contentMatchAt(v.index()),topOpen:!0,from:o,to:s,preserveWhitespace:v.parent.type.whitespace=="pre"?"full":!0,findPositions:h,ruleFromNode:QN,context:v});if(h&&h[0].pos!=null){let w=h[0].pos,E=h[1]&&h[1].pos;E==null&&(E=w),S={anchor:w+a,head:E+a}}return{doc:k,sel:S,from:a,to:u}}function QN(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Rt&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Rt&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const ZN=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function ej(t,e,n,i,o){let s=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let N=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,B=Pm(t,N);if(B&&!t.state.selection.eq(B)){if(mt&&Ei&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",W=>W(t,Jr(13,"Enter"))))return;let _=t.state.tr.setSelection(B);N=="pointer"?_.setMeta("pointer",!0):N=="key"&&_.scrollIntoView(),s&&_.setMeta("composition",s),t.dispatch(_)}return}let a=t.state.doc.resolve(e),u=a.sharedDepth(n);e=a.before(u+1),n=t.state.doc.resolve(n).after(u+1);let d=t.state.selection,h=JN(t,e,n),p=t.state.doc,g=p.slice(h.from,h.to),x,v;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(x=t.state.selection.to,v="end"):(x=t.state.selection.from,v="start"),t.input.lastKeyCode=null;let S=ij(g.content,h.doc.content,h.from,x,v);if(S&&t.input.domChangeCount++,(pl&&t.input.lastIOSEnter>Date.now()-225||Ei)&&o.some(N=>N.nodeType==1&&!ZN.test(N.nodeName))&&(!S||S.endA>=S.endB)&&t.someProp("handleKeyDown",N=>N(t,Jr(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!S)if(i&&d instanceof Se&&!d.empty&&d.$head.sameParent(d.$anchor)&&!t.composing&&!(h.sel&&h.sel.anchor!=h.sel.head))S={start:d.from,endA:d.to,endB:d.to};else{if(h.sel){let N=a1(t,t.state.doc,h.sel);if(N&&!N.eq(t.state.selection)){let B=t.state.tr.setSelection(N);s&&B.setMeta("composition",s),t.dispatch(B)}}return}t.state.selection.from<t.state.selection.to&&S.start==S.endB&&t.state.selection instanceof Se&&(S.start>t.state.selection.from&&S.start<=t.state.selection.from+2&&t.state.selection.from>=h.from?S.start=t.state.selection.from:S.endA<t.state.selection.to&&S.endA>=t.state.selection.to-2&&t.state.selection.to<=h.to&&(S.endB+=t.state.selection.to-S.endA,S.endA=t.state.selection.to)),Ft&&br<=11&&S.endB==S.start+1&&S.endA==S.start&&S.start>h.from&&h.doc.textBetween(S.start-h.from-1,S.start-h.from+1)==" "&&(S.start--,S.endA--,S.endB--);let k=h.doc.resolveNoCache(S.start-h.from),w=h.doc.resolveNoCache(S.endB-h.from),E=p.resolve(S.start),A=k.sameParent(w)&&k.parent.inlineContent&&E.end()>=S.endA;if((pl&&t.input.lastIOSEnter>Date.now()-225&&(!A||o.some(N=>N.nodeName=="DIV"||N.nodeName=="P"))||!A&&k.pos<h.doc.content.size&&(!k.sameParent(w)||!k.parent.inlineContent)&&k.pos<w.pos&&!/\S/.test(h.doc.textBetween(k.pos,w.pos,"","")))&&t.someProp("handleKeyDown",N=>N(t,Jr(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>S.start&&nj(p,S.start,S.endA,k,w)&&t.someProp("handleKeyDown",N=>N(t,Jr(8,"Backspace")))){Ei&&mt&&t.domObserver.suppressSelectionUpdates();return}mt&&S.endB==S.start&&(t.input.lastChromeDelete=Date.now()),Ei&&!A&&k.start()!=w.start()&&w.parentOffset==0&&k.depth==w.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==S.endA&&(S.endB-=2,w=h.doc.resolveNoCache(S.endB-h.from),setTimeout(()=>{t.someProp("handleKeyDown",function(N){return N(t,Jr(13,"Enter"))})},20));let D=S.start,L=S.endA,T=N=>{let B=N||t.state.tr.replace(D,L,h.doc.slice(S.start-h.from,S.endB-h.from));if(h.sel){let _=a1(t,B.doc,h.sel);_&&!(mt&&t.composing&&_.empty&&(S.start!=S.endB||t.input.lastChromeDelete<Date.now()-100)&&(_.head==D||_.head==B.mapping.map(L)-1)||Ft&&_.empty&&_.head==D)&&B.setSelection(_)}return s&&B.setMeta("composition",s),B.scrollIntoView()},z;if(A)if(k.pos==w.pos){Ft&&br<=11&&k.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Oi(t),20));let N=T(t.state.tr.delete(D,L)),B=p.resolve(S.start).marksAcross(p.resolve(S.endA));B&&N.ensureMarks(B),t.dispatch(N)}else if(S.endA==S.endB&&(z=tj(k.parent.content.cut(k.parentOffset,w.parentOffset),E.parent.content.cut(E.parentOffset,S.endA-E.start())))){let N=T(t.state.tr);z.type=="add"?N.addMark(D,L,z.mark):N.removeMark(D,L,z.mark),t.dispatch(N)}else if(k.parent.child(k.index()).isText&&k.index()==w.index()-(w.textOffset?0:1)){let N=k.parent.textBetween(k.parentOffset,w.parentOffset),B=()=>T(t.state.tr.insertText(N,D,L));t.someProp("handleTextInput",_=>_(t,D,L,N,B))||t.dispatch(B())}else t.dispatch(T());else t.dispatch(T())}function a1(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Vm(t,e.resolve(n.anchor),e.resolve(n.head))}function tj(t,e){let n=t.firstChild.marks,i=e.firstChild.marks,o=n,s=i,a,u,d;for(let p=0;p<i.length;p++)o=i[p].removeFromSet(o);for(let p=0;p<n.length;p++)s=n[p].removeFromSet(s);if(o.length==1&&s.length==0)u=o[0],a="add",d=p=>p.mark(u.addToSet(p.marks));else if(o.length==0&&s.length==1)u=s[0],a="remove",d=p=>p.mark(u.removeFromSet(p.marks));else return null;let h=[];for(let p=0;p<e.childCount;p++)h.push(d(e.child(p)));if(Q.from(h).eq(t))return{mark:u,type:a}}function nj(t,e,n,i,o){if(n-e<=o.pos-i.pos||up(i,!0,!1)<o.pos)return!1;let s=t.resolve(e);if(!i.parent.isTextblock){let u=s.nodeAfter;return u!=null&&n==e+u.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let a=t.resolve(up(s,!0,!0));return!a.parent.isTextblock||a.pos>n||up(a,!0,!1)<n?!1:i.parent.content.cut(i.parentOffset).eq(a.parent.content)}function up(t,e,n){let i=t.depth,o=e?t.end():t.pos;for(;i>0&&(e||t.indexAfter(i)==t.node(i).childCount);)i--,o++,e=!1;if(n){let s=t.node(i).maybeChild(t.indexAfter(i));for(;s&&!s.isLeaf;)s=s.firstChild,o++}return o}function ij(t,e,n,i,o){let s=t.findDiffStart(e,n);if(s==null)return null;let{a,b:u}=t.findDiffEnd(e,n+t.size,n+e.size);if(o=="end"){let d=Math.max(0,s-Math.min(a,u));i-=a+d-s}if(a<s&&t.size<e.size){let d=i<=s&&i>=a?s-i:0;s-=d,s&&s<e.size&&c1(e.textBetween(s-1,s+1))&&(s+=d?1:-1),u=s+(u-a),a=s}else if(u<s){let d=i<=s&&i>=u?s-i:0;s-=d,s&&s<t.size&&c1(t.textBetween(s-1,s+1))&&(s+=d?1:-1),a=s+(a-u),u=s}return{start:s,endA:a,endB:u}}function c1(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class kC{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new vN,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(p1),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=f1(this),d1(this),this.nodeViews=h1(this),this.docView=qv(this.state.doc,u1(this),cp(this),this.dom,this),this.domObserver=new YN(this,(i,o,s,a)=>ej(this,i,o,s,a)),this.domObserver.start(),SN(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&om(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(p1),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let i in this._props)n[i]=this._props[i];n.state=this.state;for(let i in e)n[i]=e[i];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var i;let o=this.state,s=!1,a=!1;e.storedMarks&&this.composing&&(yC(this),a=!0),this.state=e;let u=o.plugins!=e.plugins||this._props.plugins!=n.plugins;if(u||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let v=h1(this);oj(v,this.nodeViews)&&(this.nodeViews=v,s=!0)}(u||n.handleDOMEvents!=this._props.handleDOMEvents)&&om(this),this.editable=f1(this),d1(this);let d=cp(this),h=u1(this),p=o.plugins!=e.plugins&&!o.doc.eq(e.doc)?"reset":e.scrollToSelection>o.scrollToSelection?"to selection":"preserve",g=s||!this.docView.matchesNode(e.doc,h,d);(g||!e.selection.eq(o.selection))&&(a=!0);let x=p=="preserve"&&a&&this.dom.style.overflowAnchor==null&&LD(this);if(a){this.domObserver.stop();let v=g&&(Ft||mt)&&!this.composing&&!o.selection.empty&&!e.selection.empty&&rj(o.selection,e.selection);if(g){let S=mt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=LN(this)),(s||!this.docView.update(e.doc,h,d,this))&&(this.docView.updateOuterDeco(h),this.docView.destroy(),this.docView=qv(e.doc,h,d,this.dom,this)),S&&!this.trackWrites&&(v=!0)}v||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&oN(this))?Oi(this,v):(oC(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(o),!((i=this.dragging)===null||i===void 0)&&i.node&&!o.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,o),p=="reset"?this.dom.scrollTop=0:p=="to selection"?this.scrollToSelection():x&&BD(x)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof xe){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&_v(this,n.getBoundingClientRect(),e)}else _v(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let i=this.directPlugins[n];i.spec.view&&this.pluginViews.push(i.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let i=this.state.plugins[n];i.spec.view&&this.pluginViews.push(i.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let i=this.pluginViews[n];i.update&&i.update(this,e)}}updateDraggedNode(e,n){let i=e.node,o=-1;if(this.state.doc.nodeAt(i.from)==i.node)o=i.from;else{let s=i.from+(this.state.doc.content.size-n.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==i.node&&(o=s)}this.dragging=new bC(e.slice,e.move,o<0?void 0:xe.create(this.state.doc,o))}someProp(e,n){let i=this._props&&this._props[e],o;if(i!=null&&(o=n?n(i):i))return o;for(let a=0;a<this.directPlugins.length;a++){let u=this.directPlugins[a].props[e];if(u!=null&&(o=n?n(u):u))return o}let s=this.state.plugins;if(s)for(let a=0;a<s.length;a++){let u=s[a].props[e];if(u!=null&&(o=n?n(u):u))return o}}hasFocus(){if(Ft){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&ID(this.dom),Oi(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return PD(this,e)}coordsAtPos(e,n=1){return Jw(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,i=-1){let o=this.docView.posFromDOM(e,n,i);if(o==null)throw new RangeError("DOM position not inside the editor");return o}endOfTextblock(e,n){return YD(this,n||this.state,e)}pasteHTML(e,n){return Ks(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return Ks(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return qm(this,e)}destroy(){this.docView&&(wN(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],cp(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,ED())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return kN(this,e)}domSelectionRange(){let e=this.domSelection();return e?Rt&&this.root.nodeType===11&&RD(this.dom.ownerDocument)==this.dom&&KN(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}kC.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function u1(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let i in n)i=="class"?e.class+=" "+n[i]:i=="style"?e.style=(e.style?e.style+";":"")+n[i]:!e[i]&&i!="contenteditable"&&i!="nodeName"&&(e[i]=String(n[i]))}),e.translate||(e.translate="no"),[zt.node(0,t.state.doc.content.size,e)]}function d1(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:zt.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function f1(t){return!t.someProp("editable",e=>e(t.state)===!1)}function rj(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function h1(t){let e=Object.create(null);function n(i){for(let o in i)Object.prototype.hasOwnProperty.call(e,o)||(e[o]=i[o])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function oj(t,e){let n=0,i=0;for(let o in t){if(t[o]!=e[o])return!0;n++}for(let o in e)i++;return n!=i}function p1(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var wr={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},gu={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},lj=typeof navigator<"u"&&/Mac/.test(navigator.platform),sj=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Et=0;Et<10;Et++)wr[48+Et]=wr[96+Et]=String(Et);for(var Et=1;Et<=24;Et++)wr[Et+111]="F"+Et;for(var Et=65;Et<=90;Et++)wr[Et]=String.fromCharCode(Et+32),gu[Et]=String.fromCharCode(Et);for(var dp in wr)gu.hasOwnProperty(dp)||(gu[dp]=wr[dp]);function aj(t){var e=lj&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||sj&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?gu:wr)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const cj=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),uj=typeof navigator<"u"&&/Win/.test(navigator.platform);function dj(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let i,o,s,a;for(let u=0;u<e.length-1;u++){let d=e[u];if(/^(cmd|meta|m)$/i.test(d))a=!0;else if(/^a(lt)?$/i.test(d))i=!0;else if(/^(c|ctrl|control)$/i.test(d))o=!0;else if(/^s(hift)?$/i.test(d))s=!0;else if(/^mod$/i.test(d))cj?a=!0:o=!0;else throw new Error("Unrecognized modifier name: "+d)}return i&&(n="Alt-"+n),o&&(n="Ctrl-"+n),a&&(n="Meta-"+n),s&&(n="Shift-"+n),n}function fj(t){let e=Object.create(null);for(let n in t)e[dj(n)]=t[n];return e}function fp(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function hj(t){return new Ye({props:{handleKeyDown:Xm(t)}})}function Xm(t){let e=fj(t);return function(n,i){let o=aj(i),s,a=e[fp(o,i)];if(a&&a(n.state,n.dispatch,n))return!0;if(o.length==1&&o!=" "){if(i.shiftKey){let u=e[fp(o,i,!1)];if(u&&u(n.state,n.dispatch,n))return!0}if((i.altKey||i.metaKey||i.ctrlKey)&&!(uj&&i.ctrlKey&&i.altKey)&&(s=wr[i.keyCode])&&s!=o){let u=e[fp(s,i)];if(u&&u(n.state,n.dispatch,n))return!0}}return!1}}var pj=Object.defineProperty,Jm=(t,e)=>{for(var n in e)pj(t,n,{get:e[n],enumerable:!0})};function ad(t){const{state:e,transaction:n}=t;let{selection:i}=n,{doc:o}=n,{storedMarks:s}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return i},get doc(){return o},get tr(){return i=n.selection,o=n.doc,s=n.storedMarks,n}}}var cd=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:i}=e,{tr:o}=n,s=this.buildProps(o);return Object.fromEntries(Object.entries(t).map(([a,u])=>[a,(...h)=>{const p=u(...h)(s);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),p}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:i,state:o}=this,{view:s}=i,a=[],u=!!t,d=t||o.tr,h=()=>(!u&&e&&!d.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(d),a.every(g=>g===!0)),p={...Object.fromEntries(Object.entries(n).map(([g,x])=>[g,(...S)=>{const k=this.buildProps(d,e),w=x(...S)(k);return a.push(w),p}])),run:h};return p}createCan(t){const{rawCommands:e,state:n}=this,i=!1,o=t||n.tr,s=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(e).map(([u,d])=>[u,(...h)=>d(...h)({...s,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(t,e=!0){const{rawCommands:n,editor:i,state:o}=this,{view:s}=i,a={tr:t,editor:i,view:s,state:ad({state:o,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([u,d])=>[u,(...h)=>d(...h)(a)]))}};return a}},EC={};Jm(EC,{blur:()=>mj,clearContent:()=>gj,clearNodes:()=>yj,command:()=>xj,createParagraphNear:()=>bj,cut:()=>vj,deleteCurrentNode:()=>Sj,deleteNode:()=>wj,deleteRange:()=>Cj,deleteSelection:()=>kj,enter:()=>Ej,exitCode:()=>Tj,extendMarkRange:()=>Mj,first:()=>Aj,focus:()=>Rj,forEach:()=>Dj,insertContent:()=>Nj,insertContentAt:()=>Lj,joinBackward:()=>_j,joinDown:()=>Ij,joinForward:()=>Hj,joinItemBackward:()=>Uj,joinItemForward:()=>$j,joinTextblockBackward:()=>Pj,joinTextblockForward:()=>Vj,joinUp:()=>Bj,keyboardShortcut:()=>Fj,lift:()=>Wj,liftEmptyBlock:()=>Yj,liftListItem:()=>Gj,newlineInCode:()=>Kj,resetAttributes:()=>Xj,scrollIntoView:()=>Jj,selectAll:()=>Qj,selectNodeBackward:()=>Zj,selectNodeForward:()=>ez,selectParentNode:()=>tz,selectTextblockEnd:()=>nz,selectTextblockStart:()=>iz,setContent:()=>rz,setMark:()=>Ez,setMeta:()=>Tz,setNode:()=>Mz,setNodeSelection:()=>Az,setTextDirection:()=>Oz,setTextSelection:()=>Rz,sinkListItem:()=>Dz,splitBlock:()=>Nz,splitListItem:()=>jz,toggleList:()=>zz,toggleMark:()=>Lz,toggleNode:()=>Bz,toggleWrap:()=>Iz,undoInputRule:()=>_z,unsetAllMarks:()=>Hz,unsetMark:()=>Uz,unsetTextDirection:()=>$z,updateAttributes:()=>Pz,wrapIn:()=>Vz,wrapInList:()=>qz});var mj=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window?.getSelection())==null||n.removeAllRanges())}),!0),gj=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),yj=()=>({state:t,tr:e,dispatch:n})=>{const{selection:i}=e,{ranges:o}=i;return n&&o.forEach(({$from:s,$to:a})=>{t.doc.nodesBetween(s.pos,a.pos,(u,d)=>{if(u.type.isText)return;const{doc:h,mapping:p}=e,g=h.resolve(p.map(d)),x=h.resolve(p.map(d+u.nodeSize)),v=g.blockRange(x);if(!v)return;const S=wl(v);if(u.type.isTextblock){const{defaultType:k}=g.parent.contentMatchAt(g.index());e.setNodeMarkup(v.start,k)}(S||S===0)&&e.lift(v,S)})}),!0},xj=t=>e=>t(e),bj=()=>({state:t,dispatch:e})=>Uw(t,e),vj=(t,e)=>({editor:n,tr:i})=>{const{state:o}=n,s=o.doc.slice(t.from,t.to);i.deleteRange(t.from,t.to);const a=i.mapping.map(e);return i.insert(a,s.content),i.setSelection(new Se(i.doc.resolve(Math.max(a-1,0)))),!0},Sj=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,i=n.$anchor.node();if(i.content.size>0)return!1;const o=t.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i.type){if(e){const u=o.before(s),d=o.after(s);t.delete(u,d).scrollIntoView()}return!0}return!1};function ut(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var wj=t=>({tr:e,state:n,dispatch:i})=>{const o=ut(t,n.schema),s=e.selection.$anchor;for(let a=s.depth;a>0;a-=1)if(s.node(a).type===o){if(i){const d=s.before(a),h=s.after(a);e.delete(d,h).scrollIntoView()}return!0}return!1},Cj=t=>({tr:e,dispatch:n})=>{const{from:i,to:o}=t;return n&&e.delete(i,o),!0},kj=()=>({state:t,dispatch:e})=>Bm(t,e),Ej=()=>({commands:t})=>t.keyboardShortcut("Enter"),Tj=()=>({state:t,dispatch:e})=>uD(t,e);function Qm(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function yu(t,e,n={strict:!0}){const i=Object.keys(e);return i.length?i.every(o=>n.strict?e[o]===t[o]:Qm(e[o])?e[o].test(t[o]):e[o]===t[o]):!0}function TC(t,e,n={}){return t.find(i=>i.type===e&&yu(Object.fromEntries(Object.keys(n).map(o=>[o,i.attrs[o]])),n))}function m1(t,e,n={}){return!!TC(t,e,n)}function Zm(t,e,n){var i;if(!t||!e)return;let o=t.parent.childAfter(t.parentOffset);if((!o.node||!o.node.marks.some(p=>p.type===e))&&(o=t.parent.childBefore(t.parentOffset)),!o.node||!o.node.marks.some(p=>p.type===e)||(n=n||((i=o.node.marks[0])==null?void 0:i.attrs),!TC([...o.node.marks],e,n)))return;let a=o.index,u=t.start()+o.offset,d=a+1,h=u+o.node.nodeSize;for(;a>0&&m1([...t.parent.child(a-1).marks],e,n);)a-=1,u-=t.parent.child(a).nodeSize;for(;d<t.parent.childCount&&m1([...t.parent.child(d).marks],e,n);)h+=t.parent.child(d).nodeSize,d+=1;return{from:u,to:h}}function ji(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var Mj=(t,e={})=>({tr:n,state:i,dispatch:o})=>{const s=ji(t,i.schema),{doc:a,selection:u}=n,{$from:d,from:h,to:p}=u;if(o){const g=Zm(d,s,e);if(g&&g.from<=h&&g.to>=p){const x=Se.create(a,g.from,g.to);n.setSelection(x)}}return!0},Aj=t=>e=>{const n=typeof t=="function"?t(e):t;for(let i=0;i<n.length;i+=1)if(n[i](e))return!0;return!1};function eg(t){return t instanceof Se}function Ti(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function MC(t,e=null){if(!e)return null;const n=ve.atStart(t),i=ve.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return i;const o=n.from,s=i.to;return e==="all"?Se.create(t,Ti(0,o,s),Ti(t.content.size,o,s)):Se.create(t,Ti(e,o,s),Ti(e,o,s))}function Oj(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function tg(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var Rj=(t=null,e={})=>({editor:n,view:i,tr:o,dispatch:s})=>{e={scrollIntoView:!0,...e};const a=()=>{(tg()||Oj())&&i.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(i.focus(),e?.scrollIntoView&&n.commands.scrollIntoView())})};if(i.hasFocus()&&t===null||t===!1)return!0;if(s&&t===null&&!eg(n.state.selection))return a(),!0;const u=MC(o.doc,t)||n.state.selection,d=n.state.selection.eq(u);return s&&(d||o.setSelection(u),d&&o.storedMarks&&o.setStoredMarks(o.storedMarks),a()),!0},Dj=(t,e)=>n=>t.every((i,o)=>e(i,{...n,index:o})),Nj=(t,e)=>({tr:n,commands:i})=>i.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),AC=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const i=e[n];i.nodeType===3&&i.nodeValue&&/^(\n\s\s|\n)$/.test(i.nodeValue)?t.removeChild(i):i.nodeType===1&&AC(i)}return t};function jc(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return AC(n)}function Js(t,e,n){if(t instanceof yr||t instanceof Q)return t;n={slice:!0,parseOptions:{},...n};const i=typeof t=="object"&&t!==null,o=typeof t=="string";if(i)try{if(Array.isArray(t)&&t.length>0)return Q.fromArray(t.map(u=>e.nodeFromJSON(u)));const a=e.nodeFromJSON(t);return n.errorOnInvalidContent&&a.check(),a}catch(s){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",s),Js("",e,n)}if(o){if(n.errorOnInvalidContent){let a=!1,u="";const d=new fw({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:h=>(a=!0,u=typeof h=="string"?h:h.outerHTML,null)}]}})});if(n.slice?xr.fromSchema(d).parseSlice(jc(t),n.parseOptions):xr.fromSchema(d).parse(jc(t),n.parseOptions),n.errorOnInvalidContent&&a)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${u}`)})}const s=xr.fromSchema(e);return n.slice?s.parseSlice(jc(t),n.parseOptions).content:s.parse(jc(t),n.parseOptions)}return Js("",e,n)}function jj(t,e,n){const i=t.steps.length-1;if(i<e)return;const o=t.steps[i];if(!(o instanceof pt||o instanceof gt))return;const s=t.mapping.maps[i];let a=0;s.forEach((u,d,h,p)=>{a===0&&(a=p)}),t.setSelection(ve.near(t.doc.resolve(a),n))}var zj=t=>!("type"in t),Lj=(t,e,n)=>({tr:i,dispatch:o,editor:s})=>{var a;if(o){n={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let u;const d=w=>{s.emit("contentError",{editor:s,error:w,disableCollaboration:()=>{"collaboration"in s.storage&&typeof s.storage.collaboration=="object"&&s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},h={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{Js(e,s.schema,{parseOptions:h,errorOnInvalidContent:!0})}catch(w){d(w)}try{u=Js(e,s.schema,{parseOptions:h,errorOnInvalidContent:(a=n.errorOnInvalidContent)!=null?a:s.options.enableContentCheck})}catch(w){return d(w),!1}let{from:p,to:g}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},x=!0,v=!0;if((zj(u)?u:[u]).forEach(w=>{w.check(),x=x?w.isText&&w.marks.length===0:!1,v=v?w.isBlock:!1}),p===g&&v){const{parent:w}=i.doc.resolve(p);w.isTextblock&&!w.type.spec.code&&!w.childCount&&(p-=1,g+=1)}let k;if(x){if(Array.isArray(e))k=e.map(w=>w.text||"").join("");else if(e instanceof Q){let w="";e.forEach(E=>{E.text&&(w+=E.text)}),k=w}else typeof e=="object"&&e&&e.text?k=e.text:k=e;i.insertText(k,p,g)}else{k=u;const w=i.doc.resolve(p),E=w.node(),A=w.parentOffset===0,D=E.isText||E.isTextblock,L=E.content.size>0;A&&D&&L&&(p=Math.max(0,p-1)),i.replaceWith(p,g,k)}n.updateSelection&&jj(i,i.steps.length-1,-1),n.applyInputRules&&i.setMeta("applyInputRules",{from:p,text:k}),n.applyPasteRules&&i.setMeta("applyPasteRules",{from:p,text:k})}return!0},Bj=()=>({state:t,dispatch:e})=>sD(t,e),Ij=()=>({state:t,dispatch:e})=>aD(t,e),_j=()=>({state:t,dispatch:e})=>jw(t,e),Hj=()=>({state:t,dispatch:e})=>Iw(t,e),Uj=()=>({state:t,dispatch:e,tr:n})=>{try{const i=nd(t.doc,t.selection.$from.pos,-1);return i==null?!1:(n.join(i,2),e&&e(n),!0)}catch{return!1}},$j=()=>({state:t,dispatch:e,tr:n})=>{try{const i=nd(t.doc,t.selection.$from.pos,1);return i==null?!1:(n.join(i,2),e&&e(n),!0)}catch{return!1}},Pj=()=>({state:t,dispatch:e})=>oD(t,e),Vj=()=>({state:t,dispatch:e})=>lD(t,e);function OC(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function qj(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let i,o,s,a;for(let u=0;u<e.length-1;u+=1){const d=e[u];if(/^(cmd|meta|m)$/i.test(d))a=!0;else if(/^a(lt)?$/i.test(d))i=!0;else if(/^(c|ctrl|control)$/i.test(d))o=!0;else if(/^s(hift)?$/i.test(d))s=!0;else if(/^mod$/i.test(d))tg()||OC()?a=!0:o=!0;else throw new Error(`Unrecognized modifier name: ${d}`)}return i&&(n=`Alt-${n}`),o&&(n=`Ctrl-${n}`),a&&(n=`Meta-${n}`),s&&(n=`Shift-${n}`),n}var Fj=t=>({editor:e,view:n,tr:i,dispatch:o})=>{const s=qj(t).split(/-(?!$)/),a=s.find(h=>!["Alt","Ctrl","Meta","Shift"].includes(h)),u=new KeyboardEvent("keydown",{key:a==="Space"?" ":a,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),d=e.captureTransaction(()=>{n.someProp("handleKeyDown",h=>h(n,u))});return d?.steps.forEach(h=>{const p=h.map(i.mapping);p&&o&&i.maybeStep(p)}),!0};function Cr(t,e,n={}){const{from:i,to:o,empty:s}=t.selection,a=e?ut(e,t.schema):null,u=[];t.doc.nodesBetween(i,o,(g,x)=>{if(g.isText)return;const v=Math.max(i,x),S=Math.min(o,x+g.nodeSize);u.push({node:g,from:v,to:S})});const d=o-i,h=u.filter(g=>a?a.name===g.node.type.name:!0).filter(g=>yu(g.node.attrs,n,{strict:!1}));return s?!!h.length:h.reduce((g,x)=>g+x.to-x.from,0)>=d}var Wj=(t,e={})=>({state:n,dispatch:i})=>{const o=ut(t,n.schema);return Cr(n,o,e)?cD(n,i):!1},Yj=()=>({state:t,dispatch:e})=>$w(t,e),Gj=t=>({state:e,dispatch:n})=>{const i=ut(t,e.schema);return SD(i)(e,n)},Kj=()=>({state:t,dispatch:e})=>Hw(t,e);function ud(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function g1(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((i,o)=>(n.includes(o)||(i[o]=t[o]),i),{})}var Xj=(t,e)=>({tr:n,state:i,dispatch:o})=>{let s=null,a=null;const u=ud(typeof t=="string"?t:t.name,i.schema);if(!u)return!1;u==="node"&&(s=ut(t,i.schema)),u==="mark"&&(a=ji(t,i.schema));let d=!1;return n.selection.ranges.forEach(h=>{i.doc.nodesBetween(h.$from.pos,h.$to.pos,(p,g)=>{s&&s===p.type&&(d=!0,o&&n.setNodeMarkup(g,void 0,g1(p.attrs,e))),a&&p.marks.length&&p.marks.forEach(x=>{a===x.type&&(d=!0,o&&n.addMark(g,g+p.nodeSize,a.create(g1(x.attrs,e))))})})}),d},Jj=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),Qj=()=>({tr:t,dispatch:e})=>{if(e){const n=new ln(t.doc);t.setSelection(n)}return!0},Zj=()=>({state:t,dispatch:e})=>Lw(t,e),ez=()=>({state:t,dispatch:e})=>_w(t,e),tz=()=>({state:t,dispatch:e})=>hD(t,e),nz=()=>({state:t,dispatch:e})=>gD(t,e),iz=()=>({state:t,dispatch:e})=>mD(t,e);function lm(t,e,n={},i={}){return Js(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:i.errorOnInvalidContent})}var rz=(t,{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:i={}}={})=>({editor:o,tr:s,dispatch:a,commands:u})=>{const{doc:d}=s;if(i.preserveWhitespace!=="full"){const h=lm(t,o.schema,i,{errorOnInvalidContent:e??o.options.enableContentCheck});return a&&s.replaceWith(0,d.content.size,h).setMeta("preventUpdate",!n),!0}return a&&s.setMeta("preventUpdate",!n),u.insertContentAt({from:0,to:d.content.size},t,{parseOptions:i,errorOnInvalidContent:e??o.options.enableContentCheck})};function RC(t,e){const n=ji(e,t.schema),{from:i,to:o,empty:s}=t.selection,a=[];s?(t.storedMarks&&a.push(...t.storedMarks),a.push(...t.selection.$head.marks())):t.doc.nodesBetween(i,o,d=>{a.push(...d.marks)});const u=a.find(d=>d.type.name===n.name);return u?{...u.attrs}:{}}function DC(t,e){const n=new Aw(t);return e.forEach(i=>{i.steps.forEach(o=>{n.step(o)})}),n}function oz(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function lz(t,e,n){const i=[];return t.nodesBetween(e.from,e.to,(o,s)=>{n(o)&&i.push({node:o,pos:s})}),i}function sz(t,e){for(let n=t.depth;n>0;n-=1){const i=t.node(n);if(e(i))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:i}}}function dd(t){return e=>sz(e.$from,t)}function ye(t,e,n){return t.config[e]===void 0&&t.parent?ye(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?ye(t.parent,e,n):null}):t.config[e]}function ng(t){return t.map(e=>{const n={name:e.name,options:e.options,storage:e.storage},i=ye(e,"addExtensions",n);return i?[e,...ng(i())]:e}).flat(10)}function ig(t,e){const n=po.fromSchema(e).serializeFragment(t),o=document.implementation.createHTMLDocument().createElement("div");return o.appendChild(n),o.innerHTML}function NC(t){return typeof t=="function"}function Ie(t,e=void 0,...n){return NC(t)?e?t.bind(e)(...n):t(...n):t}function az(t={}){return Object.keys(t).length===0&&t.constructor===Object}function ml(t){const e=t.filter(o=>o.type==="extension"),n=t.filter(o=>o.type==="node"),i=t.filter(o=>o.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:i}}function jC(t){const e=[],{nodeExtensions:n,markExtensions:i}=ml(t),o=[...n,...i],s={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(a=>{const u={name:a.name,options:a.options,storage:a.storage,extensions:o},d=ye(a,"addGlobalAttributes",u);if(!d)return;d().forEach(p=>{p.types.forEach(g=>{Object.entries(p.attributes).forEach(([x,v])=>{e.push({type:g,name:x,attribute:{...s,...v}})})})})}),o.forEach(a=>{const u={name:a.name,options:a.options,storage:a.storage},d=ye(a,"addAttributes",u);if(!d)return;const h=d();Object.entries(h).forEach(([p,g])=>{const x={...s,...g};typeof x?.default=="function"&&(x.default=x.default()),x?.isRequired&&x?.default===void 0&&delete x.default,e.push({type:a.name,name:p,attribute:x})})}),e}function nt(...t){return t.filter(e=>!!e).reduce((e,n)=>{const i={...e};return Object.entries(n).forEach(([o,s])=>{if(!i[o]){i[o]=s;return}if(o==="class"){const u=s?String(s).split(" "):[],d=i[o]?i[o].split(" "):[],h=u.filter(p=>!d.includes(p));i[o]=[...d,...h].join(" ")}else if(o==="style"){const u=s?s.split(";").map(p=>p.trim()).filter(Boolean):[],d=i[o]?i[o].split(";").map(p=>p.trim()).filter(Boolean):[],h=new Map;d.forEach(p=>{const[g,x]=p.split(":").map(v=>v.trim());h.set(g,x)}),u.forEach(p=>{const[g,x]=p.split(":").map(v=>v.trim());h.set(g,x)}),i[o]=Array.from(h.entries()).map(([p,g])=>`${p}: ${g}`).join("; ")}else i[o]=s}),i},{})}function xu(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,i)=>nt(n,i),{})}function cz(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function y1(t,e){return"style"in t?t:{...t,getAttrs:n=>{const i=t.getAttrs?t.getAttrs(n):t.attrs;if(i===!1)return!1;const o=e.reduce((s,a)=>{const u=a.attribute.parseHTML?a.attribute.parseHTML(n):cz(n.getAttribute(a.name));return u==null?s:{...s,[a.name]:u}},{});return{...i,...o}}}}function x1(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&az(n)?!1:n!=null))}function b1(t){var e,n;const i={};return!((e=t?.attribute)!=null&&e.isRequired)&&"default"in(t?.attribute||{})&&(i.default=t.attribute.default),((n=t?.attribute)==null?void 0:n.validate)!==void 0&&(i.validate=t.attribute.validate),[t.name,i]}function uz(t,e){var n;const i=jC(t),{nodeExtensions:o,markExtensions:s}=ml(t),a=(n=o.find(h=>ye(h,"topNode")))==null?void 0:n.name,u=Object.fromEntries(o.map(h=>{const p=i.filter(E=>E.type===h.name),g={name:h.name,options:h.options,storage:h.storage,editor:e},x=t.reduce((E,A)=>{const D=ye(A,"extendNodeSchema",g);return{...E,...D?D(h):{}}},{}),v=x1({...x,content:Ie(ye(h,"content",g)),marks:Ie(ye(h,"marks",g)),group:Ie(ye(h,"group",g)),inline:Ie(ye(h,"inline",g)),atom:Ie(ye(h,"atom",g)),selectable:Ie(ye(h,"selectable",g)),draggable:Ie(ye(h,"draggable",g)),code:Ie(ye(h,"code",g)),whitespace:Ie(ye(h,"whitespace",g)),linebreakReplacement:Ie(ye(h,"linebreakReplacement",g)),defining:Ie(ye(h,"defining",g)),isolating:Ie(ye(h,"isolating",g)),attrs:Object.fromEntries(p.map(b1))}),S=Ie(ye(h,"parseHTML",g));S&&(v.parseDOM=S.map(E=>y1(E,p)));const k=ye(h,"renderHTML",g);k&&(v.toDOM=E=>k({node:E,HTMLAttributes:xu(E,p)}));const w=ye(h,"renderText",g);return w&&(v.toText=w),[h.name,v]})),d=Object.fromEntries(s.map(h=>{const p=i.filter(w=>w.type===h.name),g={name:h.name,options:h.options,storage:h.storage,editor:e},x=t.reduce((w,E)=>{const A=ye(E,"extendMarkSchema",g);return{...w,...A?A(h):{}}},{}),v=x1({...x,inclusive:Ie(ye(h,"inclusive",g)),excludes:Ie(ye(h,"excludes",g)),group:Ie(ye(h,"group",g)),spanning:Ie(ye(h,"spanning",g)),code:Ie(ye(h,"code",g)),attrs:Object.fromEntries(p.map(b1))}),S=Ie(ye(h,"parseHTML",g));S&&(v.parseDOM=S.map(w=>y1(w,p)));const k=ye(h,"renderHTML",g);return k&&(v.toDOM=w=>k({mark:w,HTMLAttributes:xu(w,p)})),[h.name,v]}));return new fw({topNode:a,nodes:u,marks:d})}function dz(t){const e=t.filter((n,i)=>t.indexOf(n)!==i);return Array.from(new Set(e))}function rg(t){return t.sort((n,i)=>{const o=ye(n,"priority")||100,s=ye(i,"priority")||100;return o>s?-1:o<s?1:0})}function zC(t){const e=rg(ng(t)),n=dz(e.map(i=>i.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),e}function LC(t,e,n){const{from:i,to:o}=e,{blockSeparator:s=`

`,textSerializers:a={}}=n||{};let u="";return t.nodesBetween(i,o,(d,h,p,g)=>{var x;d.isBlock&&h>i&&(u+=s);const v=a?.[d.type.name];if(v)return p&&(u+=v({node:d,pos:h,parent:p,index:g,range:e})),!1;d.isText&&(u+=(x=d?.text)==null?void 0:x.slice(Math.max(i,h)-h,o-h))}),u}function fz(t,e){const n={from:0,to:t.content.size};return LC(t,n,e)}function BC(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}function hz(t,e){const n=ut(e,t.schema),{from:i,to:o}=t.selection,s=[];t.doc.nodesBetween(i,o,u=>{s.push(u)});const a=s.reverse().find(u=>u.type.name===n.name);return a?{...a.attrs}:{}}function IC(t,e){const n=ud(typeof e=="string"?e:e.name,t.schema);return n==="node"?hz(t,e):n==="mark"?RC(t,e):{}}function pz(t,e=JSON.stringify){const n={};return t.filter(i=>{const o=e(i);return Object.prototype.hasOwnProperty.call(n,o)?!1:n[o]=!0})}function mz(t){const e=pz(t);return e.length===1?e:e.filter((n,i)=>!e.filter((s,a)=>a!==i).some(s=>n.oldRange.from>=s.oldRange.from&&n.oldRange.to<=s.oldRange.to&&n.newRange.from>=s.newRange.from&&n.newRange.to<=s.newRange.to))}function _C(t){const{mapping:e,steps:n}=t,i=[];return e.maps.forEach((o,s)=>{const a=[];if(o.ranges.length)o.forEach((u,d)=>{a.push({from:u,to:d})});else{const{from:u,to:d}=n[s];if(u===void 0||d===void 0)return;a.push({from:u,to:d})}a.forEach(({from:u,to:d})=>{const h=e.slice(s).map(u,-1),p=e.slice(s).map(d),g=e.invert().map(h,-1),x=e.invert().map(p);i.push({oldRange:{from:g,to:x},newRange:{from:h,to:p}})})}),mz(i)}function og(t,e,n){const i=[];return t===e?n.resolve(t).marks().forEach(o=>{const s=n.resolve(t),a=Zm(s,o.type);a&&i.push({mark:o,...a})}):n.nodesBetween(t,e,(o,s)=>{!o||o?.nodeSize===void 0||i.push(...o.marks.map(a=>({from:s,to:s+o.nodeSize,mark:a})))}),i}var gz=(t,e,n,i=20)=>{const o=t.doc.resolve(n);let s=i,a=null;for(;s>0&&a===null;){const u=o.node(s);u?.type.name===e?a=u:s-=1}return[a,s]};function hp(t,e){return e.nodes[t]||e.marks[t]||null}function eu(t,e,n){return Object.fromEntries(Object.entries(n).filter(([i])=>{const o=t.find(s=>s.type===e&&s.name===i);return o?o.attribute.keepOnSplit:!1}))}var yz=(t,e=500)=>{let n="";const i=t.parentOffset;return t.parent.nodesBetween(Math.max(0,i-e),i,(o,s,a,u)=>{var d,h;const p=((h=(d=o.type.spec).toText)==null?void 0:h.call(d,{node:o,pos:s,parent:a,index:u}))||o.textContent||"%leaf%";n+=o.isAtom&&!o.isText?p:p.slice(0,Math.max(0,i-s))}),n};function sm(t,e,n={}){const{empty:i,ranges:o}=t.selection,s=e?ji(e,t.schema):null;if(i)return!!(t.storedMarks||t.selection.$from.marks()).filter(g=>s?s.name===g.type.name:!0).find(g=>yu(g.attrs,n,{strict:!1}));let a=0;const u=[];if(o.forEach(({$from:g,$to:x})=>{const v=g.pos,S=x.pos;t.doc.nodesBetween(v,S,(k,w)=>{if(!k.isText&&!k.marks.length)return;const E=Math.max(v,w),A=Math.min(S,w+k.nodeSize),D=A-E;a+=D,u.push(...k.marks.map(L=>({mark:L,from:E,to:A})))})}),a===0)return!1;const d=u.filter(g=>s?s.name===g.mark.type.name:!0).filter(g=>yu(g.mark.attrs,n,{strict:!1})).reduce((g,x)=>g+x.to-x.from,0),h=u.filter(g=>s?g.mark.type!==s&&g.mark.type.excludes(s):!0).reduce((g,x)=>g+x.to-x.from,0);return(d>0?d+h:d)>=a}function xz(t,e,n={}){if(!e)return Cr(t,null,n)||sm(t,null,n);const i=ud(e,t.schema);return i==="node"?Cr(t,e,n):i==="mark"?sm(t,e,n):!1}var bz=(t,e)=>{const{$from:n,$to:i,$anchor:o}=t.selection;if(e){const s=dd(u=>u.type.name===e)(t.selection);if(!s)return!1;const a=t.doc.resolve(s.pos+1);return o.pos+1===a.end()}return!(i.parentOffset<i.parent.nodeSize-2||n.pos!==i.pos)},vz=t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)};function v1(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function S1(t,e){const{nodeExtensions:n}=ml(e),i=n.find(a=>a.name===t);if(!i)return!1;const o={name:i.name,options:i.options,storage:i.storage},s=Ie(ye(i,"group",o));return typeof s!="string"?!1:s.split(" ").includes("list")}function fd(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var i;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((i=t.text)!=null?i:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let o=!0;return t.content.forEach(s=>{o!==!1&&(fd(s,{ignoreWhitespace:n,checkChildren:e})||(o=!1))}),o}return!1}function HC(t){return t instanceof xe}var UC=class $C{constructor(e){this.position=e}static fromJSON(e){return new $C(e.position)}toJSON(){return{position:this.position}}};function Sz(t,e){const n=e.mapping.mapResult(t.position);return{position:new UC(n.pos),mapResult:n}}function wz(t){return new UC(t)}function Cz(t,e,n){const o=t.state.doc.content.size,s=Ti(e,0,o),a=Ti(n,0,o),u=t.coordsAtPos(s),d=t.coordsAtPos(a,-1),h=Math.min(u.top,d.top),p=Math.max(u.bottom,d.bottom),g=Math.min(u.left,d.left),x=Math.max(u.right,d.right),v=x-g,S=p-h,E={top:h,bottom:p,left:g,right:x,width:v,height:S,x:g,y:h};return{...E,toJSON:()=>E}}function kz(t,e,n){var i;const{selection:o}=e;let s=null;if(eg(o)&&(s=o.$cursor),s){const u=(i=t.storedMarks)!=null?i:s.marks();return s.parent.type.allowsMarkType(n)&&(!!n.isInSet(u)||!u.some(h=>h.type.excludes(n)))}const{ranges:a}=o;return a.some(({$from:u,$to:d})=>{let h=u.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(u.pos,d.pos,(p,g,x)=>{if(h)return!1;if(p.isInline){const v=!x||x.type.allowsMarkType(n),S=!!n.isInSet(p.marks)||!p.marks.some(k=>k.type.excludes(n));h=v&&S}return!h}),h})}var Ez=(t,e={})=>({tr:n,state:i,dispatch:o})=>{const{selection:s}=n,{empty:a,ranges:u}=s,d=ji(t,i.schema);if(o)if(a){const h=RC(i,d);n.addStoredMark(d.create({...h,...e}))}else u.forEach(h=>{const p=h.$from.pos,g=h.$to.pos;i.doc.nodesBetween(p,g,(x,v)=>{const S=Math.max(v,p),k=Math.min(v+x.nodeSize,g);x.marks.find(E=>E.type===d)?x.marks.forEach(E=>{d===E.type&&n.addMark(S,k,d.create({...E.attrs,...e}))}):n.addMark(S,k,d.create(e))})});return kz(i,n,d)},Tz=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),Mz=(t,e={})=>({state:n,dispatch:i,chain:o})=>{const s=ut(t,n.schema);let a;return n.selection.$anchor.sameParent(n.selection.$head)&&(a=n.selection.$anchor.parent.attrs),s.isTextblock?o().command(({commands:u})=>Lv(s,{...a,...e})(n)?!0:u.clearNodes()).command(({state:u})=>Lv(s,{...a,...e})(u,i)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Az=t=>({tr:e,dispatch:n})=>{if(n){const{doc:i}=e,o=Ti(t,0,i.content.size),s=xe.create(i,o);e.setSelection(s)}return!0},Oz=(t,e)=>({tr:n,state:i,dispatch:o})=>{const{selection:s}=i;let a,u;return typeof e=="number"?(a=e,u=e):e&&"from"in e&&"to"in e?(a=e.from,u=e.to):(a=s.from,u=s.to),o&&n.doc.nodesBetween(a,u,(d,h)=>{d.isText||n.setNodeMarkup(h,void 0,{...d.attrs,dir:t})}),!0},Rz=t=>({tr:e,dispatch:n})=>{if(n){const{doc:i}=e,{from:o,to:s}=typeof t=="number"?{from:t,to:t}:t,a=Se.atStart(i).from,u=Se.atEnd(i).to,d=Ti(o,a,u),h=Ti(s,a,u),p=Se.create(i,d,h);e.setSelection(p)}return!0},Dz=t=>({state:e,dispatch:n})=>{const i=ut(t,e.schema);return kD(i)(e,n)};function w1(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const i=n.filter(o=>e?.includes(o.type.name));t.tr.ensureMarks(i)}}var Nz=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:i,editor:o})=>{const{selection:s,doc:a}=e,{$from:u,$to:d}=s,h=o.extensionManager.attributes,p=eu(h,u.node().type.name,u.node().attrs);if(s instanceof xe&&s.node.isBlock)return!u.parentOffset||!Ai(a,u.pos)?!1:(i&&(t&&w1(n,o.extensionManager.splittableMarks),e.split(u.pos).scrollIntoView()),!0);if(!u.parent.isBlock)return!1;const g=d.parentOffset===d.parent.content.size,x=u.depth===0?void 0:oz(u.node(-1).contentMatchAt(u.indexAfter(-1)));let v=g&&x?[{type:x,attrs:p}]:void 0,S=Ai(e.doc,e.mapping.map(u.pos),1,v);if(!v&&!S&&Ai(e.doc,e.mapping.map(u.pos),1,x?[{type:x}]:void 0)&&(S=!0,v=x?[{type:x,attrs:p}]:void 0),i){if(S&&(s instanceof Se&&e.deleteSelection(),e.split(e.mapping.map(u.pos),1,v),x&&!g&&!u.parentOffset&&u.parent.type!==x)){const k=e.mapping.map(u.before()),w=e.doc.resolve(k);u.node(-1).canReplaceWith(w.index(),w.index()+1,x)&&e.setNodeMarkup(e.mapping.map(u.before()),x)}t&&w1(n,o.extensionManager.splittableMarks),e.scrollIntoView()}return S},jz=(t,e={})=>({tr:n,state:i,dispatch:o,editor:s})=>{var a;const u=ut(t,i.schema),{$from:d,$to:h}=i.selection,p=i.selection.node;if(p&&p.isBlock||d.depth<2||!d.sameParent(h))return!1;const g=d.node(-1);if(g.type!==u)return!1;const x=s.extensionManager.attributes;if(d.parent.content.size===0&&d.node(-1).childCount===d.indexAfter(-1)){if(d.depth===2||d.node(-3).type!==u||d.index(-2)!==d.node(-2).childCount-1)return!1;if(o){let E=Q.empty;const A=d.index(-1)?1:d.index(-2)?2:3;for(let B=d.depth-A;B>=d.depth-3;B-=1)E=Q.from(d.node(B).copy(E));const D=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,L={...eu(x,d.node().type.name,d.node().attrs),...e},T=((a=u.contentMatch.defaultType)==null?void 0:a.createAndFill(L))||void 0;E=E.append(Q.from(u.createAndFill(null,T)||void 0));const z=d.before(d.depth-(A-1));n.replace(z,d.after(-D),new se(E,4-A,0));let N=-1;n.doc.nodesBetween(z,n.doc.content.size,(B,_)=>{if(N>-1)return!1;B.isTextblock&&B.content.size===0&&(N=_+1)}),N>-1&&n.setSelection(Se.near(n.doc.resolve(N))),n.scrollIntoView()}return!0}const v=h.pos===d.end()?g.contentMatchAt(0).defaultType:null,S={...eu(x,g.type.name,g.attrs),...e},k={...eu(x,d.node().type.name,d.node().attrs),...e};n.delete(d.pos,h.pos);const w=v?[{type:u,attrs:S},{type:v,attrs:k}]:[{type:u,attrs:S}];if(!Ai(n.doc,d.pos,2))return!1;if(o){const{selection:E,storedMarks:A}=i,{splittableMarks:D}=s.extensionManager,L=A||E.$to.parentOffset&&E.$from.marks();if(n.split(d.pos,2,w).scrollIntoView(),!L||!o)return!0;const T=L.filter(z=>D.includes(z.type.name));n.ensureMarks(T)}return!0},pp=(t,e)=>{const n=dd(a=>a.type===e)(t.selection);if(!n)return!0;const i=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(i===void 0)return!0;const o=t.doc.nodeAt(i);return n.node.type===o?.type&&Tr(t.doc,n.pos)&&t.join(n.pos),!0},mp=(t,e)=>{const n=dd(a=>a.type===e)(t.selection);if(!n)return!0;const i=t.doc.resolve(n.start).after(n.depth);if(i===void 0)return!0;const o=t.doc.nodeAt(i);return n.node.type===o?.type&&Tr(t.doc,i)&&t.join(i),!0},zz=(t,e,n,i={})=>({editor:o,tr:s,state:a,dispatch:u,chain:d,commands:h,can:p})=>{const{extensions:g,splittableMarks:x}=o.extensionManager,v=ut(t,a.schema),S=ut(e,a.schema),{selection:k,storedMarks:w}=a,{$from:E,$to:A}=k,D=E.blockRange(A),L=w||k.$to.parentOffset&&k.$from.marks();if(!D)return!1;const T=dd(z=>S1(z.type.name,g))(k);if(D.depth>=1&&T&&D.depth-T.depth<=1){if(T.node.type===v)return h.liftListItem(S);if(S1(T.node.type.name,g)&&v.validContent(T.node.content)&&u)return d().command(()=>(s.setNodeMarkup(T.pos,v),!0)).command(()=>pp(s,v)).command(()=>mp(s,v)).run()}return!n||!L||!u?d().command(()=>p().wrapInList(v,i)?!0:h.clearNodes()).wrapInList(v,i).command(()=>pp(s,v)).command(()=>mp(s,v)).run():d().command(()=>{const z=p().wrapInList(v,i),N=L.filter(B=>x.includes(B.type.name));return s.ensureMarks(N),z?!0:h.clearNodes()}).wrapInList(v,i).command(()=>pp(s,v)).command(()=>mp(s,v)).run()},Lz=(t,e={},n={})=>({state:i,commands:o})=>{const{extendEmptyMarkRange:s=!1}=n,a=ji(t,i.schema);return sm(i,a,e)?o.unsetMark(a,{extendEmptyMarkRange:s}):o.setMark(a,e)},Bz=(t,e,n={})=>({state:i,commands:o})=>{const s=ut(t,i.schema),a=ut(e,i.schema),u=Cr(i,s,n);let d;return i.selection.$anchor.sameParent(i.selection.$head)&&(d=i.selection.$anchor.parent.attrs),u?o.setNode(a,d):o.setNode(s,{...d,...n})},Iz=(t,e={})=>({state:n,commands:i})=>{const o=ut(t,n.schema);return Cr(n,o,e)?i.lift(o):i.wrapIn(o,e)},_z=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let i=0;i<n.length;i+=1){const o=n[i];let s;if(o.spec.isInputRules&&(s=o.getState(t))){if(e){const a=t.tr,u=s.transform;for(let d=u.steps.length-1;d>=0;d-=1)a.step(u.steps[d].invert(u.docs[d]));if(s.text){const d=a.doc.resolve(s.from).marks();a.replaceWith(s.from,s.to,t.schema.text(s.text,d))}else a.delete(s.from,s.to)}return!0}}return!1},Hz=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:i,ranges:o}=n;return i||e&&o.forEach(s=>{t.removeMark(s.$from.pos,s.$to.pos)}),!0},Uz=(t,e={})=>({tr:n,state:i,dispatch:o})=>{var s;const{extendEmptyMarkRange:a=!1}=e,{selection:u}=n,d=ji(t,i.schema),{$from:h,empty:p,ranges:g}=u;if(!o)return!0;if(p&&a){let{from:x,to:v}=u;const S=(s=h.marks().find(w=>w.type===d))==null?void 0:s.attrs,k=Zm(h,d,S);k&&(x=k.from,v=k.to),n.removeMark(x,v,d)}else g.forEach(x=>{n.removeMark(x.$from.pos,x.$to.pos,d)});return n.removeStoredMark(d),!0},$z=t=>({tr:e,state:n,dispatch:i})=>{const{selection:o}=n;let s,a;return typeof t=="number"?(s=t,a=t):t&&"from"in t&&"to"in t?(s=t.from,a=t.to):(s=o.from,a=o.to),i&&e.doc.nodesBetween(s,a,(u,d)=>{if(u.isText)return;const h={...u.attrs};delete h.dir,e.setNodeMarkup(d,void 0,h)}),!0},Pz=(t,e={})=>({tr:n,state:i,dispatch:o})=>{let s=null,a=null;const u=ud(typeof t=="string"?t:t.name,i.schema);if(!u)return!1;u==="node"&&(s=ut(t,i.schema)),u==="mark"&&(a=ji(t,i.schema));let d=!1;return n.selection.ranges.forEach(h=>{const p=h.$from.pos,g=h.$to.pos;let x,v,S,k;n.selection.empty?i.doc.nodesBetween(p,g,(w,E)=>{s&&s===w.type&&(d=!0,S=Math.max(E,p),k=Math.min(E+w.nodeSize,g),x=E,v=w)}):i.doc.nodesBetween(p,g,(w,E)=>{E<p&&s&&s===w.type&&(d=!0,S=Math.max(E,p),k=Math.min(E+w.nodeSize,g),x=E,v=w),E>=p&&E<=g&&(s&&s===w.type&&(d=!0,o&&n.setNodeMarkup(E,void 0,{...w.attrs,...e})),a&&w.marks.length&&w.marks.forEach(A=>{if(a===A.type&&(d=!0,o)){const D=Math.max(E,p),L=Math.min(E+w.nodeSize,g);n.addMark(D,L,a.create({...A.attrs,...e}))}}))}),v&&(x!==void 0&&o&&n.setNodeMarkup(x,void 0,{...v.attrs,...e}),a&&v.marks.length&&v.marks.forEach(w=>{a===w.type&&o&&n.addMark(S,k,a.create({...w.attrs,...e}))}))}),d},Vz=(t,e={})=>({state:n,dispatch:i})=>{const o=ut(t,n.schema);return yD(o,e)(n,i)},qz=(t,e={})=>({state:n,dispatch:i})=>{const o=ut(t,n.schema);return xD(o,e)(n,i)},Fz=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(i=>i.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(i=>i!==e):delete this.callbacks[t]),this}once(t,e){const n=(...i)=>{this.off(t,n),e.apply(this,i)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}},hd=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},Wz=(t,e)=>{if(Qm(e))return e.exec(t);const n=e(t);if(!n)return null;const i=[n.text];return i.index=n.index,i.input=t,i.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),i.push(n.replaceWith)),i};function zc(t){var e;const{editor:n,from:i,to:o,text:s,rules:a,plugin:u}=t,{view:d}=n;if(d.composing)return!1;const h=d.state.doc.resolve(i);if(h.parent.type.spec.code||(e=h.nodeBefore||h.nodeAfter)!=null&&e.marks.find(x=>x.type.spec.code))return!1;let p=!1;const g=yz(h)+s;return a.forEach(x=>{if(p)return;const v=Wz(g,x.find);if(!v)return;const S=d.state.tr,k=ad({state:d.state,transaction:S}),w={from:i-(v[0].length-s.length),to:o},{commands:E,chain:A,can:D}=new cd({editor:n,state:k});x.handler({state:k,range:w,match:v,commands:E,chain:A,can:D})===null||!S.steps.length||(x.undoable&&S.setMeta(u,{transform:S,from:i,to:o,text:s}),d.dispatch(S),p=!0)}),p}function Yz(t){const{editor:e,rules:n}=t,i=new Ye({state:{init(){return null},apply(o,s,a){const u=o.getMeta(i);if(u)return u;const d=o.getMeta("applyInputRules");return d&&setTimeout(()=>{let{text:p}=d;typeof p=="string"?p=p:p=ig(Q.from(p),a.schema);const{from:g}=d,x=g+p.length;zc({editor:e,from:g,to:x,text:p,rules:n,plugin:i})}),o.selectionSet||o.docChanged?null:s}},props:{handleTextInput(o,s,a,u){return zc({editor:e,from:s,to:a,text:u,rules:n,plugin:i})},handleDOMEvents:{compositionend:o=>(setTimeout(()=>{const{$cursor:s}=o.state.selection;s&&zc({editor:e,from:s.pos,to:s.pos,text:"",rules:n,plugin:i})}),!1)},handleKeyDown(o,s){if(s.key!=="Enter")return!1;const{$cursor:a}=o.state.selection;return a?zc({editor:e,from:a.pos,to:a.pos,text:`
`,rules:n,plugin:i}):!1}},isInputRules:!0});return i}function Gz(t){return Object.prototype.toString.call(t).slice(8,-1)}function Lc(t){return Gz(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function PC(t,e){const n={...t};return Lc(t)&&Lc(e)&&Object.keys(e).forEach(i=>{Lc(e[i])&&Lc(t[i])?n[i]=PC(t[i],e[i]):n[i]=e[i]}),n}var lg=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...Ie(ye(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Ie(ye(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>PC(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},Ar=class VC extends lg{constructor(){super(...arguments),this.type="mark"}static create(e={}){const n=typeof e=="function"?e():e;return new VC(n)}static handleExit({editor:e,mark:n}){const{tr:i}=e.state,o=e.state.selection.$from;if(o.pos===o.end()){const a=o.marks();if(!!!a.find(h=>h?.type.name===n.name))return!1;const d=a.find(h=>h?.type.name===n.name);return d&&i.removeStoredMark(d),i.insertText(" ",o.pos),e.view.dispatch(i),!0}return!1}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function Kz(t){return typeof t=="number"}var Xz=class{constructor(t){this.find=t.find,this.handler=t.handler}},Jz=(t,e,n)=>{if(Qm(e))return[...t.matchAll(e)];const i=e(t,n);return i?i.map(o=>{const s=[o.text];return s.index=o.index,s.input=t,s.data=o.data,o.replaceWith&&(o.text.includes(o.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(o.replaceWith)),s}):[]};function Qz(t){const{editor:e,state:n,from:i,to:o,rule:s,pasteEvent:a,dropEvent:u}=t,{commands:d,chain:h,can:p}=new cd({editor:e,state:n}),g=[];return n.doc.nodesBetween(i,o,(v,S)=>{var k,w,E,A,D;if((w=(k=v.type)==null?void 0:k.spec)!=null&&w.code||!(v.isText||v.isTextblock||v.isInline))return;const L=(D=(A=(E=v.content)==null?void 0:E.size)!=null?A:v.nodeSize)!=null?D:0,T=Math.max(i,S),z=Math.min(o,S+L);if(T>=z)return;const N=v.isText?v.text||"":v.textBetween(T-S,z-S,void 0,"");Jz(N,s.find,a).forEach(_=>{if(_.index===void 0)return;const W=T+_.index+1,oe=W+_[0].length,re={from:n.tr.mapping.map(W),to:n.tr.mapping.map(oe)},fe=s.handler({state:n,range:re,match:_,commands:d,chain:h,can:p,pasteEvent:a,dropEvent:u});g.push(fe)})}),g.every(v=>v!==null)}var Bc=null,Zz=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)==null||e.setData("text/html",t),n};function eL(t){const{editor:e,rules:n}=t;let i=null,o=!1,s=!1,a=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,u;try{u=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{u=null}const d=({state:p,from:g,to:x,rule:v,pasteEvt:S})=>{const k=p.tr,w=ad({state:p,transaction:k});if(!(!Qz({editor:e,state:w,from:Math.max(g-1,0),to:x.b-1,rule:v,pasteEvent:S,dropEvent:u})||!k.steps.length)){try{u=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{u=null}return a=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,k}};return n.map(p=>new Ye({view(g){const x=S=>{var k;i=(k=g.dom.parentElement)!=null&&k.contains(S.target)?g.dom.parentElement:null,i&&(Bc=e)},v=()=>{Bc&&(Bc=null)};return window.addEventListener("dragstart",x),window.addEventListener("dragend",v),{destroy(){window.removeEventListener("dragstart",x),window.removeEventListener("dragend",v)}}},props:{handleDOMEvents:{drop:(g,x)=>{if(s=i===g.dom.parentElement,u=x,!s){const v=Bc;v?.isEditable&&setTimeout(()=>{const S=v.state.selection;S&&v.commands.deleteRange({from:S.from,to:S.to})},10)}return!1},paste:(g,x)=>{var v;const S=(v=x.clipboardData)==null?void 0:v.getData("text/html");return a=x,o=!!S?.includes("data-pm-slice"),!1}}},appendTransaction:(g,x,v)=>{const S=g[0],k=S.getMeta("uiEvent")==="paste"&&!o,w=S.getMeta("uiEvent")==="drop"&&!s,E=S.getMeta("applyPasteRules"),A=!!E;if(!k&&!w&&!A)return;if(A){let{text:T}=E;typeof T=="string"?T=T:T=ig(Q.from(T),v.schema);const{from:z}=E,N=z+T.length,B=Zz(T);return d({rule:p,state:v,from:z,to:{b:N},pasteEvt:B})}const D=x.doc.content.findDiffStart(v.doc.content),L=x.doc.content.findDiffEnd(v.doc.content);if(!(!Kz(D)||!L||D===L.b))return d({rule:p,state:v,from:D,to:L,pasteEvt:a})}}))}var pd=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=zC(t),this.schema=uz(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:hp(e.name,this.schema)},i=ye(e,"addCommands",n);return i?{...t,...i()}:t},{})}get plugins(){const{editor:t}=this;return rg([...this.extensions].reverse()).flatMap(i=>{const o={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:t,type:hp(i.name,this.schema)},s=[],a=ye(i,"addKeyboardShortcuts",o);let u={};if(i.type==="mark"&&ye(i,"exitable",o)&&(u.ArrowRight=()=>Ar.handleExit({editor:t,mark:i})),a){const x=Object.fromEntries(Object.entries(a()).map(([v,S])=>[v,()=>S({editor:t})]));u={...u,...x}}const d=hj(u);s.push(d);const h=ye(i,"addInputRules",o);if(v1(i,t.options.enableInputRules)&&h){const x=h();if(x&&x.length){const v=Yz({editor:t,rules:x}),S=Array.isArray(v)?v:[v];s.push(...S)}}const p=ye(i,"addPasteRules",o);if(v1(i,t.options.enablePasteRules)&&p){const x=p();if(x&&x.length){const v=eL({editor:t,rules:x});s.push(...v)}}const g=ye(i,"addProseMirrorPlugins",o);if(g){const x=g();s.push(...x)}return s})}get attributes(){return jC(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=ml(this.extensions);return Object.fromEntries(e.filter(n=>!!ye(n,"addNodeView")).map(n=>{const i=this.attributes.filter(d=>d.type===n.name),o={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:ut(n.name,this.schema)},s=ye(n,"addNodeView",o);if(!s)return[];const a=s();if(!a)return[];const u=(d,h,p,g,x)=>{const v=xu(d,i);return a({node:d,view:h,getPos:p,decorations:g,innerDecorations:x,editor:t,extension:n,HTMLAttributes:v})};return[n.name,u]}))}get markViews(){const{editor:t}=this,{markExtensions:e}=ml(this.extensions);return Object.fromEntries(e.filter(n=>!!ye(n,"addMarkView")).map(n=>{const i=this.attributes.filter(u=>u.type===n.name),o={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:ji(n.name,this.schema)},s=ye(n,"addMarkView",o);if(!s)return[];const a=(u,d,h)=>{const p=xu(u,i);return s()({mark:u,view:d,inline:h,editor:t,extension:n,HTMLAttributes:p,updateAttributes:g=>{mL(u,t,g)}})};return[n.name,a]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var n;const i={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:hp(e.name,this.schema)};e.type==="mark"&&((n=Ie(ye(e,"keepOnSplit",i)))==null||n)&&this.splittableMarks.push(e.name);const o=ye(e,"onBeforeCreate",i),s=ye(e,"onCreate",i),a=ye(e,"onUpdate",i),u=ye(e,"onSelectionUpdate",i),d=ye(e,"onTransaction",i),h=ye(e,"onFocus",i),p=ye(e,"onBlur",i),g=ye(e,"onDestroy",i);o&&this.editor.on("beforeCreate",o),s&&this.editor.on("create",s),a&&this.editor.on("update",a),u&&this.editor.on("selectionUpdate",u),d&&this.editor.on("transaction",d),h&&this.editor.on("focus",h),p&&this.editor.on("blur",p),g&&this.editor.on("destroy",g)})}};pd.resolve=zC;pd.sort=rg;pd.flatten=ng;var tL={};Jm(tL,{ClipboardTextSerializer:()=>FC,Commands:()=>WC,Delete:()=>YC,Drop:()=>GC,Editable:()=>KC,FocusEvents:()=>JC,Keymap:()=>QC,Paste:()=>ZC,Tabindex:()=>ek,TextDirection:()=>tk,focusEventsPluginKey:()=>XC});var Je=class qC extends lg{constructor(){super(...arguments),this.type="extension"}static create(e={}){const n=typeof e=="function"?e():e;return new qC(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},FC=Je.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Ye({key:new Xe("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:i,selection:o}=e,{ranges:s}=o,a=Math.min(...s.map(p=>p.$from.pos)),u=Math.max(...s.map(p=>p.$to.pos)),d=BC(n);return LC(i,{from:a,to:u},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:d})}}})]}}),WC=Je.create({name:"commands",addCommands(){return{...EC}}}),YC=Je.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var n,i,o;const s=()=>{var a,u,d,h;if((h=(d=(u=(a=this.editor.options.coreExtensionOptions)==null?void 0:a.delete)==null?void 0:u.filterTransaction)==null?void 0:d.call(u,t))!=null?h:t.getMeta("y-sync$"))return;const p=DC(t.before,[t,...e]);_C(p).forEach(v=>{p.mapping.mapResult(v.oldRange.from).deletedAfter&&p.mapping.mapResult(v.oldRange.to).deletedBefore&&p.before.nodesBetween(v.oldRange.from,v.oldRange.to,(S,k)=>{const w=k+S.nodeSize-2,E=v.oldRange.from<=k&&w<=v.oldRange.to;this.editor.emit("delete",{type:"node",node:S,from:k,to:w,newFrom:p.mapping.map(k),newTo:p.mapping.map(w),deletedRange:v.oldRange,newRange:v.newRange,partial:!E,editor:this.editor,transaction:t,combinedTransform:p})})});const x=p.mapping;p.steps.forEach((v,S)=>{var k,w;if(v instanceof Dn){const E=x.slice(S).map(v.from,-1),A=x.slice(S).map(v.to),D=x.invert().map(E,-1),L=x.invert().map(A),T=(k=p.doc.nodeAt(E-1))==null?void 0:k.marks.some(N=>N.eq(v.mark)),z=(w=p.doc.nodeAt(A))==null?void 0:w.marks.some(N=>N.eq(v.mark));this.editor.emit("delete",{type:"mark",mark:v.mark,from:v.from,to:v.to,deletedRange:{from:D,to:L},newRange:{from:E,to:A},partial:!!(z||T),editor:this.editor,transaction:t,combinedTransform:p})}})};(o=(i=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:i.async)==null||o?setTimeout(s,0):s()}}),GC=Je.create({name:"drop",addProseMirrorPlugins(){return[new Ye({key:new Xe("tiptapDrop"),props:{handleDrop:(t,e,n,i)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:i})}}})]}}),KC=Je.create({name:"editable",addProseMirrorPlugins(){return[new Ye({key:new Xe("editable"),props:{editable:()=>this.editor.options.editable}})]}}),XC=new Xe("focusEvents"),JC=Je.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Ye({key:XC,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const i=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(i),!1},blur:(e,n)=>{t.isFocused=!1;const i=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(i),!1}}}})]}}),QC=Je.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:a})=>[()=>a.undoInputRule(),()=>a.command(({tr:u})=>{const{selection:d,doc:h}=u,{empty:p,$anchor:g}=d,{pos:x,parent:v}=g,S=g.parent.isTextblock&&x>0?u.doc.resolve(x-1):g,k=S.parent.type.spec.isolating,w=g.pos-g.parentOffset,E=k&&S.parent.childCount===1?w===g.pos:ve.atStart(h).from===x;return!p||!v.type.isTextblock||v.textContent.length||!E||E&&g.parent.type.name==="paragraph"?!1:a.clearNodes()}),()=>a.deleteSelection(),()=>a.joinBackward(),()=>a.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:a})=>[()=>a.deleteSelection(),()=>a.deleteCurrentNode(),()=>a.joinForward(),()=>a.selectNodeForward()]),i={Enter:()=>this.editor.commands.first(({commands:a})=>[()=>a.newlineInCode(),()=>a.createParagraphNear(),()=>a.liftEmptyBlock(),()=>a.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},o={...i},s={...i,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return tg()||OC()?s:o},addProseMirrorPlugins(){return[new Ye({key:new Xe("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(k=>k.getMeta("composition")))return;const i=t.some(k=>k.docChanged)&&!e.doc.eq(n.doc),o=t.some(k=>k.getMeta("preventClearDocument"));if(!i||o)return;const{empty:s,from:a,to:u}=e.selection,d=ve.atStart(e.doc).from,h=ve.atEnd(e.doc).to;if(s||!(a===d&&u===h)||!fd(n.doc))return;const x=n.tr,v=ad({state:n,transaction:x}),{commands:S}=new cd({editor:this.editor,state:v});if(S.clearNodes(),!!x.steps.length)return x}})]}}),ZC=Je.create({name:"paste",addProseMirrorPlugins(){return[new Ye({key:new Xe("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),ek=Je.create({name:"tabindex",addProseMirrorPlugins(){return[new Ye({key:new Xe("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),tk=Je.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=ml(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const n=e.getAttribute("dir");return n&&(n==="ltr"||n==="rtl"||n==="auto")?n:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new Ye({key:new Xe("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),nL=class ol{constructor(e,n,i=!1,o=null){this.currentNode=null,this.actualDepth=null,this.isBlock=i,this.resolvedPos=e,this.editor=n,this.currentNode=o}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,i=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,i=this.to-1}this.editor.commands.insertContentAt({from:n,to:i},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new ol(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new ol(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new ol(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,i)=>{const o=n.isBlock&&!n.isTextblock,s=n.isAtom&&!n.isText,a=this.pos+i+(s?0:1);if(a<0||a>this.resolvedPos.doc.nodeSize-2)return;const u=this.resolvedPos.doc.resolve(a);if(!o&&u.depth<=this.depth)return;const d=new ol(u,this.editor,o,o?n:null);o&&(d.actualDepth=this.depth+1),e.push(new ol(u,this.editor,o,o?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let i=null,o=this.parent;for(;o&&!i;){if(o.node.type.name===e)if(Object.keys(n).length>0){const s=o.node.attrs,a=Object.keys(n);for(let u=0;u<a.length;u+=1){const d=a[u];if(s[d]!==n[d])break}}else i=o;o=o.parent}return i}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},i=!1){let o=[];if(!this.children||this.children.length===0)return o;const s=Object.keys(n);return this.children.forEach(a=>{i&&o.length>0||(a.node.type.name===e&&s.every(d=>n[d]===a.node.attrs[d])&&o.push(a),!(i&&o.length>0)&&(o=o.concat(a.querySelectorAll(e,n,i))))}),o}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}},iL=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function rL(t,e,n){const i=document.querySelector("style[data-tiptap-style]");if(i!==null)return i;const o=document.createElement("style");return e&&o.setAttribute("nonce",e),o.setAttribute("data-tiptap-style",""),o.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(o),o}var oL=class extends Fz{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:i})=>{throw i},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:Sz,createMappablePosition:wz},this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:i,slice:o,moved:s})=>this.options.onDrop(i,o,s)),this.on("paste",({event:i,slice:o})=>this.options.onPaste(i,o)),this.on("delete",this.options.onDelete);const e=this.createDoc(),n=MC(e,this.options.autofocus);this.editorState=sl.create({doc:e,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t?.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=rL(iL,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const n=NC(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],i=this.state.reconfigure({plugins:n});return this.view.updateState(i),i}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(o=>{const s=typeof o=="string"?`${o}$`:o.key;n=n.filter(a=>!a.key.startsWith(s))}),e.length===n.length)return;const i=this.state.reconfigure({plugins:n});return this.view.updateState(i),i}createExtensionManager(){var t,e;const i=[...this.options.enableCoreExtensions?[KC,FC.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),WC,JC,QC,ek,GC,ZC,YC,tk.configure({direction:this.options.textDirection})].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o?.type));this.extensionManager=new pd(i,this)}createCommandManager(){this.commandManager=new cd({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=lm(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(n=>n.name!=="collaboration"),this.createExtensionManager()}}),t=lm(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){var e;this.editorView=new kC(t,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)==null?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.prependClass(),this.injectCSS();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(h=>{var p;return(p=this.capturedTransaction)==null?void 0:p.step(h)});return}const{state:e,transactions:n}=this.state.applyTransaction(t),i=!this.state.selection.eq(e.selection),o=n.includes(t),s=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!o)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:n.slice(1)}),i&&this.emit("selectionUpdate",{editor:this,transaction:t});const a=n.findLast(h=>h.getMeta("focus")||h.getMeta("blur")),u=a?.getMeta("focus"),d=a?.getMeta("blur");u&&this.emit("focus",{editor:this,event:u.event,transaction:a}),d&&this.emit("blur",{editor:this,event:d.event,transaction:a}),!(t.getMeta("preventUpdate")||!n.some(h=>h.docChanged)||s.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:n.slice(1)})}getAttributes(t){return IC(this.state,t)}isActive(t,e){const n=typeof t=="string"?t:null,i=typeof t=="string"?e:t;return xz(this.state,n,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return ig(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:n={}}=t||{};return fz(this.state.doc,{blockSeparator:e,textSerializers:{...BC(this.schema),...n}})}get isEmpty(){return fd(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new nL(e,this)}get $doc(){return this.$pos(0)}};function gl(t){return new hd({find:t.find,handler:({state:e,range:n,match:i})=>{const o=Ie(t.getAttributes,void 0,i);if(o===!1||o===null)return null;const{tr:s}=e,a=i[i.length-1],u=i[0];if(a){const d=u.search(/\S/),h=n.from+u.indexOf(a),p=h+a.length;if(og(n.from,n.to,e.doc).filter(v=>v.mark.type.excluded.find(k=>k===t.type&&k!==v.mark.type)).filter(v=>v.to>h).length)return null;p<n.to&&s.delete(p,n.to),h>n.from&&s.delete(n.from+d,h);const x=n.from+d+a.length;s.addMark(n.from+d,x,t.type.create(o||{})),s.removeStoredMark(t.type)}},undoable:t.undoable})}function nk(t){return new hd({find:t.find,handler:({state:e,range:n,match:i})=>{const o=Ie(t.getAttributes,void 0,i)||{},{tr:s}=e,a=n.from;let u=n.to;const d=t.type.create(o);if(i[1]){const h=i[0].lastIndexOf(i[1]);let p=a+h;p>u?p=u:u=p+i[1].length;const g=i[0][i[0].length-1];s.insertText(g,a+i[0].length-1),s.replaceWith(p,u,d)}else if(i[0]){const h=t.type.isInline?a:a-1;s.insert(h,t.type.create(o)).delete(s.mapping.map(a),s.mapping.map(u))}s.scrollIntoView()},undoable:t.undoable})}function am(t){return new hd({find:t.find,handler:({state:e,range:n,match:i})=>{const o=e.doc.resolve(n.from),s=Ie(t.getAttributes,void 0,i)||{};if(!o.node(-1).canReplaceWith(o.index(-1),o.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,s)},undoable:t.undoable})}function yl(t){return new hd({find:t.find,handler:({state:e,range:n,match:i,chain:o})=>{const s=Ie(t.getAttributes,void 0,i)||{},a=e.tr.delete(n.from,n.to),d=a.doc.resolve(n.from).blockRange(),h=d&&zm(d,t.type,s);if(!h)return null;if(a.wrap(d,h),t.keepMarks&&t.editor){const{selection:g,storedMarks:x}=e,{splittableMarks:v}=t.editor.extensionManager,S=x||g.$to.parentOffset&&g.$from.marks();if(S){const k=S.filter(w=>v.includes(w.type.name));a.ensureMarks(k)}}if(t.keepAttributes){const g=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";o().updateAttributes(g,s).run()}const p=a.doc.resolve(n.from-1).nodeBefore;p&&p.type===t.type&&Tr(a.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(i,p))&&a.join(n.from-1)},undoable:t.undoable})}var lL=t=>"touches"in t,sL=class{constructor(t){this.directions=["bottom-left","bottom-right","top-left","top-right"],this.minSize={height:8,width:8},this.preserveAspectRatio=!1,this.classNames={container:"",wrapper:"",handle:"",resizing:""},this.initialWidth=0,this.initialHeight=0,this.aspectRatio=1,this.isResizing=!1,this.activeHandle=null,this.startX=0,this.startY=0,this.startWidth=0,this.startHeight=0,this.isShiftKeyPressed=!1,this.lastEditableState=void 0,this.handleMap=new Map,this.handleMouseMove=u=>{if(!this.isResizing||!this.activeHandle)return;const d=u.clientX-this.startX,h=u.clientY-this.startY;this.handleResize(d,h)},this.handleTouchMove=u=>{if(!this.isResizing||!this.activeHandle)return;const d=u.touches[0];if(!d)return;const h=d.clientX-this.startX,p=d.clientY-this.startY;this.handleResize(h,p)},this.handleMouseUp=()=>{if(!this.isResizing)return;const u=this.element.offsetWidth,d=this.element.offsetHeight;this.onCommit(u,d),this.isResizing=!1,this.activeHandle=null,this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)},this.handleKeyDown=u=>{u.key==="Shift"&&(this.isShiftKeyPressed=!0)},this.handleKeyUp=u=>{u.key==="Shift"&&(this.isShiftKeyPressed=!1)};var e,n,i,o,s,a;this.node=t.node,this.editor=t.editor,this.element=t.element,this.contentElement=t.contentElement,this.getPos=t.getPos,this.onResize=t.onResize,this.onCommit=t.onCommit,this.onUpdate=t.onUpdate,(e=t.options)!=null&&e.min&&(this.minSize={...this.minSize,...t.options.min}),(n=t.options)!=null&&n.max&&(this.maxSize=t.options.max),(i=t?.options)!=null&&i.directions&&(this.directions=t.options.directions),(o=t.options)!=null&&o.preserveAspectRatio&&(this.preserveAspectRatio=t.options.preserveAspectRatio),(s=t.options)!=null&&s.className&&(this.classNames={container:t.options.className.container||"",wrapper:t.options.className.wrapper||"",handle:t.options.className.handle||"",resizing:t.options.className.resizing||""}),(a=t.options)!=null&&a.createCustomHandle&&(this.createCustomHandle=t.options.createCustomHandle),this.wrapper=this.createWrapper(),this.container=this.createContainer(),this.applyInitialSize(),this.attachHandles(),this.editor.on("update",this.handleEditorUpdate.bind(this))}get dom(){return this.container}get contentDOM(){return this.contentElement}handleEditorUpdate(){const t=this.editor.isEditable;t!==this.lastEditableState&&(this.lastEditableState=t,t?t&&this.handleMap.size===0&&this.attachHandles():this.removeHandles())}update(t,e,n){return t.type!==this.node.type?!1:(this.node=t,this.onUpdate?this.onUpdate(t,e,n):!0)}destroy(){this.isResizing&&(this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp),this.isResizing=!1,this.activeHandle=null),this.editor.off("update",this.handleEditorUpdate.bind(this)),this.container.remove()}createContainer(){const t=document.createElement("div");return t.dataset.resizeContainer="",t.dataset.node=this.node.type.name,t.style.display="flex",this.classNames.container&&(t.className=this.classNames.container),t.appendChild(this.wrapper),t}createWrapper(){const t=document.createElement("div");return t.style.position="relative",t.style.display="block",t.dataset.resizeWrapper="",this.classNames.wrapper&&(t.className=this.classNames.wrapper),t.appendChild(this.element),t}createHandle(t){const e=document.createElement("div");return e.dataset.resizeHandle=t,e.style.position="absolute",this.classNames.handle&&(e.className=this.classNames.handle),e}positionHandle(t,e){const n=e.includes("top"),i=e.includes("bottom"),o=e.includes("left"),s=e.includes("right");n&&(t.style.top="0"),i&&(t.style.bottom="0"),o&&(t.style.left="0"),s&&(t.style.right="0"),(e==="top"||e==="bottom")&&(t.style.left="0",t.style.right="0"),(e==="left"||e==="right")&&(t.style.top="0",t.style.bottom="0")}attachHandles(){this.directions.forEach(t=>{let e;this.createCustomHandle?e=this.createCustomHandle(t):e=this.createHandle(t),e instanceof HTMLElement||(console.warn(`[ResizableNodeView] createCustomHandle("${t}") did not return an HTMLElement. Falling back to default handle.`),e=this.createHandle(t)),this.createCustomHandle||this.positionHandle(e,t),e.addEventListener("mousedown",n=>this.handleResizeStart(n,t)),e.addEventListener("touchstart",n=>this.handleResizeStart(n,t)),this.handleMap.set(t,e),this.wrapper.appendChild(e)})}removeHandles(){this.handleMap.forEach(t=>t.remove()),this.handleMap.clear()}applyInitialSize(){const t=this.node.attrs.width,e=this.node.attrs.height;t?(this.element.style.width=`${t}px`,this.initialWidth=t):this.initialWidth=this.element.offsetWidth,e?(this.element.style.height=`${e}px`,this.initialHeight=e):this.initialHeight=this.element.offsetHeight,this.initialWidth>0&&this.initialHeight>0&&(this.aspectRatio=this.initialWidth/this.initialHeight)}handleResizeStart(t,e){t.preventDefault(),t.stopPropagation(),this.isResizing=!0,this.activeHandle=e,lL(t)?(this.startX=t.touches[0].clientX,this.startY=t.touches[0].clientY):(this.startX=t.clientX,this.startY=t.clientY),this.startWidth=this.element.offsetWidth,this.startHeight=this.element.offsetHeight,this.startWidth>0&&this.startHeight>0&&(this.aspectRatio=this.startWidth/this.startHeight),this.getPos(),this.container.dataset.resizeState="true",this.classNames.resizing&&this.container.classList.add(this.classNames.resizing),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("touchmove",this.handleTouchMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}handleResize(t,e){if(!this.activeHandle)return;const n=this.preserveAspectRatio||this.isShiftKeyPressed,{width:i,height:o}=this.calculateNewDimensions(this.activeHandle,t,e),s=this.applyConstraints(i,o,n);this.element.style.width=`${s.width}px`,this.element.style.height=`${s.height}px`,this.onResize&&this.onResize(s.width,s.height)}calculateNewDimensions(t,e,n){let i=this.startWidth,o=this.startHeight;const s=t.includes("right"),a=t.includes("left"),u=t.includes("bottom"),d=t.includes("top");return s?i=this.startWidth+e:a&&(i=this.startWidth-e),u?o=this.startHeight+n:d&&(o=this.startHeight-n),(t==="right"||t==="left")&&(i=this.startWidth+(s?e:-e)),(t==="top"||t==="bottom")&&(o=this.startHeight+(u?n:-n)),this.preserveAspectRatio||this.isShiftKeyPressed?this.applyAspectRatio(i,o,t):{width:i,height:o}}applyConstraints(t,e,n){var i,o,s,a;if(!n){let h=Math.max(this.minSize.width,t),p=Math.max(this.minSize.height,e);return(i=this.maxSize)!=null&&i.width&&(h=Math.min(this.maxSize.width,h)),(o=this.maxSize)!=null&&o.height&&(p=Math.min(this.maxSize.height,p)),{width:h,height:p}}let u=t,d=e;return u<this.minSize.width&&(u=this.minSize.width,d=u/this.aspectRatio),d<this.minSize.height&&(d=this.minSize.height,u=d*this.aspectRatio),(s=this.maxSize)!=null&&s.width&&u>this.maxSize.width&&(u=this.maxSize.width,d=u/this.aspectRatio),(a=this.maxSize)!=null&&a.height&&d>this.maxSize.height&&(d=this.maxSize.height,u=d*this.aspectRatio),{width:u,height:d}}applyAspectRatio(t,e,n){const i=n==="left"||n==="right",o=n==="top"||n==="bottom";return i?{width:t,height:t/this.aspectRatio}:o?{width:e*this.aspectRatio,height:e}:{width:t,height:t/this.aspectRatio}}};function aL(t,e){const{selection:n}=t,{$from:i}=n;if(n instanceof xe){const s=i.index();return i.parent.canReplaceWith(s,s+1,e)}let o=i.depth;for(;o>=0;){const s=i.index(o);if(i.node(o).contentMatchAt(s).matchType(e))return!0;o-=1}return!1}var cL={};Jm(cL,{createAtomBlockMarkdownSpec:()=>uL,createBlockMarkdownSpec:()=>dL,createInlineMarkdownSpec:()=>pL,parseAttributes:()=>sg,parseIndentedBlocks:()=>cm,renderNestedMarkdownContent:()=>cg,serializeAttributes:()=>ag});function sg(t){if(!t?.trim())return{};const e={},n=[],i=t.replace(/["']([^"']*)["']/g,h=>(n.push(h),`__QUOTED_${n.length-1}__`)),o=i.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(o){const h=o.map(p=>p.trim().slice(1));e.class=h.join(" ")}const s=i.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);s&&(e.id=s[1]);const a=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(i.matchAll(a)).forEach(([,h,p])=>{var g;const x=parseInt(((g=p.match(/__QUOTED_(\d+)__/))==null?void 0:g[1])||"0",10),v=n[x];v&&(e[h]=v.slice(1,-1))});const d=i.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return d&&d.split(/\s+/).filter(Boolean).forEach(p=>{p.match(/^[a-zA-Z][\w-]*$/)&&(e[p]=!0)}),e}function ag(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(i=>e.push(`.${i}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([n,i])=>{n==="class"||n==="id"||(i===!0?e.push(n):i!==!1&&i!=null&&e.push(`${n}="${String(i)}"`))}),e.join(" ")}function uL(t){const{nodeName:e,name:n,parseAttributes:i=sg,serializeAttributes:o=ag,defaultAttributes:s={},requiredAttributes:a=[],allowedAttributes:u}=t,d=n||e,h=p=>{if(!u)return p;const g={};return u.forEach(x=>{x in p&&(g[x]=p[x])}),g};return{parseMarkdown:(p,g)=>{const x={...s,...p.attributes};return g.createNode(e,x,[])},markdownTokenizer:{name:e,level:"block",start(p){var g;const x=new RegExp(`^:::${d}(?:\\s|$)`,"m"),v=(g=p.match(x))==null?void 0:g.index;return v!==void 0?v:-1},tokenize(p,g,x){const v=new RegExp(`^:::${d}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),S=p.match(v);if(!S)return;const k=S[1]||"",w=i(k);if(!a.find(A=>!(A in w)))return{type:e,raw:S[0],attributes:w}}},renderMarkdown:p=>{const g=h(p.attrs||{}),x=o(g),v=x?` {${x}}`:"";return`:::${d}${v} :::`}}}function dL(t){const{nodeName:e,name:n,getContent:i,parseAttributes:o=sg,serializeAttributes:s=ag,defaultAttributes:a={},content:u="block",allowedAttributes:d}=t,h=n||e,p=g=>{if(!d)return g;const x={};return d.forEach(v=>{v in g&&(x[v]=g[v])}),x};return{parseMarkdown:(g,x)=>{let v;if(i){const k=i(g);v=typeof k=="string"?[{type:"text",text:k}]:k}else u==="block"?v=x.parseChildren(g.tokens||[]):v=x.parseInline(g.tokens||[]);const S={...a,...g.attributes};return x.createNode(e,S,v)},markdownTokenizer:{name:e,level:"block",start(g){var x;const v=new RegExp(`^:::${h}`,"m"),S=(x=g.match(v))==null?void 0:x.index;return S!==void 0?S:-1},tokenize(g,x,v){var S;const k=new RegExp(`^:::${h}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),w=g.match(k);if(!w)return;const[E,A=""]=w,D=o(A);let L=1;const T=E.length;let z="";const N=/^:::([\w-]*)(\s.*)?/gm,B=g.slice(T);for(N.lastIndex=0;;){const _=N.exec(B);if(_===null)break;const W=_.index,oe=_[1];if(!((S=_[2])!=null&&S.endsWith(":::"))){if(oe)L+=1;else if(L-=1,L===0){const re=B.slice(0,W);z=re.trim();const fe=g.slice(0,T+W+_[0].length);let he=[];if(z)if(u==="block")for(he=v.blockTokens(re),he.forEach(we=>{we.text&&(!we.tokens||we.tokens.length===0)&&(we.tokens=v.inlineTokens(we.text))});he.length>0;){const we=he[he.length-1];if(we.type==="paragraph"&&(!we.text||we.text.trim()===""))he.pop();else break}else he=v.inlineTokens(z);return{type:e,raw:fe,attributes:D,content:z,tokens:he}}}}}},renderMarkdown:(g,x)=>{const v=p(g.attrs||{}),S=s(v),k=S?` {${S}}`:"",w=x.renderChildren(g.content||[],`

`);return`:::${h}${k}

${w}

:::`}}}function fL(t){if(!t.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let i=n.exec(t);for(;i!==null;){const[,o,s,a]=i;e[o]=s||a,i=n.exec(t)}return e}function hL(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,n])=>`${e}="${n}"`).join(" ")}function pL(t){const{nodeName:e,name:n,getContent:i,parseAttributes:o=fL,serializeAttributes:s=hL,defaultAttributes:a={},selfClosing:u=!1,allowedAttributes:d}=t,h=n||e,p=x=>{if(!d)return x;const v={};return d.forEach(S=>{const k=typeof S=="string"?S:S.name,w=typeof S=="string"?void 0:S.skipIfDefault;if(k in x){const E=x[k];if(w!==void 0&&E===w)return;v[k]=E}}),v},g=h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(x,v)=>{const S={...a,...x.attributes};if(u)return v.createNode(e,S);const k=i?i(x):x.content||"";return k?v.createNode(e,S,[v.createTextNode(k)]):v.createNode(e,S,[])},markdownTokenizer:{name:e,level:"inline",start(x){const v=u?new RegExp(`\\[${g}\\s*[^\\]]*\\]`):new RegExp(`\\[${g}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${g}\\]`),S=x.match(v),k=S?.index;return k!==void 0?k:-1},tokenize(x,v,S){const k=u?new RegExp(`^\\[${g}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${g}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${g}\\]`),w=x.match(k);if(!w)return;let E="",A="";if(u){const[,L]=w;A=L}else{const[,L,T]=w;A=L,E=T||""}const D=o(A.trim());return{type:e,raw:w[0],content:E.trim(),attributes:D}}},renderMarkdown:x=>{let v="";i?v=i(x):x.content&&x.content.length>0&&(v=x.content.filter(E=>E.type==="text").map(E=>E.text).join(""));const S=p(x.attrs||{}),k=s(S),w=k?` ${k}`:"";return u?`[${h}${w}]`:`[${h}${w}]${v}[/${h}]`}}}function cm(t,e,n){var i,o,s,a;const u=t.split(`
`),d=[];let h="",p=0;const g=e.baseIndentSize||2;for(;p<u.length;){const x=u[p],v=x.match(e.itemPattern);if(!v){if(d.length>0)break;if(x.trim()===""){p+=1,h=`${h}${x}
`;continue}else return}const S=e.extractItemData(v),{indentLevel:k,mainContent:w}=S;h=`${h}${x}
`;const E=[w];for(p+=1;p<u.length;){const T=u[p];if(T.trim()===""){const N=u.slice(p+1).findIndex(W=>W.trim()!=="");if(N===-1)break;if((((o=(i=u[p+1+N].match(/^(\s*)/))==null?void 0:i[1])==null?void 0:o.length)||0)>k){E.push(T),h=`${h}${T}
`,p+=1;continue}else break}if((((a=(s=T.match(/^(\s*)/))==null?void 0:s[1])==null?void 0:a.length)||0)>k)E.push(T),h=`${h}${T}
`,p+=1;else break}let A;const D=E.slice(1);if(D.length>0){const T=D.map(z=>z.slice(k+g)).join(`
`);T.trim()&&(e.customNestedParser?A=e.customNestedParser(T):A=n.blockTokens(T))}const L=e.createToken(S,A);d.push(L)}if(d.length!==0)return{items:d,raw:h}}function cg(t,e,n,i){if(!t||!Array.isArray(t.content))return"";const o=typeof n=="function"?n(i):n,[s,...a]=t.content,u=e.renderChildren([s]),d=[`${o}${u}`];return a&&a.length>0&&a.forEach(h=>{const p=e.renderChildren([h]);if(p){const g=p.split(`
`).map(x=>x?e.indent(x):"").join(`
`);d.push(g)}}),d.join(`
`)}function mL(t,e,n={}){const{state:i}=e,{doc:o,tr:s}=i,a=t;o.descendants((u,d)=>{const h=s.mapping.map(d),p=s.mapping.map(d)+u.nodeSize;let g=null;if(u.marks.forEach(v=>{if(v!==a)return!1;g=v}),!g)return;let x=!1;if(Object.keys(n).forEach(v=>{n[v]!==g.attrs[v]&&(x=!0)}),x){const v=t.type.create({...t.attrs,...n});s.removeMark(h,p,t.type),s.addMark(h,p,v)}}),s.docChanged&&e.view.dispatch(s)}var Yt=class ik extends lg{constructor(){super(...arguments),this.type="node"}static create(e={}){const n=typeof e=="function"?e():e;return new ik(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function fo(t){return new Xz({find:t.find,handler:({state:e,range:n,match:i,pasteEvent:o})=>{const s=Ie(t.getAttributes,void 0,i,o);if(s===!1||s===null)return null;const{tr:a}=e,u=i[i.length-1],d=i[0];let h=n.to;if(u){const p=d.search(/\S/),g=n.from+d.indexOf(u),x=g+u.length;if(og(n.from,n.to,e.doc).filter(S=>S.mark.type.excluded.find(w=>w===t.type&&w!==S.mark.type)).filter(S=>S.to>g).length)return null;x<n.to&&a.delete(x,n.to),g>n.from&&a.delete(n.from+p,g),h=n.from+p+u.length,a.addMark(n.from+p,h,t.type.create(s||{})),a.removeStoredMark(t.type)}}})}const{getOwnPropertyNames:gL,getOwnPropertySymbols:yL}=Object,{hasOwnProperty:xL}=Object.prototype;function gp(t,e){return function(i,o,s){return t(i,o,s)&&e(i,o,s)}}function Ic(t){return function(n,i,o){if(!n||!i||typeof n!="object"||typeof i!="object")return t(n,i,o);const{cache:s}=o,a=s.get(n),u=s.get(i);if(a&&u)return a===i&&u===n;s.set(n,i),s.set(i,n);const d=t(n,i,o);return s.delete(n),s.delete(i),d}}function bL(t){return t?.[Symbol.toStringTag]}function C1(t){return gL(t).concat(yL(t))}const vL=Object.hasOwn||((t,e)=>xL.call(t,e));function mo(t,e){return t===e||!t&&!e&&t!==t&&e!==e}const SL="__v",wL="__o",CL="_owner",{getOwnPropertyDescriptor:k1,keys:E1}=Object;function kL(t,e){return t.byteLength===e.byteLength&&bu(new Uint8Array(t),new Uint8Array(e))}function EL(t,e,n){let i=t.length;if(e.length!==i)return!1;for(;i-- >0;)if(!n.equals(t[i],e[i],i,i,t,e,n))return!1;return!0}function TL(t,e){return t.byteLength===e.byteLength&&bu(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function ML(t,e){return mo(t.getTime(),e.getTime())}function AL(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function OL(t,e){return t===e}function T1(t,e,n){const i=t.size;if(i!==e.size)return!1;if(!i)return!0;const o=new Array(i),s=t.entries();let a,u,d=0;for(;(a=s.next())&&!a.done;){const h=e.entries();let p=!1,g=0;for(;(u=h.next())&&!u.done;){if(o[g]){g++;continue}const x=a.value,v=u.value;if(n.equals(x[0],v[0],d,g,t,e,n)&&n.equals(x[1],v[1],x[0],v[0],t,e,n)){p=o[g]=!0;break}g++}if(!p)return!1;d++}return!0}const RL=mo;function DL(t,e,n){const i=E1(t);let o=i.length;if(E1(e).length!==o)return!1;for(;o-- >0;)if(!rk(t,e,n,i[o]))return!1;return!0}function ws(t,e,n){const i=C1(t);let o=i.length;if(C1(e).length!==o)return!1;let s,a,u;for(;o-- >0;)if(s=i[o],!rk(t,e,n,s)||(a=k1(t,s),u=k1(e,s),(a||u)&&(!a||!u||a.configurable!==u.configurable||a.enumerable!==u.enumerable||a.writable!==u.writable)))return!1;return!0}function NL(t,e){return mo(t.valueOf(),e.valueOf())}function jL(t,e){return t.source===e.source&&t.flags===e.flags}function M1(t,e,n){const i=t.size;if(i!==e.size)return!1;if(!i)return!0;const o=new Array(i),s=t.values();let a,u;for(;(a=s.next())&&!a.done;){const d=e.values();let h=!1,p=0;for(;(u=d.next())&&!u.done;){if(!o[p]&&n.equals(a.value,u.value,a.value,u.value,t,e,n)){h=o[p]=!0;break}p++}if(!h)return!1}return!0}function bu(t,e){let n=t.byteLength;if(e.byteLength!==n||t.byteOffset!==e.byteOffset)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function zL(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function rk(t,e,n,i){return(i===CL||i===wL||i===SL)&&(t.$$typeof||e.$$typeof)?!0:vL(e,i)&&n.equals(t[i],e[i],i,i,t,e,n)}const LL="[object ArrayBuffer]",BL="[object Arguments]",IL="[object Boolean]",_L="[object DataView]",HL="[object Date]",UL="[object Error]",$L="[object Map]",PL="[object Number]",VL="[object Object]",qL="[object RegExp]",FL="[object Set]",WL="[object String]",YL={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},GL="[object URL]",KL=Object.prototype.toString;function XL({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:n,areDatesEqual:i,areErrorsEqual:o,areFunctionsEqual:s,areMapsEqual:a,areNumbersEqual:u,areObjectsEqual:d,arePrimitiveWrappersEqual:h,areRegExpsEqual:p,areSetsEqual:g,areTypedArraysEqual:x,areUrlsEqual:v,unknownTagComparators:S}){return function(w,E,A){if(w===E)return!0;if(w==null||E==null)return!1;const D=typeof w;if(D!==typeof E)return!1;if(D!=="object")return D==="number"?u(w,E,A):D==="function"?s(w,E,A):!1;const L=w.constructor;if(L!==E.constructor)return!1;if(L===Object)return d(w,E,A);if(Array.isArray(w))return e(w,E,A);if(L===Date)return i(w,E,A);if(L===RegExp)return p(w,E,A);if(L===Map)return a(w,E,A);if(L===Set)return g(w,E,A);const T=KL.call(w);if(T===HL)return i(w,E,A);if(T===qL)return p(w,E,A);if(T===$L)return a(w,E,A);if(T===FL)return g(w,E,A);if(T===VL)return typeof w.then!="function"&&typeof E.then!="function"&&d(w,E,A);if(T===GL)return v(w,E,A);if(T===UL)return o(w,E,A);if(T===BL)return d(w,E,A);if(YL[T])return x(w,E,A);if(T===LL)return t(w,E,A);if(T===_L)return n(w,E,A);if(T===IL||T===PL||T===WL)return h(w,E,A);if(S){let z=S[T];if(!z){const N=bL(w);N&&(z=S[N])}if(z)return z(w,E,A)}return!1}}function JL({circular:t,createCustomConfig:e,strict:n}){let i={areArrayBuffersEqual:kL,areArraysEqual:n?ws:EL,areDataViewsEqual:TL,areDatesEqual:ML,areErrorsEqual:AL,areFunctionsEqual:OL,areMapsEqual:n?gp(T1,ws):T1,areNumbersEqual:RL,areObjectsEqual:n?ws:DL,arePrimitiveWrappersEqual:NL,areRegExpsEqual:jL,areSetsEqual:n?gp(M1,ws):M1,areTypedArraysEqual:n?gp(bu,ws):bu,areUrlsEqual:zL,unknownTagComparators:void 0};if(e&&(i=Object.assign({},i,e(i))),t){const o=Ic(i.areArraysEqual),s=Ic(i.areMapsEqual),a=Ic(i.areObjectsEqual),u=Ic(i.areSetsEqual);i=Object.assign({},i,{areArraysEqual:o,areMapsEqual:s,areObjectsEqual:a,areSetsEqual:u})}return i}function QL(t){return function(e,n,i,o,s,a,u){return t(e,n,u)}}function ZL({circular:t,comparator:e,createState:n,equals:i,strict:o}){if(n)return function(u,d){const{cache:h=t?new WeakMap:void 0,meta:p}=n();return e(u,d,{cache:h,equals:i,meta:p,strict:o})};if(t)return function(u,d){return e(u,d,{cache:new WeakMap,equals:i,meta:void 0,strict:o})};const s={cache:void 0,equals:i,meta:void 0,strict:o};return function(u,d){return e(u,d,s)}}const e3=Or();Or({strict:!0});Or({circular:!0});Or({circular:!0,strict:!0});Or({createInternalComparator:()=>mo});Or({strict:!0,createInternalComparator:()=>mo});Or({circular:!0,createInternalComparator:()=>mo});Or({circular:!0,createInternalComparator:()=>mo,strict:!0});function Or(t={}){const{circular:e=!1,createInternalComparator:n,createState:i,strict:o=!1}=t,s=JL(t),a=XL(s),u=n?n(a):QL(a);return ZL({circular:e,comparator:a,createState:i,equals:u,strict:o})}var yp={exports:{}},xp={};var A1;function t3(){if(A1)return xp;A1=1;var t=ta(),e=KS();function n(h,p){return h===p&&(h!==0||1/h===1/p)||h!==h&&p!==p}var i=typeof Object.is=="function"?Object.is:n,o=e.useSyncExternalStore,s=t.useRef,a=t.useEffect,u=t.useMemo,d=t.useDebugValue;return xp.useSyncExternalStoreWithSelector=function(h,p,g,x,v){var S=s(null);if(S.current===null){var k={hasValue:!1,value:null};S.current=k}else k=S.current;S=u(function(){function E(z){if(!A){if(A=!0,D=z,z=x(z),v!==void 0&&k.hasValue){var N=k.value;if(v(N,z))return L=N}return L=z}if(N=L,i(D,z))return N;var B=x(z);return v!==void 0&&v(N,B)?(D=z,N):(D=z,L=B)}var A=!1,D,L,T=g===void 0?null:g;return[function(){return E(p())},T===null?void 0:function(){return E(T())}]},[p,g,x,v]);var w=o(h,S[0],S[1]);return a(function(){k.hasValue=!0,k.value=w},[w]),d(w),w},xp}var O1;function n3(){return O1||(O1=1,yp.exports=t3()),yp.exports}var i3=n3(),r3=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},o3=({contentComponent:t})=>{const e=XS.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return b.jsx(b.Fragment,{children:Object.values(e)})};function l3(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,i){e={...e,[n]:yO.createPortal(i.reactElement,i.element,n)},t.forEach(o=>o())},removeRenderer(n){const i={...e};delete i[n],e=i,t.forEach(o=>o())}}}var s3=class extends Ri.Component{constructor(t){var e;super(t),this.editorContentRef=Ri.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var t;const e=this.props.editor;if(e&&!e.isDestroyed&&((t=e.view.dom)!=null&&t.parentNode)){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n}),e.contentComponent=l3(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(i=>i.hasContentComponentInitialized?i:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.parentNode))return;const n=document.createElement("div");n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n})}catch{}}}render(){const{editor:t,innerRef:e,...n}=this.props;return b.jsxs(b.Fragment,{children:[b.jsx("div",{ref:r3(e,this.editorContentRef),...n}),t?.contentComponent&&b.jsx(o3,{contentComponent:t.contentComponent})]})}},a3=R.forwardRef((t,e)=>{const n=Ri.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return Ri.createElement(s3,{key:n,innerRef:e,...t})}),c3=Ri.memo(a3),u3=typeof window<"u"?R.useLayoutEffect:R.useEffect,d3=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(i=>i())},n=this.editor;return n.on("transaction",e),()=>{n.off("transaction",e)}}}};function f3(t){var e;const[n]=R.useState(()=>new d3(t.editor)),i=i3.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:e3);return u3(()=>n.watch(t.editor),[t.editor,n]),R.useDebugValue(i),i}var h3=!1,um=typeof window>"u",p3=um||!!(typeof window<"u"&&window.next),m3=class ok{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?um||p3?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...i)=>{var o,s;return(s=(o=this.options.current).onBeforeCreate)==null?void 0:s.call(o,...i)},onBlur:(...i)=>{var o,s;return(s=(o=this.options.current).onBlur)==null?void 0:s.call(o,...i)},onCreate:(...i)=>{var o,s;return(s=(o=this.options.current).onCreate)==null?void 0:s.call(o,...i)},onDestroy:(...i)=>{var o,s;return(s=(o=this.options.current).onDestroy)==null?void 0:s.call(o,...i)},onFocus:(...i)=>{var o,s;return(s=(o=this.options.current).onFocus)==null?void 0:s.call(o,...i)},onSelectionUpdate:(...i)=>{var o,s;return(s=(o=this.options.current).onSelectionUpdate)==null?void 0:s.call(o,...i)},onTransaction:(...i)=>{var o,s;return(s=(o=this.options.current).onTransaction)==null?void 0:s.call(o,...i)},onUpdate:(...i)=>{var o,s;return(s=(o=this.options.current).onUpdate)==null?void 0:s.call(o,...i)},onContentError:(...i)=>{var o,s;return(s=(o=this.options.current).onContentError)==null?void 0:s.call(o,...i)},onDrop:(...i)=>{var o,s;return(s=(o=this.options.current).onDrop)==null?void 0:s.call(o,...i)},onPaste:(...i)=>{var o,s;return(s=(o=this.options.current).onPaste)==null?void 0:s.call(o,...i)},onDelete:(...i)=>{var o,s;return(s=(o=this.options.current).onDelete)==null?void 0:s.call(o,...i)}};return new oL(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(i=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(i)?!0:i==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((o,s)=>{var a;return o===((a=n.extensions)==null?void 0:a[s])}):e[i]===n[i])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?ok.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((i,o)=>i===e[o]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function g3(t={},e=[]){const n=R.useRef(t);n.current=t;const[i]=R.useState(()=>new m3(n)),o=XS.useSyncExternalStore(i.subscribe,i.getEditor,i.getServerSnapshot);return R.useDebugValue(o),R.useEffect(i.onRender(e)),f3({editor:o,selector:({transactionNumber:s})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&s===0?0:s+1}),o}var y3=R.createContext({editor:null});y3.Consumer;var x3=R.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),b3=()=>R.useContext(x3);Ri.forwardRef((t,e)=>{const{onDragStart:n}=b3(),i=t.as||"div";return b.jsx(i,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});Ri.createContext({markViewContentRef:()=>{}});var vu=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:n,...i}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,i,n]},v3=/^\s*>\s$/,S3=Yt.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return vu("blockquote",{...nt(this.options.HTMLAttributes,t),children:vu("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const n=">",i=[];return t.content.forEach(o=>{const u=e.renderChildren([o]).split(`
`).map(d=>d.trim()===""?n:`${n} ${d}`);i.push(u.join(`
`))}),i.join(`
${n}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[yl({find:v3,type:this.type})]}}),w3=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,C3=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,k3=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,E3=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,T3=Ar.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return vu("strong",{...nt(this.options.HTMLAttributes,t),children:vu("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[gl({find:w3,type:this.type}),gl({find:k3,type:this.type})]},addPasteRules(){return[fo({find:C3,type:this.type}),fo({find:E3,type:this.type})]}}),M3=/(^|[^`])`([^`]+)`(?!`)$/,A3=/(^|[^`])`([^`]+)`(?!`)/g,O3=Ar.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",nt(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[gl({find:M3,type:this.type})]},addPasteRules(){return[fo({find:A3,type:this.type})]}}),bp=4,R3=/^```([a-z]+)?[\s\n]$/,D3=/^~~~([a-z]+)?[\s\n]$/,N3=Yt.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:bp,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;if(!n)return null;const s=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(a=>a.startsWith(n)).map(a=>a.replace(n,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",nt(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var n;return((n=t.raw)==null?void 0:n.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var n;let i="";const o=((n=t.attrs)==null?void 0:n.language)||"";return t.content?i=[`\`\`\`${o}`,e.renderChildren(t.content),"```"].join(`
`):i=`\`\`\`${o}

\`\`\``,i},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:bp,{state:i}=t,{selection:o}=i,{$from:s,empty:a}=o;if(s.parent.type!==this.type)return!1;const u=" ".repeat(n);return a?t.commands.insertContent(u):t.commands.command(({tr:d})=>{const{from:h,to:p}=o,v=i.doc.textBetween(h,p,`
`,`
`).split(`
`).map(S=>u+S).join(`
`);return d.replaceWith(h,p,i.schema.text(v)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:bp,{state:i}=t,{selection:o}=i,{$from:s,empty:a}=o;return s.parent.type!==this.type?!1:a?t.commands.command(({tr:u})=>{var d;const{pos:h}=s,p=s.start(),g=s.end(),v=i.doc.textBetween(p,g,`
`,`
`).split(`
`);let S=0,k=0;const w=h-p;for(let z=0;z<v.length;z+=1){if(k+v[z].length>=w){S=z;break}k+=v[z].length+1}const A=((d=v[S].match(/^ */))==null?void 0:d[0])||"",D=Math.min(A.length,n);if(D===0)return!0;let L=p;for(let z=0;z<S;z+=1)L+=v[z].length+1;return u.delete(L,L+D),h-L<=D&&u.setSelection(Se.create(u.doc,L)),!0}):t.commands.command(({tr:u})=>{const{from:d,to:h}=o,x=i.doc.textBetween(d,h,`
`,`
`).split(`
`).map(v=>{var S;const k=((S=v.match(/^ */))==null?void 0:S[0])||"",w=Math.min(k.length,n);return v.slice(w)}).join(`
`);return u.replaceWith(d,h,i.schema.text(x)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:i,empty:o}=n;if(!o||i.parent.type!==this.type)return!1;const s=i.parentOffset===i.parent.nodeSize-2,a=i.parent.textContent.endsWith(`

`);return!s||!a?!1:t.chain().command(({tr:u})=>(u.delete(i.pos-2,i.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:i}=e,{$from:o,empty:s}=n;if(!s||o.parent.type!==this.type||!(o.parentOffset===o.parent.nodeSize-2))return!1;const u=o.after();return u===void 0?!1:i.nodeAt(u)?t.commands.command(({tr:h})=>(h.setSelection(ve.near(i.resolve(u))),!0)):t.commands.exitCode()}}},addInputRules(){return[am({find:R3,type:this.type,getAttributes:t=>({language:t[1]})}),am({find:D3,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Ye({key:new Xe("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),i=e.clipboardData.getData("vscode-editor-data"),o=i?JSON.parse(i):void 0,s=o?.mode;if(!n||!s)return!1;const{tr:a,schema:u}=t.state,d=u.text(n.replace(/\r\n?/g,`
`));return a.replaceSelectionWith(this.type.create({language:s},d)),a.selection.$from.parent.type!==this.type&&a.setSelection(Se.near(a.doc.resolve(Math.max(0,a.selection.from-2)))),a.setMeta("paste",!0),t.dispatch(a),!0}}})]}}),j3=Yt.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),z3=Yt.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",nt(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:i})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:o,storedMarks:s}=n;if(o.$from.parent.type.spec.isolating)return!1;const{keepMarks:a}=this.options,{splittableMarks:u}=i.extensionManager,d=s||o.$to.parentOffset&&o.$from.marks();return e().insertContent({type:this.name}).command(({tr:h,dispatch:p})=>{if(p&&d&&a){const g=d.filter(x=>u.includes(x.type.name));h.ensureMarks(g)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),L3=Yt.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,nt(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var n;const i=(n=t.attrs)!=null&&n.level?parseInt(t.attrs.level,10):1,o="#".repeat(i);return t.content?`${o} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>am({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),B3=Yt.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",nt(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!aL(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$to:i}=n,o=t();return HC(n)?o.insertContentAt(i.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({state:s,tr:a,dispatch:u})=>{if(u){const{$to:d}=a.selection,h=d.end();if(d.nodeAfter)d.nodeAfter.isTextblock?a.setSelection(Se.create(a.doc,d.pos+1)):d.nodeAfter.isBlock?a.setSelection(xe.create(a.doc,d.pos)):a.setSelection(Se.create(a.doc,d.pos));else{const p=s.schema.nodes[this.options.nextNodeType]||d.parent.type.contentMatch.defaultType,g=p?.create();g&&(a.insert(h,g),a.setSelection(Se.create(a.doc,h+1)))}a.scrollIntoView()}return!0}).run()}}},addInputRules(){return[nk({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),I3=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,_3=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,H3=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,U3=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,$3=Ar.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",nt(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[gl({find:I3,type:this.type}),gl({find:H3,type:this.type})]},addPasteRules(){return[fo({find:_3,type:this.type}),fo({find:U3,type:this.type})]}});const P3="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",V3="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",dm="numeric",fm="ascii",hm="alpha",Is="asciinumeric",Os="alphanumeric",pm="domain",lk="emoji",q3="scheme",F3="slashscheme",vp="whitespace";function W3(t,e){return t in e||(e[t]=[]),e[t]}function eo(t,e,n){e[dm]&&(e[Is]=!0,e[Os]=!0),e[fm]&&(e[Is]=!0,e[hm]=!0),e[Is]&&(e[Os]=!0),e[hm]&&(e[Os]=!0),e[Os]&&(e[pm]=!0),e[lk]&&(e[pm]=!0);for(const i in e){const o=W3(i,n);o.indexOf(t)<0&&o.push(t)}}function Y3(t,e){const n={};for(const i in e)e[i].indexOf(t)>=0&&(n[i]=!0);return n}function qt(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}qt.groups={};qt.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let i=0;i<e.jr.length;i++){const o=e.jr[i][0],s=e.jr[i][1];if(s&&o.test(t))return s}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,i){for(let o=0;o<t.length;o++)this.tt(t[o],e,n,i)},tr(t,e,n,i){i=i||qt.groups;let o;return e&&e.j?o=e:(o=new qt(e),n&&i&&eo(e,n,i)),this.jr.push([t,o]),o},ts(t,e,n,i){let o=this;const s=t.length;if(!s)return o;for(let a=0;a<s-1;a++)o=o.tt(t[a]);return o.tt(t[s-1],e,n,i)},tt(t,e,n,i){i=i||qt.groups;const o=this;if(e&&e.j)return o.j[t]=e,e;const s=e;let a,u=o.go(t);if(u?(a=new qt,Object.assign(a.j,u.j),a.jr.push.apply(a.jr,u.jr),a.jd=u.jd,a.t=u.t):a=new qt,s){if(i)if(a.t&&typeof a.t=="string"){const d=Object.assign(Y3(a.t,i),n);eo(s,d,i)}else n&&eo(s,n,i);a.t=s}return o.j[t]=a,a}};const Te=(t,e,n,i,o)=>t.ta(e,n,i,o),et=(t,e,n,i,o)=>t.tr(e,n,i,o),R1=(t,e,n,i,o)=>t.ts(e,n,i,o),ne=(t,e,n,i,o)=>t.tt(e,n,i,o),Si="WORD",mm="UWORD",sk="ASCIINUMERICAL",ak="ALPHANUMERICAL",Qs="LOCALHOST",gm="TLD",ym="UTLD",tu="SCHEME",ll="SLASH_SCHEME",ug="NUM",xm="WS",dg="NL",_s="OPENBRACE",Hs="CLOSEBRACE",Su="OPENBRACKET",wu="CLOSEBRACKET",Cu="OPENPAREN",ku="CLOSEPAREN",Eu="OPENANGLEBRACKET",Tu="CLOSEANGLEBRACKET",Mu="FULLWIDTHLEFTPAREN",Au="FULLWIDTHRIGHTPAREN",Ou="LEFTCORNERBRACKET",Ru="RIGHTCORNERBRACKET",Du="LEFTWHITECORNERBRACKET",Nu="RIGHTWHITECORNERBRACKET",ju="FULLWIDTHLESSTHAN",zu="FULLWIDTHGREATERTHAN",Lu="AMPERSAND",Bu="APOSTROPHE",Iu="ASTERISK",ur="AT",_u="BACKSLASH",Hu="BACKTICK",Uu="CARET",hr="COLON",fg="COMMA",$u="DOLLAR",Un="DOT",Pu="EQUALS",hg="EXCLAMATION",vn="HYPHEN",Us="PERCENT",Vu="PIPE",qu="PLUS",Fu="POUND",$s="QUERY",pg="QUOTE",ck="FULLWIDTHMIDDLEDOT",mg="SEMI",$n="SLASH",Ps="TILDE",Wu="UNDERSCORE",uk="EMOJI",Yu="SYM";var dk=Object.freeze({__proto__:null,ALPHANUMERICAL:ak,AMPERSAND:Lu,APOSTROPHE:Bu,ASCIINUMERICAL:sk,ASTERISK:Iu,AT:ur,BACKSLASH:_u,BACKTICK:Hu,CARET:Uu,CLOSEANGLEBRACKET:Tu,CLOSEBRACE:Hs,CLOSEBRACKET:wu,CLOSEPAREN:ku,COLON:hr,COMMA:fg,DOLLAR:$u,DOT:Un,EMOJI:uk,EQUALS:Pu,EXCLAMATION:hg,FULLWIDTHGREATERTHAN:zu,FULLWIDTHLEFTPAREN:Mu,FULLWIDTHLESSTHAN:ju,FULLWIDTHMIDDLEDOT:ck,FULLWIDTHRIGHTPAREN:Au,HYPHEN:vn,LEFTCORNERBRACKET:Ou,LEFTWHITECORNERBRACKET:Du,LOCALHOST:Qs,NL:dg,NUM:ug,OPENANGLEBRACKET:Eu,OPENBRACE:_s,OPENBRACKET:Su,OPENPAREN:Cu,PERCENT:Us,PIPE:Vu,PLUS:qu,POUND:Fu,QUERY:$s,QUOTE:pg,RIGHTCORNERBRACKET:Ru,RIGHTWHITECORNERBRACKET:Nu,SCHEME:tu,SEMI:mg,SLASH:$n,SLASH_SCHEME:ll,SYM:Yu,TILDE:Ps,TLD:gm,UNDERSCORE:Wu,UTLD:ym,UWORD:mm,WORD:Si,WS:xm});const yi=/[a-z]/,Cs=new RegExp("\\p{L}","u"),Sp=new RegExp("\\p{Emoji}","u"),xi=/\d/,wp=/\s/,D1="\r",Cp=`
`,G3="",K3="",kp="";let _c=null,Hc=null;function X3(t=[]){const e={};qt.groups=e;const n=new qt;_c==null&&(_c=N1(P3)),Hc==null&&(Hc=N1(V3)),ne(n,"'",Bu),ne(n,"{",_s),ne(n,"}",Hs),ne(n,"[",Su),ne(n,"]",wu),ne(n,"(",Cu),ne(n,")",ku),ne(n,"<",Eu),ne(n,">",Tu),ne(n,"",Mu),ne(n,"",Au),ne(n,"",Ou),ne(n,"",Ru),ne(n,"",Du),ne(n,"",Nu),ne(n,"",ju),ne(n,"",zu),ne(n,"&",Lu),ne(n,"*",Iu),ne(n,"@",ur),ne(n,"`",Hu),ne(n,"^",Uu),ne(n,":",hr),ne(n,",",fg),ne(n,"$",$u),ne(n,".",Un),ne(n,"=",Pu),ne(n,"!",hg),ne(n,"-",vn),ne(n,"%",Us),ne(n,"|",Vu),ne(n,"+",qu),ne(n,"#",Fu),ne(n,"?",$s),ne(n,'"',pg),ne(n,"/",$n),ne(n,";",mg),ne(n,"~",Ps),ne(n,"_",Wu),ne(n,"\\",_u),ne(n,"",ck);const i=et(n,xi,ug,{[dm]:!0});et(i,xi,i);const o=et(i,yi,sk,{[Is]:!0}),s=et(i,Cs,ak,{[Os]:!0}),a=et(n,yi,Si,{[fm]:!0});et(a,xi,o),et(a,yi,a),et(o,xi,o),et(o,yi,o);const u=et(n,Cs,mm,{[hm]:!0});et(u,yi),et(u,xi,s),et(u,Cs,u),et(s,xi,s),et(s,yi),et(s,Cs,s);const d=ne(n,Cp,dg,{[vp]:!0}),h=ne(n,D1,xm,{[vp]:!0}),p=et(n,wp,xm,{[vp]:!0});ne(n,kp,p),ne(h,Cp,d),ne(h,kp,p),et(h,wp,p),ne(p,D1),ne(p,Cp),et(p,wp,p),ne(p,kp,p);const g=et(n,Sp,uk,{[lk]:!0});ne(g,"#"),et(g,Sp,g),ne(g,G3,g);const x=ne(g,K3);ne(x,"#"),et(x,Sp,g);const v=[[yi,a],[xi,o]],S=[[yi,null],[Cs,u],[xi,s]];for(let k=0;k<_c.length;k++)sr(n,_c[k],gm,Si,v);for(let k=0;k<Hc.length;k++)sr(n,Hc[k],ym,mm,S);eo(gm,{tld:!0,ascii:!0},e),eo(ym,{utld:!0,alpha:!0},e),sr(n,"file",tu,Si,v),sr(n,"mailto",tu,Si,v),sr(n,"http",ll,Si,v),sr(n,"https",ll,Si,v),sr(n,"ftp",ll,Si,v),sr(n,"ftps",ll,Si,v),eo(tu,{scheme:!0,ascii:!0},e),eo(ll,{slashscheme:!0,ascii:!0},e),t=t.sort((k,w)=>k[0]>w[0]?1:-1);for(let k=0;k<t.length;k++){const w=t[k][0],A=t[k][1]?{[q3]:!0}:{[F3]:!0};w.indexOf("-")>=0?A[pm]=!0:yi.test(w)?xi.test(w)?A[Is]=!0:A[fm]=!0:A[dm]=!0,R1(n,w,w,A)}return R1(n,"localhost",Qs,{ascii:!0}),n.jd=new qt(Yu),{start:n,tokens:Object.assign({groups:e},dk)}}function fk(t,e){const n=J3(e.replace(/[A-Z]/g,u=>u.toLowerCase())),i=n.length,o=[];let s=0,a=0;for(;a<i;){let u=t,d=null,h=0,p=null,g=-1,x=-1;for(;a<i&&(d=u.go(n[a]));)u=d,u.accepts()?(g=0,x=0,p=u):g>=0&&(g+=n[a].length,x++),h+=n[a].length,s+=n[a].length,a++;s-=g,a-=x,h-=g,o.push({t:p.t,v:e.slice(s-h,s),s:s-h,e:s})}return o}function J3(t){const e=[],n=t.length;let i=0;for(;i<n;){let o=t.charCodeAt(i),s,a=o<55296||o>56319||i+1===n||(s=t.charCodeAt(i+1))<56320||s>57343?t[i]:t.slice(i,i+2);e.push(a),i+=a.length}return e}function sr(t,e,n,i,o){let s;const a=e.length;for(let u=0;u<a-1;u++){const d=e[u];t.j[d]?s=t.j[d]:(s=new qt(i),s.jr=o.slice(),t.j[d]=s),t=s}return s=new qt(n),s.jr=o.slice(),t.j[e[a-1]]=s,s}function N1(t){const e=[],n=[];let i=0,o="0123456789";for(;i<t.length;){let s=0;for(;o.indexOf(t[i+s])>=0;)s++;if(s>0){e.push(n.join(""));for(let a=parseInt(t.substring(i,i+s),10);a>0;a--)n.pop();i+=s}else n.push(t[i]),i++}return e}const Zs={defaultProtocol:"http",events:null,format:j1,formatHref:j1,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function gg(t,e=null){let n=Object.assign({},Zs);t&&(n=Object.assign(n,t instanceof gg?t.o:t));const i=n.ignoreTags,o=[];for(let s=0;s<i.length;s++)o.push(i[s].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=o}gg.prototype={o:Zs,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const i=e!=null;let o=this.o[t];return o&&(typeof o=="object"?(o=n.t in o?o[n.t]:Zs[t],typeof o=="function"&&i&&(o=o(e,n))):typeof o=="function"&&i&&(o=o(e,n.t,n)),o)},getObj(t,e,n){let i=this.o[t];return typeof i=="function"&&e!=null&&(i=i(e,n.t,n)),i},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function j1(t){return t}function hk(t,e){this.t="token",this.v=t,this.tk=e}hk.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),i=t.get("format",e,this);return n&&i.length>n?i.substring(0,n)+"":i},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=Zs.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),i=t.get("formatHref",n,this),o=t.get("tagName",n,e),s=this.toFormattedString(t),a={},u=t.get("className",n,e),d=t.get("target",n,e),h=t.get("rel",n,e),p=t.getObj("attributes",n,e),g=t.getObj("events",n,e);return a.href=i,u&&(a.class=u),d&&(a.target=d),h&&(a.rel=h),p&&Object.assign(a,p),{tagName:o,attributes:a,content:s,eventListeners:g}}};function md(t,e){class n extends hk{constructor(o,s){super(o,s),this.t=t}}for(const i in e)n.prototype[i]=e[i];return n.t=t,n}const z1=md("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),L1=md("text"),Q3=md("nl"),Uc=md("url",{isLink:!0,toHref(t=Zs.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==Qs&&t[1].t===hr}}),bn=t=>new qt(t);function Z3({groups:t}){const e=t.domain.concat([Lu,Iu,ur,_u,Hu,Uu,$u,Pu,vn,ug,Us,Vu,qu,Fu,$n,Yu,Ps,Wu]),n=[Bu,hr,fg,Un,hg,Us,$s,pg,mg,Eu,Tu,_s,Hs,wu,Su,Cu,ku,Mu,Au,Ou,Ru,Du,Nu,ju,zu],i=[Lu,Bu,Iu,_u,Hu,Uu,$u,Pu,vn,_s,Hs,Us,Vu,qu,Fu,$s,$n,Yu,Ps,Wu],o=bn(),s=ne(o,Ps);Te(s,i,s),Te(s,t.domain,s);const a=bn(),u=bn(),d=bn();Te(o,t.domain,a),Te(o,t.scheme,u),Te(o,t.slashscheme,d),Te(a,i,s),Te(a,t.domain,a);const h=ne(a,ur);ne(s,ur,h),ne(u,ur,h),ne(d,ur,h);const p=ne(s,Un);Te(p,i,s),Te(p,t.domain,s);const g=bn();Te(h,t.domain,g),Te(g,t.domain,g);const x=ne(g,Un);Te(x,t.domain,g);const v=bn(z1);Te(x,t.tld,v),Te(x,t.utld,v),ne(h,Qs,v);const S=ne(g,vn);ne(S,vn,S),Te(S,t.domain,g),Te(v,t.domain,g),ne(v,Un,x),ne(v,vn,S);const k=ne(v,hr);Te(k,t.numeric,z1);const w=ne(a,vn),E=ne(a,Un);ne(w,vn,w),Te(w,t.domain,a),Te(E,i,s),Te(E,t.domain,a);const A=bn(Uc);Te(E,t.tld,A),Te(E,t.utld,A),Te(A,t.domain,a),Te(A,i,s),ne(A,Un,E),ne(A,vn,w),ne(A,ur,h);const D=ne(A,hr),L=bn(Uc);Te(D,t.numeric,L);const T=bn(Uc),z=bn();Te(T,e,T),Te(T,n,z),Te(z,e,T),Te(z,n,z),ne(A,$n,T),ne(L,$n,T);const N=ne(u,hr),B=ne(d,hr),_=ne(B,$n),W=ne(_,$n);Te(u,t.domain,a),ne(u,Un,E),ne(u,vn,w),Te(d,t.domain,a),ne(d,Un,E),ne(d,vn,w),Te(N,t.domain,T),ne(N,$n,T),ne(N,$s,T),Te(W,t.domain,T),Te(W,e,T),ne(W,$n,T);const oe=[[_s,Hs],[Su,wu],[Cu,ku],[Eu,Tu],[Mu,Au],[Ou,Ru],[Du,Nu],[ju,zu]];for(let re=0;re<oe.length;re++){const[fe,he]=oe[re],we=ne(T,fe);ne(z,fe,we),ne(we,he,T);const q=bn(Uc);Te(we,e,q);const ee=bn();Te(we,n),Te(q,e,q),Te(q,n,ee),Te(ee,e,q),Te(ee,n,ee),ne(q,he,T),ne(ee,he,T)}return ne(o,Qs,A),ne(o,dg,Q3),{start:o,tokens:dk}}function eB(t,e,n){let i=n.length,o=0,s=[],a=[];for(;o<i;){let u=t,d=null,h=null,p=0,g=null,x=-1;for(;o<i&&!(d=u.go(n[o].t));)a.push(n[o++]);for(;o<i&&(h=d||u.go(n[o].t));)d=null,u=h,u.accepts()?(x=0,g=u):x>=0&&x++,o++,p++;if(x<0)o-=p,o<i&&(a.push(n[o]),o++);else{a.length>0&&(s.push(Ep(L1,e,a)),a=[]),o-=x,p-=x;const v=g.t,S=n.slice(o-p,o);s.push(Ep(v,e,S))}}return a.length>0&&s.push(Ep(L1,e,a)),s}function Ep(t,e,n){const i=n[0].s,o=n[n.length-1].e,s=e.slice(i,o);return new t(s,n)}const tB=typeof console<"u"&&console&&console.warn||(()=>{}),nB="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Fe={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function iB(){return qt.groups={},Fe.scanner=null,Fe.parser=null,Fe.tokenQueue=[],Fe.pluginQueue=[],Fe.customSchemes=[],Fe.initialized=!1,Fe}function B1(t,e=!1){if(Fe.initialized&&tB(`linkifyjs: already initialized - will not register custom scheme "${t}" ${nB}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Fe.customSchemes.push([t,e])}function rB(){Fe.scanner=X3(Fe.customSchemes);for(let t=0;t<Fe.tokenQueue.length;t++)Fe.tokenQueue[t][1]({scanner:Fe.scanner});Fe.parser=Z3(Fe.scanner.tokens);for(let t=0;t<Fe.pluginQueue.length;t++)Fe.pluginQueue[t][1]({scanner:Fe.scanner,parser:Fe.parser});return Fe.initialized=!0,Fe}function yg(t){return Fe.initialized||rB(),eB(Fe.parser.start,t,fk(Fe.scanner.start,t))}yg.scan=fk;function pk(t,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const i=new gg(n),o=yg(t),s=[];for(let a=0;a<o.length;a++){const u=o[a];u.isLink&&(!e||u.t===e)&&i.check(u)&&s.push(u.toFormattedObject(i))}return s}var xg="[\0- -\u2029]",oB=new RegExp(xg),lB=new RegExp(`${xg}$`),sB=new RegExp(xg,"g");function aB(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function cB(t){return new Ye({key:new Xe("autolink"),appendTransaction:(e,n,i)=>{const o=e.some(h=>h.docChanged)&&!n.doc.eq(i.doc),s=e.some(h=>h.getMeta("preventAutolink"));if(!o||s)return;const{tr:a}=i,u=DC(n.doc,[...e]);if(_C(u).forEach(({newRange:h})=>{const p=lz(i.doc,h,v=>v.isTextblock);let g,x;if(p.length>1)g=p[0],x=i.doc.textBetween(g.pos,g.pos+g.node.nodeSize,void 0," ");else if(p.length){const v=i.doc.textBetween(h.from,h.to," "," ");if(!lB.test(v))return;g=p[0],x=i.doc.textBetween(g.pos,h.to,void 0," ")}if(g&&x){const v=x.split(oB).filter(Boolean);if(v.length<=0)return!1;const S=v[v.length-1],k=g.pos+x.lastIndexOf(S);if(!S)return!1;const w=yg(S).map(E=>E.toObject(t.defaultProtocol));if(!aB(w))return!1;w.filter(E=>E.isLink).map(E=>({...E,from:k+E.start+1,to:k+E.end+1})).filter(E=>i.schema.marks.code?!i.doc.rangeHasMark(E.from,E.to,i.schema.marks.code):!0).filter(E=>t.validate(E.value)).filter(E=>t.shouldAutoLink(E.value)).forEach(E=>{og(E.from,E.to,i.doc).some(A=>A.mark.type===t.type)||a.addMark(E.from,E.to,t.type.create({href:E.href}))})}}),!!a.steps.length)return a}})}function uB(t){return new Ye({key:new Xe("handleClickLink"),props:{handleClick:(e,n,i)=>{var o,s;if(i.button!==0||!e.editable)return!1;let a=!1;if(t.enableClickSelection&&(a=t.editor.commands.extendMarkRange(t.type.name)),t.openOnClick){let u=null;if(i.target instanceof HTMLAnchorElement)u=i.target;else{let g=i.target;const x=[];for(;g.nodeName!=="DIV";)x.push(g),g=g.parentNode;u=x.find(v=>v.nodeName==="A")}if(!u)return a;const d=IC(e.state,t.type.name),h=(o=u?.href)!=null?o:d.href,p=(s=u?.target)!=null?s:d.target;u&&h&&(window.open(h,p),a=!0)}return a}}})}function dB(t){return new Ye({key:new Xe("handlePasteLink"),props:{handlePaste:(e,n,i)=>{const{shouldAutoLink:o}=t,{state:s}=e,{selection:a}=s,{empty:u}=a;if(u)return!1;let d="";i.content.forEach(p=>{d+=p.textContent});const h=pk(d,{defaultProtocol:t.defaultProtocol}).find(p=>p.isLink&&p.value===d);return!d||!h||o!==void 0&&!o(h.href)?!1:t.editor.commands.setMark(t.type,{href:h.href})}}})}function Kr(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(i=>{const o=typeof i=="string"?i:i.scheme;o&&n.push(o)}),!t||t.replace(sB,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var mk=Ar.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){B1(t);return}B1(t.scheme,t.optionalSlashes)})},onDestroy(){iB()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!Kr(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>!!t}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!Kr(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!Kr(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",nt(this.options.HTMLAttributes,t),0]:["a",nt(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var n;const i=((n=t.attrs)==null?void 0:n.href)||"";return`[${e.renderChildren(t)}](${i})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:i=>!!Kr(i,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t||{};return n&&!this.options.isAllowedUri(n,{defaultValidate:i=>!!Kr(i,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[fo({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:i}=this.options,o=pk(t).filter(s=>s.isLink&&this.options.isAllowedUri(s.value,{defaultValidate:a=>!!Kr(a,n),protocols:n,defaultProtocol:i}));o.length&&o.forEach(s=>{this.options.shouldAutoLink(s.value)&&e.push({text:s.value,data:{href:s.href},index:s.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(cB({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:i=>this.options.isAllowedUri(i,{defaultValidate:o=>!!Kr(o,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),t.push(uB({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(dB({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),fB=mk,hB=Object.defineProperty,pB=(t,e)=>{for(var n in e)hB(t,n,{get:e[n],enumerable:!0})},mB="listItem",I1="textStyle",_1=/^\s*([-+*])\s$/,gk=Yt.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",nt(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(mB,this.editor.getAttributes(I1)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=yl({find:_1,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=yl({find:_1,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(I1),editor:this.editor})),[t]}}),yk=Yt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",nt(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let n=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(o=>o.type==="paragraph"))n=e.parseChildren(t.tokens);else{const o=t.tokens[0];if(o&&o.type==="text"&&o.tokens&&o.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(o.tokens)}],t.tokens.length>1){const a=t.tokens.slice(1),u=e.parseChildren(a);n.push(...u)}}else n=e.parseChildren(t.tokens)}return n.length===0&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(t,e,n)=>cg(t,e,i=>i.parentType==="bulletList"?"- ":i.parentType==="orderedList"?`${i.index+1}. `:"- ",n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),gB={};pB(gB,{findListItemPos:()=>aa,getNextListDepth:()=>bg,handleBackspace:()=>bm,handleDelete:()=>vm,hasListBefore:()=>xk,hasListItemAfter:()=>yB,hasListItemBefore:()=>bk,listItemHasSubList:()=>vk,nextListIsDeeper:()=>Sk,nextListIsHigher:()=>wk});var aa=(t,e)=>{const{$from:n}=e.selection,i=ut(t,e.schema);let o=null,s=n.depth,a=n.pos,u=null;for(;s>0&&u===null;)o=n.node(s),o.type===i?u=s:(s-=1,a-=1);return u===null?null:{$pos:e.doc.resolve(a),depth:u}},bg=(t,e)=>{const n=aa(t,e);if(!n)return!1;const[,i]=gz(e,t,n.$pos.pos+4);return i},xk=(t,e,n)=>{const{$anchor:i}=t.selection,o=Math.max(0,i.pos-2),s=t.doc.resolve(o).node();return!(!s||!n.includes(s.type.name))},bk=(t,e)=>{var n;const{$anchor:i}=e.selection,o=e.doc.resolve(i.pos-2);return!(o.index()===0||((n=o.nodeBefore)==null?void 0:n.type.name)!==t)},vk=(t,e,n)=>{if(!n)return!1;const i=ut(t,e.schema);let o=!1;return n.descendants(s=>{s.type===i&&(o=!0)}),o},bm=(t,e,n)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!Cr(t.state,e)&&xk(t.state,e,n)){const{$anchor:u}=t.state.selection,d=t.state.doc.resolve(u.before()-1),h=[];d.node().descendants((x,v)=>{x.type.name===e&&h.push({node:x,pos:v})});const p=h.at(-1);if(!p)return!1;const g=t.state.doc.resolve(d.start()+p.pos+1);return t.chain().cut({from:u.start()-1,to:u.end()+1},g.end()).joinForward().run()}if(!Cr(t.state,e)||!vz(t.state))return!1;const i=aa(e,t.state);if(!i)return!1;const s=t.state.doc.resolve(i.$pos.pos-2).node(i.depth),a=vk(e,t.state,s);return bk(e,t.state)&&!a?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},Sk=(t,e)=>{const n=bg(t,e),i=aa(t,e);return!i||!n?!1:n>i.depth},wk=(t,e)=>{const n=bg(t,e),i=aa(t,e);return!i||!n?!1:n<i.depth},vm=(t,e)=>{if(!Cr(t.state,e)||!bz(t.state,e))return!1;const{selection:n}=t.state,{$from:i,$to:o}=n;return!n.empty&&i.sameParent(o)?!1:Sk(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():wk(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},yB=(t,e)=>{var n;const{$anchor:i}=e.selection,o=e.doc.resolve(i.pos-i.parentOffset-2);return!(o.index()===o.parent.childCount-1||((n=o.nodeAfter)==null?void 0:n.type.name)!==t)},Ck=Je.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&vm(t,n)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&vm(t,n)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:i})=>{t.state.schema.nodes[n]!==void 0&&bm(t,n,i)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:i})=>{t.state.schema.nodes[n]!==void 0&&bm(t,n,i)&&(e=!0)}),e}}}}),H1=/^(\s*)(\d+)\.\s+(.*)$/,xB=/^\s/;function bB(t){const e=[];let n=0,i=0;for(;n<t.length;){const o=t[n],s=o.match(H1);if(!s)break;const[,a,u,d]=s,h=a.length;let p=d,g=n+1;const x=[o];for(;g<t.length;){const v=t[g];if(v.match(H1))break;if(v.trim()==="")x.push(v),p+=`
`,g+=1;else if(v.match(xB))x.push(v),p+=`
${v.slice(h+2)}`,g+=1;else break}e.push({indent:h,number:parseInt(u,10),content:p.trim(),raw:x.join(`
`)}),i=g,n=g}return[e,i]}function kk(t,e,n){var i;const o=[];let s=0;for(;s<t.length;){const a=t[s];if(a.indent===e){const u=a.content.split(`
`),d=((i=u[0])==null?void 0:i.trim())||"",h=[];d&&h.push({type:"paragraph",raw:d,tokens:n.inlineTokens(d)});const p=u.slice(1).join(`
`).trim();if(p){const v=n.blockTokens(p);h.push(...v)}let g=s+1;const x=[];for(;g<t.length&&t[g].indent>e;)x.push(t[g]),g+=1;if(x.length>0){const v=Math.min(...x.map(k=>k.indent)),S=kk(x,v,n);h.push({type:"list",ordered:!0,start:x[0].number,items:S,raw:x.map(k=>k.raw).join(`
`)})}o.push({type:"list_item",raw:a.raw,tokens:h}),s=g}else s+=1}return o}function vB(t,e){return t.map(n=>{if(n.type!=="list_item")return e.parseChildren([n])[0];const i=[];return n.tokens&&n.tokens.length>0&&n.tokens.forEach(o=>{if(o.type==="paragraph"||o.type==="list"||o.type==="blockquote"||o.type==="code")i.push(...e.parseChildren([o]));else if(o.type==="text"&&o.tokens){const s=e.parseChildren([o]);i.push({type:"paragraph",content:s})}else{const s=e.parseChildren([o]);s.length>0&&i.push(...s)}}),{type:"listItem",content:i}})}var SB="listItem",U1="textStyle",$1=/^(\d+)\.\s$/,Ek=Yt.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",nt(this.options.HTMLAttributes,n),0]:["ol",nt(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const n=t.start||1,i=t.items?vB(t.items,e):[];return n!==1?{type:"orderedList",attrs:{start:n},content:i}:{type:"orderedList",content:i}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),n=e?.index;return n!==void 0?n:-1},tokenize:(t,e,n)=>{var i;const o=t.split(`
`),[s,a]=bB(o);if(s.length===0)return;const u=kk(s,0,n);return u.length===0?void 0:{type:"list",ordered:!0,start:((i=s[0])==null?void 0:i.number)||1,items:u,raw:o.slice(0,a).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(SB,this.editor.getAttributes(U1)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=yl({find:$1,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=yl({find:$1,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(U1)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),wB=/^\s*(\[([( |x])?\])\s$/,CB=Yt.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",nt(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const n=[];if(t.tokens&&t.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):n.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const i=e.parseChildren(t.nestedTokens);n.push(...i)}return e.createNode("taskItem",{checked:t.checked||!1},n)},renderMarkdown:(t,e)=>{var n;const o=`- [${(n=t.attrs)!=null&&n.checked?"x":" "}] `;return cg(t,e,o)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:i})=>{const o=document.createElement("li"),s=document.createElement("label"),a=document.createElement("span"),u=document.createElement("input"),d=document.createElement("div"),h=p=>{var g,x;u.ariaLabel=((x=(g=this.options.a11y)==null?void 0:g.checkboxLabel)==null?void 0:x.call(g,p,u.checked))||`Task item checkbox for ${p.textContent||"empty task item"}`};return h(t),s.contentEditable="false",u.type="checkbox",u.addEventListener("mousedown",p=>p.preventDefault()),u.addEventListener("change",p=>{if(!i.isEditable&&!this.options.onReadOnlyChecked){u.checked=!u.checked;return}const{checked:g}=p.target;i.isEditable&&typeof n=="function"&&i.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:x})=>{const v=n();if(typeof v!="number")return!1;const S=x.doc.nodeAt(v);return x.setNodeMarkup(v,void 0,{...S?.attrs,checked:g}),!0}).run(),!i.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,g)||(u.checked=!u.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([p,g])=>{o.setAttribute(p,g)}),o.dataset.checked=t.attrs.checked,u.checked=t.attrs.checked,s.append(u,a),o.append(s,d),Object.entries(e).forEach(([p,g])=>{o.setAttribute(p,g)}),{dom:o,contentDOM:d,update:p=>p.type!==this.type?!1:(o.dataset.checked=p.attrs.checked,u.checked=p.attrs.checked,h(p),!0)}}},addInputRules(){return[yl({find:wB,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),kB=Yt.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",nt(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const n=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return n!==void 0?n:-1},tokenize(t,e,n){const i=s=>{const a=cm(s,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:u=>({indentLevel:u[1].length,mainContent:u[4],checked:u[3].toLowerCase()==="x"}),createToken:(u,d)=>({type:"taskItem",raw:"",mainContent:u.mainContent,indentLevel:u.indentLevel,checked:u.checked,text:u.mainContent,tokens:n.inlineTokens(u.mainContent),nestedTokens:d}),customNestedParser:i},n);return a?[{type:"taskList",raw:a.raw,items:a.items}]:n.blockTokens(s)},o=cm(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:s=>({indentLevel:s[1].length,mainContent:s[4],checked:s[3].toLowerCase()==="x"}),createToken:(s,a)=>({type:"taskItem",raw:"",mainContent:s.mainContent,indentLevel:s.indentLevel,checked:s.checked,text:s.mainContent,tokens:n.inlineTokens(s.mainContent),nestedTokens:a}),customNestedParser:i},n);if(o)return{type:"taskList",raw:o.raw,items:o.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});Je.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(gk.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(yk.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(Ck.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(Ek.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(CB.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(kB.configure(this.options.taskList)),t}});var EB=Yt.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",nt(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const n=t.tokens||[];return n.length===1&&n[0].type==="image"?e.parseChildren([n[0]]):e.createNode("paragraph",void 0,e.parseInline(n))},renderMarkdown:(t,e)=>!t||!Array.isArray(t.content)?"":e.renderChildren(t.content),addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),TB=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,MB=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,AB=Ar.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",nt(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[gl({find:TB,type:this.type})]},addPasteRules(){return[fo({find:MB,type:this.type})]}}),OB=Yt.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),Tk=Ar.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",nt(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,n){const o=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!o)return;const s=o[2].trim();return{type:"underline",raw:o[0],text:s,tokens:n.inlineTokens(s)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),RB=Tk;function DB(t={}){return new Ye({view(e){return new NB(e,t)}})}class NB{constructor(e,n){var i;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(i=n.width)!==null&&i!==void 0?i:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(o=>{let s=a=>{this[o](a)};return e.dom.addEventListener(o,s),{name:o,handler:s}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,i,o=this.editorView.dom,s=o.getBoundingClientRect(),a=s.width/o.offsetWidth,u=s.height/o.offsetHeight;if(n){let g=e.nodeBefore,x=e.nodeAfter;if(g||x){let v=this.editorView.nodeDOM(this.cursorPos-(g?g.nodeSize:0));if(v){let S=v.getBoundingClientRect(),k=g?S.bottom:S.top;g&&x&&(k=(k+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let w=this.width/2*u;i={left:S.left,right:S.right,top:k-w,bottom:k+w}}}}if(!i){let g=this.editorView.coordsAtPos(this.cursorPos),x=this.width/2*a;i={left:g.left-x,right:g.left+x,top:g.top,bottom:g.bottom}}let d=this.editorView.dom.offsetParent;this.element||(this.element=d.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let h,p;if(!d||d==document.body&&getComputedStyle(d).position=="static")h=-pageXOffset,p=-pageYOffset;else{let g=d.getBoundingClientRect(),x=g.width/d.offsetWidth,v=g.height/d.offsetHeight;h=g.left-d.scrollLeft*x,p=g.top-d.scrollTop*v}this.element.style.left=(i.left-h)/a+"px",this.element.style.top=(i.top-p)/u+"px",this.element.style.width=(i.right-i.left)/a+"px",this.element.style.height=(i.bottom-i.top)/u+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),i=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),o=i&&i.type.spec.disableDropCursor,s=typeof o=="function"?o(this.editorView,n,e):o;if(n&&!s){let a=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let u=Cw(this.editorView.state.doc,a,this.editorView.dragging.slice);u!=null&&(a=u)}this.setCursor(a),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class tt extends ve{constructor(e){super(e,e)}map(e,n){let i=e.resolve(n.map(this.head));return tt.valid(i)?new tt(i):ve.near(i)}content(){return se.empty}eq(e){return e instanceof tt&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new tt(e.resolve(n.pos))}getBookmark(){return new vg(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!jB(e)||!zB(e))return!1;let i=n.type.spec.allowGapCursor;if(i!=null)return i;let o=n.contentMatchAt(e.index()).defaultType;return o&&o.isTextblock}static findGapCursorFrom(e,n,i=!1){e:for(;;){if(!i&&tt.valid(e))return e;let o=e.pos,s=null;for(let a=e.depth;;a--){let u=e.node(a);if(n>0?e.indexAfter(a)<u.childCount:e.index(a)>0){s=u.child(n>0?e.indexAfter(a):e.index(a)-1);break}else if(a==0)return null;o+=n;let d=e.doc.resolve(o);if(tt.valid(d))return d}for(;;){let a=n>0?s.firstChild:s.lastChild;if(!a){if(s.isAtom&&!s.isText&&!xe.isSelectable(s)){e=e.doc.resolve(o+s.nodeSize*n),i=!1;continue e}break}s=a,o+=n;let u=e.doc.resolve(o);if(tt.valid(u))return u}return null}}}tt.prototype.visible=!1;tt.findFrom=tt.findGapCursorFrom;ve.jsonID("gapcursor",tt);class vg{constructor(e){this.pos=e}map(e){return new vg(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return tt.valid(n)?new tt(n):ve.near(n)}}function Mk(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function jB(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),i=t.node(e);if(n==0){if(i.type.spec.isolating)return!0;continue}for(let o=i.child(n-1);;o=o.lastChild){if(o.childCount==0&&!o.inlineContent||Mk(o.type))return!0;if(o.inlineContent)return!1}}return!0}function zB(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),i=t.node(e);if(n==i.childCount){if(i.type.spec.isolating)return!0;continue}for(let o=i.child(n);;o=o.firstChild){if(o.childCount==0&&!o.inlineContent||Mk(o.type))return!0;if(o.inlineContent)return!1}}return!0}function LB(){return new Ye({props:{decorations:HB,createSelectionBetween(t,e,n){return e.pos==n.pos&&tt.valid(n)?new tt(n):null},handleClick:IB,handleKeyDown:BB,handleDOMEvents:{beforeinput:_B}}})}const BB=Xm({ArrowLeft:$c("horiz",-1),ArrowRight:$c("horiz",1),ArrowUp:$c("vert",-1),ArrowDown:$c("vert",1)});function $c(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(i,o,s){let a=i.selection,u=e>0?a.$to:a.$from,d=a.empty;if(a instanceof Se){if(!s.endOfTextblock(n)||u.depth==0)return!1;d=!1,u=i.doc.resolve(e>0?u.after():u.before())}let h=tt.findGapCursorFrom(u,e,d);return h?(o&&o(i.tr.setSelection(new tt(h))),!0):!1}}function IB(t,e,n){if(!t||!t.editable)return!1;let i=t.state.doc.resolve(e);if(!tt.valid(i))return!1;let o=t.posAtCoords({left:n.clientX,top:n.clientY});return o&&o.inside>-1&&xe.isSelectable(t.state.doc.nodeAt(o.inside))?!1:(t.dispatch(t.state.tr.setSelection(new tt(i))),!0)}function _B(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof tt))return!1;let{$from:n}=t.state.selection,i=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!i)return!1;let o=Q.empty;for(let a=i.length-1;a>=0;a--)o=Q.from(i[a].createAndFill(null,o));let s=t.state.tr.replace(n.pos,n.pos,new se(o,0,0));return s.setSelection(Se.near(s.doc.resolve(n.pos+1))),t.dispatch(s),!1}function HB(t){if(!(t.selection instanceof tt))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Ge.create(t.doc,[zt.widget(t.selection.head,e,{key:"gapcursor"})])}var Gu=200,yt=function(){};yt.prototype.append=function(e){return e.length?(e=yt.from(e),!this.length&&e||e.length<Gu&&this.leafAppend(e)||this.length<Gu&&e.leafPrepend(this)||this.appendInner(e)):this};yt.prototype.prepend=function(e){return e.length?yt.from(e).append(this):this};yt.prototype.appendInner=function(e){return new UB(this,e)};yt.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?yt.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};yt.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};yt.prototype.forEach=function(e,n,i){n===void 0&&(n=0),i===void 0&&(i=this.length),n<=i?this.forEachInner(e,n,i,0):this.forEachInvertedInner(e,n,i,0)};yt.prototype.map=function(e,n,i){n===void 0&&(n=0),i===void 0&&(i=this.length);var o=[];return this.forEach(function(s,a){return o.push(e(s,a))},n,i),o};yt.from=function(e){return e instanceof yt?e:e&&e.length?new Ak(e):yt.empty};var Ak=(function(t){function e(i){t.call(this),this.values=i}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(o,s){return o==0&&s==this.length?this:new e(this.values.slice(o,s))},e.prototype.getInner=function(o){return this.values[o]},e.prototype.forEachInner=function(o,s,a,u){for(var d=s;d<a;d++)if(o(this.values[d],u+d)===!1)return!1},e.prototype.forEachInvertedInner=function(o,s,a,u){for(var d=s-1;d>=a;d--)if(o(this.values[d],u+d)===!1)return!1},e.prototype.leafAppend=function(o){if(this.length+o.length<=Gu)return new e(this.values.concat(o.flatten()))},e.prototype.leafPrepend=function(o){if(this.length+o.length<=Gu)return new e(o.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e})(yt);yt.empty=new Ak([]);var UB=(function(t){function e(n,i){t.call(this),this.left=n,this.right=i,this.length=n.length+i.length,this.depth=Math.max(n.depth,i.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(i){return i<this.left.length?this.left.get(i):this.right.get(i-this.left.length)},e.prototype.forEachInner=function(i,o,s,a){var u=this.left.length;if(o<u&&this.left.forEachInner(i,o,Math.min(s,u),a)===!1||s>u&&this.right.forEachInner(i,Math.max(o-u,0),Math.min(this.length,s)-u,a+u)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,s,a){var u=this.left.length;if(o>u&&this.right.forEachInvertedInner(i,o-u,Math.max(s,u)-u,a+u)===!1||s<u&&this.left.forEachInvertedInner(i,Math.min(o,u),s,a)===!1)return!1},e.prototype.sliceInner=function(i,o){if(i==0&&o==this.length)return this;var s=this.left.length;return o<=s?this.left.slice(i,o):i>=s?this.right.slice(i-s,o-s):this.left.slice(i,s).append(this.right.slice(0,o-s))},e.prototype.leafAppend=function(i){var o=this.right.leafAppend(i);if(o)return new e(this.left,o)},e.prototype.leafPrepend=function(i){var o=this.left.leafPrepend(i);if(o)return new e(o,this.right)},e.prototype.appendInner=function(i){return this.left.depth>=Math.max(this.right.depth,i.depth)+1?new e(this.left,new e(this.right,i)):new e(this,i)},e})(yt);const $B=500;class Rn{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let i=this.items.length;for(;;i--)if(this.items.get(i-1).selection){--i;break}let o,s;n&&(o=this.remapping(i,this.items.length),s=o.maps.length);let a=e.tr,u,d,h=[],p=[];return this.items.forEach((g,x)=>{if(!g.step){o||(o=this.remapping(i,x+1),s=o.maps.length),s--,p.push(g);return}if(o){p.push(new Pn(g.map));let v=g.step.map(o.slice(s)),S;v&&a.maybeStep(v).doc&&(S=a.mapping.maps[a.mapping.maps.length-1],h.push(new Pn(S,void 0,void 0,h.length+p.length))),s--,S&&o.appendMap(S,s)}else a.maybeStep(g.step);if(g.selection)return u=o?g.selection.map(o.slice(s)):g.selection,d=new Rn(this.items.slice(0,i).append(p.reverse().concat(h)),this.eventCount-1),!1},this.items.length,0),{remaining:d,transform:a,selection:u}}addTransform(e,n,i,o){let s=[],a=this.eventCount,u=this.items,d=!o&&u.length?u.get(u.length-1):null;for(let p=0;p<e.steps.length;p++){let g=e.steps[p].invert(e.docs[p]),x=new Pn(e.mapping.maps[p],g,n),v;(v=d&&d.merge(x))&&(x=v,p?s.pop():u=u.slice(0,u.length-1)),s.push(x),n&&(a++,n=void 0),o||(d=x)}let h=a-i.depth;return h>VB&&(u=PB(u,h),a-=h),new Rn(u.append(s),a)}remapping(e,n){let i=new Ws;return this.items.forEach((o,s)=>{let a=o.mirrorOffset!=null&&s-o.mirrorOffset>=e?i.maps.length-o.mirrorOffset:void 0;i.appendMap(o.map,a)},e,n),i}addMaps(e){return this.eventCount==0?this:new Rn(this.items.append(e.map(n=>new Pn(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let i=[],o=Math.max(0,this.items.length-n),s=e.mapping,a=e.steps.length,u=this.eventCount;this.items.forEach(x=>{x.selection&&u--},o);let d=n;this.items.forEach(x=>{let v=s.getMirror(--d);if(v==null)return;a=Math.min(a,v);let S=s.maps[v];if(x.step){let k=e.steps[v].invert(e.docs[v]),w=x.selection&&x.selection.map(s.slice(d+1,v));w&&u++,i.push(new Pn(S,k,w))}else i.push(new Pn(S))},o);let h=[];for(let x=n;x<a;x++)h.push(new Pn(s.maps[x]));let p=this.items.slice(0,o).append(h).append(i),g=new Rn(p,u);return g.emptyItemCount()>$B&&(g=g.compress(this.items.length-i.length)),g}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),i=n.maps.length,o=[],s=0;return this.items.forEach((a,u)=>{if(u>=e)o.push(a),a.selection&&s++;else if(a.step){let d=a.step.map(n.slice(i)),h=d&&d.getMap();if(i--,h&&n.appendMap(h,i),d){let p=a.selection&&a.selection.map(n.slice(i));p&&s++;let g=new Pn(h.invert(),d,p),x,v=o.length-1;(x=o.length&&o[v].merge(g))?o[v]=x:o.push(g)}}else a.map&&i--},this.items.length,0),new Rn(yt.from(o.reverse()),s)}}Rn.empty=new Rn(yt.empty,0);function PB(t,e){let n;return t.forEach((i,o)=>{if(i.selection&&e--==0)return n=o,!1}),t.slice(n)}class Pn{constructor(e,n,i,o){this.map=e,this.step=n,this.selection=i,this.mirrorOffset=o}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new Pn(n.getMap().invert(),n,this.selection)}}}class dr{constructor(e,n,i,o,s){this.done=e,this.undone=n,this.prevRanges=i,this.prevTime=o,this.prevComposition=s}}const VB=20;function qB(t,e,n,i){let o=n.getMeta(lo),s;if(o)return o.historyState;n.getMeta(YB)&&(t=new dr(t.done,t.undone,null,0,-1));let a=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(a&&a.getMeta(lo))return a.getMeta(lo).redo?new dr(t.done.addTransform(n,void 0,i,nu(e)),t.undone,P1(n.mapping.maps),t.prevTime,t.prevComposition):new dr(t.done,t.undone.addTransform(n,void 0,i,nu(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(a&&a.getMeta("addToHistory")===!1)){let u=n.getMeta("composition"),d=t.prevTime==0||!a&&t.prevComposition!=u&&(t.prevTime<(n.time||0)-i.newGroupDelay||!FB(n,t.prevRanges)),h=a?Tp(t.prevRanges,n.mapping):P1(n.mapping.maps);return new dr(t.done.addTransform(n,d?e.selection.getBookmark():void 0,i,nu(e)),Rn.empty,h,n.time,u??t.prevComposition)}else return(s=n.getMeta("rebased"))?new dr(t.done.rebased(n,s),t.undone.rebased(n,s),Tp(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new dr(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Tp(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function FB(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((i,o)=>{for(let s=0;s<e.length;s+=2)i<=e[s+1]&&o>=e[s]&&(n=!0)}),n}function P1(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((i,o,s,a)=>e.push(s,a));return e}function Tp(t,e){if(!t)return null;let n=[];for(let i=0;i<t.length;i+=2){let o=e.map(t[i],1),s=e.map(t[i+1],-1);o<=s&&n.push(o,s)}return n}function WB(t,e,n){let i=nu(e),o=lo.get(e).spec.config,s=(n?t.undone:t.done).popEvent(e,i);if(!s)return null;let a=s.selection.resolve(s.transform.doc),u=(n?t.done:t.undone).addTransform(s.transform,e.selection.getBookmark(),o,i),d=new dr(n?u:s.remaining,n?s.remaining:u,null,0,-1);return s.transform.setSelection(a).setMeta(lo,{redo:n,historyState:d})}let Mp=!1,V1=null;function nu(t){let e=t.plugins;if(V1!=e){Mp=!1,V1=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){Mp=!0;break}}return Mp}const lo=new Xe("history"),YB=new Xe("closeHistory");function GB(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Ye({key:lo,state:{init(){return new dr(Rn.empty,Rn.empty,null,0,-1)},apply(e,n,i){return qB(n,i,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let i=n.inputType,o=i=="historyUndo"?Rk:i=="historyRedo"?Dk:null;return!o||!e.editable?!1:(n.preventDefault(),o(e.state,e.dispatch))}}}})}function Ok(t,e){return(n,i)=>{let o=lo.getState(n);if(!o||(t?o.undone:o.done).eventCount==0)return!1;if(i){let s=WB(o,n,t);s&&i(e?s.scrollIntoView():s)}return!0}}const Rk=Ok(!1,!0),Dk=Ok(!0,!0);var KB=Je.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=t?.node||this.editor.state.doc;if((t?.mode||this.options.mode)==="textSize"){const i=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(i)}return e.nodeSize},this.storage.words=t=>{const e=t?.node||this.editor.state.doc,n=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let t=!1;return[new Ye({key:new Xe("characterCount"),appendTransaction:(e,n,i)=>{if(t)return;const o=this.options.limit;if(o==null||o===0){t=!0;return}const s=this.storage.characters({node:i.doc});if(s>o){const a=s-o,u=0,d=a;console.warn(`[CharacterCount] Initial content exceeded limit of ${o} characters. Content was automatically trimmed.`);const h=i.tr.deleteRange(u,d);return t=!0,h}t=!0},filterTransaction:(e,n)=>{const i=this.options.limit;if(!e.docChanged||i===0||i===null||i===void 0)return!0;const o=this.storage.characters({node:n.doc}),s=this.storage.characters({node:e.doc});if(s<=i||o>i&&s>i&&s<=o)return!0;if(o>i&&s>i&&s>o||!e.getMeta("paste"))return!1;const u=e.selection.$head.pos,d=s-i,h=u-d,p=u;return e.deleteRange(h,p),!(this.storage.characters({node:e.doc})>i)}})]}}),XB=Je.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[DB(this.options)]}}),JB=Je.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Ye({key:new Xe("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:n,isFocused:i}=this.editor,{anchor:o}=e,s=[];if(!n||!i)return Ge.create(t,[]);let a=0;this.options.mode==="deepest"&&t.descendants((d,h)=>{if(d.isText)return;if(!(o>=h&&o<=h+d.nodeSize-1))return!1;a+=1});let u=0;return t.descendants((d,h)=>{if(d.isText||!(o>=h&&o<=h+d.nodeSize-1))return!1;if(u+=1,this.options.mode==="deepest"&&a-u>0||this.options.mode==="shallowest"&&u>1)return this.options.mode==="deepest";s.push(zt.node(h,h+d.nodeSize,{class:this.options.className}))}),Ge.create(t,s)}}})]}}),QB=Je.create({name:"gapCursor",addProseMirrorPlugins(){return[LB()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=Ie(ye(t,"allowGapCursor",n)))!=null?e:null}}}),ZB=Je.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Ye({key:new Xe("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:i}=e,o=[];if(!n)return null;const s=this.editor.isEmpty;return t.descendants((a,u)=>{const d=i>=u&&i<=u+a.nodeSize,h=!a.isLeaf&&fd(a);if((d||!this.options.showOnlyCurrent)&&h){const p=[this.options.emptyNodeClass];s&&p.push(this.options.emptyEditorClass);const g=zt.node(u,u+a.nodeSize,{class:p.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:a,pos:u,hasAnchor:d}):this.options.placeholder});o.push(g)}return this.options.includeChildren}),Ge.create(t,o)}}})]}});Je.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new Ye({key:new Xe("selection"),props:{decorations(n){return n.selection.empty||t.isFocused||!t.isEditable||HC(n.selection)||t.view.dragging?null:Ge.create(n.doc,[zt.inline(n.selection.from,n.selection.to,{class:e.className})])}}})]}});function q1({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||e?.type===t}var e5=Je.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new Xe(this.name),n=this.options.node||((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||"paragraph",i=Object.entries(this.editor.schema.nodes).map(([,o])=>o).filter(o=>(this.options.notAfter||[]).concat(n).includes(o.name));return[new Ye({key:e,appendTransaction:(o,s,a)=>{const{doc:u,tr:d,schema:h}=a,p=e.getState(a),g=u.content.size,x=h.nodes[n];if(p)return d.insert(g,x.create())},state:{init:(o,s)=>{const a=s.tr.doc.lastChild;return!q1({node:a,types:i})},apply:(o,s)=>{if(!o.docChanged||o.getMeta("__uniqueIDTransaction"))return s;const a=o.doc.lastChild;return!q1({node:a,types:i})}}})]}}),t5=Je.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>Rk(t,e),redo:()=>({state:t,dispatch:e})=>Dk(t,e)}},addProseMirrorPlugins(){return[GB(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),n5=Je.create({name:"starterKit",addExtensions(){var t,e,n,i;const o=[];return this.options.bold!==!1&&o.push(T3.configure(this.options.bold)),this.options.blockquote!==!1&&o.push(S3.configure(this.options.blockquote)),this.options.bulletList!==!1&&o.push(gk.configure(this.options.bulletList)),this.options.code!==!1&&o.push(O3.configure(this.options.code)),this.options.codeBlock!==!1&&o.push(N3.configure(this.options.codeBlock)),this.options.document!==!1&&o.push(j3.configure(this.options.document)),this.options.dropcursor!==!1&&o.push(XB.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&o.push(QB.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&o.push(z3.configure(this.options.hardBreak)),this.options.heading!==!1&&o.push(L3.configure(this.options.heading)),this.options.undoRedo!==!1&&o.push(t5.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&o.push(B3.configure(this.options.horizontalRule)),this.options.italic!==!1&&o.push($3.configure(this.options.italic)),this.options.listItem!==!1&&o.push(yk.configure(this.options.listItem)),this.options.listKeymap!==!1&&o.push(Ck.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&o.push(mk.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&o.push(Ek.configure(this.options.orderedList)),this.options.paragraph!==!1&&o.push(EB.configure(this.options.paragraph)),this.options.strike!==!1&&o.push(AB.configure(this.options.strike)),this.options.text!==!1&&o.push(OB.configure(this.options.text)),this.options.underline!==!1&&o.push(Tk.configure((n=this.options)==null?void 0:n.underline)),this.options.trailingNode!==!1&&o.push(e5.configure((i=this.options)==null?void 0:i.trailingNode)),o}}),i5=n5,r5=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,o5=Yt.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{},resize:!1}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null},width:{default:null},height:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:t}){return["img",nt(this.options.HTMLAttributes,t)]},parseMarkdown:(t,e)=>e.createNode("image",{src:t.href,title:t.title,alt:t.text}),renderMarkdown:t=>{var e,n,i,o,s,a;const u=(n=(e=t.attrs)==null?void 0:e.src)!=null?n:"",d=(o=(i=t.attrs)==null?void 0:i.alt)!=null?o:"",h=(a=(s=t.attrs)==null?void 0:s.title)!=null?a:"";return h?`![${d}](${u} "${h}")`:`![${d}](${u})`},addNodeView(){if(!this.options.resize||!this.options.resize.enabled||typeof document>"u")return null;const{directions:t,minWidth:e,minHeight:n,alwaysPreserveAspectRatio:i}=this.options.resize;return({node:o,getPos:s,HTMLAttributes:a,editor:u})=>{const d=document.createElement("img");Object.entries(a).forEach(([g,x])=>{if(x!=null)switch(g){case"width":case"height":break;default:d.setAttribute(g,x);break}}),d.src=a.src;const h=new sL({element:d,editor:u,node:o,getPos:s,onResize:(g,x)=>{d.style.width=`${g}px`,d.style.height=`${x}px`},onCommit:(g,x)=>{const v=s();v!==void 0&&this.editor.chain().setNodeSelection(v).updateAttributes(this.name,{width:g,height:x}).run()},onUpdate:(g,x,v)=>g.type===o.type,options:{directions:t,min:{width:e,height:n},preserveAspectRatio:i===!0}}),p=h.dom;return p.style.visibility="hidden",p.style.pointerEvents="none",d.onload=()=>{p.style.visibility="",p.style.pointerEvents=""},h}},addCommands(){return{setImage:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t})}},addInputRules(){return[nk({find:r5,type:this.type,getAttributes:t=>{const[,,e,n,i]=t;return{src:n,alt:e,title:i}}})]}}),l5=o5,s5=Je.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>{const e=t.style.textAlign;return this.options.alignments.includes(e)?e:this.options.defaultAlignment},renderHTML:t=>t.textAlign?{style:`text-align: ${t.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:t=>({commands:e})=>this.options.alignments.includes(t)?this.options.types.map(n=>e.updateAttributes(n,{textAlign:t})).some(n=>n):!1,unsetTextAlign:()=>({commands:t})=>this.options.types.map(e=>t.resetAttributes(e,"textAlign")).some(e=>e),toggleTextAlign:t=>({editor:e,commands:n})=>this.options.alignments.includes(t)?e.isActive({textAlign:t})?n.unsetTextAlign():n.setTextAlign(t):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),a5=s5,c5=ZB;const Nk=["top","right","bottom","left"],F1=["start","end"],W1=Nk.reduce((t,e)=>t.concat(e,e+"-"+F1[0],e+"-"+F1[1]),[]),Gn=Math.min,jt=Math.max,Ku=Math.round,qn=t=>({x:t,y:t}),u5={left:"right",right:"left",bottom:"top",top:"bottom"},d5={start:"end",end:"start"};function Sm(t,e,n){return jt(t,Gn(e,n))}function zi(t,e){return typeof t=="function"?t(e):t}function En(t){return t.split("-")[0]}function Nn(t){return t.split("-")[1]}function jk(t){return t==="x"?"y":"x"}function Sg(t){return t==="y"?"height":"width"}const f5=new Set(["top","bottom"]);function Vn(t){return f5.has(En(t))?"y":"x"}function wg(t){return jk(Vn(t))}function zk(t,e,n){n===void 0&&(n=!1);const i=Nn(t),o=wg(t),s=Sg(o);let a=o==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(a=Ju(a)),[a,Ju(a)]}function h5(t){const e=Ju(t);return[Xu(t),e,Xu(e)]}function Xu(t){return t.replace(/start|end/g,e=>d5[e])}const Y1=["left","right"],G1=["right","left"],p5=["top","bottom"],m5=["bottom","top"];function g5(t,e,n){switch(t){case"top":case"bottom":return n?e?G1:Y1:e?Y1:G1;case"left":case"right":return e?p5:m5;default:return[]}}function y5(t,e,n,i){const o=Nn(t);let s=g5(En(t),n==="start",i);return o&&(s=s.map(a=>a+"-"+o),e&&(s=s.concat(s.map(Xu)))),s}function Ju(t){return t.replace(/left|right|bottom|top/g,e=>u5[e])}function x5(t){return{top:0,right:0,bottom:0,left:0,...t}}function Cg(t){return typeof t!="number"?x5(t):{top:t,right:t,bottom:t,left:t}}function xl(t){const{x:e,y:n,width:i,height:o}=t;return{width:i,height:o,top:n,left:e,right:e+i,bottom:n+o,x:e,y:n}}function K1(t,e,n){let{reference:i,floating:o}=t;const s=Vn(e),a=wg(e),u=Sg(a),d=En(e),h=s==="y",p=i.x+i.width/2-o.width/2,g=i.y+i.height/2-o.height/2,x=i[u]/2-o[u]/2;let v;switch(d){case"top":v={x:p,y:i.y-o.height};break;case"bottom":v={x:p,y:i.y+i.height};break;case"right":v={x:i.x+i.width,y:g};break;case"left":v={x:i.x-o.width,y:g};break;default:v={x:i.x,y:i.y}}switch(Nn(e)){case"start":v[a]-=x*(n&&h?-1:1);break;case"end":v[a]+=x*(n&&h?-1:1);break}return v}const b5=async(t,e,n)=>{const{placement:i="bottom",strategy:o="absolute",middleware:s=[],platform:a}=n,u=s.filter(Boolean),d=await(a.isRTL==null?void 0:a.isRTL(e));let h=await a.getElementRects({reference:t,floating:e,strategy:o}),{x:p,y:g}=K1(h,i,d),x=i,v={},S=0;for(let k=0;k<u.length;k++){const{name:w,fn:E}=u[k],{x:A,y:D,data:L,reset:T}=await E({x:p,y:g,initialPlacement:i,placement:x,strategy:o,middlewareData:v,rects:h,platform:a,elements:{reference:t,floating:e}});p=A??p,g=D??g,v={...v,[w]:{...v[w],...L}},T&&S<=50&&(S++,typeof T=="object"&&(T.placement&&(x=T.placement),T.rects&&(h=T.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:o}):T.rects),{x:p,y:g}=K1(h,x,d)),k=-1)}return{x:p,y:g,placement:x,strategy:o,middlewareData:v}};async function bl(t,e){var n;e===void 0&&(e={});const{x:i,y:o,platform:s,rects:a,elements:u,strategy:d}=t,{boundary:h="clippingAncestors",rootBoundary:p="viewport",elementContext:g="floating",altBoundary:x=!1,padding:v=0}=zi(e,t),S=Cg(v),w=u[x?g==="floating"?"reference":"floating":g],E=xl(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(w)))==null||n?w:w.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(u.floating)),boundary:h,rootBoundary:p,strategy:d})),A=g==="floating"?{x:i,y:o,width:a.floating.width,height:a.floating.height}:a.reference,D=await(s.getOffsetParent==null?void 0:s.getOffsetParent(u.floating)),L=await(s.isElement==null?void 0:s.isElement(D))?await(s.getScale==null?void 0:s.getScale(D))||{x:1,y:1}:{x:1,y:1},T=xl(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:A,offsetParent:D,strategy:d}):A);return{top:(E.top-T.top+S.top)/L.y,bottom:(T.bottom-E.bottom+S.bottom)/L.y,left:(E.left-T.left+S.left)/L.x,right:(T.right-E.right+S.right)/L.x}}const v5=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:i,placement:o,rects:s,platform:a,elements:u,middlewareData:d}=e,{element:h,padding:p=0}=zi(t,e)||{};if(h==null)return{};const g=Cg(p),x={x:n,y:i},v=wg(o),S=Sg(v),k=await a.getDimensions(h),w=v==="y",E=w?"top":"left",A=w?"bottom":"right",D=w?"clientHeight":"clientWidth",L=s.reference[S]+s.reference[v]-x[v]-s.floating[S],T=x[v]-s.reference[v],z=await(a.getOffsetParent==null?void 0:a.getOffsetParent(h));let N=z?z[D]:0;(!N||!await(a.isElement==null?void 0:a.isElement(z)))&&(N=u.floating[D]||s.floating[S]);const B=L/2-T/2,_=N/2-k[S]/2-1,W=Gn(g[E],_),oe=Gn(g[A],_),re=W,fe=N-k[S]-oe,he=N/2-k[S]/2+B,we=Sm(re,he,fe),q=!d.arrow&&Nn(o)!=null&&he!==we&&s.reference[S]/2-(he<re?W:oe)-k[S]/2<0,ee=q?he<re?he-re:he-fe:0;return{[v]:x[v]+ee,data:{[v]:we,centerOffset:he-we-ee,...q&&{alignmentOffset:ee}},reset:q}}});function S5(t,e,n){return(t?[...n.filter(o=>Nn(o)===t),...n.filter(o=>Nn(o)!==t)]:n.filter(o=>En(o)===o)).filter(o=>t?Nn(o)===t||(e?Xu(o)!==o:!1):!0)}const w5=function(t){return t===void 0&&(t={}),{name:"autoPlacement",options:t,async fn(e){var n,i,o;const{rects:s,middlewareData:a,placement:u,platform:d,elements:h}=e,{crossAxis:p=!1,alignment:g,allowedPlacements:x=W1,autoAlignment:v=!0,...S}=zi(t,e),k=g!==void 0||x===W1?S5(g||null,v,x):x,w=await bl(e,S),E=((n=a.autoPlacement)==null?void 0:n.index)||0,A=k[E];if(A==null)return{};const D=zk(A,s,await(d.isRTL==null?void 0:d.isRTL(h.floating)));if(u!==A)return{reset:{placement:k[0]}};const L=[w[En(A)],w[D[0]],w[D[1]]],T=[...((i=a.autoPlacement)==null?void 0:i.overflows)||[],{placement:A,overflows:L}],z=k[E+1];if(z)return{data:{index:E+1,overflows:T},reset:{placement:z}};const N=T.map(W=>{const oe=Nn(W.placement);return[W.placement,oe&&p?W.overflows.slice(0,2).reduce((re,fe)=>re+fe,0):W.overflows[0],W.overflows]}).sort((W,oe)=>W[1]-oe[1]),_=((o=N.filter(W=>W[2].slice(0,Nn(W[0])?2:3).every(oe=>oe<=0))[0])==null?void 0:o[0])||N[0][0];return _!==u?{data:{index:E+1,overflows:T},reset:{placement:_}}:{}}}},C5=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,i;const{placement:o,middlewareData:s,rects:a,initialPlacement:u,platform:d,elements:h}=e,{mainAxis:p=!0,crossAxis:g=!0,fallbackPlacements:x,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:S="none",flipAlignment:k=!0,...w}=zi(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const E=En(o),A=Vn(u),D=En(u)===u,L=await(d.isRTL==null?void 0:d.isRTL(h.floating)),T=x||(D||!k?[Ju(u)]:h5(u)),z=S!=="none";!x&&z&&T.push(...y5(u,k,S,L));const N=[u,...T],B=await bl(e,w),_=[];let W=((i=s.flip)==null?void 0:i.overflows)||[];if(p&&_.push(B[E]),g){const he=zk(o,a,L);_.push(B[he[0]],B[he[1]])}if(W=[...W,{placement:o,overflows:_}],!_.every(he=>he<=0)){var oe,re;const he=(((oe=s.flip)==null?void 0:oe.index)||0)+1,we=N[he];if(we&&(!(g==="alignment"?A!==Vn(we):!1)||W.every(ce=>Vn(ce.placement)===A?ce.overflows[0]>0:!0)))return{data:{index:he,overflows:W},reset:{placement:we}};let q=(re=W.filter(ee=>ee.overflows[0]<=0).sort((ee,ce)=>ee.overflows[1]-ce.overflows[1])[0])==null?void 0:re.placement;if(!q)switch(v){case"bestFit":{var fe;const ee=(fe=W.filter(ce=>{if(z){const te=Vn(ce.placement);return te===A||te==="y"}return!0}).map(ce=>[ce.placement,ce.overflows.filter(te=>te>0).reduce((te,pe)=>te+pe,0)]).sort((ce,te)=>ce[1]-te[1])[0])==null?void 0:fe[0];ee&&(q=ee);break}case"initialPlacement":q=u;break}if(o!==q)return{reset:{placement:q}}}return{}}}};function X1(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function J1(t){return Nk.some(e=>t[e]>=0)}const k5=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:i="referenceHidden",...o}=zi(t,e);switch(i){case"referenceHidden":{const s=await bl(e,{...o,elementContext:"reference"}),a=X1(s,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:J1(a)}}}case"escaped":{const s=await bl(e,{...o,altBoundary:!0}),a=X1(s,n.floating);return{data:{escapedOffsets:a,escaped:J1(a)}}}default:return{}}}}};function Lk(t){const e=Gn(...t.map(s=>s.left)),n=Gn(...t.map(s=>s.top)),i=jt(...t.map(s=>s.right)),o=jt(...t.map(s=>s.bottom));return{x:e,y:n,width:i-e,height:o-n}}function E5(t){const e=t.slice().sort((o,s)=>o.y-s.y),n=[];let i=null;for(let o=0;o<e.length;o++){const s=e[o];!i||s.y-i.y>i.height/2?n.push([s]):n[n.length-1].push(s),i=s}return n.map(o=>xl(Lk(o)))}const T5=function(t){return t===void 0&&(t={}),{name:"inline",options:t,async fn(e){const{placement:n,elements:i,rects:o,platform:s,strategy:a}=e,{padding:u=2,x:d,y:h}=zi(t,e),p=Array.from(await(s.getClientRects==null?void 0:s.getClientRects(i.reference))||[]),g=E5(p),x=xl(Lk(p)),v=Cg(u);function S(){if(g.length===2&&g[0].left>g[1].right&&d!=null&&h!=null)return g.find(w=>d>w.left-v.left&&d<w.right+v.right&&h>w.top-v.top&&h<w.bottom+v.bottom)||x;if(g.length>=2){if(Vn(n)==="y"){const W=g[0],oe=g[g.length-1],re=En(n)==="top",fe=W.top,he=oe.bottom,we=re?W.left:oe.left,q=re?W.right:oe.right,ee=q-we,ce=he-fe;return{top:fe,bottom:he,left:we,right:q,width:ee,height:ce,x:we,y:fe}}const w=En(n)==="left",E=jt(...g.map(W=>W.right)),A=Gn(...g.map(W=>W.left)),D=g.filter(W=>w?W.left===A:W.right===E),L=D[0].top,T=D[D.length-1].bottom,z=A,N=E,B=N-z,_=T-L;return{top:L,bottom:T,left:z,right:N,width:B,height:_,x:z,y:L}}return x}const k=await s.getElementRects({reference:{getBoundingClientRect:S},floating:i.floating,strategy:a});return o.reference.x!==k.reference.x||o.reference.y!==k.reference.y||o.reference.width!==k.reference.width||o.reference.height!==k.reference.height?{reset:{rects:k}}:{}}}},M5=new Set(["left","top"]);async function A5(t,e){const{placement:n,platform:i,elements:o}=t,s=await(i.isRTL==null?void 0:i.isRTL(o.floating)),a=En(n),u=Nn(n),d=Vn(n)==="y",h=M5.has(a)?-1:1,p=s&&d?-1:1,g=zi(e,t);let{mainAxis:x,crossAxis:v,alignmentAxis:S}=typeof g=="number"?{mainAxis:g,crossAxis:0,alignmentAxis:null}:{mainAxis:g.mainAxis||0,crossAxis:g.crossAxis||0,alignmentAxis:g.alignmentAxis};return u&&typeof S=="number"&&(v=u==="end"?S*-1:S),d?{x:v*p,y:x*h}:{x:x*h,y:v*p}}const O5=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,i;const{x:o,y:s,placement:a,middlewareData:u}=e,d=await A5(e,t);return a===((n=u.offset)==null?void 0:n.placement)&&(i=u.arrow)!=null&&i.alignmentOffset?{}:{x:o+d.x,y:s+d.y,data:{...d,placement:a}}}}},R5=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:o}=e,{mainAxis:s=!0,crossAxis:a=!1,limiter:u={fn:w=>{let{x:E,y:A}=w;return{x:E,y:A}}},...d}=zi(t,e),h={x:n,y:i},p=await bl(e,d),g=Vn(En(o)),x=jk(g);let v=h[x],S=h[g];if(s){const w=x==="y"?"top":"left",E=x==="y"?"bottom":"right",A=v+p[w],D=v-p[E];v=Sm(A,v,D)}if(a){const w=g==="y"?"top":"left",E=g==="y"?"bottom":"right",A=S+p[w],D=S-p[E];S=Sm(A,S,D)}const k=u.fn({...e,[x]:v,[g]:S});return{...k,data:{x:k.x-n,y:k.y-i,enabled:{[x]:s,[g]:a}}}}}},D5=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,i;const{placement:o,rects:s,platform:a,elements:u}=e,{apply:d=()=>{},...h}=zi(t,e),p=await bl(e,h),g=En(o),x=Nn(o),v=Vn(o)==="y",{width:S,height:k}=s.floating;let w,E;g==="top"||g==="bottom"?(w=g,E=x===(await(a.isRTL==null?void 0:a.isRTL(u.floating))?"start":"end")?"left":"right"):(E=g,w=x==="end"?"top":"bottom");const A=k-p.top-p.bottom,D=S-p.left-p.right,L=Gn(k-p[w],A),T=Gn(S-p[E],D),z=!e.middlewareData.shift;let N=L,B=T;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(B=D),(i=e.middlewareData.shift)!=null&&i.enabled.y&&(N=A),z&&!x){const W=jt(p.left,0),oe=jt(p.right,0),re=jt(p.top,0),fe=jt(p.bottom,0);v?B=S-2*(W!==0||oe!==0?W+oe:jt(p.left,p.right)):N=k-2*(re!==0||fe!==0?re+fe:jt(p.top,p.bottom))}await d({...e,availableWidth:B,availableHeight:N});const _=await a.getDimensions(u.floating);return S!==_.width||k!==_.height?{reset:{rects:!0}}:{}}}};function gd(){return typeof window<"u"}function Cl(t){return Bk(t)?(t.nodeName||"").toLowerCase():"#document"}function sn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Li(t){var e;return(e=(Bk(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Bk(t){return gd()?t instanceof Node||t instanceof sn(t).Node:!1}function jn(t){return gd()?t instanceof Element||t instanceof sn(t).Element:!1}function Kn(t){return gd()?t instanceof HTMLElement||t instanceof sn(t).HTMLElement:!1}function Q1(t){return!gd()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof sn(t).ShadowRoot}const N5=new Set(["inline","contents"]);function ca(t){const{overflow:e,overflowX:n,overflowY:i,display:o}=zn(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!N5.has(o)}const j5=new Set(["table","td","th"]);function z5(t){return j5.has(Cl(t))}const L5=[":popover-open",":modal"];function yd(t){return L5.some(e=>{try{return t.matches(e)}catch{return!1}})}const B5=["transform","translate","scale","rotate","perspective"],I5=["transform","translate","scale","rotate","perspective","filter"],_5=["paint","layout","strict","content"];function kg(t){const e=Eg(),n=jn(t)?zn(t):t;return B5.some(i=>n[i]?n[i]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||I5.some(i=>(n.willChange||"").includes(i))||_5.some(i=>(n.contain||"").includes(i))}function H5(t){let e=kr(t);for(;Kn(e)&&!vl(e);){if(kg(e))return e;if(yd(e))return null;e=kr(e)}return null}function Eg(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const U5=new Set(["html","body","#document"]);function vl(t){return U5.has(Cl(t))}function zn(t){return sn(t).getComputedStyle(t)}function xd(t){return jn(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function kr(t){if(Cl(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Q1(t)&&t.host||Li(t);return Q1(e)?e.host:e}function Ik(t){const e=kr(t);return vl(e)?t.ownerDocument?t.ownerDocument.body:t.body:Kn(e)&&ca(e)?e:Ik(e)}function _k(t,e,n){var i;e===void 0&&(e=[]);const o=Ik(t),s=o===((i=t.ownerDocument)==null?void 0:i.body),a=sn(o);return s?(wm(a),e.concat(a,a.visualViewport||[],ca(o)?o:[],[])):e.concat(o,_k(o,[]))}function wm(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Hk(t){const e=zn(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const o=Kn(t),s=o?t.offsetWidth:n,a=o?t.offsetHeight:i,u=Ku(n)!==s||Ku(i)!==a;return u&&(n=s,i=a),{width:n,height:i,$:u}}function Uk(t){return jn(t)?t:t.contextElement}function ul(t){const e=Uk(t);if(!Kn(e))return qn(1);const n=e.getBoundingClientRect(),{width:i,height:o,$:s}=Hk(e);let a=(s?Ku(n.width):n.width)/i,u=(s?Ku(n.height):n.height)/o;return(!a||!Number.isFinite(a))&&(a=1),(!u||!Number.isFinite(u))&&(u=1),{x:a,y:u}}const $5=qn(0);function $k(t){const e=sn(t);return!Eg()||!e.visualViewport?$5:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function P5(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==sn(t)?!1:e}function ea(t,e,n,i){e===void 0&&(e=!1),n===void 0&&(n=!1);const o=t.getBoundingClientRect(),s=Uk(t);let a=qn(1);e&&(i?jn(i)&&(a=ul(i)):a=ul(t));const u=P5(s,n,i)?$k(s):qn(0);let d=(o.left+u.x)/a.x,h=(o.top+u.y)/a.y,p=o.width/a.x,g=o.height/a.y;if(s){const x=sn(s),v=i&&jn(i)?sn(i):i;let S=x,k=wm(S);for(;k&&i&&v!==S;){const w=ul(k),E=k.getBoundingClientRect(),A=zn(k),D=E.left+(k.clientLeft+parseFloat(A.paddingLeft))*w.x,L=E.top+(k.clientTop+parseFloat(A.paddingTop))*w.y;d*=w.x,h*=w.y,p*=w.x,g*=w.y,d+=D,h+=L,S=sn(k),k=wm(S)}}return xl({width:p,height:g,x:d,y:h})}function bd(t,e){const n=xd(t).scrollLeft;return e?e.left+n:ea(Li(t)).left+n}function Pk(t,e){const n=t.getBoundingClientRect(),i=n.left+e.scrollLeft-bd(t,n),o=n.top+e.scrollTop;return{x:i,y:o}}function V5(t){let{elements:e,rect:n,offsetParent:i,strategy:o}=t;const s=o==="fixed",a=Li(i),u=e?yd(e.floating):!1;if(i===a||u&&s)return n;let d={scrollLeft:0,scrollTop:0},h=qn(1);const p=qn(0),g=Kn(i);if((g||!g&&!s)&&((Cl(i)!=="body"||ca(a))&&(d=xd(i)),Kn(i))){const v=ea(i);h=ul(i),p.x=v.x+i.clientLeft,p.y=v.y+i.clientTop}const x=a&&!g&&!s?Pk(a,d):qn(0);return{width:n.width*h.x,height:n.height*h.y,x:n.x*h.x-d.scrollLeft*h.x+p.x+x.x,y:n.y*h.y-d.scrollTop*h.y+p.y+x.y}}function q5(t){return Array.from(t.getClientRects())}function F5(t){const e=Li(t),n=xd(t),i=t.ownerDocument.body,o=jt(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),s=jt(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let a=-n.scrollLeft+bd(t);const u=-n.scrollTop;return zn(i).direction==="rtl"&&(a+=jt(e.clientWidth,i.clientWidth)-o),{width:o,height:s,x:a,y:u}}const Z1=25;function W5(t,e){const n=sn(t),i=Li(t),o=n.visualViewport;let s=i.clientWidth,a=i.clientHeight,u=0,d=0;if(o){s=o.width,a=o.height;const p=Eg();(!p||p&&e==="fixed")&&(u=o.offsetLeft,d=o.offsetTop)}const h=bd(i);if(h<=0){const p=i.ownerDocument,g=p.body,x=getComputedStyle(g),v=p.compatMode==="CSS1Compat"&&parseFloat(x.marginLeft)+parseFloat(x.marginRight)||0,S=Math.abs(i.clientWidth-g.clientWidth-v);S<=Z1&&(s-=S)}else h<=Z1&&(s+=h);return{width:s,height:a,x:u,y:d}}const Y5=new Set(["absolute","fixed"]);function G5(t,e){const n=ea(t,!0,e==="fixed"),i=n.top+t.clientTop,o=n.left+t.clientLeft,s=Kn(t)?ul(t):qn(1),a=t.clientWidth*s.x,u=t.clientHeight*s.y,d=o*s.x,h=i*s.y;return{width:a,height:u,x:d,y:h}}function eS(t,e,n){let i;if(e==="viewport")i=W5(t,n);else if(e==="document")i=F5(Li(t));else if(jn(e))i=G5(e,n);else{const o=$k(t);i={x:e.x-o.x,y:e.y-o.y,width:e.width,height:e.height}}return xl(i)}function Vk(t,e){const n=kr(t);return n===e||!jn(n)||vl(n)?!1:zn(n).position==="fixed"||Vk(n,e)}function K5(t,e){const n=e.get(t);if(n)return n;let i=_k(t,[]).filter(u=>jn(u)&&Cl(u)!=="body"),o=null;const s=zn(t).position==="fixed";let a=s?kr(t):t;for(;jn(a)&&!vl(a);){const u=zn(a),d=kg(a);!d&&u.position==="fixed"&&(o=null),(s?!d&&!o:!d&&u.position==="static"&&!!o&&Y5.has(o.position)||ca(a)&&!d&&Vk(t,a))?i=i.filter(p=>p!==a):o=u,a=kr(a)}return e.set(t,i),i}function X5(t){let{element:e,boundary:n,rootBoundary:i,strategy:o}=t;const a=[...n==="clippingAncestors"?yd(e)?[]:K5(e,this._c):[].concat(n),i],u=a[0],d=a.reduce((h,p)=>{const g=eS(e,p,o);return h.top=jt(g.top,h.top),h.right=Gn(g.right,h.right),h.bottom=Gn(g.bottom,h.bottom),h.left=jt(g.left,h.left),h},eS(e,u,o));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function J5(t){const{width:e,height:n}=Hk(t);return{width:e,height:n}}function Q5(t,e,n){const i=Kn(e),o=Li(e),s=n==="fixed",a=ea(t,!0,s,e);let u={scrollLeft:0,scrollTop:0};const d=qn(0);function h(){d.x=bd(o)}if(i||!i&&!s)if((Cl(e)!=="body"||ca(o))&&(u=xd(e)),i){const v=ea(e,!0,s,e);d.x=v.x+e.clientLeft,d.y=v.y+e.clientTop}else o&&h();s&&!i&&o&&h();const p=o&&!i&&!s?Pk(o,u):qn(0),g=a.left+u.scrollLeft-d.x-p.x,x=a.top+u.scrollTop-d.y-p.y;return{x:g,y:x,width:a.width,height:a.height}}function Ap(t){return zn(t).position==="static"}function tS(t,e){if(!Kn(t)||zn(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Li(t)===n&&(n=n.ownerDocument.body),n}function qk(t,e){const n=sn(t);if(yd(t))return n;if(!Kn(t)){let o=kr(t);for(;o&&!vl(o);){if(jn(o)&&!Ap(o))return o;o=kr(o)}return n}let i=tS(t,e);for(;i&&z5(i)&&Ap(i);)i=tS(i,e);return i&&vl(i)&&Ap(i)&&!kg(i)?n:i||H5(t)||n}const Z5=async function(t){const e=this.getOffsetParent||qk,n=this.getDimensions,i=await n(t.floating);return{reference:Q5(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function e4(t){return zn(t).direction==="rtl"}const t4={convertOffsetParentRelativeRectToViewportRelativeRect:V5,getDocumentElement:Li,getClippingRect:X5,getOffsetParent:qk,getElementRects:Z5,getClientRects:q5,getDimensions:J5,getScale:ul,isElement:jn,isRTL:e4},n4=O5,i4=w5,r4=R5,o4=C5,l4=D5,s4=k5,a4=v5,c4=T5,u4=(t,e,n)=>{const i=new Map,o={platform:t4,...n},s={...o.platform,_c:i};return b5(t,e,{...o,platform:s})};let Cm,km;if(typeof WeakMap<"u"){let t=new WeakMap;Cm=e=>t.get(e),km=(e,n)=>(t.set(e,n),n)}else{const t=[];let n=0;Cm=i=>{for(let o=0;o<t.length;o+=2)if(t[o]==i)return t[o+1]},km=(i,o)=>(n==10&&(n=0),t[n++]=i,t[n++]=o)}var ki=class{constructor(t,e,n,i){this.width=t,this.height=e,this.map=n,this.problems=i}findCell(t){for(let e=0;e<this.map.length;e++){const n=this.map[e];if(n!=t)continue;const i=e%this.width,o=e/this.width|0;let s=i+1,a=o+1;for(let u=1;s<this.width&&this.map[e+u]==n;u++)s++;for(let u=1;a<this.height&&this.map[e+this.width*u]==n;u++)a++;return{left:i,top:o,right:s,bottom:a}}throw new RangeError(`No cell with offset ${t} found`)}colCount(t){for(let e=0;e<this.map.length;e++)if(this.map[e]==t)return e%this.width;throw new RangeError(`No cell with offset ${t} found`)}nextCell(t,e,n){const{left:i,right:o,top:s,bottom:a}=this.findCell(t);return e=="horiz"?(n<0?i==0:o==this.width)?null:this.map[s*this.width+(n<0?i-1:o)]:(n<0?s==0:a==this.height)?null:this.map[i+this.width*(n<0?s-1:a)]}rectBetween(t,e){const{left:n,right:i,top:o,bottom:s}=this.findCell(t),{left:a,right:u,top:d,bottom:h}=this.findCell(e);return{left:Math.min(n,a),top:Math.min(o,d),right:Math.max(i,u),bottom:Math.max(s,h)}}cellsInRect(t){const e=[],n={};for(let i=t.top;i<t.bottom;i++)for(let o=t.left;o<t.right;o++){const s=i*this.width+o,a=this.map[s];n[a]||(n[a]=!0,!(o==t.left&&o&&this.map[s-1]==a||i==t.top&&i&&this.map[s-this.width]==a)&&e.push(a))}return e}positionAt(t,e,n){for(let i=0,o=0;;i++){const s=o+n.child(i).nodeSize;if(i==t){let a=e+t*this.width;const u=(t+1)*this.width;for(;a<u&&this.map[a]<o;)a++;return a==u?s-1:this.map[a]}o=s}}static get(t){return Cm(t)||km(t,d4(t))}};function d4(t){if(t.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+t.type.name);const e=f4(t),n=t.childCount,i=[];let o=0,s=null;const a=[];for(let h=0,p=e*n;h<p;h++)i[h]=0;for(let h=0,p=0;h<n;h++){const g=t.child(h);p++;for(let S=0;;S++){for(;o<i.length&&i[o]!=0;)o++;if(S==g.childCount)break;const k=g.child(S),{colspan:w,rowspan:E,colwidth:A}=k.attrs;for(let D=0;D<E;D++){if(D+h>=n){(s||(s=[])).push({type:"overlong_rowspan",pos:p,n:E-D});break}const L=o+D*e;for(let T=0;T<w;T++){i[L+T]==0?i[L+T]=p:(s||(s=[])).push({type:"collision",row:h,pos:p,n:w-T});const z=A&&A[T];if(z){const N=(L+T)%e*2,B=a[N];B==null||B!=z&&a[N+1]==1?(a[N]=z,a[N+1]=1):B==z&&a[N+1]++}}}o+=w,p+=k.nodeSize}const x=(h+1)*e;let v=0;for(;o<x;)i[o++]==0&&v++;v&&(s||(s=[])).push({type:"missing",row:h,n:v}),p++}(e===0||n===0)&&(s||(s=[])).push({type:"zero_sized"});const u=new ki(e,n,i,s);let d=!1;for(let h=0;!d&&h<a.length;h+=2)a[h]!=null&&a[h+1]<n&&(d=!0);return d&&h4(u,a,t),u}function f4(t){let e=-1,n=!1;for(let i=0;i<t.childCount;i++){const o=t.child(i);let s=0;if(n)for(let a=0;a<i;a++){const u=t.child(a);for(let d=0;d<u.childCount;d++){const h=u.child(d);a+h.attrs.rowspan>i&&(s+=h.attrs.colspan)}}for(let a=0;a<o.childCount;a++){const u=o.child(a);s+=u.attrs.colspan,u.attrs.rowspan>1&&(n=!0)}e==-1?e=s:e!=s&&(e=Math.max(e,s))}return e}function h4(t,e,n){t.problems||(t.problems=[]);const i={};for(let o=0;o<t.map.length;o++){const s=t.map[o];if(i[s])continue;i[s]=!0;const a=n.nodeAt(s);if(!a)throw new RangeError(`No cell with offset ${s} found`);let u=null;const d=a.attrs;for(let h=0;h<d.colspan;h++){const p=e[(o+h)%t.width*2];p!=null&&(!d.colwidth||d.colwidth[h]!=p)&&((u||(u=p4(d)))[h]=p)}u&&t.problems.unshift({type:"colwidth mismatch",pos:s,colwidth:u})}}function p4(t){if(t.colwidth)return t.colwidth.slice();const e=[];for(let n=0;n<t.colspan;n++)e.push(0);return e}function Tg(t){let e=t.cached.tableNodeTypes;if(!e){e=t.cached.tableNodeTypes={};for(const n in t.nodes){const i=t.nodes[n],o=i.spec.tableRole;o&&(e[o]=i)}}return e}new Xe("selectingCells");function m4(t){for(let e=t.depth-1;e>0;e--)if(t.node(e).type.spec.tableRole=="row")return t.node(0).resolve(t.before(e+1));return null}function Fk(t){const e=t.selection.$head;for(let n=e.depth;n>0;n--)if(e.node(n).type.spec.tableRole=="row")return!0;return!1}function g4(t){const e=t.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const n=m4(e.$head)||y4(e.$head);if(n)return n;throw new RangeError(`No cell found around position ${e.head}`)}function y4(t){for(let e=t.nodeAfter,n=t.pos;e;e=e.firstChild,n++){const i=e.type.spec.tableRole;if(i=="cell"||i=="header_cell")return t.doc.resolve(n)}for(let e=t.nodeBefore,n=t.pos;e;e=e.lastChild,n--){const i=e.type.spec.tableRole;if(i=="cell"||i=="header_cell")return t.doc.resolve(n-e.nodeSize)}}function nS(t){return t.parent.type.spec.tableRole=="row"&&!!t.nodeAfter}function Wk(t,e){return t.depth==e.depth&&t.pos>=e.start(-1)&&t.pos<=e.end(-1)}function Yk(t,e,n){const i=t.node(-1),o=ki.get(i),s=t.start(-1),a=o.nextCell(t.pos-s,e,n);return a==null?null:t.node(0).resolve(s+a)}function iS(t,e,n=1){const i={...t,colspan:t.colspan-n};return i.colwidth&&(i.colwidth=i.colwidth.slice(),i.colwidth.splice(e,n),i.colwidth.some(o=>o>0)||(i.colwidth=null)),i}var Fn=class wi extends ve{constructor(e,n=e){const i=e.node(-1),o=ki.get(i),s=e.start(-1),a=o.rectBetween(e.pos-s,n.pos-s),u=e.node(0),d=o.cellsInRect(a).filter(p=>p!=n.pos-s);d.unshift(n.pos-s);const h=d.map(p=>{const g=i.nodeAt(p);if(!g)throw new RangeError(`No cell with offset ${p} found`);const x=s+p+1;return new Ow(u.resolve(x),u.resolve(x+g.content.size))});super(h[0].$from,h[0].$to,h),this.$anchorCell=e,this.$headCell=n}map(e,n){const i=e.resolve(n.map(this.$anchorCell.pos)),o=e.resolve(n.map(this.$headCell.pos));if(nS(i)&&nS(o)&&Wk(i,o)){const s=this.$anchorCell.node(-1)!=i.node(-1);return s&&this.isRowSelection()?wi.rowSelection(i,o):s&&this.isColSelection()?wi.colSelection(i,o):new wi(i,o)}return Se.between(i,o)}content(){const e=this.$anchorCell.node(-1),n=ki.get(e),i=this.$anchorCell.start(-1),o=n.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i),s={},a=[];for(let d=o.top;d<o.bottom;d++){const h=[];for(let p=d*n.width+o.left,g=o.left;g<o.right;g++,p++){const x=n.map[p];if(s[x])continue;s[x]=!0;const v=n.findCell(x);let S=e.nodeAt(x);if(!S)throw new RangeError(`No cell with offset ${x} found`);const k=o.left-v.left,w=v.right-o.right;if(k>0||w>0){let E=S.attrs;if(k>0&&(E=iS(E,0,k)),w>0&&(E=iS(E,E.colspan-w,w)),v.left<o.left){if(S=S.type.createAndFill(E),!S)throw new RangeError(`Could not create cell with attrs ${JSON.stringify(E)}`)}else S=S.type.create(E,S.content)}if(v.top<o.top||v.bottom>o.bottom){const E={...S.attrs,rowspan:Math.min(v.bottom,o.bottom)-Math.max(v.top,o.top)};v.top<o.top?S=S.type.createAndFill(E):S=S.type.create(E,S.content)}h.push(S)}a.push(e.child(d).copy(Q.from(h)))}const u=this.isColSelection()&&this.isRowSelection()?e:a;return new se(Q.from(u),1,1)}replace(e,n=se.empty){const i=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){const{$from:u,$to:d}=o[a],h=e.mapping.slice(i);e.replace(h.map(u.pos),h.map(d.pos),a?se.empty:n)}const s=ve.findFrom(e.doc.resolve(e.mapping.slice(i).map(this.to)),-1);s&&e.setSelection(s)}replaceWith(e,n){this.replace(e,new se(Q.from(n),0,0))}forEachCell(e){const n=this.$anchorCell.node(-1),i=ki.get(n),o=this.$anchorCell.start(-1),s=i.cellsInRect(i.rectBetween(this.$anchorCell.pos-o,this.$headCell.pos-o));for(let a=0;a<s.length;a++)e(n.nodeAt(s[a]),o+s[a])}isColSelection(){const e=this.$anchorCell.index(-1),n=this.$headCell.index(-1);if(Math.min(e,n)>0)return!1;const i=e+this.$anchorCell.nodeAfter.attrs.rowspan,o=n+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(i,o)==this.$headCell.node(-1).childCount}static colSelection(e,n=e){const i=e.node(-1),o=ki.get(i),s=e.start(-1),a=o.findCell(e.pos-s),u=o.findCell(n.pos-s),d=e.node(0);return a.top<=u.top?(a.top>0&&(e=d.resolve(s+o.map[a.left])),u.bottom<o.height&&(n=d.resolve(s+o.map[o.width*(o.height-1)+u.right-1]))):(u.top>0&&(n=d.resolve(s+o.map[u.left])),a.bottom<o.height&&(e=d.resolve(s+o.map[o.width*(o.height-1)+a.right-1]))),new wi(e,n)}isRowSelection(){const e=this.$anchorCell.node(-1),n=ki.get(e),i=this.$anchorCell.start(-1),o=n.colCount(this.$anchorCell.pos-i),s=n.colCount(this.$headCell.pos-i);if(Math.min(o,s)>0)return!1;const a=o+this.$anchorCell.nodeAfter.attrs.colspan,u=s+this.$headCell.nodeAfter.attrs.colspan;return Math.max(a,u)==n.width}eq(e){return e instanceof wi&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,n=e){const i=e.node(-1),o=ki.get(i),s=e.start(-1),a=o.findCell(e.pos-s),u=o.findCell(n.pos-s),d=e.node(0);return a.left<=u.left?(a.left>0&&(e=d.resolve(s+o.map[a.top*o.width])),u.right<o.width&&(n=d.resolve(s+o.map[o.width*(u.top+1)-1]))):(u.left>0&&(n=d.resolve(s+o.map[u.top*o.width])),a.right<o.width&&(e=d.resolve(s+o.map[o.width*(a.top+1)-1]))),new wi(e,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,n){return new wi(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,i=n){return new wi(e.resolve(n),e.resolve(i))}getBookmark(){return new x4(this.$anchorCell.pos,this.$headCell.pos)}};Fn.prototype.visible=!1;ve.jsonID("cell",Fn);var x4=class Gk{constructor(e,n){this.anchor=e,this.head=n}map(e){return new Gk(e.map(this.anchor),e.map(this.head))}resolve(e){const n=e.resolve(this.anchor),i=e.resolve(this.head);return n.parent.type.spec.tableRole=="row"&&i.parent.type.spec.tableRole=="row"&&n.index()<n.parent.childCount&&i.index()<i.parent.childCount&&Wk(n,i)?new Fn(n,i):ve.near(i,1)}};new Xe("fix-tables");function Kk(t){const e=t.selection,n=g4(t),i=n.node(-1),o=n.start(-1),s=ki.get(i);return{...e instanceof Fn?s.rectBetween(e.$anchorCell.pos-o,e.$headCell.pos-o):s.findCell(n.pos-o),tableStart:o,map:s,table:i}}function b4(t){return function(e,n){if(!Fk(e))return!1;if(n){const i=Tg(e.schema),o=Kk(e),s=e.tr,a=o.map.cellsInRect(t=="column"?{left:o.left,top:0,right:o.right,bottom:o.map.height}:t=="row"?{left:0,top:o.top,right:o.map.width,bottom:o.bottom}:o),u=a.map(d=>o.table.nodeAt(d));for(let d=0;d<a.length;d++)u[d].type==i.header_cell&&s.setNodeMarkup(o.tableStart+a[d],i.cell,u[d].attrs);if(s.steps.length===0)for(let d=0;d<a.length;d++)s.setNodeMarkup(o.tableStart+a[d],i.header_cell,u[d].attrs);n(s)}return!0}}function rS(t,e,n){const i=e.map.cellsInRect({left:0,top:0,right:t=="row"?e.map.width:1,bottom:t=="column"?e.map.height:1});for(let o=0;o<i.length;o++){const s=e.table.nodeAt(i[o]);if(s&&s.type!==n.header_cell)return!1}return!0}function Mg(t,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?b4(t):function(n,i){if(!Fk(n))return!1;if(i){const o=Tg(n.schema),s=Kk(n),a=n.tr,u=rS("row",s,o),d=rS("column",s,o),h=(t==="column"?u:t==="row"&&d)?1:0,p=t=="column"?{left:0,top:h,right:1,bottom:s.map.height}:t=="row"?{left:h,top:0,right:s.map.width,bottom:1}:s,g=t=="column"?d?o.cell:o.header_cell:t=="row"?u?o.cell:o.header_cell:o.cell;s.map.cellsInRect(p).forEach(x=>{const v=x+s.tableStart,S=a.doc.nodeAt(v);S&&a.setNodeMarkup(v,g,S.attrs)}),i(a)}return!0}}Mg("row",{useDeprecatedLogic:!0});Mg("column",{useDeprecatedLogic:!0});Mg("cell",{useDeprecatedLogic:!0});function Pc(t,e){const n=t.selection;if(!(n instanceof Fn))return!1;if(e){const i=t.tr,o=Tg(t.schema).cell.createAndFill().content;n.forEachCell((s,a)=>{s.content.eq(o)||i.replace(i.mapping.map(a+1),i.mapping.map(a+s.nodeSize-1),new se(o,0,0))}),i.docChanged&&e(i)}return!0}Xm({ArrowLeft:Vc("horiz",-1),ArrowRight:Vc("horiz",1),ArrowUp:Vc("vert",-1),ArrowDown:Vc("vert",1),"Shift-ArrowLeft":qc("horiz",-1),"Shift-ArrowRight":qc("horiz",1),"Shift-ArrowUp":qc("vert",-1),"Shift-ArrowDown":qc("vert",1),Backspace:Pc,"Mod-Backspace":Pc,Delete:Pc,"Mod-Delete":Pc});function iu(t,e,n){return n.eq(t.selection)?!1:(e&&e(t.tr.setSelection(n).scrollIntoView()),!0)}function Vc(t,e){return(n,i,o)=>{if(!o)return!1;const s=n.selection;if(s instanceof Fn)return iu(n,i,ve.near(s.$headCell,e));if(t!="horiz"&&!s.empty)return!1;const a=Xk(o,t,e);if(a==null)return!1;if(t=="horiz")return iu(n,i,ve.near(n.doc.resolve(s.head+e),e));{const u=n.doc.resolve(a),d=Yk(u,t,e);let h;return d?h=ve.near(d,1):e<0?h=ve.near(n.doc.resolve(u.before(-1)),-1):h=ve.near(n.doc.resolve(u.after(-1)),1),iu(n,i,h)}}}function qc(t,e){return(n,i,o)=>{if(!o)return!1;const s=n.selection;let a;if(s instanceof Fn)a=s;else{const d=Xk(o,t,e);if(d==null)return!1;a=new Fn(n.doc.resolve(d))}const u=Yk(a.$headCell,t,e);return u?iu(n,i,new Fn(a.$anchorCell,u)):!1}}function Xk(t,e,n){if(!(t.state.selection instanceof Se))return null;const{$head:i}=t.state.selection;for(let o=i.depth-1;o>=0;o--){const s=i.node(o);if((n<0?i.index(o):i.indexAfter(o))!=(n<0?0:s.childCount))return null;if(s.type.spec.tableRole=="cell"||s.type.spec.tableRole=="header_cell"){const a=i.before(o),u=e=="vert"?n>0?"down":"up":n>0?"right":"left";return t.endOfTextblock(u)?a:null}}return null}new Xe("tableColumnResizing");function v4(t,e){const n=Math.min(t.top,e.top),i=Math.max(t.bottom,e.bottom),o=Math.min(t.left,e.left),a=Math.max(t.right,e.right)-o,u=i-n,d=o,h=n;return new DOMRect(d,h,a,u)}var S4=class{constructor({editor:t,element:e,view:n,updateDelay:i=250,resizeDelay:o=60,shouldShow:s,appendTo:a,getReferencedVirtualElement:u,options:d}){this.preventHide=!1,this.isVisible=!1,this.scrollTarget=window,this.floatingUIOptions={strategy:"absolute",placement:"top",offset:8,flip:{},shift:{},arrow:!1,size:!1,autoPlacement:!1,hide:!1,inline:!1,onShow:void 0,onHide:void 0,onUpdate:void 0,onDestroy:void 0},this.shouldShow=({view:p,state:g,from:x,to:v})=>{const{doc:S,selection:k}=g,{empty:w}=k,E=!S.textBetween(x,v).length&&eg(g.selection),A=this.element.contains(document.activeElement);return!(!(p.hasFocus()||A)||w||E||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.resizeHandler=()=>{this.resizeDebounceTimer&&clearTimeout(this.resizeDebounceTimer),this.resizeDebounceTimer=window.setTimeout(()=>{this.updatePosition()},this.resizeDelay)},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:p})=>{var g;if(this.editor.isDestroyed){this.destroy();return}if(this.preventHide){this.preventHide=!1;return}p?.relatedTarget&&((g=this.element.parentNode)!=null&&g.contains(p.relatedTarget))||p?.relatedTarget!==this.editor.view.dom&&this.hide()},this.handleDebouncedUpdate=(p,g)=>{const x=!g?.selection.eq(p.state.selection),v=!g?.doc.eq(p.state.doc);!x&&!v||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(p,x,v,g)},this.updateDelay))},this.updateHandler=(p,g,x,v)=>{const{composing:S}=p;if(S||!g&&!x)return;if(!this.getShouldShow(v)){this.hide();return}this.updatePosition(),this.show()},this.transactionHandler=({transaction:p})=>{p.getMeta("bubbleMenu")==="updatePosition"&&this.updatePosition()};var h;this.editor=t,this.element=e,this.view=n,this.updateDelay=i,this.resizeDelay=o,this.appendTo=a,this.scrollTarget=(h=d?.scrollTarget)!=null?h:window,this.getReferencedVirtualElement=u,this.floatingUIOptions={...this.floatingUIOptions,...d},this.element.tabIndex=0,s&&(this.shouldShow=s),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.editor.on("transaction",this.transactionHandler),window.addEventListener("resize",this.resizeHandler),this.scrollTarget.addEventListener("scroll",this.resizeHandler),this.update(n,n.state),this.getShouldShow()&&(this.show(),this.updatePosition())}get middlewares(){const t=[];return this.floatingUIOptions.flip&&t.push(o4(typeof this.floatingUIOptions.flip!="boolean"?this.floatingUIOptions.flip:void 0)),this.floatingUIOptions.shift&&t.push(r4(typeof this.floatingUIOptions.shift!="boolean"?this.floatingUIOptions.shift:void 0)),this.floatingUIOptions.offset&&t.push(n4(typeof this.floatingUIOptions.offset!="boolean"?this.floatingUIOptions.offset:void 0)),this.floatingUIOptions.arrow&&t.push(a4(this.floatingUIOptions.arrow)),this.floatingUIOptions.size&&t.push(l4(typeof this.floatingUIOptions.size!="boolean"?this.floatingUIOptions.size:void 0)),this.floatingUIOptions.autoPlacement&&t.push(i4(typeof this.floatingUIOptions.autoPlacement!="boolean"?this.floatingUIOptions.autoPlacement:void 0)),this.floatingUIOptions.hide&&t.push(s4(typeof this.floatingUIOptions.hide!="boolean"?this.floatingUIOptions.hide:void 0)),this.floatingUIOptions.inline&&t.push(c4(typeof this.floatingUIOptions.inline!="boolean"?this.floatingUIOptions.inline:void 0)),t}get virtualElement(){var t;const{selection:e}=this.editor.state,n=(t=this.getReferencedVirtualElement)==null?void 0:t.call(this);if(n)return n;const i=Cz(this.view,e.from,e.to);let o={getBoundingClientRect:()=>i,getClientRects:()=>[i]};if(e instanceof xe){let s=this.view.nodeDOM(e.from);const a=s.dataset.nodeViewWrapper?s:s.querySelector("[data-node-view-wrapper]");a&&(s=a),s&&(o={getBoundingClientRect:()=>s.getBoundingClientRect(),getClientRects:()=>[s.getBoundingClientRect()]})}if(e instanceof Fn){const{$anchorCell:s,$headCell:a}=e,u=s?s.pos:a.pos,d=a?a.pos:s.pos,h=this.view.nodeDOM(u),p=this.view.nodeDOM(d);if(!h||!p)return;const g=h===p?h.getBoundingClientRect():v4(h.getBoundingClientRect(),p.getBoundingClientRect());o={getBoundingClientRect:()=>g,getClientRects:()=>[g]}}return o}updatePosition(){const t=this.virtualElement;t&&u4(t,this.element,{placement:this.floatingUIOptions.placement,strategy:this.floatingUIOptions.strategy,middleware:this.middlewares}).then(({x:e,y:n,strategy:i})=>{this.element.style.width="max-content",this.element.style.position=i,this.element.style.left=`${e}px`,this.element.style.top=`${n}px`,this.isVisible&&this.floatingUIOptions.onUpdate&&this.floatingUIOptions.onUpdate()})}update(t,e){const{state:n}=t,i=n.selection.from!==n.selection.to;if(this.updateDelay>0&&i){this.handleDebouncedUpdate(t,e);return}const o=!e?.selection.eq(t.state.selection),s=!e?.doc.eq(t.state.doc);this.updateHandler(t,o,s,e)}getShouldShow(t){var e;const{state:n}=this.view,{selection:i}=n,{ranges:o}=i,s=Math.min(...o.map(d=>d.$from.pos)),a=Math.max(...o.map(d=>d.$to.pos));return((e=this.shouldShow)==null?void 0:e.call(this,{editor:this.editor,element:this.element,view:this.view,state:n,oldState:t,from:s,to:a}))||!1}show(){var t;if(this.isVisible)return;this.element.style.visibility="visible",this.element.style.opacity="1";const e=typeof this.appendTo=="function"?this.appendTo():this.appendTo;(t=e??this.view.dom.parentElement)==null||t.appendChild(this.element),this.floatingUIOptions.onShow&&this.floatingUIOptions.onShow(),this.isVisible=!0}hide(){this.isVisible&&(this.element.style.visibility="hidden",this.element.style.opacity="0",this.element.remove(),this.floatingUIOptions.onHide&&this.floatingUIOptions.onHide(),this.isVisible=!1)}destroy(){this.hide(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),window.removeEventListener("resize",this.resizeHandler),this.scrollTarget.removeEventListener("scroll",this.resizeHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler),this.editor.off("transaction",this.transactionHandler),this.floatingUIOptions.onDestroy&&this.floatingUIOptions.onDestroy()}},w4=t=>new Ye({key:typeof t.pluginKey=="string"?new Xe(t.pluginKey):t.pluginKey,view:e=>new S4({view:e,...t})}),C4=Je.create({name:"bubbleMenu",addOptions(){return{element:null,pluginKey:"bubbleMenu",updateDelay:void 0,appendTo:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[w4({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,updateDelay:this.options.updateDelay,options:this.options.options,appendTo:this.options.appendTo,getReferencedVirtualElement:this.options.getReferencedVirtualElement,shouldShow:this.options.shouldShow})]:[]}}),k4=C4,E4=KB,T4=JB;const M4=({editor:t})=>{if(!t)return null;const e=()=>{const s=window.prompt("Enter Image URL:");s&&t.chain().focus().setImage({src:s}).run()},n=()=>{const s=window.prompt("Enter Link URL:");if(s!==null){if(s===""){t.chain().focus().extendMarkRange("link").unsetLink().run();return}t.chain().focus().extendMarkRange("link").setLink({href:s}).run()}},i=({onClick:s,isActive:a,children:u,title:d})=>b.jsx("button",{onClick:s,title:d,style:{background:a?"var(--bg-app)":"transparent",border:"none",color:a?"var(--accent)":"var(--text-muted)",cursor:"pointer",padding:"3px 5px",borderRadius:"3px",fontWeight:"bold",fontSize:"12px",minWidth:"22px",display:"flex",alignItems:"center",justifyContent:"center"},className:"toolbar-btn",children:u}),o=()=>b.jsx("div",{style:{width:"1px",height:"16px",background:"#444",margin:"0 4px"}});return b.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1px",padding:"0 5px",flexWrap:"wrap"},children:[b.jsx(i,{onClick:()=>t.chain().focus().undo().run(),title:"Undo",children:""}),b.jsx(i,{onClick:()=>t.chain().focus().redo().run(),title:"Redo",children:""}),b.jsx(o,{}),b.jsx(i,{onClick:()=>t.chain().focus().toggleBold().run(),isActive:t.isActive("bold"),title:"Bold",children:"B"}),b.jsx(i,{onClick:()=>t.chain().focus().toggleItalic().run(),isActive:t.isActive("italic"),title:"Italic",children:"I"}),b.jsx(i,{onClick:()=>t.chain().focus().toggleUnderline().run(),isActive:t.isActive("underline"),title:"Underline",children:"U"}),b.jsx(i,{onClick:()=>t.chain().focus().toggleStrike().run(),isActive:t.isActive("strike"),title:"Strikethrough",children:"S"}),b.jsx(o,{}),b.jsx(i,{onClick:()=>t.chain().focus().toggleHeading({level:1}).run(),isActive:t.isActive("heading",{level:1}),title:"Heading 1",children:"H1"}),b.jsx(i,{onClick:()=>t.chain().focus().toggleHeading({level:2}).run(),isActive:t.isActive("heading",{level:2}),title:"Heading 2",children:"H2"}),b.jsx(i,{onClick:()=>t.chain().focus().setParagraph().run(),isActive:t.isActive("paragraph"),title:"Paragraph",children:""}),b.jsx(o,{}),b.jsx(i,{onClick:()=>t.chain().focus().setTextAlign("left").run(),isActive:t.isActive({textAlign:"left"}),title:"Align Left",children:"L"}),b.jsx(i,{onClick:()=>t.chain().focus().setTextAlign("center").run(),isActive:t.isActive({textAlign:"center"}),title:"Align Center",children:"C"}),b.jsx(i,{onClick:()=>t.chain().focus().setTextAlign("right").run(),isActive:t.isActive({textAlign:"right"}),title:"Align Right",children:"R"}),b.jsx(i,{onClick:()=>t.chain().focus().setTextAlign("justify").run(),isActive:t.isActive({textAlign:"justify"}),title:"Justify",children:"J"}),b.jsx(o,{}),b.jsx(i,{onClick:()=>t.chain().focus().toggleBulletList().run(),isActive:t.isActive("bulletList"),title:"Bullet List",children:""}),b.jsx(i,{onClick:()=>t.chain().focus().toggleOrderedList().run(),isActive:t.isActive("orderedList"),title:"Numbered List",children:"1."}),b.jsx(i,{onClick:()=>t.chain().focus().toggleBlockquote().run(),isActive:t.isActive("blockquote"),title:"Blockquote",children:""}),b.jsx(o,{}),b.jsx(i,{onClick:e,title:"Insert Image",children:""}),b.jsx(i,{onClick:n,isActive:t.isActive("link"),title:"Add Link",children:""}),b.jsx(i,{onClick:()=>t.chain().focus().unsetAllMarks().run(),title:"Clear Formatting",children:""}),b.jsx("style",{children:`
        .toolbar-btn:hover { background-color: rgba(255,255,255,0.1) !important; color: var(--text-main) !important; }
      `})]})},A4=({editor:t})=>{if(!t)return null;const[e,n]=R.useState(500),i=t.storage.characterCount.words(),o=t.storage.characterCount.characters(),s=Math.min(i/e*100,100),a=Math.ceil(i/200);return b.jsxs("div",{style:O4,children:[b.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[b.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[b.jsxs("span",{children:[" ",i," Words"]}),b.jsx("div",{style:R4,children:b.jsx("div",{style:{...D4,width:`${s}%`}})}),b.jsxs("span",{style:{fontSize:"10px",color:"#666"},children:["Goal:",b.jsx("input",{type:"number",value:e,onChange:u=>n(parseInt(u.target.value)||0),style:N4})]})]}),b.jsxs("span",{children:[" ",o," Chars"]}),b.jsxs("span",{children:[" ~",a," min read"]})]}),b.jsx("div",{style:{fontSize:"11px",color:"#555",fontStyle:"italic"},children:s===100?" Goal Reached!":`${e-i} words to go`})]})},O4={height:"35px",background:"var(--bg-header)",borderTop:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 20px",fontSize:"12px",color:"var(--text-muted)",flexShrink:0,zIndex:10},R4={width:"100px",height:"6px",background:"#333",borderRadius:"3px",overflow:"hidden"},D4={height:"100%",background:"var(--accent)",transition:"width 0.3s ease"},N4={background:"transparent",border:"none",color:"var(--accent)",width:"40px",fontSize:"10px",marginLeft:"4px",outline:"none"},j4=({character:t,position:e})=>{if(!t)return null;const n=t.aliases&&t.aliases.length>0?t.aliases.join(", "):null;return b.jsxs("div",{style:{position:"fixed",left:e.x,top:e.y+24,zIndex:2e3,background:"var(--bg-panel)",border:"1px solid var(--accent)",borderRadius:"8px",padding:"12px",width:"280px",boxShadow:"0 8px 30px rgba(0,0,0,0.6)",display:"flex",gap:"12px",pointerEvents:"none",animation:"fadeIn 0.2s ease-out"},children:[b.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"50%",overflow:"hidden",border:"2px solid var(--border)",flexShrink:0,background:"#000",display:"flex",alignItems:"center",justifyContent:"center"},children:t.imageSrc?b.jsx("div",{style:{width:"100%",height:"100%",...t.imageStyles,backgroundImage:`url(${t.imageSrc})`,backgroundRepeat:"no-repeat",backgroundSize:"cover"}}):b.jsx("span",{style:{fontSize:"24px"},children:""})}),b.jsxs("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"center"},children:[b.jsx("h4",{style:{margin:"0 0 4px 0",color:"var(--text-main)",fontSize:"14px",lineHeight:"1.2"},children:t.name}),n&&b.jsxs("div",{style:{fontSize:"10px",color:"var(--accent)",marginBottom:"6px",fontStyle:"italic"},children:["aka ",n]}),b.jsx("p",{style:{margin:0,fontSize:"11px",color:"var(--text-muted)",lineHeight:"1.4",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:z4(t)})]}),b.jsx("style",{children:"@keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }"})]})},z4=t=>{if(t.biography&&t.biography.trim().length>0)return t.biography;if(!t.sections)return"No details available.";for(let e of t.sections)for(let n of e.blocks)if(["role","title","class","description","summary","biography"].includes(n.label.toLowerCase())&&n.content)return n.content;return t.sections[0]&&t.sections[0].blocks[0]?t.sections[0].blocks[0].content:"No details available."},L4=()=>{const{projectData:t,setProjectData:e}=Tt(),[n,i]=R.useState({isOpen:!1,type:"alert",title:"",message:"",onConfirm:()=>{}}),o=()=>i({...n,isOpen:!1}),s=t.settings||{fontSize:18,zoom:100,fontFamily:"serif",customFonts:[]},a=(d,h)=>{e(p=>({...p,settings:{...p.settings,[d]:h}}))},u=d=>{const h=d.target.files[0];if(!h)return;const p=new FileReader;p.onload=g=>{const x=h.name.split(".")[0].replace(/\s+/g,"-"),v=g.target.result;try{new FontFace(x,`url(${v})`).load().then(k=>{document.fonts.add(k),e(w=>{const E=w.settings||{},A=E.customFonts||[];return{...w,settings:{...E,customFonts:[...A,{name:x,data:v}],fontFamily:x}}}),i({isOpen:!0,type:"alert",title:"Font Added",message:`Successfully installed "${x}". It is now selected.`,onConfirm:o})}).catch(k=>{throw k})}catch(S){console.error("Font loading failed:",S),i({isOpen:!0,type:"alert",title:"Upload Failed",message:"Failed to load font. Make sure it is a valid TTF or OTF file.",onConfirm:o})}},p.readAsDataURL(h),d.target.value=null};return b.jsxs(b.Fragment,{children:[b.jsx(Wt,{isOpen:n.isOpen,type:n.type,title:n.title,message:n.message,onConfirm:()=>{n.onConfirm&&n.onConfirm(),o()},onCancel:o}),b.jsxs("div",{style:B4,children:[b.jsxs("select",{value:s.fontFamily,onChange:d=>a("fontFamily",d.target.value),style:I4,title:"Select Font",children:[b.jsxs("optgroup",{label:"System",children:[b.jsx("option",{value:"serif",children:"Serif"}),b.jsx("option",{value:"sans-serif",children:"Sans"}),b.jsx("option",{value:"'Courier New', monospace",children:"Mono"}),b.jsx("option",{value:"'Georgia', serif",children:"Georgia"}),b.jsx("option",{value:"'Palatino Linotype', serif",children:"Palatino"})]}),s.customFonts&&s.customFonts.length>0&&b.jsx("optgroup",{label:"My Fonts",children:s.customFonts.map((d,h)=>b.jsx("option",{value:d.name,children:d.name},`${d.name}-${h}`))})]}),b.jsxs("div",{style:oS,children:[b.jsx("button",{onClick:()=>a("fontSize",Math.max(10,s.fontSize-1)),style:Fc,title:"Decrease Size",children:"-"}),b.jsx("span",{style:lS,children:s.fontSize}),b.jsx("button",{onClick:()=>a("fontSize",Math.min(72,s.fontSize+1)),style:Fc,title:"Increase Size",children:"+"})]}),b.jsxs("div",{style:oS,children:[b.jsx("span",{style:_4,children:"Z"}),b.jsx("button",{onClick:()=>a("zoom",Math.max(50,s.zoom-10)),style:Fc,title:"Zoom Out",children:"-"}),b.jsxs("span",{style:lS,children:[s.zoom,"%"]}),b.jsx("button",{onClick:()=>a("zoom",Math.min(200,s.zoom+10)),style:Fc,title:"Zoom In",children:"+"})]}),b.jsxs("label",{style:H4,title:"Upload Custom Font (TTF/OTF)",children:[" Font",b.jsx("input",{type:"file",accept:".ttf,.otf",onChange:u,style:{display:"none"}})]})]})]})},B4={display:"flex",alignItems:"center",gap:"8px",borderLeft:"1px solid #444",paddingLeft:"8px"},I4={background:"#111",color:"#ccc",border:"1px solid #444",borderRadius:"4px",fontSize:"11px",padding:"2px",maxWidth:"100px"},oS={display:"flex",alignItems:"center",background:"#222",borderRadius:"4px",border:"1px solid #333",padding:"0 4px"},Fc={background:"none",border:"none",color:"var(--accent)",cursor:"pointer",fontWeight:"bold",padding:"0 4px",fontSize:"14px"},lS={fontSize:"10px",width:"25px",textAlign:"center",color:"#888"},_4={fontSize:"9px",color:"#555",fontWeight:"bold",marginRight:"2px"},H4={fontSize:"10px",background:"#333",padding:"3px 6px",borderRadius:"3px",cursor:"pointer",color:"#ccc",whiteSpace:"nowrap"},U4=({chapterId:t})=>{const{projectData:e,setProjectData:n}=Tt(),[i,o]=R.useState("notes"),s=e.manuscript?.chapters?.find(h=>h.id===t),a=e.manuscript?.chapters?.findIndex(h=>h.id===t),u=h=>{if(a===-1)return;const p=[...e.manuscript.chapters];p[a]={...s,...h},n({...e,manuscript:{...e.manuscript,chapters:p}})},d=R.useMemo(()=>{if(!s||!s.content)return null;const h=document.createElement("div");h.innerHTML=s.content;const p=h.innerText||h.textContent||"",g=p.trim().split(/\s+/).filter(z=>z.length>0),x=g.length,v=p.split(/[.!?]+/).filter(z=>z.trim().length>0).length||1,S=Math.ceil(x/250),k=g.filter(z=>z.toLowerCase().endsWith("ly")&&z.length>4);let w=0;g.forEach(z=>{const N=z.toLowerCase().replace(/[^a-z]/g,"");if(N.length<=3){w+=1;return}const B=N.replace(/(?:[^laeiouy]es|ed|[^laeiouy]e)$/,"").match(/[aeiouy]{1,2}/g);w+=B?B.length:1});const E=.39*(x/v)+11.8*(w/Math.max(1,x))-15.59,A=Math.max(0,Math.round(E*10)/10),D=new Set(["the","and","to","of","a","in","that","is","was","he","she","it","for","on","with","as","his","her","at","be","this","have","from","or","one","had","by","word","but","not","what","all","were","we","when","your","can","said","there","use","an","each","which","do","how","their","if"]),L={};g.forEach(z=>{const N=z.toLowerCase().replace(/[^a-z]/g,"");N&&!D.has(N)&&N.length>2&&(L[N]=(L[N]||0)+1)});const T=Object.entries(L).sort((z,N)=>N[1]-z[1]).slice(0,5);return{wordCount:x,sentenceCount:v,readTime:S,adverbs:k,gradeLevel:A,topWords:T}},[s?.content]);return s?b.jsxs("div",{style:V4,children:[b.jsxs("div",{style:q4,children:[b.jsx("button",{onClick:()=>o("notes"),style:i==="notes"?sS:Em,children:" Notes"}),b.jsx("button",{onClick:()=>o("analytics"),style:i==="analytics"?sS:Em,children:" Analytics"})]}),b.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px"},children:[i==="notes"&&b.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[b.jsxs("div",{children:[b.jsx("div",{style:ks,children:"CHAPTER SYNOPSIS"}),b.jsx("textarea",{value:s.synopsis||"",onChange:h=>u({synopsis:h.target.value}),placeholder:"What happens in this chapter?",style:dS})]}),b.jsx("div",{style:Op}),b.jsxs("div",{children:[b.jsx("div",{style:ks,children:"CHAPTER NOTES"}),b.jsx("textarea",{value:s.notes||"",onChange:h=>u({notes:h.target.value}),placeholder:"Ideas, reminders, continuity checks...",style:{...dS,minHeight:"200px"}})]})]}),i==="analytics"&&d&&b.jsxs(b.Fragment,{children:[b.jsxs("div",{style:F4,children:[b.jsxs("div",{style:aS,children:[b.jsx("div",{style:cS,children:d.wordCount}),b.jsx("div",{style:uS,children:"Words"})]}),b.jsxs("div",{style:aS,children:[b.jsxs("div",{style:cS,children:[d.readTime," ",b.jsx("span",{style:{fontSize:"10px"},children:"min"})]}),b.jsx("div",{style:uS,children:"Read Time"})]})]}),b.jsx("div",{style:Op}),b.jsxs("div",{style:{marginBottom:"20px"},children:[b.jsx("div",{style:ks,children:"READABILITY GRADE"}),b.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[b.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:$4(d.gradeLevel)},children:d.gradeLevel}),b.jsx("div",{style:{fontSize:"11px",color:"#888",lineHeight:"1.2"},children:P4(d.gradeLevel)})]})]}),b.jsxs("div",{style:{marginBottom:"20px"},children:[b.jsx("div",{style:ks,children:"ADVERB USAGE"}),b.jsxs("div",{style:{fontSize:"13px",color:"var(--text-main)",marginBottom:"5px"},children:["Count:"," ",b.jsx("span",{style:{fontWeight:"bold",color:d.adverbs.length>d.wordCount/100*3?"#e74c3c":"#2ecc71"},children:d.adverbs.length})]}),b.jsx("div",{style:{fontSize:"11px",color:"#666",fontStyle:"italic"},children:"(Aim for < 3%)"})]}),b.jsx("div",{style:Op}),b.jsxs("div",{children:[b.jsx("div",{style:ks,children:"MOST USED WORDS"}),d.topWords.length===0?b.jsx("div",{style:{fontSize:"12px",color:"var(--text-muted)"},children:"Not enough content to analyze."}):d.topWords.map(([h,p],g)=>b.jsxs("div",{style:W4,children:[b.jsx("span",{style:{color:"var(--text-main)"},children:h}),b.jsx("div",{style:Y4,children:b.jsx("div",{style:{width:`${Math.min(100,p/d.topWords[0][1]*100)}%`,height:"100%",background:"var(--accent)",opacity:.5,borderRadius:"2px"}})}),b.jsx("span",{style:{fontSize:"11px",color:"#666",minWidth:"20px",textAlign:"right"},children:p})]},g))]})]})]})]}):null},$4=t=>t<6?"#2ecc71":t<10?"#f1c40f":"#e74c3c",P4=t=>t<6?"Very easy.":t<10?"Standard.":"Complex.",V4={width:"250px",background:"var(--bg-panel)",borderLeft:"1px solid var(--border)",display:"flex",flexDirection:"column",height:"100%"},q4={display:"flex",borderBottom:"1px solid var(--border)",flexShrink:0},Em={flex:1,background:"transparent",border:"none",color:"var(--text-muted)",padding:"10px 5px",cursor:"pointer",fontSize:"11px",fontWeight:"bold",borderBottom:"2px solid transparent"},sS={...Em,background:"var(--bg-header)",color:"var(--text-main)",borderBottom:"2px solid var(--accent)"},F4={display:"flex",gap:"10px",marginBottom:"10px"},aS={flex:1,background:"var(--bg-app)",border:"1px solid var(--border)",borderRadius:"4px",padding:"10px",textAlign:"center"},cS={fontSize:"20px",fontWeight:"bold",color:"var(--text-main)"},uS={fontSize:"10px",color:"var(--text-muted)",marginTop:"2px"},ks={fontSize:"10px",fontWeight:"bold",color:"var(--accent)",marginBottom:"8px",textTransform:"uppercase"},Op={height:"1px",background:"var(--border)",margin:"20px 0"},W4={display:"flex",alignItems:"center",gap:"10px",marginBottom:"6px",fontSize:"13px"},Y4={flex:1,height:"6px",background:"var(--bg-app)",borderRadius:"2px",overflow:"hidden"},dS={width:"100%",boxSizing:"border-box",minHeight:"100px",background:"var(--bg-app)",border:"1px solid var(--border)",color:"var(--text-main)",padding:"10px",borderRadius:"4px",fontSize:"13px",lineHeight:"1.5",resize:"vertical",outline:"none"},G4=({editor:t,position:e,onClose:n})=>{const{projectData:i,setProjectData:o}=Tt(),[s,a]=R.useState(!1),[u,d]=R.useState(null),[h,p]=R.useState(""),[g,x]=R.useState("Character"),[v,S]=R.useState([]),[k,w]=R.useState(!1);R.useEffect(()=>{if(!t)return;const _=t.state.selection,W=t.state.doc.textBetween(_.from,_.to," ");p(W),x(E(W)),W&&W.trim().split(/\s+/).length===1?(w(!0),fetch(`https://api.datamuse.com/words?rel_syn=${encodeURIComponent(W.trim())}&max=10`).then(oe=>oe.json()).then(oe=>{const re=oe.map(fe=>fe.word).slice(0,8);S(re)}).catch(oe=>{console.error("Failed to fetch synonyms:",oe),S([])}).finally(()=>w(!1))):S([])},[t]);const E=_=>{if(!_)return"Character";const W=_.toLowerCase();return["forest","city","kingdom","castle","mountain","river","sea","island","valley","cave","temple","tower","village","town","plains","desert"].some(fe=>W.includes(fe))||_.startsWith("The ")?"Location":["elf","dwarf","orc","goblin","dragon","human","race","tribe","clan","folk"].some(fe=>W.includes(fe))?"Race":"Character"},A=_=>{_.stopPropagation(),document.execCommand("copy"),n()},D=_=>{_.stopPropagation(),document.execCommand("paste"),n()},L=_=>{_.stopPropagation(),document.execCommand("cut"),n()},T=_=>{_.stopPropagation(),t?.commands.selectAll(),n()},z=_=>{_.stopPropagation(),d("create"),a(!0)},N=_=>{_.stopPropagation(),d("addTo"),a(!0)},B=_=>{t&&(t.chain().focus().insertContent(_).run(),n())};return e?b.jsxs(b.Fragment,{children:[b.jsxs("div",{style:{...J4,left:e.x,top:e.y},onClick:_=>_.stopPropagation(),children:[b.jsx("div",{style:Rp,children:"Standard"}),b.jsx("button",{onClick:L,style:bi,children:" Cut"}),b.jsx("button",{onClick:A,style:bi,children:" Copy"}),b.jsx("button",{onClick:D,style:bi,children:" Paste"}),b.jsx("div",{style:Dp}),b.jsx("button",{onClick:T,style:bi,children:" Select All"}),h&&h.trim().split(/\s+/).length===1&&b.jsxs(b.Fragment,{children:[b.jsx("div",{style:Dp}),b.jsxs("div",{style:Rp,children:[' Synonyms for "',h.slice(0,15),h.length>15?"...":"",'"']}),k?b.jsx("div",{style:{...bi,cursor:"default",opacity:.6},children:"Loading..."}):v.length>0?v.map((_,W)=>b.jsx("button",{onClick:()=>B(_),style:bi,children:_},W)):b.jsx("div",{style:{...bi,cursor:"default",opacity:.6},children:"No synonyms found"})]}),h&&b.jsxs(b.Fragment,{children:[b.jsx("div",{style:Dp}),b.jsx("div",{style:Rp,children:"Lore Tools"}),b.jsxs("button",{onClick:z,style:bi,children:[' Create "',h.slice(0,20),h.length>20?"...":"",'" as Lore']}),b.jsx("button",{onClick:N,style:bi,children:" Add to Existing Lore Card"})]})]}),s&&u==="create"&&b.jsx(K4,{selectedText:h,suggestedType:g,projectData:i,setProjectData:o,onClose:()=>{a(!1),n()},editor:t}),s&&u==="addTo"&&b.jsx(X4,{selectedText:h,projectData:i,setProjectData:o,onClose:()=>{a(!1),n()}})]}):null},K4=({selectedText:t,suggestedType:e,projectData:n,setProjectData:i,onClose:o,editor:s})=>{const[a,u]=R.useState(t),[d,h]=R.useState(e),[p,g]=R.useState("root_misc"),[x,v]=R.useState(!0),[S,k]=R.useState(!1),[w,E]=R.useState(""),[A,D]=R.useState(!1),L=n.lore?.folders||[],T=L.filter(N=>N.parentId===null),z=()=>{if(A)return;D(!0);const N={id:Date.now(),name:a,type:d,aliases:[],folderId:p,imageSrc:null,biography:"",sections:[]},B=[...n.lore.characters||[],N];i({...n,lore:{...n.lore,characters:B}}),x&&s&&s.chain().focus().setMark("loreLink",{charId:N.id}).run();const _=L.find(W=>W.id===p)?.name||"Unsorted";E(`Created "${a}" as ${d} in ${_}`),k(!0)};return b.jsxs(b.Fragment,{children:[b.jsx(Wt,{isOpen:S,type:"alert",title:" Lore Card Created",message:w,onConfirm:()=>{k(!1),o()},onCancel:()=>{k(!1),o()}}),!S&&b.jsx("div",{style:Jk,onClick:o,children:b.jsxs("div",{style:Qk,onClick:N=>N.stopPropagation(),children:[b.jsx("h3",{style:{margin:"0 0 15px 0",color:"var(--text-main)"},children:"Create New Lore Card"}),b.jsx("label",{style:Rs,children:"Name"}),b.jsx("input",{type:"text",value:a,onChange:N=>u(N.target.value),style:ru,autoFocus:!0}),b.jsxs("label",{style:Rs,children:["Type (Suggestion: ",e,")"]}),b.jsxs("select",{value:d,onChange:N=>h(N.target.value),style:ru,children:[b.jsx("option",{value:"Character",children:"Character"}),b.jsx("option",{value:"Location",children:"Location"}),b.jsx("option",{value:"Race",children:"Race/Species"}),b.jsx("option",{value:"Faction",children:"Faction/Group"}),b.jsx("option",{value:"Item",children:"Item/Artifact"}),b.jsx("option",{value:"Concept",children:"Concept/Magic"}),b.jsx("option",{value:"Event",children:"Event"}),b.jsx("option",{value:"Other",children:"Other"})]}),b.jsx("label",{style:Rs,children:"Folder"}),b.jsx("select",{value:p,onChange:N=>g(N.target.value),style:ru,children:T.map(N=>b.jsx("option",{value:N.id,children:N.name},N.id))}),b.jsxs("label",{style:{...Rs,display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",marginTop:"10px"},children:[b.jsx("input",{type:"checkbox",checked:x,onChange:N=>v(N.target.checked)}),b.jsx("span",{children:"Create smart link in editor"})]}),b.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[b.jsx("button",{onClick:o,style:Zk,children:"Cancel"}),b.jsx("button",{onClick:z,disabled:!a||A,style:eE,children:A?"Creating...":"Create"})]})]})})]})},X4=({selectedText:t,projectData:e,setProjectData:n,onClose:i})=>{const[o,s]=R.useState(null),[a,u]=R.useState(""),[d,h]=R.useState(!1),[p,g]=R.useState(""),[x,v]=R.useState(!1),S=e.lore.characters||[],k=S.filter(E=>E.name.toLowerCase().includes(a.toLowerCase())),w=()=>{if(!o||x)return;v(!0);const E=S.findIndex(B=>B.id===o);if(E===-1)return;const A=S[E];let D=A.sections||[],L=D.find(B=>B.title==="Uncategorized");L||(L={id:Date.now(),title:"Uncategorized",blocks:[]},D=[...D,L]);const T={id:Date.now(),label:"Note from Manuscript",content:t};L.blocks.push(T);const z={...A,sections:D},N=[...S];N[E]=z,n({...e,lore:{...e.lore,characters:N}}),g(`Added to "${A.name}" in Uncategorized section`),h(!0)};return b.jsxs(b.Fragment,{children:[b.jsx(Wt,{isOpen:d,type:"alert",title:" Added to Lore Card",message:p,onConfirm:()=>{h(!1),i()},onCancel:()=>{h(!1),i()}}),!d&&b.jsx("div",{style:Jk,onClick:i,children:b.jsxs("div",{style:Qk,onClick:E=>E.stopPropagation(),children:[b.jsx("h3",{style:{margin:"0 0 15px 0",color:"var(--text-main)"},children:"Add to Existing Lore Card"}),b.jsxs("div",{style:{marginBottom:"15px",padding:"10px",background:"var(--bg-app)",borderRadius:"4px",fontSize:"13px",color:"var(--text-muted)"},children:['"',t,'"']}),b.jsx("label",{style:Rs,children:"Search Lore Cards"}),b.jsx("input",{type:"text",placeholder:" Type to search...",value:a,onChange:E=>u(E.target.value),style:ru,autoFocus:!0}),b.jsxs("div",{style:Q4,children:[k.map(E=>b.jsxs("div",{onClick:()=>s(E.id),style:{...Z4,background:o===E.id?"var(--accent)":"var(--bg-app)",color:o===E.id?"white":"var(--text-main)"},children:[b.jsx("div",{style:{fontWeight:"bold"},children:E.name}),b.jsx("div",{style:{fontSize:"10px",opacity:.7},children:E.type||"Entity"})]},E.id)),k.length===0&&b.jsx("div",{style:{padding:"20px",textAlign:"center",color:"var(--text-muted)"},children:"No lore cards found"})]}),b.jsx("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"10px"},children:' Text will be added to "Uncategorized" section. You can move it later.'}),b.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"15px"},children:[b.jsx("button",{onClick:i,style:Zk,children:"Cancel"}),b.jsx("button",{onClick:w,disabled:!o||x,style:eE,children:x?"Adding...":"Add to Card"})]})]})})]})},J4={position:"fixed",background:"var(--bg-panel)",border:"1px solid var(--border)",borderRadius:"6px",boxShadow:"0 8px 24px rgba(0,0,0,0.5)",minWidth:"220px",zIndex:9999,padding:"4px 0"},bi={width:"100%",padding:"8px 12px",background:"transparent",border:"none",color:"var(--text-main)",textAlign:"left",cursor:"pointer",fontSize:"13px",display:"flex",alignItems:"center",gap:"8px"},Rp={padding:"4px 12px",fontSize:"10px",fontWeight:"bold",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"1px"},Dp={height:"1px",background:"var(--border)",margin:"4px 0"},Jk={position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},Qk={background:"var(--bg-panel)",border:"1px solid var(--border)",borderRadius:"8px",padding:"20px",width:"450px",maxWidth:"90%",boxShadow:"0 10px 40px rgba(0,0,0,0.7)"},Rs={display:"block",fontSize:"11px",fontWeight:"bold",color:"var(--text-muted)",marginBottom:"5px",marginTop:"10px"},ru={width:"100%",padding:"8px",background:"var(--bg-app)",border:"1px solid var(--border)",borderRadius:"4px",color:"var(--text-main)",fontSize:"14px",outline:"none",boxSizing:"border-box"},Q4={maxHeight:"300px",overflowY:"auto",border:"1px solid var(--border)",borderRadius:"4px",marginTop:"10px"},Z4={padding:"10px",cursor:"pointer",borderBottom:"1px solid var(--border)",transition:"all 0.2s"},Zk={flex:1,padding:"8px",background:"transparent",border:"1px solid var(--border)",borderRadius:"4px",color:"var(--text-muted)",cursor:"pointer",fontSize:"13px"},eE={flex:1,padding:"8px",background:"var(--accent)",border:"none",borderRadius:"4px",color:"white",cursor:"pointer",fontSize:"13px",fontWeight:"bold"},tE=document.createElement("style");tE.innerHTML=`
  button:hover:not(:disabled) { background-color: rgba(255,255,255,0.1) !important; }
  button:disabled { opacity: 0.5; cursor: not-allowed; }
`;document.head.appendChild(tE);const eI=Ar.create({name:"loreLink",parseHTML(){return[{tag:"span.lore-link"}]},renderHTML({HTMLAttributes:t}){return["span",nt(t,{class:"lore-link"}),0]},addAttributes(){return{charId:{default:null}}}}),tI=()=>{const{projectData:t,setProjectData:e}=Tt(),[n]=IS(),i=Er(),o=t.settings||{fontSize:18,zoom:100,fontFamily:"serif",customFonts:[]},s=n.get("id"),a=t.manuscript.chapters||[];let u=0;if(s){const O=a.findIndex(U=>U.id.toString()===s);O!==-1&&(u=O)}const d=a[u],[h,p]=R.useState(!0),[g,x]=R.useState("Saved"),[v,S]=R.useState(null),[k,w]=R.useState({x:0,y:0}),[E,A]=R.useState(!1),[D,L]=R.useState(!1),[T,z]=R.useState(!0),[N,B]=R.useState(null),[_,W]=R.useState(d?.title||""),oe=R.useRef(null);R.useEffect(()=>{d&&W(d.title)},[d?.id]),R.useEffect(()=>{o.customFonts&&o.customFonts.forEach(O=>{new FontFace(O.name,`url(${O.data})`).load().then(K=>document.fonts.add(K)).catch(K=>console.error(K))})},[o.customFonts]);const re=g3({extensions:[i5,eI,RB,l5,fB.configure({openOnClick:!1}),a5.configure({types:["heading","paragraph"]}),c5.configure({placeholder:"Start writing your masterpiece..."}),E4,T4.configure({className:"has-focus",mode:"all"}),k4.configure({element:null})],content:d?.content||"",editorProps:{attributes:{class:"seymour-editor",spellcheck:"true"}},onUpdate:()=>{h&&x("Unsaved changes...")},onTransaction:({transaction:O,editor:U})=>{!E||!O.docChanged&&!O.selectionSet||requestAnimationFrame(()=>{const{view:K}=U,{selection:ie}=K.state;try{const le=K.domAtPos(ie.from).node,Y=le.nodeType===1?le:le.parentElement,Z=document.getElementById("editor-workspace");if(Z&&Y){const ae=Y.getBoundingClientRect(),me=Z.getBoundingClientRect(),Ln=ae.top+Z.scrollTop-me.height/2+ae.height/2;Z.scrollTo({top:Ln,behavior:"smooth"})}}catch{}})}});R.useEffect(()=>{re&&d&&re.getHTML()!==d.content&&re.commands.setContent(d.content)},[d?.id,re]),R.useEffect(()=>{if(!re||!h)return;const O=setTimeout(()=>{g==="Unsaved changes..."&&(fe(re.getHTML(),d.title),x("Saved"))},1500);return()=>clearTimeout(O)},[g,h,re,d?.id]);const fe=(O,U)=>{const K={...t.manuscript};K.chapters[u]={...d,content:O,title:U},e({...t,manuscript:K})},he=O=>{const U=O.target.value;W(U),x("Unsaved changes..."),oe.current&&clearTimeout(oe.current),h&&(oe.current=setTimeout(()=>{fe(re?.getHTML(),U),x("Saved")},1500))},we=()=>{re&&(fe(re.getHTML(),_),x("Saved"))},q=()=>{if(!re||!t.lore.characters)return;const O=re.chain().focus();t.lore.characters.forEach(U=>{[U.name,...U.aliases||[]].forEach(ie=>{if(!ie||ie.trim().length<2)return;const le=ie.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Y=new RegExp(`\\b${le}\\b`,"gi");re.state.doc.descendants((Z,ae)=>{if(Z.isText){let me;for(;(me=Y.exec(Z.text))!==null;){const Mt=ae+me.index,Ln=Mt+me[0].length;O.setTextSelection({from:Mt,to:Ln}).setMark("loreLink",{charId:U.id})}}})})}),O.run(),x("Links Updated!"),setTimeout(()=>x("Saved"),2e3)},ee=O=>{if(O.target.classList.contains("lore-link")){const U=O.target.innerText,K=t.lore.characters.find(ie=>ie.name.toLowerCase()===U.toLowerCase()||ie.aliases&&ie.aliases.some(le=>le.toLowerCase()===U.toLowerCase()));K&&(S(K),w({x:O.clientX,y:O.clientY}))}else S(null)},ce=O=>{if(O.target.classList.contains("lore-link")){const U=O.target.innerText,K=t.lore.characters.find(ie=>ie.name.toLowerCase()===U.toLowerCase()||ie.aliases&&ie.aliases.some(le=>le.toLowerCase()===U.toLowerCase()));K&&i(`/lore?id=${K.id}`)}},te=O=>{O.preventDefault(),B({x:O.clientX,y:O.clientY})};R.useEffect(()=>{const O=()=>B(null);return document.addEventListener("click",O),()=>document.removeEventListener("click",O)},[]),R.useEffect(()=>{const O=U=>{if(U.ctrlKey&&U.target.closest("#editor-workspace")){U.preventDefault();const K=U.deltaY>0?-10:10,ie=Math.max(50,Math.min(200,o.zoom+K)),le={...o,zoom:ie};e({...t,settings:le})}};return document.addEventListener("wheel",O,{passive:!1}),()=>document.removeEventListener("wheel",O)},[o,t,e]);const pe=({editor:O})=>{const[U,K]=R.useState(!1),[ie,le]=R.useState({left:0,top:0});return R.useEffect(()=>{if(!O)return;const Y=()=>{const{from:Z,to:ae}=O.state.selection;if(!O||Z===ae){K(!1);return}try{const me=O.view.coordsAtPos(Z),Mt=O.view.coordsAtPos(ae),Ln=(me.left+Mt.right)/2+window.pageXOffset,kl=Math.min(me.top,Mt.top)-44+window.pageYOffset;le({left:Ln,top:kl}),K(!0)}catch{K(!1)}};return O.on("selectionUpdate",Y),O.on("transaction",Y),Y(),()=>{O.off("selectionUpdate",Y),O.off("transaction",Y)}},[O]),!O||!U?null:b.jsx("div",{style:{position:"absolute",left:ie.left,top:ie.top,zIndex:2e3,transform:"translateX(-50%)"},children:b.jsxs("div",{style:cI,children:[b.jsx("button",{onClick:()=>O.chain().focus().toggleBold().run(),style:O.isActive("bold")?Wc:Ns,children:"B"}),b.jsx("button",{onClick:()=>O.chain().focus().toggleItalic().run(),style:O.isActive("italic")?Wc:Ns,children:"I"}),b.jsx("button",{onClick:()=>O.chain().focus().toggleUnderline().run(),style:O.isActive("underline")?Wc:Ns,children:"U"}),b.jsx("button",{onClick:()=>O.chain().focus().toggleStrike().run(),style:O.isActive("strike")?Wc:Ns,children:"S"})]})})};return d?b.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[v&&b.jsx(j4,{character:v,position:k}),b.jsxs("div",{style:nI,children:[b.jsx("div",{style:{flex:1}}),b.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[b.jsx(M4,{editor:re}),b.jsx(L4,{}),b.jsx("div",{style:{width:"1px",height:"20px",background:"#555",margin:"0 5px"}}),b.jsx("button",{onClick:()=>A(!E),style:E?Np:Ds,title:"Typewriter Mode",children:""}),b.jsx("button",{onClick:()=>L(!D),style:D?Np:Ds,title:"Focus Mode",children:""}),b.jsx("button",{onClick:q,style:Ds,title:"Scan for Lore",children:" Link Lore"}),b.jsx("button",{onClick:()=>z(!T),style:T?Np:Ds,title:"Chapter Inspector",children:""})]}),b.jsxs("div",{style:iI,children:[b.jsx("span",{style:{color:g==="Saved"?"var(--text-muted)":"var(--accent)"},children:g}),!h&&b.jsx("button",{onClick:we,style:aI,children:" Save Now"}),b.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"5px",cursor:"pointer",userSelect:"none"},children:[b.jsx("input",{type:"checkbox",checked:h,onChange:O=>p(O.target.checked),style:{cursor:"pointer"}}),b.jsx("span",{style:{color:"var(--text-main)"},children:"Auto-Save"})]})]})]}),b.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[b.jsx("div",{id:"editor-workspace",style:rI,className:`${E?"typewriter-active":""} ${D?"focus-mode-active":""}`,onContextMenu:te,children:b.jsxs("div",{style:{...oI,transform:`scale(${o.zoom/100})`,transformOrigin:"top center"},onMouseMove:ee,onDoubleClick:ce,children:[b.jsx("input",{type:"text",value:_,onChange:he,style:lI,placeholder:"Chapter Title"}),b.jsxs("div",{style:{...sI,fontSize:`${o.fontSize}px`,fontFamily:o.fontFamily},children:[re&&b.jsx(pe,{editor:re}),b.jsx(c3,{editor:re})]})]})}),T&&b.jsx(U4,{chapterId:d.id})]}),b.jsx(A4,{editor:re}),N&&b.jsx(G4,{editor:re,position:N,onClose:()=>B(null)})]}):b.jsx("div",{style:{padding:40},children:"No chapters found. Create one in the Binder."})},nI={display:"flex",alignItems:"center",justifyContent:"space-between",background:"var(--bg-header)",borderBottom:"1px solid var(--border)",height:"45px",padding:"0 15px",flexShrink:0},iI={flex:1,display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"15px",fontSize:"12px"},rI={flex:1,background:"var(--bg-app)",overflowY:"auto",padding:"0",display:"block",scrollBehavior:"smooth"},oI={width:"800px",maxWidth:"100%",minHeight:"1000px",height:"auto",background:"var(--paper)",boxShadow:"none",padding:"100px 80px",borderRadius:"2px",margin:"0 auto",transition:"transform 0.2s ease"},lI={width:"100%",background:"transparent",border:"none",borderBottom:"1px dashed var(--border)",fontSize:"28px",fontWeight:"bold",color:"var(--text-main)",marginBottom:"30px",outline:"none",paddingBottom:"10px",textAlign:"center"},sI={color:"var(--text-main)",lineHeight:"1.8"},Ds={background:"none",border:"1px solid var(--accent)",color:"var(--accent)",borderRadius:"4px",padding:"4px 8px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},Np={...Ds,background:"var(--accent)",color:"white"},aI={background:"var(--accent)",border:"none",color:"white",borderRadius:"4px",padding:"4px 10px",cursor:"pointer",fontSize:"11px",fontWeight:"bold"},cI={background:"#111",border:"1px solid #444",borderRadius:"6px",display:"flex",padding:"2px",boxShadow:"0 8px 24px rgba(0,0,0,0.5)"},Ns={background:"transparent",border:"none",color:"#ccc",padding:"5px 10px",cursor:"pointer",fontWeight:"bold"},Wc={...Ns,color:"var(--accent)"},nE=document.createElement("style");nE.innerHTML=`
  .seymour-editor p.is-editor-empty:first-child::before { content: attr(data-placeholder); float: left; color: #555; pointer-events: none; height: 0; }
  .seymour-editor img { max-width: 100%; border-radius: 4px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
  .seymour-editor blockquote { border-left: 3px solid var(--accent); margin-left: 0; padding-left: 15px; color: #888; font-style: italic; }
  .seymour-editor a { color: var(--accent); cursor: pointer; text-decoration: underline; }
  .typewriter-active .seymour-editor { padding-top: 40vh !important; padding-bottom: 60vh !important; }
  .focus-mode-active .seymour-editor > * { opacity: 0.15 !important; transition: opacity 0.3s ease; }
  .focus-mode-active .seymour-editor .has-focus { opacity: 1 !important; }
  .focus-mode-active .ProseMirror-focused .has-focus { opacity: 1 !important; }
  .seymour-editor { outline: none; }
  
  /* Lore link styling */
  .lore-link {
    color: var(--accent);
    border-bottom: 1px dotted var(--accent);
    cursor: pointer;
    transition: all 0.2s;
  }
  .lore-link:hover {
    background: rgba(92, 139, 214, 0.1);
    border-bottom-style: solid;
  }
`;document.head.appendChild(nE);const Yc=[{id:"blue",val:"var(--accent)",title:"Blue"},{id:"red",val:"#e74c3c",title:"Red"},{id:"green",val:"#2ecc71",title:"Green"},{id:"gold",val:"#f1c40f",title:"Gold"},{id:"purple",val:"#9b59b6",title:"Purple"},{id:"orange",val:"#e67e22",title:"Orange"},{id:"teal",val:"#1abc9c",title:"Teal"},{id:"pink",val:"#e91e63",title:"Pink"},{id:"brown",val:"#795548",title:"Brown"},{id:"lime",val:"#cddc39",title:"Lime"},{id:"white",val:"#ffffff",title:"White"},{id:"black",val:"#222222",title:"Black"}],uI=5,dI=(t,e)=>{if(!t||t.length===0)return[];const n=uI/e,i=n*2,o=new Map,s=(d,h)=>{const p=Math.floor(d/i),g=Math.floor(h/i);return`${p},${g}`},a=(d,h)=>{const p=Math.floor(d/i),g=Math.floor(h/i),x=[];for(let v=-1;v<=1;v++)for(let S=-1;S<=1;S++)x.push(`${p+v},${g+S}`);return x};t.forEach((d,h)=>{const p=s(d.x,d.y);o.has(p)||o.set(p,[]),o.get(p).push({...d,originalIndex:h,clustered:!1})});const u=[];return t.forEach((d,h)=>{const p=a(d.x,d.y);let g=null;for(const x of p){const v=o.get(x);if(v)for(const S of v){if(S.clustered)continue;const k=d.x-S.x,w=d.y-S.y;Math.sqrt(k*k+w*w)<n&&(g?S.clustered||(g.push(S),S.clustered=!0):(g=[S],S.clustered=!0))}}g&&g.length>0&&u.push(g)}),t.forEach((d,h)=>{const p=s(d.x,d.y),x=o.get(p)?.find(v=>v.originalIndex===h);x&&!x.clustered&&u.push([{...d,originalIndex:h}])}),u},fI=({mapImage:t,pins:e=[],onAddPin:n,onRemovePin:i,onPinClick:o,allEntities:s})=>{const a=R.useRef(null),[u,d]=R.useState(1),[h,p]=R.useState({x:0,y:0}),[g,x]=R.useState(!1),[v,S]=R.useState({x:0,y:0}),[k,w]=R.useState(!1),[E,A]=R.useState(null),[D,L]=R.useState(""),[T,z]=R.useState(Yc[0].val),[N,B]=R.useState(null),_=R.useMemo(()=>dI(e,u),[e,u]),W=R.useMemo(()=>{const te={};return e.forEach(pe=>{const O=pe.color||"var(--accent)";te[O]||(te[O]=[]);const U=s.find(K=>K.id==pe.linkedId);te[O].push({...pe,name:U?U.name:"Unknown Location"})}),te},[e,s]),oe=R.useCallback((te,pe)=>{const O=Math.min(Math.max(1,te),10);if(O===u)return;const U=O/u,K=pe.x-(pe.x-h.x)*U,ie=pe.y-(pe.y-h.y)*U;p(O===1?{x:0,y:0}:{x:K,y:ie}),d(O)},[u,h]),re=R.useRef(0);R.useEffect(()=>{const te=a.current;if(!te)return;const pe=O=>{O.preventDefault(),O.stopPropagation();const U=Date.now();if(U-re.current<16)return;re.current=U;const K=te.getBoundingClientRect(),ie=O.clientX-K.left,le=O.clientY-K.top,Y=.1,Z=O.deltaY>0?-1:1,ae=u+Z*Y*u;oe(ae,{x:ie,y:le})};return te.addEventListener("wheel",pe,{passive:!1}),()=>te.removeEventListener("wheel",pe)},[u,oe]);const fe=te=>{const pe=a.current.getBoundingClientRect(),O=pe.width/2,U=pe.height/2,K=u+te*.5;oe(K,{x:O,y:U})},he=te=>{te.target.closest(".pin-wrapper")||te.target.closest(".map-modal")||te.target.closest(".key-log")||(x(!0),S({x:te.clientX-h.x,y:te.clientY-h.y}))},we=te=>{g&&(te.preventDefault(),p({x:te.clientX-v.x,y:te.clientY-v.y}))},q=()=>x(!1),ee=te=>{if(!t||k)return;const pe=a.current.getBoundingClientRect(),O=te.clientX-pe.left,U=te.clientY-pe.top,K=O-h.x,ie=U-h.y,le=K/(pe.width*u)*100,Y=ie/(pe.height*u)*100;le<0||le>100||Y<0||Y>100||(A({x:le,y:Y}),w(!0),L(""),z(Yc[0].val))},ce=()=>{D&&(n({...E,linkedId:D,color:T,id:Date.now()}),w(!1),A(null))};return b.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",width:"100%",overflowY:"auto"},children:[b.jsxs("div",{style:SI,className:"key-log custom-scrollbar",onWheel:te=>te.stopPropagation(),children:[b.jsxs("div",{style:{fontSize:"10px",fontWeight:"bold",color:"var(--text-muted)",marginBottom:"10px",letterSpacing:"1px",borderBottom:"1px solid #333",paddingBottom:"5px",position:"sticky",top:0,background:"var(--bg-panel)",zIndex:10},children:["MAP KEY (Grouped by Color)  ",e.length," pins"]}),b.jsxs("div",{style:{display:"flex",gap:"30px",flexWrap:"wrap",alignContent:"flex-start"},children:[Object.entries(W).map(([te,pe])=>{const O=Yc.find(U=>U.val===te)?.title||"Custom";return b.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px",minWidth:"100px"},children:[b.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"4px"},children:[b.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:te}}),b.jsx("span",{style:{fontSize:"10px",color:"#888",fontWeight:"bold",textTransform:"uppercase"},children:O})]}),pe.map((U,K)=>b.jsx("div",{onMouseEnter:()=>B(U.id),onMouseLeave:()=>B(null),onClick:()=>o(U.linkedId),style:{fontSize:"12px",color:N===U.id?"var(--accent)":"var(--text-main)",cursor:"pointer",paddingLeft:"14px",fontWeight:N===U.id?"bold":"normal",textDecoration:N===U.id?"underline":"none",transition:"color 0.1s"},children:U.name},K))]},te)}),e.length===0&&b.jsx("div",{style:{fontSize:"12px",color:"#555",fontStyle:"italic"},children:"Double click map below to add pins."})]})]}),b.jsxs("div",{style:{height:"70vh",minHeight:"500px",flexShrink:0,overflow:"hidden",background:"#111",position:"relative"},ref:a,onMouseDown:he,onMouseMove:we,onMouseUp:q,onMouseLeave:q,onDoubleClick:ee,children:[b.jsxs("div",{style:hI,children:[b.jsx("button",{onClick:()=>fe(1),style:jp,children:"+"}),b.jsxs("div",{style:{background:"#222",padding:"5px 10px",fontSize:"12px"},children:[Math.round(u*100),"%"]}),b.jsx("button",{onClick:()=>fe(-1),style:jp,children:"-"}),b.jsx("button",{onClick:()=>{d(1),p({x:0,y:0})},style:{...jp,width:"auto",padding:"0 8px"},children:"Reset"})]}),b.jsxs("div",{style:{transform:`translate(${h.x}px, ${h.y}px) scale(${u})`,transformOrigin:"0 0",transition:g?"none":"transform 0.1s ease-out",width:"100%",height:"100%",cursor:g?"grabbing":"crosshair",willChange:"transform"},children:[t?b.jsx("img",{src:t,alt:"Map",style:{width:"100%",height:"100%",objectFit:"contain",pointerEvents:"none"},draggable:!1}):b.jsx("div",{style:{color:"#666",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:"Upload Map to Begin"}),_.map((te,pe)=>{const O=te.reduce((ae,me)=>ae+me.x,0)/te.length,U=te.reduce((ae,me)=>ae+me.y,0)/te.length,K=te.some(ae=>ae.id===N);if(te.length>1)return b.jsx("div",{className:"cluster-wrapper",style:{...fS,left:`${O}%`,top:`${U}%`,transform:`translate(-50%, -50%) scale(${1/u})`,zIndex:K?200:50},children:b.jsx("div",{style:{...mI,border:K?"3px solid #f1c40f":"2px solid var(--accent)",background:K?"#222":"rgba(255, 255, 255, 0.9)",color:K?"#f1c40f":"black",boxShadow:K?"0 0 15px #f1c40f":"0 4px 10px rgba(0,0,0,0.5)",transform:K?"scale(1.2)":"scale(1)",transition:"all 0.2s ease"},children:te.length})},`cluster-${pe}`);const le=te[0],Y=s.find(ae=>ae.id==le.linkedId),Z=N===le.id;return b.jsxs("div",{className:"pin-wrapper",title:Y?.name,style:{...fS,left:`${le.x}%`,top:`${le.y}%`,transform:`translate(-50%, -50%) scale(${1/u})`,zIndex:Z?100:10},children:[b.jsx("div",{onClick:ae=>{ae.stopPropagation(),o(le.linkedId)},style:{width:Z?"28px":"18px",height:Z?"28px":"18px",background:le.color||"var(--accent)",borderRadius:"50%",border:"2px solid white",boxShadow:Z?"0 0 0 4px white, 0 0 20px black":"0 2px 5px black",cursor:"pointer",transition:"all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275)"}}),Z&&b.jsx("div",{style:wI,children:Y?.name}),b.jsx("button",{onClick:ae=>{ae.stopPropagation(),i(le.originalIndex)},className:"pin-delete",style:pI,children:""})]},`pin-${le.originalIndex}`)})]}),k&&b.jsx("div",{style:gI,className:"map-modal",children:b.jsxs("div",{style:yI,children:[b.jsx("div",{style:{fontWeight:"bold",marginBottom:"10px",color:"var(--text-main)"},children:"Add Pin"}),b.jsxs("div",{style:{marginBottom:"10px"},children:[b.jsx("label",{style:{fontSize:"11px",color:"var(--text-muted)"},children:"LINK TO:"}),b.jsxs("select",{value:D,onChange:te=>L(te.target.value),style:xI,children:[b.jsx("option",{value:"",disabled:!0,children:"Select Entity..."}),s.map(te=>b.jsx("option",{value:te.id,children:te.name},te.id))]})]}),b.jsxs("div",{style:{marginBottom:"15px"},children:[b.jsx("label",{style:{fontSize:"11px",color:"var(--text-muted)"},children:"COLOR:"}),b.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginTop:"5px"},children:Yc.map(te=>b.jsx("div",{title:te.title,onClick:()=>z(te.val),style:{width:"20px",height:"20px",borderRadius:"50%",background:te.val,cursor:"pointer",border:T===te.val?"2px solid white":"1px solid #555",boxShadow:T===te.val?"0 0 0 2px var(--accent)":"none"}},te.id))})]}),b.jsxs("div",{style:{display:"flex",gap:"10px"},children:[b.jsx("button",{onClick:()=>w(!1),style:bI,children:"Cancel"}),b.jsx("button",{onClick:ce,disabled:!D,style:vI,children:"Add Pin"})]})]})})]}),b.jsx("div",{style:{height:"120px",flexShrink:0}}),b.jsx("style",{children:`
        .pin-wrapper:hover .pin-delete { display: flex !important; }
        .cluster-wrapper:hover { z-index: 100 !important; }
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #111; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #444; borderRadius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #666; }
      `})]})},hI={position:"absolute",bottom:"10px",right:"10px",display:"flex",gap:"5px",zIndex:50,background:"rgba(0,0,0,0.5)",padding:"5px",borderRadius:"4px"},jp={background:"#333",color:"white",border:"1px solid #555",width:"25px",height:"25px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},fS={position:"absolute",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},pI={position:"absolute",top:0,right:0,background:"red",color:"white",fontSize:"12px",fontWeight:"bold",width:"18px",height:"18px",borderRadius:"50%",border:"1px solid white",cursor:"pointer",display:"none",alignItems:"center",justifyContent:"center",padding:0},mI={width:"30px",height:"30px",background:"rgba(255, 255, 255, 0.9)",color:"black",borderRadius:"50%",border:"2px solid var(--accent)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",fontSize:"14px",boxShadow:"0 4px 10px rgba(0,0,0,0.5)",cursor:"pointer"},gI={position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},yI={background:"var(--bg-panel)",padding:"20px",border:"1px solid var(--border)",boxShadow:"0 5px 20px black",borderRadius:"8px",minWidth:"250px"},xI={width:"100%",padding:"5px",marginTop:"5px",background:"var(--bg-app)",color:"var(--text-main)",border:"1px solid var(--border)"},bI={flex:1,background:"transparent",border:"1px solid var(--border)",color:"var(--text-muted)",cursor:"pointer",padding:"6px",borderRadius:"4px"},vI={flex:1,background:"var(--accent)",border:"none",color:"white",cursor:"pointer",padding:"6px",borderRadius:"4px",fontWeight:"bold"},SI={minHeight:"120px",background:"var(--bg-panel)",borderBottom:"2px solid var(--border)",padding:"15px 20px",flexShrink:0,zIndex:60,position:"relative"},wI={position:"absolute",top:"-35px",left:"50%",transform:"translateX(-50%)",background:"rgba(0,0,0,0.9)",color:"white",padding:"4px 10px",borderRadius:"4px",fontSize:"12px",whiteSpace:"nowrap",pointerEvents:"none",border:"1px solid var(--accent)",boxShadow:"0 4px 10px black",zIndex:200},CI=()=>{const{projectData:t,setProjectData:e}=Tt(),n=Er(),i=t.worldMap||{imageSrc:null,pins:[]},o=Array.isArray(i)?i:[{id:"default",name:"Global Map",imageSrc:i.imageSrc,pins:i.pins||[]}],[s,a]=R.useState(o[0].id),u=o.find(L=>L.id===s)||o[0],d=t.lore.characters||[],[h,p]=R.useState({isOpen:!1,type:"input",title:"",message:"",onConfirm:()=>{}}),g=()=>p({...h,isOpen:!1}),x=L=>{const T=o.map(z=>z.id===s?{...z,...L}:z);e(z=>({...z,worldMap:T}))},v=()=>{p({isOpen:!0,type:"input",title:"New Map Name",message:'e.g. "Capital City"',onConfirm:L=>{const T={id:Date.now(),name:L||"Untitled Map",imageSrc:null,pins:[]};e(z=>({...z,worldMap:[...Array.isArray(z.worldMap)?z.worldMap:o,T]})),a(T.id),g()}})},S=L=>{p({isOpen:!0,type:"input",title:"Rename Map",message:"Enter new name:",onConfirm:T=>{if(!T)return g();const z=o.map(N=>N.id===L?{...N,name:T}:N);e(N=>({...N,worldMap:z})),g()}})},k=(L,T)=>{if(T.stopPropagation(),o.length===1)return alert("Cannot delete the last map.");p({isOpen:!0,type:"confirm",title:"Delete Map",message:"Are you sure? All pins on this map will be lost.",onConfirm:()=>{const z=o.filter(N=>N.id!==L);e(N=>({...N,worldMap:z})),a(z[0].id),g()}})},w=async L=>{const T=L.target.files[0];if(!T)return;const z=(T.size/1024/1024).toFixed(2);console.log(` Original map size: ${z}MB`);try{const N=await YS(T,1920,1920,.8);x({imageSrc:N})}catch(N){console.error("Map compression failed:",N),alert("Failed to upload map. Please try a smaller file.")}},E=L=>{const T={...L,id:L.id||Date.now()};x({pins:[...u.pins,T]})},A=L=>{p({isOpen:!0,type:"confirm",title:"Delete Pin",message:"Remove this pin?",onConfirm:()=>{const T=[...u.pins];T.splice(L,1),x({pins:T}),g()}})},D=L=>{L&&n(`/lore?id=${L}`)};return b.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#000"},children:[b.jsx(Wt,{isOpen:h.isOpen,type:h.type,title:h.title,message:h.message,onConfirm:h.onConfirm,onCancel:g}),b.jsxs("div",{style:kI,children:[b.jsx("div",{style:{display:"flex",gap:"2px",overflowX:"auto",flex:1},children:o.map(L=>b.jsxs("div",{onClick:()=>a(L.id),onDoubleClick:()=>S(L.id),style:{...EI,background:s===L.id?"var(--bg-app)":"var(--bg-panel)",borderBottom:s===L.id?"2px solid var(--accent)":"2px solid transparent",color:s===L.id?"var(--text-main)":"var(--text-muted)"},children:[L.name,o.length>1&&b.jsx("span",{onClick:T=>k(L.id,T),style:TI,children:""})]},L.id))}),b.jsx("button",{onClick:v,style:MI,children:"+ Add a new Map"})]}),b.jsxs("div",{style:AI,children:[b.jsx("div",{children:b.jsx("div",{style:{fontSize:"11px",color:"var(--text-muted)"},children:u.imageSrc?"Double-click map to add pins.":"Upload an image to start."})}),b.jsxs("label",{style:OI,children:[u.imageSrc?"Replace Image":"Upload Image",b.jsx("input",{type:"file",accept:"image/*",onChange:w,style:{display:"none"}})]})]}),b.jsx("div",{style:{flex:1,overflow:"hidden",position:"relative"},children:b.jsx(fI,{mapImage:u.imageSrc,pins:u.pins||[],onAddPin:E,onRemovePin:A,onPinClick:D,allEntities:d},s)})]})},kI={height:"36px",background:"var(--bg-header)",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",padding:"0 10px",gap:"5px"},EI={padding:"0 15px",height:"100%",display:"flex",alignItems:"center",fontSize:"12px",fontWeight:"bold",cursor:"pointer",borderRight:"1px solid var(--border)",position:"relative",whiteSpace:"nowrap"},TI={marginLeft:"8px",fontSize:"14px",color:"#666",cursor:"pointer"},MI={background:"none",border:"none",color:"var(--accent)",fontSize:"12px",fontWeight:"bold",cursor:"pointer",padding:"0 10px",display:"flex",alignItems:"center",whiteSpace:"nowrap"},AI={padding:"8px 20px",background:"var(--bg-panel)",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center",zIndex:10},OI={background:"var(--bg-header)",border:"1px solid var(--border)",padding:"4px 12px",borderRadius:"4px",color:"var(--text-main)",cursor:"pointer",fontWeight:"bold",fontSize:"11px"},RI=()=>{const{projectData:t,setProjectData:e}=Tt(),n=i=>{e({...t,globalNotes:i.target.value})};return b.jsxs("div",{style:{padding:"40px",height:"100%",display:"flex",flexDirection:"column",background:"var(--bg-app)"},children:[b.jsx("h2",{style:{color:"var(--text-main)",marginBottom:"20px"},children:" Global Scratchpad"}),b.jsx("textarea",{value:t.globalNotes||"",onChange:n,placeholder:"Store your overarching plot points, series bibles, or random ideas here...",style:DI})]})},DI={flex:1,background:"var(--bg-panel)",color:"var(--text-main)",border:"1px solid var(--border)",borderRadius:"8px",padding:"20px",fontSize:"16px",lineHeight:"1.6",outline:"none",resize:"none",fontFamily:"inherit"},zp=[{id:"era",label:"Era / Age",color:"#fff",border:"2px solid #fff"},{id:"war",label:"War / Conflict",color:"#e74c3c",border:"1px solid #e74c3c"},{id:"pol",label:"Political",color:"#f1c40f",border:"1px solid #f1c40f"},{id:"bio",label:"Life Event",color:"#3498db",border:"1px solid #3498db"},{id:"lore",label:"General Lore",color:"#9b59b6",border:"1px solid #9b59b6"}],NI=()=>{const{projectData:t,setProjectData:e}=Tt(),n=t.timeline||[],[i,o]=R.useState({isOpen:!1,type:"input",title:"",onConfirm:()=>{}}),[s,a]=R.useState(!1),[u,d]=R.useState(null),[h,p]=R.useState({year:0,displayDate:"",title:"",desc:"",type:"lore"}),g=()=>o({...i,isOpen:!1}),x=()=>{let w;const E={id:u||Date.now(),year:parseInt(h.year)||0,displayDate:h.displayDate,title:h.title,desc:h.desc,type:h.type};u?w=n.map(A=>A.id===u?E:A):w=[...n,E],w.sort((A,D)=>A.year-D.year),e({...t,timeline:w}),k()},v=w=>{o({isOpen:!0,type:"confirm",title:"Delete Event",message:"Remove this event from history?",onConfirm:()=>{const E=n.filter(A=>A.id!==w);e({...t,timeline:E}),g()}})},S=w=>{p({year:w.year,displayDate:w.displayDate,title:w.title,desc:w.desc,type:w.type}),d(w.id),a(!0)},k=()=>{p({year:0,displayDate:"",title:"",desc:"",type:"lore"}),d(null),a(!1)};return b.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"var(--bg-app)"},children:[b.jsx(Wt,{isOpen:i.isOpen,type:i.type,title:i.title,message:i.message,onConfirm:i.onConfirm,onCancel:g}),b.jsxs("div",{style:jI,children:[b.jsx("h2",{style:{margin:0,color:"var(--text-main)"},children:" The Chronicle"}),b.jsx("button",{onClick:()=>a(!0),style:zI,children:"+ Add Event"})]}),b.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[b.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"40px",position:"relative"},children:[b.jsx("div",{style:LI}),n.length===0&&b.jsx("div",{style:{textAlign:"center",color:"#666",marginTop:"50px"},children:"No history recorded yet."}),n.map((w,E)=>{const A=zp.find(L=>L.id===w.type)||zp[4],D=E%2===0;return b.jsxs("div",{style:{...BI,flexDirection:D?"row":"row-reverse"},children:[b.jsx("div",{style:II,children:b.jsxs("div",{style:{..._I,borderLeft:D?`4px solid ${A.color}`:"none",borderRight:D?"none":`4px solid ${A.color}`},children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[b.jsx("span",{style:{fontSize:"12px",fontWeight:"bold",color:A.color,textTransform:"uppercase"},children:w.displayDate||w.year}),b.jsxs("div",{style:{display:"flex",gap:"5px"},children:[b.jsx("button",{onClick:()=>S(w),style:hS,children:""}),b.jsx("button",{onClick:()=>v(w.id),style:{...hS,color:"red"},children:""})]})]}),b.jsx("div",{style:{fontSize:"16px",fontWeight:"bold",color:"var(--text-main)",marginBottom:"5px"},children:w.title}),b.jsx("div",{style:{fontSize:"13px",color:"var(--text-muted)",lineHeight:"1.5"},children:w.desc})]})}),b.jsx("div",{style:{...HI,background:A.color,boxShadow:`0 0 10px ${A.color}`}}),b.jsx("div",{style:{flex:1}})]},w.id)})]}),s&&b.jsxs("div",{style:UI,children:[b.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"20px",color:"var(--text-main)"},children:u?"Edit Event":"New Event"}),b.jsx("label",{style:Es,children:"Sort Order (Numeric Year)"}),b.jsx("input",{type:"number",value:h.year,onChange:w=>p({...h,year:w.target.value}),style:Gc}),b.jsx("label",{style:Es,children:'Display Date (e.g. "4th Age, 202")'}),b.jsx("input",{type:"text",value:h.displayDate,onChange:w=>p({...h,displayDate:w.target.value}),style:Gc}),b.jsx("label",{style:Es,children:"Event Type"}),b.jsx("div",{style:{display:"flex",gap:"5px",marginBottom:"15px",flexWrap:"wrap"},children:zp.map(w=>b.jsx("div",{onClick:()=>p({...h,type:w.id}),style:{...$I,borderColor:w.color,background:h.type===w.id?w.color:"transparent",color:h.type===w.id?"#000":w.color},children:w.label},w.id))}),b.jsx("label",{style:Es,children:"Title"}),b.jsx("input",{type:"text",value:h.title,onChange:w=>p({...h,title:w.target.value}),style:Gc}),b.jsx("label",{style:Es,children:"Description"}),b.jsx("textarea",{value:h.desc,onChange:w=>p({...h,desc:w.target.value}),style:{...Gc,height:"100px",resize:"none"}}),b.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[b.jsx("button",{onClick:x,style:PI,children:"Save Event"}),b.jsx("button",{onClick:k,style:VI,children:"Cancel"})]})]})]})]})},jI={padding:"20px 40px",borderBottom:"1px solid var(--border)",background:"var(--bg-header)",display:"flex",justifyContent:"space-between",alignItems:"center"},zI={background:"var(--accent)",border:"none",color:"white",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},LI={position:"absolute",left:"50%",top:0,bottom:0,width:"2px",background:"var(--border)",transform:"translateX(-50%)"},BI={display:"flex",alignItems:"center",marginBottom:"40px",position:"relative",zIndex:2},II={flex:1,display:"flex",justifyContent:"center"},_I={width:"80%",background:"var(--bg-panel)",padding:"15px",borderRadius:"6px",border:"1px solid var(--border)",boxShadow:"0 4px 10px rgba(0,0,0,0.3)"},HI={width:"16px",height:"16px",borderRadius:"50%",border:"3px solid var(--bg-app)",position:"absolute",left:"50%",transform:"translateX(-50%)",zIndex:10},hS={background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)",fontSize:"14px"},UI={width:"350px",background:"var(--bg-panel)",borderLeft:"1px solid var(--border)",padding:"20px",display:"flex",flexDirection:"column"},Es={fontSize:"11px",color:"var(--text-muted)",marginBottom:"5px",fontWeight:"bold",textTransform:"uppercase"},Gc={width:"100%",background:"var(--bg-app)",border:"1px solid var(--border)",color:"var(--text-main)",padding:"8px",borderRadius:"4px",marginBottom:"15px",outline:"none"},$I={padding:"4px 8px",borderRadius:"12px",border:"1px solid",fontSize:"10px",cursor:"pointer",fontWeight:"bold",transition:"0.2s"},PI={flex:1,background:"var(--accent)",border:"none",color:"white",padding:"10px",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},VI={flex:1,background:"transparent",border:"1px solid var(--border)",color:"var(--text-muted)",padding:"10px",borderRadius:"4px",cursor:"pointer"},qI=()=>{const{projectData:t,setProjectData:e}=Tt(),n=t?.relationships;let i=[];Array.isArray(n)&&n.length>0?i=n:n&&!Array.isArray(n)&&(n.nodes||n.edges)?i=[{id:"default",name:"Main Web",nodes:n.nodes||[],edges:n.edges||[]}]:i=[{id:"default",name:"Main Web",nodes:[],edges:[]}];const[o,s]=R.useState(i[0]?.id||"default"),a=i.find(Y=>Y.id===o)||i[0],u=a?.nodes||[],d=a?.edges||[],[h,p]=R.useState(1),[g,x]=R.useState({x:0,y:0}),[v,S]=R.useState(!1),[k,w]=R.useState({x:0,y:0}),[E,A]=R.useState(null),[D,L]=R.useState(!1),[T,z]=R.useState(null),[N,B]=R.useState({isOpen:!1,type:"input",title:"",onConfirm:()=>{}}),_=()=>B({...N,isOpen:!1}),W=Y=>{const Z=i.map(ae=>ae.id===o?{...ae,...Y}:ae);e(ae=>({...ae,relationships:Z}))},oe=()=>{B({isOpen:!0,type:"input",title:"New Web Name",message:`e.g. "Leon's Relations"`,onConfirm:Y=>{const Z={id:Date.now(),name:Y||"Untitled Web",nodes:[],edges:[]};e(ae=>({...ae,relationships:[...i,Z]})),s(Z.id),x({x:0,y:0}),p(1),_()}})},re=Y=>{i.find(Z=>Z.id===Y),B({isOpen:!0,type:"input",title:"Rename Web",message:"Enter new name:",onConfirm:Z=>{if(!Z)return _();const ae=i.map(me=>me.id===Y?{...me,name:Z}:me);e(me=>({...me,relationships:ae})),_()}})},fe=(Y,Z)=>{if(Z.stopPropagation(),i.length===1)return alert("Cannot delete the last tab.");B({isOpen:!0,type:"confirm",title:"Delete Web",message:"Are you sure? This cannot be undone.",onConfirm:()=>{const ae=i.filter(me=>me.id!==Y);e(me=>({...me,relationships:ae})),s(ae[0].id),_()}})},he=Y=>{if(Y.target.closest(".node-card"))return;const Z=Math.min(Math.max(.5,h-Y.deltaY*.001),2);p(Z)},we=Y=>{Y.target.closest(".node-card")||Y.target.closest("button")||(S(!0),w({x:Y.clientX-g.x,y:Y.clientY-g.y}))},q=Y=>{if(v&&x({x:Y.clientX-k.x,y:Y.clientY-k.y}),E){const Z=(Y.clientX-E.mouseX)/h,ae=(Y.clientY-E.mouseY)/h,me=u.map(Mt=>Mt.id===E.id?{...Mt,x:E.startX+Z,y:E.startY+ae}:Mt);W({nodes:me})}},ee=()=>{S(!1),A(null)},ce=Y=>{if(u.find(ae=>ae.id===Y))return;const Z={id:Y,x:100+Math.random()*50,y:100+Math.random()*50};W({nodes:[...u,Z]})},te=Y=>{B({isOpen:!0,type:"confirm",title:"Remove Character",message:"Remove from this web?",onConfirm:()=>{W({nodes:u.filter(Z=>Z.id!==Y),edges:d.filter(Z=>Z.source!==Y&&Z.target!==Y)}),_()}})},pe=(Y,Z,ae,me)=>{if(D){O(Z);return}Y.target.closest(".node-delete")||(Y.stopPropagation(),A({id:Z,startX:ae,startY:me,mouseX:Y.clientX,mouseY:Y.clientY}))},O=Y=>{if(!T)z(Y);else{if(T===Y){z(null);return}B({isOpen:!0,type:"input",title:"Relationship Label",onConfirm:Z=>{const ae={id:Date.now(),source:T,target:Y,label:Z||""};W({edges:[...d,ae]}),z(null),L(!1),_()}})}},U=Y=>{B({isOpen:!0,type:"confirm",title:"Delete Connection",message:"Delete line?",onConfirm:()=>{W({edges:d.filter(Z=>Z.id!==Y)}),_()}})},K=t?.lore?.characters||[],ie=()=>{const Y=new Set(u.map(Z=>Z.id));return K.filter(Z=>!Y.has(Z.id))},le=Y=>{const Z=u.find(ae=>ae.id===Y);return Z?{x:Z.x+60,y:Z.y+30}:{x:0,y:0}};return b.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",background:"#111"},children:[b.jsx(Wt,{isOpen:N.isOpen,type:N.type,title:N.title,message:N.message,onConfirm:N.onConfirm,onCancel:_}),b.jsxs("div",{style:FI,children:[b.jsx("div",{style:{display:"flex",gap:"2px",overflowX:"auto",flex:1},className:"custom-scrollbar",children:i.map(Y=>b.jsxs("div",{onClick:()=>{s(Y.id),x({x:0,y:0}),p(1)},onDoubleClick:()=>re(Y.id),style:{...WI,background:o===Y.id?"var(--bg-app)":"var(--bg-panel)",borderBottom:o===Y.id?"2px solid var(--accent)":"2px solid transparent",color:o===Y.id?"var(--text-main)":"var(--text-muted)"},children:[Y.name,i.length>1&&b.jsx("span",{onClick:Z=>fe(Y.id,Z),style:YI,children:""})]},Y.id))}),b.jsx("button",{onClick:oe,style:GI,children:"+ New Web"})]}),b.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[b.jsxs("div",{style:KI,children:[b.jsx("div",{style:{fontWeight:"bold",paddingBottom:"10px",borderBottom:"1px solid var(--border)",marginBottom:"10px",color:"var(--accent)",fontSize:"11px",letterSpacing:"1px"},children:"UNPLACED CHARACTERS"}),b.jsxs("div",{style:{overflowY:"auto",flex:1},className:"custom-scrollbar",children:[ie().map(Y=>b.jsxs("div",{style:XI,children:[b.jsx("span",{children:Y.name}),b.jsx("button",{onClick:()=>ce(Y.id),style:JI,children:"+"})]},Y.id)),ie().length===0&&b.jsx("div",{style:{color:"#555",fontSize:"12px",fontStyle:"italic"},children:"All characters placed."})]})]}),b.jsxs("div",{style:{flex:1,overflow:"hidden",position:"relative",cursor:v?"grabbing":"default",background:"#0a0a0a"},onMouseDown:we,onMouseMove:q,onMouseUp:ee,onMouseLeave:ee,onWheel:he,children:[b.jsxs("div",{style:QI,children:[b.jsx("button",{onClick:()=>{L(!D),z(null)},style:{...pS,background:D?"var(--accent)":"#333",color:D?"white":"#ccc"},children:D?T?"Select Target...":"Select Source...":" Connect"}),b.jsx("button",{onClick:()=>{x({x:0,y:0}),p(1)},style:pS,children:"Reset View"})]}),b.jsxs("div",{style:{transform:`translate(${g.x}px, ${g.y}px) scale(${h})`,transformOrigin:"0 0",width:"100%",height:"100%",position:"absolute"},children:[b.jsxs("svg",{style:{width:"100%",height:"100%",position:"absolute",top:0,left:0,overflow:"visible",pointerEvents:"none"},children:[b.jsx("defs",{children:b.jsx("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"28",refY:"3.5",orient:"auto",children:b.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#555"})})}),d.map(Y=>{const Z=le(Y.source),ae=le(Y.target);return Z.x===0||ae.x===0?null:b.jsxs("g",{pointerEvents:"auto",onClick:()=>U(Y.id),style:{cursor:"pointer"},children:[b.jsx("line",{x1:Z.x,y1:Z.y,x2:ae.x,y2:ae.y,stroke:"#555",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),b.jsx("rect",{x:(Z.x+ae.x)/2-20,y:(Z.y+ae.y)/2-10,width:"40",height:"20",rx:"4",fill:"#000"}),b.jsx("text",{x:(Z.x+ae.x)/2,y:(Z.y+ae.y)/2,dy:"4",textAnchor:"middle",fill:"#ccc",fontSize:"10",fontWeight:"bold",children:Y.label})]},Y.id)})]}),u.map(Y=>{const Z=K.find(me=>me.id===Y.id);if(!Z)return null;const ae=T===Y.id;return b.jsxs("div",{className:"node-card",onMouseDown:me=>pe(me,Y.id,Y.x,Y.y),style:{position:"absolute",left:Y.x,top:Y.y,width:"120px",height:"60px",background:ae?"var(--accent)":"var(--bg-panel)",border:ae?"2px solid white":"1px solid var(--border)",borderRadius:"8px",display:"flex",alignItems:"center",padding:"5px",gap:"8px",boxShadow:"0 4px 10px rgba(0,0,0,0.5)",cursor:D?"crosshair":"grab",zIndex:10},children:[b.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#000",overflow:"hidden",flexShrink:0,border:"1px solid #444"},children:Z.imageSrc?b.jsx("img",{src:Z.imageSrc,alt:"",style:{width:"100%",height:"100%",objectFit:"cover"},draggable:!1}):null}),b.jsx("div",{style:{flex:1,minWidth:0},children:b.jsx("div",{style:{fontSize:"11px",fontWeight:"bold",color:ae?"white":"var(--text-main)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:Z.name})}),b.jsx("button",{className:"node-delete",onClick:me=>{me.stopPropagation(),te(Y.id)},style:ZI,children:""})]},Y.id)})]})]})]}),b.jsx("style",{children:` 
        .node-card:hover .node-delete { opacity: 1 !important; } 
        /* Custom Scrollbar for Sidebar */
        .custom-scrollbar::-webkit-scrollbar { width: 4px; height: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: transparent; }
        .custom-scrollbar:hover::-webkit-scrollbar-thumb { background: #444; border-radius: 2px; }
      `})]})},FI={height:"36px",background:"var(--bg-header)",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",padding:"0 10px",gap:"5px"},WI={padding:"0 15px",height:"100%",display:"flex",alignItems:"center",fontSize:"12px",fontWeight:"bold",cursor:"pointer",borderRight:"1px solid var(--border)",position:"relative",whiteSpace:"nowrap"},YI={marginLeft:"8px",fontSize:"14px",color:"#666",cursor:"pointer"},GI={background:"none",border:"none",color:"var(--accent)",fontSize:"12px",fontWeight:"bold",cursor:"pointer",padding:"0 10px",display:"flex",alignItems:"center",whiteSpace:"nowrap"},KI={width:"220px",background:"var(--bg-panel)",borderRight:"1px solid var(--border)",display:"flex",flexDirection:"column",padding:"15px",zIndex:20},XI={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px",background:"var(--bg-app)",marginBottom:"5px",borderRadius:"4px",border:"1px solid var(--border)",fontSize:"13px"},JI={background:"var(--bg-header)",border:"1px solid #555",cursor:"pointer",color:"var(--accent)",borderRadius:"3px",fontWeight:"bold",width:"20px"},QI={position:"absolute",top:10,left:10,zIndex:100,display:"flex",gap:"10px"},pS={padding:"8px 12px",background:"var(--bg-panel)",border:"1px solid var(--border)",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",fontSize:"12px",color:"var(--text-main)",boxShadow:"0 2px 5px rgba(0,0,0,0.3)"},ZI={position:"absolute",top:"-6px",right:"-6px",width:"18px",height:"18px",background:"#e74c3c",color:"white",border:"2px solid var(--bg-panel)",borderRadius:"50%",fontSize:"10px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",opacity:0,transition:"opacity 0.2s",padding:0};function e_(){const[t,e]=R.useState("dark"),{saveToDisk:n,loadFromDisk:i,projectData:o,setProjectData:s}=Tt(),a={title:"Untitled Project",globalNotes:"",settings:{fontSize:18,zoom:100,fontFamily:"serif",customFonts:[]},manuscript:{chapters:[{id:1,title:"Chapter 1",content:"<p>Once upon a time...</p>",synopsis:"",notes:""}]},lore:{characters:[],folders:[{id:"root_char",name:"Characters",parentId:null,isOpen:!0},{id:"root_loc",name:"Locations",parentId:null,isOpen:!0},{id:"root_misc",name:"Unsorted",parentId:null,isOpen:!0}]},worldMap:{imageSrc:null,pins:[]},timeline:[],relationships:[]};R.useEffect(()=>{document.documentElement.setAttribute("data-theme",t)},[t]),R.useEffect(()=>(window.electronAPI&&(window.electronAPI.onMenuNewProject(()=>{s(a)}),window.electronAPI.onMenuLoadProject((d,h)=>{try{const p=JSON.parse(h);s(p)}catch(p){console.error("Failed to load project:",p)}}),window.electronAPI.onMenuSaveProject(()=>{n()}),window.electronAPI.onMenuSaveProjectAs(()=>{n()}),window.electronAPI.onMenuGetProjectData(()=>{window.electronAPI.sendProjectData(o)})),()=>{window.electronAPI&&(window.electronAPI.removeAllListeners("menu-new-project"),window.electronAPI.removeAllListeners("menu-load-project"),window.electronAPI.removeAllListeners("menu-save-project"),window.electronAPI.removeAllListeners("menu-save-project-as"),window.electronAPI.removeAllListeners("menu-get-project-data"))}),[n,s]);const u=()=>{e(d=>d==="dark"?"light":"dark")};return b.jsx(TO,{children:b.jsx(lO,{children:b.jsx(LA,{children:b.jsxs(vi,{path:"/",element:b.jsx(OR,{theme:t,toggleTheme:u}),children:[b.jsx(vi,{index:!0,element:b.jsx(cv,{})}),b.jsx(vi,{path:"lore",element:b.jsx(cv,{})}),b.jsx(vi,{path:"map",element:b.jsx(CI,{})}),b.jsx(vi,{path:"scratchpad",element:b.jsx(RI,{})}),b.jsx(vi,{path:"editor",element:b.jsx(tI,{})}),b.jsx(vi,{path:"timeline",element:b.jsx(NI,{})}),b.jsx(vi,{path:"web",element:b.jsx(qI,{})})]})})})})}LM.createRoot(document.getElementById("root")).render(b.jsxs(Ri.StrictMode,{children:[b.jsxs(VO,{children:["  ",b.jsx(e_,{})]})," "]}));
